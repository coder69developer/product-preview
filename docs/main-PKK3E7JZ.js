var $S=Object.defineProperty,BR=Object.defineProperties;var VR=Object.getOwnPropertyDescriptors;var jd=Object.getOwnPropertySymbols;var qS=Object.prototype.hasOwnProperty,XS=Object.prototype.propertyIsEnumerable;var WS=(i,e,t)=>e in i?$S(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ie=(i,e)=>{for(var t in e||={})qS.call(e,t)&&WS(i,t,e[t]);if(jd)for(var t of jd(e))XS.call(e,t)&&WS(i,t,e[t]);return i},tt=(i,e)=>BR(i,VR(e));var ml=(i,e)=>{var t={};for(var n in i)qS.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&jd)for(var n of jd(i))e.indexOf(n)<0&&XS.call(i,n)&&(t[n]=i[n]);return t};var zR=(i,e)=>{for(var t in e)$S(i,t,{get:e[t],enumerable:!0})};var Ss=(i,e,t)=>new Promise((n,r)=>{var s=c=>{try{a(t.next(c))}catch(l){r(l)}},o=c=>{try{a(t.throw(c))}catch(l){r(l)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(i,e)).next())});function YS(i,e){return Object.is(i,e)}var ln=null,gl=!1,Wd=1,bi=Symbol("SIGNAL");function gt(i){let e=ln;return ln=i,e}function ZS(){return ln}function HR(){return gl}var va={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function qd(i){if(gl)throw new Error("");if(ln===null)return;ln.consumerOnSignalRead(i);let e=ln.nextProducerIndex++;if(Jd(ln),e<ln.producerNode.length&&ln.producerNode[e]!==i&&vl(ln)){let t=ln.producerNode[e];Kd(t,ln.producerIndexOfThis[e])}ln.producerNode[e]!==i&&(ln.producerNode[e]=i,ln.producerIndexOfThis[e]=vl(ln)?tb(i,ln,e):0),ln.producerLastReadVersion[e]=i.version}function GR(){Wd++}function KS(i){if(!(vl(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===Wd)){if(!i.producerMustRecompute(i)&&!Yd(i)){i.dirty=!1,i.lastCleanEpoch=Wd;return}i.producerRecomputeValue(i),i.dirty=!1,i.lastCleanEpoch=Wd}}function JS(i){if(i.liveConsumerNode===void 0)return;let e=gl;gl=!0;try{for(let t of i.liveConsumerNode)t.dirty||eb(t)}finally{gl=e}}function QS(){return ln?.consumerAllowSignalWrites!==!1}function eb(i){i.dirty=!0,JS(i),i.consumerMarkedDirty?.(i)}function yl(i){return i&&(i.nextProducerIndex=0),gt(i)}function Xd(i,e){if(gt(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(vl(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)Kd(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function Yd(i){Jd(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||(KS(t),n!==t.version))return!0}return!1}function Zd(i){if(Jd(i),vl(i))for(let e=0;e<i.producerNode.length;e++)Kd(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function tb(i,e,t){if(nb(i),i.liveConsumerNode.length===0&&ib(i))for(let n=0;n<i.producerNode.length;n++)i.producerIndexOfThis[n]=tb(i.producerNode[n],i,n);return i.liveConsumerIndexOfThis.push(t),i.liveConsumerNode.push(e)-1}function Kd(i,e){if(nb(i),i.liveConsumerNode.length===1&&ib(i))for(let n=0;n<i.producerNode.length;n++)Kd(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];Jd(r),r.producerIndexOfThis[n]=e}}function vl(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function Jd(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function nb(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function ib(i){return i.producerNode!==void 0}function Qg(i){let e=Object.create(jR);e.computation=i;let t=()=>{if(KS(e),qd(e),e.value===$d)throw e.error;return e.value};return t[bi]=e,t}var Zg=Symbol("UNSET"),Kg=Symbol("COMPUTING"),$d=Symbol("ERRORED"),jR=tt(ie({},va),{value:Zg,dirty:!0,error:null,equal:YS,producerMustRecompute(i){return i.value===Zg||i.value===Kg},producerRecomputeValue(i){if(i.value===Kg)throw new Error("Detected cycle in computations.");let e=i.value;i.value=Kg;let t=yl(i),n;try{n=i.computation()}catch(r){n=$d,i.error=r}finally{Xd(i,t)}if(e!==Zg&&e!==$d&&n!==$d&&i.equal(e,n)){i.value=e;return}i.value=n,i.version++}});function WR(){throw new Error}var rb=WR;function sb(){rb()}function ob(i){rb=i}var $R=null;function ab(i){let e=Object.create(ev);e.value=i;let t=()=>(qd(e),e.value);return t[bi]=e,t}function Qd(i,e){QS()||sb(),i.equal(i.value,e)||(i.value=e,qR(i))}function cb(i,e){QS()||sb(),Qd(i,e(i.value))}var ev=tt(ie({},va),{equal:YS,value:void 0});function qR(i){i.version++,GR(),JS(i),$R?.()}function lb(i,e,t){let n=Object.create(XR);t&&(n.consumerAllowSignalWrites=!0),n.fn=i,n.schedule=e;let r=c=>{n.cleanupFn=c};function s(c){return c.fn===null&&c.schedule===null}function o(c){s(c)||(Zd(c),c.cleanupFn(),c.fn=null,c.schedule=null,c.cleanupFn=Jg)}let a=()=>{if(n.fn===null)return;if(HR())throw new Error("Schedulers cannot synchronously execute watches while scheduling.");if(n.dirty=!1,n.hasRun&&!Yd(n))return;n.hasRun=!0;let c=yl(n);try{n.cleanupFn(),n.cleanupFn=Jg,n.fn(r)}finally{Xd(n,c)}};return n.ref={notify:()=>eb(n),run:a,cleanup:()=>n.cleanupFn(),destroy:()=>o(n),[bi]:n},n.ref}var Jg=()=>{},XR=tt(ie({},va),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:i=>{i.schedule!==null&&i.schedule(i.ref)},hasRun:!1,cleanupFn:Jg});function je(i){return typeof i=="function"}function ya(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ef=ya(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ao(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var jt=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(je(n))try{n()}catch(s){e=s instanceof ef?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{ub(s)}catch(o){e=e??[],o instanceof ef?e=[...e,...o.errors]:e.push(o)}}if(e)throw new ef(e)}}add(e){var t;if(e&&e!==this)if(this.closed)ub(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ao(t,e)}remove(e){let{_finalizers:t}=this;t&&ao(t,e),e instanceof i&&e._removeParent(this)}};jt.EMPTY=(()=>{let i=new jt;return i.closed=!0,i})();var tv=jt.EMPTY;function tf(i){return i instanceof jt||i&&"closed"in i&&je(i.remove)&&je(i.add)&&je(i.unsubscribe)}function ub(i){je(i)?i():i.unsubscribe()}var Hi={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var _a={setTimeout(i,e,...t){let{delegate:n}=_a;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=_a;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function nf(i){_a.setTimeout(()=>{let{onUnhandledError:e}=Hi;if(e)e(i);else throw i})}function _l(){}var db=nv("C",void 0,void 0);function fb(i){return nv("E",void 0,i)}function hb(i){return nv("N",i,void 0)}function nv(i,e,t){return{kind:i,value:e,error:t}}var co=null;function xa(i){if(Hi.useDeprecatedSynchronousErrorHandling){let e=!co;if(e&&(co={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=co;if(co=null,t)throw n}}else i()}function pb(i){Hi.useDeprecatedSynchronousErrorHandling&&co&&(co.errorThrown=!0,co.error=i)}var lo=class extends jt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,tf(e)&&e.add(this)):this.destination=KR}static create(e,t,n){return new Lr(e,t,n)}next(e){this.isStopped?rv(hb(e),this):this._next(e)}error(e){this.isStopped?rv(fb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?rv(db,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},YR=Function.prototype.bind;function iv(i,e){return YR.call(i,e)}var sv=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){rf(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){rf(n)}else rf(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){rf(t)}}},Lr=class extends lo{constructor(e,t,n){super();let r;if(je(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Hi.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&iv(e.next,s),error:e.error&&iv(e.error,s),complete:e.complete&&iv(e.complete,s)}):r=e}this.destination=new sv(r)}};function rf(i){Hi.useDeprecatedSynchronousErrorHandling?pb(i):nf(i)}function ZR(i){throw i}function rv(i,e){let{onStoppedNotification:t}=Hi;t&&_a.setTimeout(()=>t(i,e))}var KR={closed:!0,next:_l,error:ZR,complete:_l};var Ma=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ai(i){return i}function xl(...i){return ov(i)}function ov(i){return i.length===0?ai:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var vt=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let s=QR(t)?t:new Lr(t,n,r);return xa(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=mb(n),new n((r,s)=>{let o=new Lr({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[Ma](){return this}pipe(...t){return ov(t)(this)}toPromise(t){return t=mb(t),new t((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function mb(i){var e;return(e=i??Hi.Promise)!==null&&e!==void 0?e:Promise}function JR(i){return i&&je(i.next)&&je(i.error)&&je(i.complete)}function QR(i){return i&&i instanceof lo||JR(i)&&tf(i)}function av(i){return je(i?.lift)}function ut(i){return e=>{if(av(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ft(i,e,t,n,r){return new cv(i,e,t,n,r)}var cv=class extends lo{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Sa(){return ut((i,e)=>{let t=null;i._refCount++;let n=ft(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){t=null;return}let r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}var ba=class extends vt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,av(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new jt;let t=this.getSubject();e.add(this.source.subscribe(ft(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=jt.EMPTY)}return e}refCount(){return Sa()(this)}};var gb=ya(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Kt=(()=>{class i extends vt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new sf(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new gb}next(t){xa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){xa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){xa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:s}=this;return n||r?tv:(this.currentObservers=null,s.push(t),new jt(()=>{this.currentObservers=null,ao(s,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){let t=new vt;return t.source=this,t}}return i.create=(e,t)=>new sf(e,t),i})(),sf=class extends Kt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:tv}};var Sn=class extends Kt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var Ml={now(){return(Ml.delegate||Date).now()},delegate:void 0};var uo=class extends Kt{constructor(e=1/0,t=1/0,n=Ml){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!r&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){let o=t.now(),a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}};var of=class extends jt{constructor(e,t){super()}schedule(e,t=0){return this}};var Sl={setInterval(i,e,...t){let{delegate:n}=Sl;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){let{delegate:e}=Sl;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};var af=class extends of{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;let r=this.id,s=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return Sl.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(n!=null&&this.delay===n&&this.pending===!1)return t;t!=null&&Sl.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let n=this._execute(e,t);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n=!1,r;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ao(n,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var wa=class i{constructor(e,t=i.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}};wa.now=Ml.now;var cf=class extends wa{constructor(e,t=wa.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let n;this._active=!0;do if(n=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}};var vb=new cf(af);var ci=new vt(i=>i.complete());function yb(i){return i&&je(i.schedule)}function _b(i){return i[i.length-1]}function xb(i){return je(_b(i))?i.pop():void 0}function bs(i){return yb(_b(i))?i.pop():void 0}function Sb(i,e,t,n){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((n=n.apply(i,e||[])).next())})}function Mb(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fo(i){return this instanceof fo?(this.v=i,this):new fo(i)}function bb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){n[h]&&(r[h]=function(v){return new Promise(function(g,m){s.push([h,v,g,m])>1||c(h,v)})},p&&(r[h]=p(r[h])))}function c(h,p){try{l(n[h](p))}catch(v){f(s[0][3],v)}}function l(h){h.value instanceof fo?Promise.resolve(h.value.v).then(u,d):f(s[0][2],h)}function u(h){c("next",h)}function d(h){c("throw",h)}function f(h,p){h(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}function wb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Mb=="function"?Mb(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,c){o=i[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var Ea=i=>i&&typeof i.length=="number"&&typeof i!="function";function lf(i){return je(i?.then)}function uf(i){return je(i[Ma])}function df(i){return Symbol.asyncIterator&&je(i?.[Symbol.asyncIterator])}function ff(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function e1(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var hf=e1();function pf(i){return je(i?.[hf])}function mf(i){return bb(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield fo(t.read());if(r)return yield fo(void 0);yield yield fo(n)}}finally{t.releaseLock()}})}function gf(i){return je(i?.getReader)}function Vt(i){if(i instanceof vt)return i;if(i!=null){if(uf(i))return t1(i);if(Ea(i))return n1(i);if(lf(i))return i1(i);if(df(i))return Eb(i);if(pf(i))return r1(i);if(gf(i))return s1(i)}throw ff(i)}function t1(i){return new vt(e=>{let t=i[Ma]();if(je(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function n1(i){return new vt(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function i1(i){return new vt(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,nf)})}function r1(i){return new vt(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function Eb(i){return new vt(e=>{o1(i,e).catch(t=>e.error(t))})}function s1(i){return Eb(mf(i))}function o1(i,e){var t,n,r,s;return Sb(this,void 0,void 0,function*(){try{for(t=wb(i);n=yield t.next(),!n.done;){let o=n.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function jn(i,e,t,n=0,r=!1){let s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function vf(i,e=0){return ut((t,n)=>{t.subscribe(ft(n,r=>jn(n,i,()=>n.next(r),e),()=>jn(n,i,()=>n.complete(),e),r=>jn(n,i,()=>n.error(r),e)))})}function yf(i,e=0){return ut((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function Tb(i,e){return Vt(i).pipe(yf(e),vf(e))}function Cb(i,e){return Vt(i).pipe(yf(e),vf(e))}function Ab(i,e){return new vt(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function Db(i,e){return new vt(t=>{let n;return jn(t,e,()=>{n=i[hf](),jn(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>je(n?.return)&&n.return()})}function _f(i,e){if(!i)throw new Error("Iterable cannot be null");return new vt(t=>{jn(t,e,()=>{let n=i[Symbol.asyncIterator]();jn(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Ib(i,e){return _f(mf(i),e)}function Rb(i,e){if(i!=null){if(uf(i))return Tb(i,e);if(Ea(i))return Ab(i,e);if(lf(i))return Cb(i,e);if(df(i))return _f(i,e);if(pf(i))return Db(i,e);if(gf(i))return Ib(i,e)}throw ff(i)}function Jt(i,e){return e?Rb(i,e):Vt(i)}function Ke(...i){let e=bs(i);return Jt(i,e)}function Ta(i,e){let t=je(i)?i:()=>i,n=r=>r.error(t());return new vt(e?r=>e.schedule(n,0,r):n)}function lv(i){return!!i&&(i instanceof vt||je(i.lift)&&je(i.subscribe))}var Fr=ya(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function yt(i,e){return ut((t,n)=>{let r=0;t.subscribe(ft(n,s=>{n.next(i.call(e,s,r++))}))})}var{isArray:a1}=Array;function c1(i,e){return a1(e)?i(...e):i(e)}function xf(i){return yt(e=>c1(i,e))}var{isArray:l1}=Array,{getPrototypeOf:u1,prototype:d1,keys:f1}=Object;function Nb(i){if(i.length===1){let e=i[0];if(l1(e))return{args:e,keys:null};if(h1(e)){let t=f1(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function h1(i){return i&&typeof i=="object"&&u1(i)===d1}function Pb(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function bl(...i){let e=bs(i),t=xb(i),{args:n,keys:r}=Nb(i);if(n.length===0)return Jt([],e);let s=new vt(p1(n,e,r?o=>Pb(r,o):ai));return t?s.pipe(xf(t)):s}function p1(i,e,t=ai){return n=>{Ob(e,()=>{let{length:r}=i,s=new Array(r),o=r,a=r;for(let c=0;c<r;c++)Ob(e,()=>{let l=Jt(i[c],e),u=!1;l.subscribe(ft(n,d=>{s[c]=d,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}function Ob(i,e,t){i?jn(t,i,e):e()}function Lb(i,e,t,n,r,s,o,a){let c=[],l=0,u=0,d=!1,f=()=>{d&&!c.length&&!l&&e.complete()},h=v=>l<n?p(v):c.push(v),p=v=>{s&&e.next(v),l++;let g=!1;Vt(t(v,u++)).subscribe(ft(e,m=>{r?.(m),s?h(m):e.next(m)},()=>{g=!0},void 0,()=>{if(g)try{for(l--;c.length&&l<n;){let m=c.shift();o?jn(e,o,()=>p(m)):p(m)}f()}catch(m){e.error(m)}}))};return i.subscribe(ft(e,h,()=>{d=!0,f()})),()=>{a?.()}}function Wt(i,e,t=1/0){return je(e)?Wt((n,r)=>yt((s,o)=>e(n,s,r,o))(Vt(i(n,r))),t):(typeof e=="number"&&(t=e),ut((n,r)=>Lb(n,r,i,t)))}function Ca(i=1/0){return Wt(ai,i)}function Fb(){return Ca(1)}function Aa(...i){return Fb()(Jt(i,bs(i)))}function Mf(i){return new vt(e=>{Vt(i()).subscribe(e)})}var m1=["addListener","removeListener"],g1=["addEventListener","removeEventListener"],v1=["on","off"];function kr(i,e,t,n){if(je(t)&&(n=t,t=void 0),n)return kr(i,e,t).pipe(xf(n));let[r,s]=x1(i)?g1.map(o=>a=>i[o](e,a,t)):y1(i)?m1.map(kb(i,e)):_1(i)?v1.map(kb(i,e)):[];if(!r&&Ea(i))return Wt(o=>kr(o,e,t))(Vt(i));if(!r)throw new TypeError("Invalid event target");return new vt(o=>{let a=(...c)=>o.next(1<c.length?c:c[0]);return r(a),()=>s(a)})}function kb(i,e){return t=>n=>i[t](e,n)}function y1(i){return je(i.addListener)&&je(i.removeListener)}function _1(i){return je(i.on)&&je(i.off)}function x1(i){return je(i.addEventListener)&&je(i.removeEventListener)}function Rn(i,e){return ut((t,n)=>{let r=0;t.subscribe(ft(n,s=>i.call(e,s,r++)&&n.next(s)))})}function ws(i){return ut((e,t)=>{let n=null,r=!1,s;n=e.subscribe(ft(t,void 0,void 0,o=>{s=Vt(i(o,ws(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Ub(i,e,t,n,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(ft(o,u=>{let d=l++;c=a?i(c,u,d):(a=!0,u),n&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}function ho(i,e){return je(e)?Wt(i,e,1):Wt(i,1)}function Sf(i,e=vb){return ut((t,n)=>{let r=null,s=null,o=null,a=()=>{if(r){r.unsubscribe(),r=null;let l=s;s=null,n.next(l)}};function c(){let l=o+i,u=e.now();if(u<l){r=this.schedule(void 0,l-u),n.add(r);return}a()}t.subscribe(ft(n,l=>{s=l,o=e.now(),r||(r=e.schedule(c,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function Es(i){return ut((e,t)=>{let n=!1;e.subscribe(ft(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function Ur(i){return i<=0?()=>ci:ut((e,t)=>{let n=0;e.subscribe(ft(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function uv(i){return yt(()=>i)}function bf(i=M1){return ut((e,t)=>{let n=!1;e.subscribe(ft(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function M1(){return new Fr}function wl(i){return ut((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}function fr(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Rn((r,s)=>i(r,s,n)):ai,Ur(1),t?Es(e):bf(()=>new Fr))}function Da(i){return i<=0?()=>ci:ut((e,t)=>{let n=[];e.subscribe(ft(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(let r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function dv(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Rn((r,s)=>i(r,s,n)):ai,Da(1),t?Es(e):bf(()=>new Fr))}function fv(i,e){return ut(Ub(i,e,arguments.length>=2,!0))}function pv(i={}){let{connector:e=()=>new Kt,resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o,a,c,l=0,u=!1,d=!1,f=()=>{a?.unsubscribe(),a=void 0},h=()=>{f(),o=c=void 0,u=d=!1},p=()=>{let v=o;h(),v?.unsubscribe()};return ut((v,g)=>{l++,!d&&!u&&f();let m=c=c??e();g.add(()=>{l--,l===0&&!d&&!u&&(a=hv(p,r))}),m.subscribe(g),!o&&l>0&&(o=new Lr({next:_=>m.next(_),error:_=>{d=!0,f(),a=hv(h,t,_),m.error(_)},complete:()=>{u=!0,f(),a=hv(h,n),m.complete()}}),Vt(v).subscribe(o))})(s)}}function hv(i,e,...t){if(e===!0){i();return}if(e===!1)return;let n=new Lr({next:()=>{n.unsubscribe(),i()}});return Vt(e(...t)).subscribe(n)}function mv(...i){let e=bs(i);return ut((t,n)=>{(e?Aa(i,t,e):Aa(i,t)).subscribe(n)})}function wi(i,e){return ut((t,n)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&n.complete();t.subscribe(ft(n,c=>{r?.unsubscribe();let l=0,u=s++;Vt(i(c,u)).subscribe(r=ft(n,d=>n.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Ts(i){return ut((e,t)=>{Vt(i).subscribe(ft(t,()=>t.complete(),_l)),!t.closed&&e.subscribe(t)})}function bn(i,e,t){let n=je(i)||e||t?{next:i,error:e,complete:t}:i;return n?ut((r,s)=>{var o;(o=n.subscribe)===null||o===void 0||o.call(n);let a=!0;r.subscribe(ft(s,c=>{var l;(l=n.next)===null||l===void 0||l.call(n,c),s.next(c)},()=>{var c;a=!1,(c=n.complete)===null||c===void 0||c.call(n),s.complete()},c=>{var l;a=!1,(l=n.error)===null||l===void 0||l.call(n,c),s.error(c)},()=>{var c,l;a&&((c=n.unsubscribe)===null||c===void 0||c.call(n)),(l=n.finalize)===null||l===void 0||l.call(n)}))}):ai}var S1="https://g.co/ng/security#xss",Le=class extends Error{constructor(e,t){super(Cy(e,t)),this.code=e}};function Cy(i,e){return`${`NG0${Math.abs(i)}`}${e?": "+e:""}`}var Aw=Symbol("InputSignalNode#UNSET"),b1=tt(ie({},ev),{transformFn:void 0,applyValueToInputSignal(i,e){Qd(i,e)}});function Dw(i,e){let t=Object.create(b1);t.value=i,t.transformFn=e?.transform;function n(){if(qd(t),t.value===Aw)throw new Le(-950,!1);return t.value}return n[bi]=t,n}function Ll(i){return{toString:i}.toString()}var wf="__parameters__";function w1(i){return function(...t){if(i){let n=i(...t);for(let r in n)this[r]=n[r]}}}function Iw(i,e,t){return Ll(()=>{let n=w1(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(c,l,u){let d=c.hasOwnProperty(wf)?c[wf]:Object.defineProperty(c,wf,{value:[]})[wf];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}var Gr=globalThis;function Pt(i){for(let e in i)if(i[e]===Pt)return e;throw Error("Could not find renamed property on target object.")}function Wn(i){if(typeof i=="string")return i;if(Array.isArray(i))return"["+i.map(Wn).join(", ")+"]";if(i==null)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;let e=i.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function Bb(i,e){return i==null||i===""?e===null?"":e:e==null||e===""?i:i+" "+e}var E1=Pt({__forward_ref__:Pt});function Rw(i){return i.__forward_ref__=Rw,i.toString=function(){return Wn(this())},i}function Nn(i){return Nw(i)?i():i}function Nw(i){return typeof i=="function"&&i.hasOwnProperty(E1)&&i.__forward_ref__===Rw}function ke(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function Zi(i){return{providers:i.providers||[],imports:i.imports||[]}}function sh(i){return Vb(i,Ow)||Vb(i,Lw)}function Pw(i){return sh(i)!==null}function Vb(i,e){return i.hasOwnProperty(e)?i[e]:null}function T1(i){let e=i&&(i[Ow]||i[Lw]);return e||null}function zb(i){return i&&(i.hasOwnProperty(Hb)||i.hasOwnProperty(C1))?i[Hb]:null}var Ow=Pt({\u0275prov:Pt}),Hb=Pt({\u0275inj:Pt}),Lw=Pt({ngInjectableDef:Pt}),C1=Pt({ngInjectorDef:Pt}),Ue=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ke({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Fw(i){return i&&!!i.\u0275providers}var A1=Pt({\u0275cmp:Pt}),D1=Pt({\u0275dir:Pt}),I1=Pt({\u0275pipe:Pt}),R1=Pt({\u0275mod:Pt}),Of=Pt({\u0275fac:Pt}),Tl=Pt({__NG_ELEMENT_ID__:Pt}),Gb=Pt({__NG_ENV_ID__:Pt});function Ay(i){return typeof i=="string"?i:i==null?"":String(i)}function N1(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():Ay(i)}function P1(i,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new Le(-200,i)}function Dy(i,e){throw new Le(-201,!1)}var ct=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(ct||{}),Rv;function kw(){return Rv}function Ei(i){let e=Rv;return Rv=i,e}function Uw(i,e,t){let n=sh(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&ct.Optional)return null;if(e!==void 0)return e;Dy(i,"Injector")}var O1={},Al=O1,Nv="__NG_DI_FLAG__",Lf="ngTempTokenPath",L1="ngTokenPath",F1=/\n/gm,k1="\u0275",jb="__source",Oa;function U1(){return Oa}function Cs(i){let e=Oa;return Oa=i,e}function B1(i,e=ct.Default){if(Oa===void 0)throw new Le(-203,!1);return Oa===null?Uw(i,void 0,e):Oa.get(i,e&ct.Optional?null:void 0,e)}function qe(i,e=ct.Default){return(kw()||B1)(Nn(i),e)}function ee(i,e=ct.Default){return qe(i,oh(e))}function oh(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function Pv(i){let e=[];for(let t=0;t<i.length;t++){let n=Nn(i[t]);if(Array.isArray(n)){if(n.length===0)throw new Le(900,!1);let r,s=ct.Default;for(let o=0;o<n.length;o++){let a=n[o],c=V1(a);typeof c=="number"?c===-1?r=a.token:s|=c:r=a}e.push(qe(r,s))}else e.push(qe(n))}return e}function Bw(i,e){return i[Nv]=e,i.prototype[Nv]=e,i}function V1(i){return i[Nv]}function z1(i,e,t,n){let r=i[Lf];throw e[jb]&&r.unshift(e[jb]),i.message=H1(`
`+i.message,r,t,n),i[L1]=r,i[Lf]=null,i}function H1(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==k1?i.slice(2):i;let r=Wn(e);if(Array.isArray(e))r=e.map(Wn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Wn(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(F1,`
  `)}`}var Iy=Bw(Iw("Optional"),8);var Vw=Bw(Iw("SkipSelf"),4);function Fa(i,e){let t=i.hasOwnProperty(Of);return t?i[Of]:null}function G1(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function j1(i){return i.flat(Number.POSITIVE_INFINITY)}function Ry(i,e){i.forEach(t=>Array.isArray(t)?Ry(t,e):e(t))}function zw(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Ff(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function W1(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let s=r-2;i[r]=i[s],r--}i[e]=t,i[e+1]=n}}function $1(i,e,t){let n=Fl(i,e);return n>=0?i[n|1]=t:(n=~n,W1(i,n,e,t)),n}function gv(i,e){let t=Fl(i,e);if(t>=0)return i[t|1]}function Fl(i,e){return q1(i,e,1)}function q1(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}var Dl={},li=[],Rs=new Ue(""),Hw=new Ue("",-1),Gw=new Ue(""),kf=class{get(e,t=Al){if(t===Al){let n=new Error(`NullInjectorError: No provider for ${Wn(e)}!`);throw n.name="NullInjectorError",n}return t}},jw=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(jw||{}),mr=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(mr||{}),Ns=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(Ns||{});function X1(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}function Ov(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{let s=r,o=t[++n];Z1(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function Y1(i){return i===3||i===4||i===6}function Z1(i){return i.charCodeAt(0)===64}function Ny(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?Wb(i,t,r,null,e[++n]):Wb(i,t,r,null,null))}}return i}function Wb(i,e,t,n,r){let s=0,o=i.length;if(e===-1)o=-1;else for(;s<i.length;){let a=i[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<i.length;){let a=i[s];if(typeof a=="number")break;if(a===t){if(n===null){r!==null&&(i[s+1]=r);return}else if(n===i[s+1]){i[s+2]=r;return}}s++,n!==null&&s++,r!==null&&s++}o!==-1&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),n!==null&&i.splice(s++,0,n),r!==null&&i.splice(s++,0,r)}var Ww="ng-template";function K1(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&X1(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(Py(i))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Py(i){return i.type===4&&i.value!==Ww}function J1(i,e,t){let n=i.type===4&&!t?Ww:i.value;return e===n}function Q1(i,e,t){let n=4,r=i.attrs,s=r!==null?nN(r):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Gi(n)&&!Gi(c))return!1;if(o&&Gi(c))continue;o=!1,n=c|n&1;continue}if(!o)if(n&4){if(n=2|n&1,c!==""&&!J1(i,c,t)||c===""&&e.length===1){if(Gi(n))return!1;o=!0}}else if(n&8){if(r===null||!K1(i,r,c,t)){if(Gi(n))return!1;o=!0}}else{let l=e[++a],u=eN(c,r,Py(i),t);if(u===-1){if(Gi(n))return!1;o=!0;continue}if(l!==""){let d;if(u>s?d="":d=r[u+1].toLowerCase(),n&2&&l!==d){if(Gi(n))return!1;o=!0}}}}return Gi(n)||o}function Gi(i){return(i&1)===0}function eN(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===i)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return iN(e,i)}function tN(i,e,t=!1){for(let n=0;n<e.length;n++)if(Q1(i,e[n],t))return!0;return!1}function nN(i){for(let e=0;e<i.length;e++){let t=i[e];if(Y1(t))return e}return i.length}function iN(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function $b(i,e){return i?":not("+e.trim()+")":e}function rN(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if(typeof o=="string")if(n&2){let a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+o:n&4&&(r+=" "+o);else r!==""&&!Gi(o)&&(e+=$b(s,r),r=""),n=o,s=s||!Gi(n);t++}return r!==""&&(e+=$b(s,r)),e}function sN(i){return i.map(rN).join(",")}function oN(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let s=i[n];if(typeof s=="string")r===2?s!==""&&e.push(s,i[++n]):r===8&&t.push(s);else{if(!Gi(r))break;r=s}n++}return{attrs:e,classes:t}}function ui(i){return Ll(()=>{let e=Zw(i),t=tt(ie({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===jw.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||mr.Emulated,styles:i.styles||li,_:null,schemas:i.schemas||null,tView:null,id:""});Kw(t);let n=i.dependencies;return t.directiveDefs=Xb(n,!1),t.pipeDefs=Xb(n,!0),t.id=lN(t),t})}function aN(i){return Ps(i)||$w(i)}function cN(i){return i!==null}function Ki(i){return Ll(()=>({type:i.type,bootstrap:i.bootstrap||li,declarations:i.declarations||li,imports:i.imports||li,exports:i.exports||li,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function qb(i,e){if(i==null)return Dl;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],s,o,a=Ns.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==Ns.None?[n,a]:n,e[s]=o):t[s]=n}return t}function bo(i){return Ll(()=>{let e=Zw(i);return Kw(e),e})}function Ps(i){return i[A1]||null}function $w(i){return i[D1]||null}function qw(i){return i[I1]||null}function Xw(i){let e=Ps(i)||$w(i)||qw(i);return e!==null?e.standalone:!1}function Yw(i,e){let t=i[R1]||null;if(!t&&e===!0)throw new Error(`Type ${Wn(i)} does not have '\u0275mod' property.`);return t}function Zw(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:i.inputs||Dl,exportAs:i.exportAs||null,standalone:i.standalone===!0,signals:i.signals===!0,selectors:i.selectors||li,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qb(i.inputs,e),outputs:qb(i.outputs),debugInfo:null}}function Kw(i){i.features?.forEach(e=>e(i))}function Xb(i,e){if(!i)return null;let t=e?qw:aN;return()=>(typeof i=="function"?i():i).map(n=>t(n)).filter(cN)}function lN(i){let e=0,t=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function ah(i){return{\u0275providers:i}}function uN(...i){return{\u0275providers:Jw(!0,i),\u0275fromNgModule:!0}}function Jw(i,...e){let t=[],n=new Set,r,s=o=>{t.push(o)};return Ry(e,o=>{let a=o;Lv(a,s,[],n)&&(r||=[],r.push(a))}),r!==void 0&&Qw(r,s),t}function Qw(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];Oy(r,s=>{e(s,n)})}}function Lv(i,e,t,n){if(i=Nn(i),!i)return!1;let r=null,s=zb(i),o=!s&&Ps(i);if(!s&&!o){let c=i.ngModule;if(s=zb(c),s)r=c;else return!1}else{if(o&&!o.standalone)return!1;r=i}let a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Lv(l,e,t,n)}}else if(s){if(s.imports!=null&&!a){n.add(r);let l;try{Ry(s.imports,u=>{Lv(u,e,t,n)&&(l||=[],l.push(u))})}finally{}l!==void 0&&Qw(l,e)}if(!a){let l=Fa(r)||(()=>new r);e({provide:r,useFactory:l,deps:li},r),e({provide:Gw,useValue:r,multi:!0},r),e({provide:Rs,useValue:()=>qe(r),multi:!0},r)}let c=s.providers;if(c!=null&&!a){let l=i;Oy(c,u=>{e(u,l)})}}else return!1;return r!==i&&i.providers!==void 0}function Oy(i,e){for(let t of i)Fw(t)&&(t=t.\u0275providers),Array.isArray(t)?Oy(t,e):e(t)}var dN=Pt({provide:String,useValue:Pt});function eE(i){return i!==null&&typeof i=="object"&&dN in i}function fN(i){return!!(i&&i.useExisting)}function hN(i){return!!(i&&i.useFactory)}function ka(i){return typeof i=="function"}function pN(i){return!!i.useClass}var ch=new Ue(""),Af={},mN={},vv;function Ly(){return vv===void 0&&(vv=new kf),vv}var Pn=class{},Il=class extends Pn{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,kv(e,o=>this.processProvider(o)),this.records.set(Hw,Ia(void 0,this)),r.has("environment")&&this.records.set(Pn,Ia(void 0,this));let s=this.records.get(ch);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Gw,li,ct.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=gt(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),gt(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Cs(this),n=Ei(void 0),r;try{return e()}finally{Cs(t),Ei(n)}}get(e,t=Al,n=ct.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Gb))return e[Gb](this);n=oh(n);let r,s=Cs(this),o=Ei(void 0);try{if(!(n&ct.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=xN(e)&&sh(e);l&&this.injectableDefInScope(l)?c=Ia(Fv(e),Af):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=n&ct.Self?Ly():this.parent;return t=n&ct.Optional&&t===Al?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Lf]=a[Lf]||[]).unshift(Wn(e)),s)throw a;return z1(a,e,"R3InjectorError",this.source)}else throw a}finally{Ei(o),Cs(s)}}resolveInjectorInitializers(){let e=gt(null),t=Cs(this),n=Ei(void 0),r;try{let s=this.get(Rs,li,ct.Self);for(let o of s)o()}finally{Cs(t),Ei(n),gt(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(Wn(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Le(205,!1)}processProvider(e){e=Nn(e);let t=ka(e)?e:Nn(e&&e.provide),n=vN(e);if(!ka(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Ia(void 0,Af,!0),r.factory=()=>Pv(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){let n=gt(null);try{return t.value===Af&&(t.value=mN,t.value=t.factory()),typeof t.value=="object"&&t.value&&_N(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{gt(n)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Nn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Fv(i){let e=sh(i),t=e!==null?e.factory:Fa(i);if(t!==null)return t;if(i instanceof Ue)throw new Le(204,!1);if(i instanceof Function)return gN(i);throw new Le(204,!1)}function gN(i){if(i.length>0)throw new Le(204,!1);let t=T1(i);return t!==null?()=>t.factory(i):()=>new i}function vN(i){if(eE(i))return Ia(void 0,i.useValue);{let e=tE(i);return Ia(e,Af)}}function tE(i,e,t){let n;if(ka(i)){let r=Nn(i);return Fa(r)||Fv(r)}else if(eE(i))n=()=>Nn(i.useValue);else if(hN(i))n=()=>i.useFactory(...Pv(i.deps||[]));else if(fN(i))n=()=>qe(Nn(i.useExisting));else{let r=Nn(i&&(i.useClass||i.provide));if(yN(i))n=()=>new r(...Pv(i.deps));else return Fa(r)||Fv(r)}return n}function Ia(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function yN(i){return!!i.deps}function _N(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function xN(i){return typeof i=="function"||typeof i=="object"&&i instanceof Ue}function kv(i,e){for(let t of i)Array.isArray(t)?kv(t,e):t&&Fw(t)?kv(t.\u0275providers,e):e(t)}function Xn(i,e){i instanceof Il&&i.assertNotDestroyed();let t,n=Cs(i),r=Ei(void 0);try{return e()}finally{Cs(n),Ei(r)}}function nE(){return kw()!==void 0||U1()!=null}function $a(i){if(!nE())throw new Le(-203,!1)}function MN(i){let e=Gr.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function SN(i){return typeof i=="function"}var jr=0,Oe=1,Ye=2,wn=3,Wi=4,Ci=5,Uf=6,Rl=7,qn=8,Ua=9,Br=10,On=11,Nl=12,Yb=13,kl=14,qi=15,mo=16,Ra=17,Vr=18,Ul=19,iE=20,As=21,Df=22,Ti=23,Xi=25,rE=1;var Os=7,Bf=8,Ba=9,$n=10,Vf=function(i){return i[i.None=0]="None",i[i.HasTransplantedViews=2]="HasTransplantedViews",i}(Vf||{});function Ds(i){return Array.isArray(i)&&typeof i[rE]=="object"}function vr(i){return Array.isArray(i)&&i[rE]===!0}function sE(i){return(i.flags&4)!==0}function Bl(i){return i.componentOffset>-1}function Fy(i){return(i.flags&1)===1}function qa(i){return!!i.template}function Uv(i){return(i[Ye]&512)!==0}var Bv=class{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function oE(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}function lh(){return aE}function aE(i){return i.type.prototype.ngOnChanges&&(i.setInput=wN),bN}lh.ngInherit=!0;function bN(){let i=lE(this),e=i?.current;if(e){let t=i.previous;if(t===Dl)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function wN(i,e,t,n,r){let s=this.declaredInputs[n],o=lE(i)||EN(i,{previous:Dl,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new Bv(l&&l.currentValue,t,c===Dl),oE(i,e,r,t)}var cE="__ngSimpleChanges__";function lE(i){return i[cE]||null}function EN(i,e){return i[cE]=e}var Zb=null;var hr=function(i,e,t){Zb?.(i,e,t)},TN="svg",CN="math";function Ln(i){for(;Array.isArray(i);)i=i[jr];return i}function uE(i,e){return Ln(e[i])}function Ji(i,e){return Ln(e[i.index])}function AN(i,e){let t=i===null?-1:i.index;return t!==-1?Ln(e[t]):null}function dE(i,e){return i.data[e]}function gr(i,e){let t=e[i];return Ds(t)?t:t[jr]}function ky(i){return(i[Ye]&128)===128}function DN(i){return vr(i[wn])}function zf(i,e){return e==null?null:i[e]}function fE(i){i[Ra]=0}function hE(i){i[Ye]&1024||(i[Ye]|=1024,ky(i)&&dh(i))}function uh(i){return!!(i[Ye]&9216||i[Ti]?.dirty)}function Vv(i){i[Br].changeDetectionScheduler?.notify(8),i[Ye]&64&&(i[Ye]|=1024),uh(i)&&dh(i)}function dh(i){i[Br].changeDetectionScheduler?.notify(0);let e=Ls(i);for(;e!==null&&!(e[Ye]&8192||(e[Ye]|=8192,!ky(e)));)e=Ls(e)}function pE(i,e){if((i[Ye]&256)===256)throw new Le(911,!1);i[As]===null&&(i[As]=[]),i[As].push(e)}function IN(i,e){if(i[As]===null)return;let t=i[As].indexOf(e);t!==-1&&i[As].splice(t,1)}function Ls(i){let e=i[wn];return vr(e)?e[wn]:e}var ht={lFrame:EE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var mE=!1;function RN(){return ht.lFrame.elementDepthCount}function NN(){ht.lFrame.elementDepthCount++}function PN(){ht.lFrame.elementDepthCount--}function gE(){return ht.bindingsEnabled}function ON(){return ht.skipHydrationRootTNode!==null}function LN(i){return ht.skipHydrationRootTNode===i}function FN(){ht.skipHydrationRootTNode=null}function Bt(){return ht.lFrame.lView}function Qi(){return ht.lFrame.tView}function vE(i){return ht.lFrame.contextLView=i,i[qn]}function yE(i){return ht.lFrame.contextLView=null,i}function Ai(){let i=_E();for(;i!==null&&i.type===64;)i=i.parent;return i}function _E(){return ht.lFrame.currentTNode}function kN(){let i=ht.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function Vl(i,e){let t=ht.lFrame;t.currentTNode=i,t.isParent=e}function xE(){return ht.lFrame.isParent}function UN(){ht.lFrame.isParent=!1}function ME(){return mE}function Kb(i){mE=i}function Uy(){let i=ht.lFrame,e=i.bindingRootIndex;return e===-1&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function BN(i){return ht.lFrame.bindingIndex=i}function SE(){return ht.lFrame.bindingIndex++}function VN(i){let e=ht.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function zN(){return ht.lFrame.inI18n}function HN(i,e){let t=ht.lFrame;t.bindingIndex=t.bindingRootIndex=i,zv(e)}function GN(){return ht.lFrame.currentDirectiveIndex}function zv(i){ht.lFrame.currentDirectiveIndex=i}function jN(i){let e=ht.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function WN(){return ht.lFrame.currentQueryIndex}function By(i){ht.lFrame.currentQueryIndex=i}function $N(i){let e=i[Oe];return e.type===2?e.declTNode:e.type===1?i[Ci]:null}function bE(i,e,t){if(t&ct.SkipSelf){let r=e,s=i;for(;r=r.parent,r===null&&!(t&ct.Host);)if(r=$N(s),r===null||(s=s[kl],r.type&10))break;if(r===null)return!1;e=r,i=s}let n=ht.lFrame=wE();return n.currentTNode=e,n.lView=i,!0}function Vy(i){let e=wE(),t=i[Oe];ht.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function wE(){let i=ht.lFrame,e=i===null?null:i.child;return e===null?EE(i):e}function EE(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function TE(){let i=ht.lFrame;return ht.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var CE=TE;function zy(){let i=TE();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function Xa(){return ht.lFrame.selectedIndex}function go(i){ht.lFrame.selectedIndex=i}function qN(){let i=ht.lFrame;return dE(i.tView,i.selectedIndex)}function XN(){return ht.lFrame.currentNamespace}var AE=!0;function Hy(){return AE}function Gy(i){AE=i}function YN(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){let o=aE(e);(t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o)}r&&(t.preOrderHooks??=[]).push(0-i,r),s&&((t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s))}function jy(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(i.contentHooks??=[]).push(-t,o),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),c&&(i.viewHooks??=[]).push(-t,c),l&&((i.viewHooks??=[]).push(t,l),(i.viewCheckHooks??=[]).push(t,l)),u!=null&&(i.destroyHooks??=[]).push(t,u)}}function If(i,e,t){DE(i,e,3,t)}function Rf(i,e,t,n){(i[Ye]&3)===t&&DE(i,e,t,n)}function yv(i,e){let t=i[Ye];(t&3)===e&&(t&=16383,t+=1,i[Ye]=t)}function DE(i,e,t,n){let r=n!==void 0?i[Ra]&65535:0,s=n??-1,o=e.length-1,a=0;for(let c=r;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],n!=null&&a>=n)break}else e[c]<0&&(i[Ra]+=65536),(a<s||s==-1)&&(ZN(i,t,e,c),i[Ra]=(i[Ra]&4294901760)+c+2),c++}function Jb(i,e){hr(4,i,e);let t=gt(null);try{e.call(i)}finally{gt(t),hr(5,i,e)}}function ZN(i,e,t,n){let r=t[n]<0,s=t[n+1],o=r?-t[n]:t[n],a=i[o];r?i[Ye]>>14<i[Ra]>>16&&(i[Ye]&3)===e&&(i[Ye]+=16384,Jb(a,s)):Jb(a,s)}var La=-1,vo=class{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}};function KN(i){return i instanceof vo}function JN(i){return(i.flags&8)!==0}function QN(i){return(i.flags&16)!==0}var _v={},Hv=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=oh(n);let r=this.injector.get(e,_v,n);return r!==_v||t===_v?r:this.parentInjector.get(e,t,n)}};function IE(i){return i!==La}function Hf(i){return i&32767}function eP(i){return i>>16}function Gf(i,e){let t=eP(i),n=e;for(;t>0;)n=n[kl],t--;return n}var Gv=!0;function Qb(i){let e=Gv;return Gv=i,e}var tP=256,RE=tP-1,NE=5,nP=0,pr={};function iP(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(Tl)&&(n=t[Tl]),n==null&&(n=t[Tl]=nP++);let r=n&RE,s=1<<r;e.data[i+(r>>NE)]|=s}function jf(i,e){let t=PE(i,e);if(t!==-1)return t;let n=e[Oe];n.firstCreatePass&&(i.injectorIndex=e.length,xv(n.data,i),xv(e,null),xv(n.blueprint,null));let r=Wy(i,e),s=i.injectorIndex;if(IE(r)){let o=Hf(r),a=Gf(r,e),c=a[Oe].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function xv(i,e){i.push(0,0,0,0,0,0,0,0,e)}function PE(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function Wy(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=UE(r),n===null)return La;if(t++,r=r[kl],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return La}function jv(i,e,t){iP(i,e,t)}function OE(i,e,t){if(t&ct.Optional||i!==void 0)return i;Dy(e,"NodeInjector")}function LE(i,e,t,n){if(t&ct.Optional&&n===void 0&&(n=null),!(t&(ct.Self|ct.Host))){let r=i[Ua],s=Ei(void 0);try{return r?r.get(e,n,t&ct.Optional):Uw(e,n,t&ct.Optional)}finally{Ei(s)}}return OE(n,e,t)}function FE(i,e,t,n=ct.Default,r){if(i!==null){if(e[Ye]&2048&&!(n&ct.Self)){let o=aP(i,e,t,n,pr);if(o!==pr)return o}let s=kE(i,e,t,n,pr);if(s!==pr)return s}return LE(e,t,n,r)}function kE(i,e,t,n,r){let s=sP(t);if(typeof s=="function"){if(!bE(e,i,n))return n&ct.Host?OE(r,t,n):LE(e,t,n,r);try{let o;if(o=s(n),o==null&&!(n&ct.Optional))Dy(t);else return o}finally{CE()}}else if(typeof s=="number"){let o=null,a=PE(i,e),c=La,l=n&ct.Host?e[qi][Ci]:null;for((a===-1||n&ct.SkipSelf)&&(c=a===-1?Wy(i,e):e[a+8],c===La||!tw(n,!1)?a=-1:(o=e[Oe],a=Hf(c),e=Gf(c,e)));a!==-1;){let u=e[Oe];if(ew(s,a,u.data)){let d=rP(a,e,t,o,n,l);if(d!==pr)return d}c=e[a+8],c!==La&&tw(n,e[Oe].data[a+8]===l)&&ew(s,a,e)?(o=u,a=Hf(c),e=Gf(c,e)):a=-1}}return r}function rP(i,e,t,n,r,s){let o=e[Oe],a=o.data[i+8],c=n==null?Bl(a)&&Gv:n!=o&&(a.type&3)!==0,l=r&ct.Host&&s===a,u=Nf(a,o,t,c,l);return u!==null?yo(e,o,u,a):pr}function Nf(i,e,t,n,r){let s=i.providerIndexes,o=e.data,a=s&1048575,c=i.directiveStart,l=i.directiveEnd,u=s>>20,d=n?a:a+u,f=r?a+u:l;for(let h=d;h<f;h++){let p=o[h];if(h<c&&t===p||h>=c&&p.type===t)return h}if(r){let h=o[c];if(h&&qa(h)&&h.type===t)return c}return null}function yo(i,e,t,n){let r=i[t],s=e.data;if(KN(r)){let o=r;o.resolving&&P1(N1(s[t]));let a=Qb(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Ei(o.injectImpl):null,u=bE(i,n,ct.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&YN(t,s[t],e)}finally{l!==null&&Ei(l),Qb(a),o.resolving=!1,CE()}}return r}function sP(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(Tl)?i[Tl]:void 0;return typeof e=="number"?e>=0?e&RE:oP:e}function ew(i,e,t){let n=1<<i;return!!(t[e+(i>>NE)]&n)}function tw(i,e){return!(i&ct.Self)&&!(i&ct.Host&&e)}var Is=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return FE(this._tNode,this._lView,e,oh(n),t)}};function oP(){return new Is(Ai(),Bt())}function $y(i){return Ll(()=>{let e=i.prototype.constructor,t=e[Of]||Wv(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let s=r[Of]||Wv(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Wv(i){return Nw(i)?()=>{let e=Wv(Nn(i));return e&&e()}:Fa(i)}function aP(i,e,t,n,r){let s=i,o=e;for(;s!==null&&o!==null&&o[Ye]&2048&&!(o[Ye]&512);){let a=kE(s,o,t,n|ct.Self,pr);if(a!==pr)return a;let c=s.parent;if(!c){let l=o[iE];if(l){let u=l.get(t,pr,n);if(u!==pr)return u}c=UE(o),o=o[kl]}s=c}return r}function UE(i){let e=i[Oe],t=e.type;return t===2?e.declTNode:t===1?i[Ci]:null}function nw(i,e=null,t=null,n){let r=BE(i,e,t,n);return r.resolveInjectorInitializers(),r}function BE(i,e=null,t=null,n,r=new Set){let s=[t||li,uN(i)];return n=n||(typeof i=="object"?void 0:Wn(i)),new Il(s,e||Ly(),n||null,r)}var un=class i{static{this.THROW_IF_NOT_FOUND=Al}static{this.NULL=new kf}static create(e,t){if(Array.isArray(e))return nw({name:""},t,e,"");{let n=e.name??"";return nw({name:n},e.parent,e.providers,n)}}static{this.\u0275prov=ke({token:i,providedIn:"any",factory:()=>qe(Hw)})}static{this.__NG_ELEMENT_ID__=-1}};var cP=new Ue("");cP.__NG_ELEMENT_ID__=i=>{let e=Ai();if(e===null)throw new Le(204,!1);if(e.type&2)return e.value;if(i&ct.Optional)return null;throw new Le(204,!1)};var lP="ngOriginalError";function Mv(i){return i[lP]}var VE=!0,Yn=(()=>{class i{static{this.__NG_ELEMENT_ID__=uP}static{this.__NG_ENV_ID__=t=>t}}return i})(),$v=class extends Yn{constructor(e){super(),this._lView=e}onDestroy(e){return pE(this._lView,e),()=>IN(this._lView,e)}};function uP(){return new $v(Bt())}var wo=(()=>{class i{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Sn(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=ke({token:i,providedIn:"root",factory:()=>new i})}}return i})();var qv=class extends Kt{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,nE()&&(this.destroyRef=ee(Yn,{optional:!0})??void 0,this.pendingTasks=ee(wo,{optional:!0})??void 0)}emit(e){let t=gt(null);try{super.next(e)}finally{gt(t)}}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof jt&&e.add(a),a}wrapInTimeout(e){return t=>{let n=this.pendingTasks?.add();setTimeout(()=>{e(t),n!==void 0&&this.pendingTasks?.remove(n)})}}},tn=qv;function Wf(...i){}function zE(i){let e,t;function n(){i=Wf;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{i(),n()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{i(),n()})),()=>n()}function iw(i){return queueMicrotask(()=>i()),()=>{i=Wf}}var qy="isAngularZone",$f=qy+"_ID",dP=0,At=class i{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new tn(!1),this.onMicrotaskEmpty=new tn(!1),this.onStable=new tn(!1),this.onError=new tn(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=VE}=e;if(typeof Zone>"u")throw new Le(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&n,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,pP(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(qy)===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new Le(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new Le(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,fP,Wf,Wf);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},fP={};function Xy(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function hP(i){if(i.isCheckStableRunning||i.callbackScheduled)return;i.callbackScheduled=!0;function e(){zE(()=>{i.callbackScheduled=!1,Xv(i),i.isCheckStableRunning=!0,Xy(i),i.isCheckStableRunning=!1})}i.scheduleInRootZone?Zone.root.run(()=>{e()}):i._outer.run(()=>{e()}),Xv(i)}function pP(i){let e=()=>{hP(i)},t=dP++;i._inner=i._inner.fork({name:"angular",properties:{[qy]:!0,[$f]:t,[$f+t]:!0},onInvokeTask:(n,r,s,o,a,c)=>{if(mP(c))return n.invokeTask(s,o,a,c);try{return rw(i),n.invokeTask(s,o,a,c)}finally{(i.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),sw(i)}},onInvoke:(n,r,s,o,a,c,l)=>{try{return rw(i),n.invoke(s,o,a,c,l)}finally{i.shouldCoalesceRunChangeDetection&&!i.callbackScheduled&&!gP(c)&&e(),sw(i)}},onHasTask:(n,r,s,o)=>{n.hasTask(s,o),r===s&&(o.change=="microTask"?(i._hasPendingMicrotasks=o.microTask,Xv(i),Xy(i)):o.change=="macroTask"&&(i.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,s,o)=>(n.handleError(s,o),i.runOutsideAngular(()=>i.onError.emit(o)),!1)})}function Xv(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.callbackScheduled===!0?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function rw(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function sw(i){i._nesting--,Xy(i)}var qf=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new tn,this.onMicrotaskEmpty=new tn,this.onStable=new tn,this.onError=new tn}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}};function mP(i){return HE(i,"__ignore_ng_zone__")}function gP(i){return HE(i,"__scheduler_tick__")}function HE(i,e){return!Array.isArray(i)||i.length!==1?!1:i[0]?.data?.[e]===!0}function vP(i="zone.js",e){return i==="noop"?new qf:i==="zone.js"?new At(e):i}var Yi=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Mv(e);for(;t&&Mv(t);)t=Mv(t);return t||null}},yP=new Ue("",{providedIn:"root",factory:()=>{let i=ee(At),e=ee(Yi);return t=>i.runOutsideAngular(()=>e.handleError(t))}}),Yv=class{constructor(){this.destroyed=!1,this.listeners=null,this.errorHandler=ee(Yi,{optional:!0}),this.destroyRef=ee(Yn),this.destroyRef.onDestroy(()=>{this.destroyed=!0,this.listeners=null})}subscribe(e){if(this.destroyed)throw new Le(953,!1);return(this.listeners??=[]).push(e),{unsubscribe:()=>{let t=this.listeners?.indexOf(e);t!==void 0&&t!==-1&&this.listeners?.splice(t,1)}}}emit(e){if(this.destroyed)throw new Le(953,!1);if(this.listeners===null)return;let t=gt(null);try{for(let n of this.listeners)try{n(e)}catch(r){this.errorHandler?.handleError(r)}}finally{gt(t)}}};function GE(i){return new Yv}function ow(i,e){return Dw(i,e)}function _P(i){return Dw(Aw,i)}var nn=(ow.required=_P,ow);function xP(){return Ya(Ai(),Bt())}function Ya(i,e){return new di(Ji(i,e))}var di=(()=>{class i{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=xP}}return i})();function MP(i){return i instanceof di?i.nativeElement:i}function SP(){return this._results[Symbol.iterator]()}var Zv=class i{get changes(){return this._changes??=new tn}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=i.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=SP)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=j1(e);(this._changesDetected=!G1(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function jE(i){return(i.flags&128)===128}var Yy=new Map,bP=0;function wP(){return bP++}function EP(i){Yy.set(i[Ul],i)}function WE(i){return Yy.get(i)||null}function Kv(i){Yy.delete(i[Ul])}var Jv=class{get lView(){return WE(this.lViewId)}constructor(e,t,n){this.lViewId=e,this.nodeIndex=t,this.native=n}};function $i(i){let e=Sv(i);if(e){if(Ds(e)){let t=e,n,r,s;if($E(i)){if(n=AP(t,i),n==-1)throw new Error("The provided component was not found in the application");r=i}else if(TP(i)){if(n=DP(t,i),n==-1)throw new Error("The provided directive was not found in the application");s=IP(n,t)}else if(n=cw(t,i),n==-1)return null;let o=Ln(t[n]),a=Sv(o),c=a&&!Array.isArray(a)?a:aw(t,n,o);if(r&&c.component===void 0&&(c.component=r,ji(c.component,c)),s&&c.directives===void 0){c.directives=s;for(let l=0;l<s.length;l++)ji(s[l],c)}ji(c.native,c),e=c}}else{let t=i,n=t;for(;n=n.parentNode;){let r=Sv(n);if(r){let s=Array.isArray(r)?r:r.lView;if(!s)return null;let o=cw(s,t);if(o>=0){let a=Ln(s[o]),c=aw(s,o,a);ji(a,c),e=c;break}}}}return e||null}function aw(i,e,t){return new Jv(i[Ul],e,t)}var Qv="__ngContext__";function ji(i,e){Ds(e)?(i[Qv]=e[Ul],EP(e)):i[Qv]=e}function Sv(i){let e=i[Qv];return typeof e=="number"?WE(e):e||null}function $E(i){return i&&i.constructor&&i.constructor.\u0275cmp}function TP(i){return i&&i.constructor&&i.constructor.\u0275dir}function cw(i,e){let t=i[Oe];for(let n=Xi;n<t.bindingStartIndex;n++)if(Ln(i[n])===e)return n;return-1}function CP(i){if(i.child)return i.child;if(i.next)return i.next;for(;i.parent&&!i.parent.next;)i=i.parent;return i.parent&&i.parent.next}function AP(i,e){let t=i[Oe].components;if(t)for(let n=0;n<t.length;n++){let r=t[n];if(gr(r,i)[qn]===e)return r}else if(gr(Xi,i)[qn]===e)return Xi;return-1}function DP(i,e){let t=i[Oe].firstChild;for(;t;){let n=t.directiveStart,r=t.directiveEnd;for(let s=n;s<r;s++)if(i[s]===e)return t.index;t=CP(t)}return-1}function IP(i,e){let t=e[Oe].data[i];if(t.directiveStart===0)return li;let n=[];for(let r=t.directiveStart;r<t.directiveEnd;r++){let s=e[r];$E(s)||n.push(s)}return n}function RP(i,e){let t=e[Oe].data[i],{directiveStart:n,componentOffset:r}=t;return r>-1?e[n+r]:null}function NP(i,e){let t=i[Oe].data[e];if(t&&t.localNames){let n={},r=t.index+1;for(let s=0;s<t.localNames.length;s+=2)n[t.localNames[s]]=i[r],r++;return n}return null}function qE(i){return YE(i[Nl])}function XE(i){return YE(i[Wi])}function YE(i){for(;i!==null&&!vr(i);)i=i[Wi];return i}function lw(i){let e=$i(i);if(e===null)return null;if(e.component===void 0){let t=e.lView;if(t===null)return null;e.component=RP(e.nodeIndex,t)}return e.component}function PP(i){zP(i);let e=$i(i),t=e?e.lView:null;return t===null?null:t[qn]}function OP(i){let e=$i(i),t=e?e.lView:null;if(t===null)return null;let n;for(;t[Oe].type===2&&(n=Ls(t));)t=n;return t[Ye]&512?null:t[qn]}function LP(i){let e=$i(i),t=e?e.lView:null;if(t===null)return un.NULL;let n=t[Oe].data[e.nodeIndex];return new Is(n,t)}function FP(i){let e=$i(i),t=e?e.lView:null;if(t===null)return[];let n=t[Oe],r=n.data[e.nodeIndex],s=[],o=r.providerIndexes&1048575,a=r.directiveEnd;for(let c=o;c<a;c++){let l=n.data[c];VP(l)&&(l=l.type),s.push(l)}return s}function kP(i){let e=$i(i);if(e===null)return{};if(e.localRefs===void 0){let t=e.lView;if(t===null)return{};e.localRefs=NP(t,e.nodeIndex)}return e.localRefs||{}}function UP(i){let e=$i(i),t=e===null?null:e.lView;if(t===null)return[];let n=t[Oe],r=t[Rl],s=n.cleanup,o=[];if(s&&r)for(let a=0;a<s.length;){let c=s[a++],l=s[a++];if(typeof c=="string"){let u=c,d=Ln(t[l]),f=r[s[a++]],h=s[a++],p=typeof h=="boolean"||h>=0?"dom":"output",v=typeof h=="boolean"?h:!1;i==d&&o.push({element:i,name:u,callback:f,useCapture:v,type:p})}}return o.sort(BP),o}function BP(i,e){return i.name==e.name?0:i.name<e.name?-1:1}function VP(i){return i.type!==void 0&&i.declaredInputs!==void 0&&i.findHostDirectiveDefs!==void 0}function zP(i){if(typeof Element<"u"&&!(i instanceof Element))throw new Error("Expecting instance of DOM Element")}var ey;function ZE(i){ey=i}function HP(){if(ey!==void 0)return ey;if(typeof document<"u")return document;throw new Le(210,!1)}var fh=new Ue("",{providedIn:"root",factory:()=>GP}),GP="ng",Zy=new Ue(""),ks=new Ue("",{providedIn:"platform",factory:()=>"unknown"});var Ky=new Ue("",{providedIn:"root",factory:()=>HP().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var jP="h",WP="b";var $P=()=>null;function Jy(i,e,t=!1){return $P(i,e,t)}var KE=!1,qP=new Ue("",{providedIn:"root",factory:()=>KE});var ty=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${S1})`}};function Qy(i){return i instanceof ty?i.changingThisBreaksApplicationSecurity:i}var XP="\uFFFD";function JE(i){return i instanceof Function?i():i}function YP(i){return(i??ee(un)).get(ks)==="browser"}var zr=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(zr||{}),ZP;function e_(i,e){return ZP(i,e)}function Na(i,e,t,n,r){if(n!=null){let s,o=!1;vr(n)?s=n:Ds(n)&&(o=!0,n=n[jr]);let a=Ln(n);i===0&&t!==null?r==null?iT(e,t,a):Xf(e,t,a,r||null,!0):i===1&&t!==null?Xf(e,t,a,r||null,!0):i===2?dO(e,a,o):i===3&&e.destroyNode(a),s!=null&&hO(e,i,s,t,r)}}function KP(i,e){return i.createText(e)}function JP(i,e,t){i.setValue(e,t)}function QE(i,e,t){return i.createElement(e,t)}function QP(i,e){eT(i,e),e[jr]=null,e[Ci]=null}function eO(i,e,t,n,r,s){n[jr]=r,n[Ci]=e,hh(i,n,t,1,r,s)}function eT(i,e){e[Br].changeDetectionScheduler?.notify(9),hh(i,e,e[On],2,null,null)}function tO(i){let e=i[Nl];if(!e)return bv(i[Oe],i);for(;e;){let t=null;if(Ds(e))t=e[Nl];else{let n=e[$n];n&&(t=n)}if(!t){for(;e&&!e[Wi]&&e!==i;)Ds(e)&&bv(e[Oe],e),e=e[wn];e===null&&(e=i),Ds(e)&&bv(e[Oe],e),t=e&&e[Wi]}e=t}}function nO(i,e,t,n){let r=$n+n,s=t.length;n>0&&(t[r-1][Wi]=e),n<s-$n?(e[Wi]=t[r],zw(t,$n+n,e)):(t.push(e),e[Wi]=null),e[wn]=t;let o=e[mo];o!==null&&t!==o&&tT(o,e);let a=e[Vr];a!==null&&a.insertView(i),Vv(e),e[Ye]|=128}function tT(i,e){let t=i[Ba],n=e[wn];if(Ds(n))i[Ye]|=Vf.HasTransplantedViews;else{let r=n[wn][qi];e[qi]!==r&&(i[Ye]|=Vf.HasTransplantedViews)}t===null?i[Ba]=[e]:t.push(e)}function t_(i,e){let t=i[Ba],n=t.indexOf(e);t.splice(n,1)}function ny(i,e){if(i.length<=$n)return;let t=$n+e,n=i[t];if(n){let r=n[mo];r!==null&&r!==i&&t_(r,n),e>0&&(i[t-1][Wi]=n[Wi]);let s=Ff(i,$n+e);QP(n[Oe],n);let o=s[Vr];o!==null&&o.detachView(s[Oe]),n[wn]=null,n[Wi]=null,n[Ye]&=-129}return n}function nT(i,e){if(!(e[Ye]&256)){let t=e[On];t.destroyNode&&hh(i,e,t,3,null,null),tO(e)}}function bv(i,e){if(e[Ye]&256)return;let t=gt(null);try{e[Ye]&=-129,e[Ye]|=256,e[Ti]&&Zd(e[Ti]),rO(i,e),iO(i,e),e[Oe].type===1&&e[On].destroy();let n=e[mo];if(n!==null&&vr(e[wn])){n!==e[wn]&&t_(n,e);let r=e[Vr];r!==null&&r.detachView(i)}Kv(e)}finally{gt(t)}}function iO(i,e){let t=i.cleanup,n=e[Rl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else{let o=n[t[s+1]];t[s].call(o)}n!==null&&(e[Rl]=null);let r=e[As];if(r!==null){e[As]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function rO(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof vo)){let s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],c=s[o+1];hr(4,a,c);try{c.call(a)}finally{hr(5,a,c)}}else{hr(4,r,s);try{s.call(r)}finally{hr(5,r,s)}}}}}function sO(i,e,t){return oO(i,e.parent,t)}function oO(i,e,t){let n=e;for(;n!==null&&n.type&168;)e=n,n=e.parent;if(n===null)return t[jr];{let{componentOffset:r}=n;if(r>-1){let{encapsulation:s}=i.data[n.directiveStart+r];if(s===mr.None||s===mr.Emulated)return null}return Ji(n,t)}}function Xf(i,e,t,n,r){i.insertBefore(e,t,n,r)}function iT(i,e,t){i.appendChild(e,t)}function uw(i,e,t,n,r){n!==null?Xf(i,e,t,n,r):iT(i,e,t)}function rT(i,e){return i.parentNode(e)}function aO(i,e){return i.nextSibling(e)}function cO(i,e,t){return uO(i,e,t)}function lO(i,e,t){return i.type&40?Ji(i,t):null}var uO=lO,dw;function n_(i,e,t,n){let r=sO(i,n,e),s=e[On],o=n.parent||e[Ci],a=cO(o,n,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)uw(s,r,t[c],a,!1);else uw(s,r,t,a,!1);dw!==void 0&&dw(s,n,e,t,r)}function El(i,e){if(e!==null){let t=e.type;if(t&3)return Ji(e,i);if(t&4)return iy(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return El(i,n);{let r=i[e.index];return vr(r)?iy(-1,r):Ln(r)}}else{if(t&128)return El(i,e.next);if(t&32)return e_(e,i)()||Ln(i[e.index]);{let n=sT(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=Ls(i[qi]);return El(r,n)}else return El(i,e.next)}}}return null}function sT(i,e){if(e!==null){let n=i[qi][Ci],r=e.projection;return n.projection[r]}return null}function iy(i,e){let t=$n+i+1;if(t<e.length){let n=e[t],r=n[Oe].firstChild;if(r!==null)return El(n,r)}return e[Os]}function dO(i,e,t){i.removeChild(null,e,t)}function i_(i,e,t,n,r,s,o){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=n[t.index],c=t.type;if(o&&e===0&&(a&&ji(Ln(a),n),t.flags|=2),(t.flags&32)!==32)if(c&8)i_(i,e,t.child,n,r,s,!1),Na(e,i,r,a,s);else if(c&32){let l=e_(t,n),u;for(;u=l();)Na(e,i,r,u,s);Na(e,i,r,a,s)}else c&16?fO(i,e,n,t,r,s):Na(e,i,r,a,s);t=o?t.projectionNext:t.next}}function hh(i,e,t,n,r,s){i_(t,n,i.firstChild,e,r,s,!1)}function fO(i,e,t,n,r,s){let o=t[qi],c=o[Ci].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Na(e,i,r,u,s)}else{let l=c,u=o[wn];jE(n)&&(l.flags|=128),i_(i,e,l,u,r,s,!0)}}function hO(i,e,t,n,r){let s=t[Os],o=Ln(t);s!==o&&Na(e,i,n,s,r);for(let a=$n;a<t.length;a++){let c=t[a];hh(c[Oe],c,i,e,n,s)}}function pO(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=n.indexOf("-")===-1?void 0:zr.DashCase;r==null?i.removeStyle(t,n,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=zr.Important),i.setStyle(t,n,r,s))}}function mO(i,e,t){i.setAttribute(e,"style",t)}function oT(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function aT(i,e,t){let{mergedAttrs:n,classes:r,styles:s}=t;n!==null&&Ov(i,e,n),r!==null&&oT(i,e,r),s!==null&&mO(i,e,s)}var Us={};function vn(i=1){cT(Qi(),Bt(),Xa()+i,!1)}function cT(i,e,t,n){if(!n)if((e[Ye]&3)===3){let s=i.preOrderCheckHooks;s!==null&&If(e,s,t)}else{let s=i.preOrderHooks;s!==null&&Rf(e,s,0,t)}go(t)}function yr(i,e=ct.Default){let t=Bt();if(t===null)return qe(i,e);let n=Ai();return FE(n,t,Nn(i),e)}function lT(){let i="invalid";throw new Error(i)}function uT(i,e,t,n,r,s){let o=gt(null);try{let a=null;r&Ns.SignalBased&&(a=e[n][bi]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&Ns.HasDecoratorInputTransform&&(s=i.inputTransforms[n].call(e,s)),i.setInput!==null?i.setInput(e,a,s,t,n):oE(e,a,n,s)}finally{gt(o)}}function gO(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)go(~r);else{let s=r,o=t[++n],a=t[++n];HN(o,s);let c=e[s];a(2,c)}}}finally{go(-1)}}function ph(i,e,t,n,r,s,o,a,c,l,u){let d=e.blueprint.slice();return d[jr]=r,d[Ye]=n|4|128|8|64,(l!==null||i&&i[Ye]&2048)&&(d[Ye]|=2048),fE(d),d[wn]=d[kl]=i,d[qn]=t,d[Br]=o||i&&i[Br],d[On]=a||i&&i[On],d[Ua]=c||i&&i[Ua]||null,d[Ci]=s,d[Ul]=wP(),d[Uf]=u,d[iE]=l,d[qi]=e.type==2?i[qi]:d,d}function mh(i,e,t,n,r){let s=i.data[e];if(s===null)s=vO(i,e,t,n,r),zN()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=n,s.attrs=r;let o=kN();s.injectorIndex=o===null?-1:o.injectorIndex}return Vl(s,!0),s}function vO(i,e,t,n,r){let s=_E(),o=xE(),a=o?s:s&&s.parent,c=i.data[e]=bO(i,a,t,e,n,r);return i.firstChild===null&&(i.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function dT(i,e,t,n){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function fT(i,e,t,n,r){let s=Xa(),o=n&2;try{go(-1),o&&e.length>Xi&&cT(i,e,Xi,!1),hr(o?2:0,r),t(n,r)}finally{go(s),hr(o?3:1,r)}}function hT(i,e,t){if(sE(e)){let n=gt(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=i.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{gt(n)}}}function pT(i,e,t){gE()&&(IO(i,e,t,Ji(t,e)),(t.flags&64)===64&&_T(i,e,t))}function mT(i,e,t=Ji){let n=e.localNames;if(n!==null){let r=e.index+1;for(let s=0;s<n.length;s+=2){let o=n[s+1],a=o===-1?t(e,i):i[o];i[r++]=a}}}function gT(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=r_(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function r_(i,e,t,n,r,s,o,a,c,l,u){let d=Xi+n,f=d+r,h=yO(d,f),p=typeof l=="function"?l():l;return h[Oe]={type:i,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}function yO(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:Us);return t}function _O(i,e,t,n){let s=n.get(qP,KE)||t===mr.ShadowDom,o=i.selectRootElement(e,s);return xO(o),o}function xO(i){MO(i)}var MO=()=>null;function SO(i,e,t,n){let r=ST(e);r.push(t),i.firstCreatePass&&bT(i).push(n,r.length-1)}function bO(i,e,t,n,r,s){let o=e?e.injectorIndex:-1,a=0;return ON()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function fw(i,e,t,n,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;n??={};let a,c=Ns.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(r!==null){if(!r.hasOwnProperty(s))continue;l=r[s]}i===0?hw(n,t,l,a,c):hw(n,t,l,a)}return n}function hw(i,e,t,n,r){let s;i.hasOwnProperty(t)?(s=i[t]).push(e,n):s=i[t]=[e,n],r!==void 0&&s.push(r)}function wO(i,e,t){let n=e.directiveStart,r=e.directiveEnd,s=i.data,o=e.attrs,a=[],c=null,l=null;for(let u=n;u<r;u++){let d=s[u],f=t?t.get(d):null,h=f?f.inputs:null,p=f?f.outputs:null;c=fw(0,d.inputs,u,c,h),l=fw(1,d.outputs,u,l,p);let v=c!==null&&o!==null&&!Py(e)?BO(c,u,o):null;a.push(v)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function EO(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function TO(i,e,t,n,r,s,o,a){let c=Ji(e,t),l=e.inputs,u;!a&&l!=null&&(u=l[n])?(s_(i,t,u,n,r),Bl(e)&&CO(t,e.index)):e.type&3?(n=EO(n),r=o!=null?o(r,e.value||"",n):r,s.setProperty(c,n,r)):e.type&12}function CO(i,e){let t=gr(e,i);t[Ye]&16||(t[Ye]|=64)}function vT(i,e,t,n){if(gE()){let r=n===null?null:{"":-1},s=NO(i,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&yT(i,e,t,o,r,a),r&&PO(t,n,r)}t.mergedAttrs=Ny(t.mergedAttrs,t.attrs)}function yT(i,e,t,n,r,s){for(let l=0;l<n.length;l++)jv(jf(t,e),i,n[l].type);LO(t,i.data.length,n.length);for(let l=0;l<n.length;l++){let u=n[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=dT(i,e,n.length,null);for(let l=0;l<n.length;l++){let u=n[l];t.mergedAttrs=Ny(t.mergedAttrs,u.hostAttrs),FO(i,t,e,c,u),OO(c,u,r),u.contentQueries!==null&&(t.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(t.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}wO(i,t,s)}function AO(i,e,t,n,r){let s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;o===null&&(o=i.hostBindingOpCodes=[]);let a=~e.index;DO(o)!=a&&o.push(a),o.push(t,n,s)}}function DO(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function IO(i,e,t,n){let r=t.directiveStart,s=t.directiveEnd;Bl(t)&&kO(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||jf(t,e),ji(n,e);let o=t.initialInputs;for(let a=r;a<s;a++){let c=i.data[a],l=yo(e,i,a,t);if(ji(l,e),o!==null&&UO(e,a-r,l,c,t,o),qa(c)){let u=gr(t.index,e);u[qn]=yo(e,i,a,t)}}}function _T(i,e,t){let n=t.directiveStart,r=t.directiveEnd,s=t.index,o=GN();try{go(s);for(let a=n;a<r;a++){let c=i.data[a],l=e[a];zv(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&RO(c,l)}}finally{go(-1),zv(o)}}function RO(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function NO(i,e){let t=i.directiveRegistry,n=null,r=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(tN(e,o.selectors,!1))if(n||(n=[]),qa(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o);let c=a.length;ry(i,e,c)}else n.unshift(o),ry(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return n===null?null:[n,r]}function ry(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function PO(i,e,t){if(e){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new Le(-301,!1);n.push(e[r],s)}}}function OO(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;qa(e)&&(t[""]=i)}}function LO(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function FO(i,e,t,n,r){i.data[n]=r;let s=r.factory||(r.factory=Fa(r.type,!0)),o=new vo(s,qa(r),yr);i.blueprint[n]=o,t[n]=o,AO(i,e,n,dT(i,t,r.hostVars,Us),r)}function kO(i,e,t){let n=Ji(e,i),r=gT(t),s=i[Br].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=gh(i,ph(i,r,null,o,n,e,null,s.createRenderer(n,t),null,null,null));i[e.index]=a}function UO(i,e,t,n,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],d=o[a++];uT(n,t,c,l,u,d)}}function BO(i,e,t){let n=null,r=0;for(;r<t.length;){let s=t[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(i.hasOwnProperty(s)){n===null&&(n=[]);let o=i[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){n.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}return n}function xT(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function MT(i,e){let t=i.contentQueries;if(t!==null){let n=gt(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=i.data[o];By(s),a.contentQueries(2,e[o],o)}}}finally{gt(n)}}}function gh(i,e){return i[Nl]?i[Yb][Wi]=e:i[Nl]=e,i[Yb]=e,e}function sy(i,e,t){By(0);let n=gt(null);try{e(i,t)}finally{gt(n)}}function ST(i){return i[Rl]??=[]}function bT(i){return i.cleanup??=[]}function wT(i,e){let t=i[Ua],n=t?t.get(Yi,null):null;n&&n.handleError(e)}function s_(i,e,t,n,r){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],u=i.data[o];uT(u,l,n,a,c,r)}}function VO(i,e,t){let n=uE(e,i);JP(i[On],n,t)}function zO(i,e){let t=gr(e,i),n=t[Oe];HO(n,t);let r=t[jr];r!==null&&t[Uf]===null&&(t[Uf]=Jy(r,t[Ua])),o_(n,t,t[qn])}function HO(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function o_(i,e,t){Vy(e);try{let n=i.viewQuery;n!==null&&sy(1,n,t);let r=i.template;r!==null&&fT(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[Vr]?.finishViewCreation(i),i.staticContentQueries&&MT(i,e),i.staticViewQueries&&sy(2,i.viewQuery,t);let s=i.components;s!==null&&GO(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[Ye]&=-5,zy()}}function GO(i,e){for(let t=0;t<e.length;t++)zO(i,e[t])}function jO(i,e,t,n){let r=gt(null);try{let s=e.tView,a=i[Ye]&4096?4096:16,c=ph(i,s,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),l=i[e.index];c[mo]=l;let u=i[Vr];return u!==null&&(c[Vr]=u.createEmbeddedView(s)),o_(s,c,t),c}finally{gt(r)}}function pw(i,e){return!e||e.firstChild===null||jE(i)}function WO(i,e,t,n=!0){let r=e[Oe];if(nO(r,e,i,t),n){let o=iy(t,i),a=e[On],c=rT(a,i[Os]);c!==null&&eO(r,i[Ci],a,e,c,o)}let s=e[Uf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Yf(i,e,t,n,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&n.push(Ln(s)),vr(s)&&$O(s,n);let o=t.type;if(o&8)Yf(i,e,t.child,n);else if(o&32){let a=e_(t,e),c;for(;c=a();)n.push(c)}else if(o&16){let a=sT(e,t);if(Array.isArray(a))n.push(...a);else{let c=Ls(e[qi]);Yf(c[Oe],c,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function $O(i,e){for(let t=$n;t<i.length;t++){let n=i[t],r=n[Oe].firstChild;r!==null&&Yf(n[Oe],n,r,e)}i[Os]!==i[jr]&&e.push(i[Os])}var ET=[];function qO(i){return i[Ti]??XO(i)}function XO(i){let e=ET.pop()??Object.create(ZO);return e.lView=i,e}function YO(i){i.lView[Ti]!==i&&(i.lView=null,ET.push(i))}var ZO=tt(ie({},va),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{dh(i.lView)},consumerOnSignalRead(){this.lView[Ti]=this}});function KO(i){let e=i[Ti]??Object.create(JO);return e.lView=i,e}var JO=tt(ie({},va),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{let e=Ls(i.lView);for(;e&&!TT(e[Oe]);)e=Ls(e);e&&hE(e)},consumerOnSignalRead(){this.lView[Ti]=this}});function TT(i){return i.type!==2}var QO=100;function CT(i,e=!0,t=0){let n=i[Br],r=n.rendererFactory,s=!1;s||r.begin?.();try{eL(i,t)}catch(o){throw e&&wT(i,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush())}}function eL(i,e){let t=ME();try{Kb(!0),oy(i,e);let n=0;for(;uh(i);){if(n===QO)throw new Le(103,!1);n++,oy(i,1)}}finally{Kb(t)}}function tL(i,e,t,n){let r=e[Ye];if((r&256)===256)return;let s=!1,o=!1;!s&&e[Br].inlineEffectRunner?.flush(),Vy(e);let a=!0,c=null,l=null;s||(TT(i)?(l=qO(e),c=yl(l)):ZS()===null?(a=!1,l=KO(e),c=yl(l)):e[Ti]&&(Zd(e[Ti]),e[Ti]=null));try{fE(e),BN(i.bindingStartIndex),t!==null&&fT(i,e,t,2,n);let u=(r&3)===3;if(!s)if(u){let h=i.preOrderCheckHooks;h!==null&&If(e,h,null)}else{let h=i.preOrderHooks;h!==null&&Rf(e,h,0,null),yv(e,0)}if(o||nL(e),AT(e,0),i.contentQueries!==null&&MT(i,e),!s)if(u){let h=i.contentCheckHooks;h!==null&&If(e,h)}else{let h=i.contentHooks;h!==null&&Rf(e,h,1),yv(e,1)}gO(i,e);let d=i.components;d!==null&&IT(e,d,0);let f=i.viewQuery;if(f!==null&&sy(2,f,n),!s)if(u){let h=i.viewCheckHooks;h!==null&&If(e,h)}else{let h=i.viewHooks;h!==null&&Rf(e,h,2),yv(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[Df]){for(let h of e[Df])h();e[Df]=null}s||(e[Ye]&=-73)}catch(u){throw s||dh(e),u}finally{l!==null&&(Xd(l,c),a&&YO(l)),zy()}}function AT(i,e){for(let t=qE(i);t!==null;t=XE(t))for(let n=$n;n<t.length;n++){let r=t[n];DT(r,e)}}function nL(i){for(let e=qE(i);e!==null;e=XE(e)){if(!(e[Ye]&Vf.HasTransplantedViews))continue;let t=e[Ba];for(let n=0;n<t.length;n++){let r=t[n];hE(r)}}}function iL(i,e,t){let n=gr(e,i);DT(n,t)}function DT(i,e){ky(i)&&oy(i,e)}function oy(i,e){let n=i[Oe],r=i[Ye],s=i[Ti],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&Yd(s)),o||=!1,s&&(s.dirty=!1),i[Ye]&=-9217,o)tL(n,i,n.template,i[qn]);else if(r&8192){AT(i,1);let a=n.components;a!==null&&IT(i,a,1)}}function IT(i,e,t){for(let n=0;n<e.length;n++)iL(i,e[n],t)}function a_(i,e){let t=ME()?64:1088;for(i[Br].changeDetectionScheduler?.notify(e);i;){i[Ye]|=t;let n=Ls(i);if(Uv(i)&&!n)return i;i=n}return null}var _o=class{get rootNodes(){let e=this._lView,t=e[Oe];return Yf(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[qn]}set context(e){this._lView[qn]=e}get destroyed(){return(this._lView[Ye]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[wn];if(vr(e)){let t=e[Bf],n=t?t.indexOf(this):-1;n>-1&&(ny(e,n),Ff(t,n))}this._attachedToViewContainer=!1}nT(this._lView[Oe],this._lView)}onDestroy(e){pE(this._lView,e)}markForCheck(){a_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ye]&=-129}reattach(){Vv(this._lView),this._lView[Ye]|=128}detectChanges(){this._lView[Ye]|=1024,CT(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Le(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Uv(this._lView),t=this._lView[mo];t!==null&&!e&&t_(t,this._lView),eT(this._lView[Oe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Le(902,!1);this._appRef=e;let t=Uv(this._lView),n=this._lView[mo];n!==null&&!t&&tT(n,this._lView),Vv(this._lView)}},xo=(()=>{class i{static{this.__NG_ELEMENT_ID__=oL}}return i})(),rL=xo,sL=class extends rL{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){let r=jO(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:n});return new _o(r)}};function oL(){return c_(Ai(),Bt())}function c_(i,e){return i.type&4?new sL(e,i,Ya(i,e)):null}var d9=new RegExp(`^(\\d+)*(${WP}|${jP})*(.*)`);var aL=()=>null;function mw(i,e){return aL(i,e)}var Va=class{},l_=new Ue("",{providedIn:"root",factory:()=>!1});var RT=new Ue(""),NT=new Ue(""),ay=class{},Zf=class{};function cL(i){let e=Error(`No component factory found for ${Wn(i)}.`);return e[lL]=i,e}var lL="ngComponent";var cy=class{resolveComponentFactory(e){throw cL(e)}},za=class{static{this.NULL=new cy}},Hr=class{};var uL=(()=>{class i{static{this.\u0275prov=ke({token:i,providedIn:"root",factory:()=>null})}}return i})();function ly(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=Bb(r,a);else if(s==2){let c=a,l=e[++o];n=Bb(n,c+": "+l+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}var Kf=class extends za{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Ps(e);return new Ha(t,this.ngModule)}};function gw(i,e){let t=[];for(let n in i){if(!i.hasOwnProperty(n))continue;let r=i[n];if(r===void 0)continue;let s=Array.isArray(r),o=s?r[0]:r,a=s?r[1]:Ns.None;e?t.push({propName:o,templateName:n,isSignal:(a&Ns.SignalBased)!==0}):t.push({propName:o,templateName:n})}return t}function dL(i){let e=i.toLowerCase();return e==="svg"?TN:e==="math"?CN:null}var Ha=class extends Zf{get inputs(){let e=this.componentDef,t=e.inputTransforms,n=gw(e.inputs,!0);if(t!==null)for(let r of n)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return n}get outputs(){return gw(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=sN(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=gt(null);try{r=r||this.ngModule;let o=r instanceof Pn?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Hv(e,o):e,c=a.get(Hr,null);if(c===null)throw new Le(407,!1);let l=a.get(uL,null),u=a.get(Va,null),d={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:u},f=c.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",p=n?_O(f,n,this.componentDef.encapsulation,a):QE(f,h,dL(h)),v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let g=null;p!==null&&(g=Jy(p,a,!0));let m=r_(0,null,null,1,0,null,null,null,null,null,null),_=ph(null,m,null,v,null,null,d,f,a,null,g);Vy(_);let x,y,D=null;try{let w=this.componentDef,E,C=null;w.findHostDirectiveDefs?(E=[],C=new Map,w.findHostDirectiveDefs(w,E,C),E.push(w)):E=[w];let S=fL(_,p);D=hL(S,p,w,E,_,d,f),y=dE(m,Xi),p&&gL(f,w,p,n),t!==void 0&&vL(y,this.ngContentSelectors,t),x=mL(D,w,E,C,_,[yL]),o_(m,_,null)}catch(w){throw D!==null&&Kv(D),Kv(_),w}finally{zy()}return new uy(this.componentType,x,Ya(y,_),_,y)}finally{gt(s)}}},uy=class extends ay{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new _o(r,void 0,!1),this.componentType=e}setInput(e,t){let n=this._tNode.inputs,r;if(n!==null&&(r=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;s_(s[Oe],s,r,e,t),this.previousInputValues.set(e,t);let o=gr(this._tNode.index,s);a_(o,1)}}get injector(){return new Is(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function fL(i,e){let t=i[Oe],n=Xi;return i[n]=e,mh(t,n,2,"#host",null)}function hL(i,e,t,n,r,s,o){let a=r[Oe];pL(n,i,e,o);let c=null;e!==null&&(c=Jy(e,r[Ua]));let l=s.rendererFactory.createRenderer(e,t),u=16;t.signals?u=4096:t.onPush&&(u=64);let d=ph(r,gT(t),null,u,r[i.index],i,s,l,null,null,c);return a.firstCreatePass&&ry(a,i,n.length-1),gh(r,d),r[i.index]=d}function pL(i,e,t,n){for(let r of i)e.mergedAttrs=Ny(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(ly(e,e.mergedAttrs,!0),t!==null&&aT(n,t,e))}function mL(i,e,t,n,r,s){let o=Ai(),a=r[Oe],c=Ji(o,r);yT(a,r,o,t,null,n);for(let u=0;u<t.length;u++){let d=o.directiveStart+u,f=yo(r,a,d,o);ji(f,r)}_T(a,r,o),c&&ji(c,r);let l=yo(r,a,o.directiveStart+o.componentOffset,o);if(i[qn]=r[qn]=l,s!==null)for(let u of s)u(l,e);return hT(a,o,r),l}function gL(i,e,t,n){if(n)Ov(i,t,["ng-version","18.2.13"]);else{let{attrs:r,classes:s}=oN(e.selectors[0]);r&&Ov(i,t,r),s&&s.length>0&&oT(i,t,s.join(" "))}}function vL(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let s=t[r];n.push(s!=null?Array.from(s):null)}}function yL(){let i=Ai();jy(Bt()[Oe],i)}var _r=(()=>{class i{static{this.__NG_ELEMENT_ID__=_L}}return i})();function _L(){let i=Ai();return OT(i,Bt())}var xL=_r,PT=class extends xL{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Ya(this._hostTNode,this._hostLView)}get injector(){return new Is(this._hostTNode,this._hostLView)}get parentInjector(){let e=Wy(this._hostTNode,this._hostLView);if(IE(e)){let t=Gf(e,this._hostLView),n=Hf(e),r=t[Oe].data[n+8];return new Is(r,t)}else return new Is(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=vw(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-$n}createEmbeddedView(e,t,n){let r,s;typeof n=="number"?r=n:n!=null&&(r=n.index,s=n.injector);let o=mw(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,pw(this._hostTNode,o)),a}createComponent(e,t,n,r,s){let o=e&&!SN(e),a;if(o)a=t;else{let p=t||{};a=p.index,n=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new Ha(Ps(e)),l=n||this.parentInjector;if(!s&&c.ngModule==null){let v=(o?l:this.parentInjector).get(Pn,null);v&&(s=v)}let u=Ps(c.componentType??{}),d=mw(this._lContainer,u?.id??null),f=d?.firstChild??null,h=c.create(l,r,f,s);return this.insertImpl(h.hostView,a,pw(this._hostTNode,d)),h}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(DN(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[wn],l=new PT(c,c[Ci],c[wn]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return WO(o,r,s,n),e.attachToViewContainerRef(),zw(wv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=vw(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=ny(this._lContainer,t);n&&(Ff(wv(this._lContainer),t),nT(n[Oe],n))}detach(e){let t=this._adjustIndex(e,-1),n=ny(this._lContainer,t);return n&&Ff(wv(this._lContainer),t)!=null?new _o(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function vw(i){return i[Bf]}function wv(i){return i[Bf]||(i[Bf]=[])}function OT(i,e){let t,n=e[i.index];return vr(n)?t=n:(t=xT(n,e,null,i),e[i.index]=t,gh(e,t)),SL(t,e,i,n),new PT(t,i,e)}function ML(i,e){let t=i[On],n=t.createComment(""),r=Ji(e,i),s=rT(t,r);return Xf(t,s,n,aO(t,r),!1),n}var SL=EL,bL=()=>!1;function wL(i,e,t){return bL(i,e,t)}function EL(i,e,t,n){if(i[Os])return;let r;t.type&8?r=Ln(n):r=ML(e,t),i[Os]=r}var dy=class i{constructor(e){this.queryList=e,this.matches=null}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},fy=class i{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)kT(e,t).matches!==null&&this.queries[t].setDirty()}},hy=class{constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=NL(e):this.predicate=e}},py=class i{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,t!==null?t.push(s):t=[s])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},my=class i{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let s=n[r];this.matchTNodeWithReadOption(e,t,TL(t,s)),this.matchTNodeWithReadOption(e,t,Nf(t,e,s,!1,!1))}else n===xo?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Nf(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===di||r===_r||r===xo&&t.type&4)this.addMatch(t.index,-2);else{let s=Nf(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function TL(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function CL(i,e){return i.type&11?Ya(i,e):i.type&4?c_(i,e):null}function AL(i,e,t,n){return t===-1?CL(e,i):t===-2?DL(i,e,n):yo(i,i[Oe],t,e)}function DL(i,e,t){if(t===di)return Ya(e,i);if(t===xo)return c_(e,i);if(t===_r)return OT(e,i)}function LT(i,e,t,n){let r=e[Vr].queries[n];if(r.matches===null){let s=i.data,o=t.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let l=o[c];if(l<0)a.push(null);else{let u=s[l];a.push(AL(e,u,o[c+1],t.metadata.read))}}r.matches=a}return r.matches}function gy(i,e,t,n){let r=i.queries.getByIndex(t),s=r.matches;if(s!==null){let o=LT(i,e,r,t);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)n.push(o[a/2]);else{let l=s[a+1],u=e[-c];for(let d=$n;d<u.length;d++){let f=u[d];f[mo]===f[wn]&&gy(f[Oe],f,l,n)}if(u[Ba]!==null){let d=u[Ba];for(let f=0;f<d.length;f++){let h=d[f];gy(h[Oe],h,l,n)}}}}}return n}function FT(i,e){return i[Vr].queries[e].queryList}function IL(i,e,t){let n=new Zv((t&4)===4);return SO(i,e,n,n.destroy),(e[Vr]??=new fy).queries.push(new dy(n))-1}function RL(i,e,t){let n=Qi();return n.firstCreatePass&&(PL(n,new hy(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),IL(n,Bt(),e)}function NL(i){return i.split(",").map(e=>e.trim())}function PL(i,e,t){i.queries===null&&(i.queries=new py),i.queries.track(new my(e,t))}function kT(i,e){return i.queries.getByIndex(e)}function OL(i,e){let t=i[Oe],n=kT(t,e);return n.crossesNgTemplate?gy(t,i,e,[]):LT(t,i,n,e)}var yw=new Set;function Za(i){yw.has(i)||(yw.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}function Di(i,e){Za("NgSignals");let t=ab(i),n=t[bi];return e?.equal&&(n.equal=e.equal),t.set=r=>Qd(n,r),t.update=r=>cb(n,r),t.asReadonly=LL.bind(t),t}function LL(){let i=this[bi];if(i.readonlyFn===void 0){let e=()=>this();e[bi]=i,i.readonlyFn=e}return i.readonlyFn}function UT(i,e){let t,n=Qg(()=>{t._dirtyCounter();let r=BL(t,i);if(e&&r===void 0)throw new Le(-951,!1);return r});return t=n[bi],t._dirtyCounter=Di(0),t._flatValue=void 0,n}function FL(){return UT(!0,!1)}function kL(){return UT(!0,!0)}function UL(i,e){let t=i[bi];t._lView=Bt(),t._queryIndex=e,t._queryList=FT(t._lView,e),t._queryList.onDirty(()=>t._dirtyCounter.update(n=>n+1))}function BL(i,e){let t=i._lView,n=i._queryIndex;if(t===void 0||n===void 0||t[Ye]&4)return e?void 0:li;let r=FT(t,n),s=OL(t,n);return r.reset(s,MP),e?r.first:r._changesDetected||i._flatValue===void 0?i._flatValue=r.toArray():i._flatValue}function _w(i,e){return FL()}function VL(i,e){return kL()}var zl=(_w.required=VL,_w);function zL(i){let e=[],t=new Map;function n(r){let s=t.get(r);if(!s){let o=i(r);t.set(r,s=o.then(WL))}return s}return Jf.forEach((r,s)=>{let o=[];r.templateUrl&&o.push(n(r.templateUrl).then(l=>{r.template=l}));let a=typeof r.styles=="string"?[r.styles]:r.styles||[];if(r.styles=a,r.styleUrl&&r.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(r.styleUrls?.length){let l=r.styles.length,u=r.styleUrls;r.styleUrls.forEach((d,f)=>{a.push(""),o.push(n(d).then(h=>{a[l+f]=h,u.splice(u.indexOf(d),1),u.length==0&&(r.styleUrls=void 0)}))})}else r.styleUrl&&o.push(n(r.styleUrl).then(l=>{a.push(l),r.styleUrl=void 0}));let c=Promise.all(o).then(()=>$L(s));e.push(c)}),GL(),Promise.all(e).then(()=>{})}var Jf=new Map,HL=new Set;function GL(){let i=Jf;return Jf=new Map,i}function jL(){return Jf.size===0}function WL(i){return typeof i=="string"?i:i.text()}function $L(i){HL.delete(i)}var Fs=class{},Pl=class{};var Qf=class extends Fs{constructor(e,t,n,r=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Kf(this);let s=Yw(e);this._bootstrapComponents=JE(s.bootstrap),this._r3Injector=BE(e,t,[{provide:Fs,useValue:this},{provide:za,useValue:this.componentFactoryResolver},...n],Wn(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},eh=class extends Pl{constructor(e){super(),this.moduleType=e}create(e){return new Qf(this.moduleType,e,[])}};function qL(i,e,t){return new Qf(i,e,t,!1)}var vy=class extends Fs{constructor(e){super(),this.componentFactoryResolver=new Kf(this),this.instance=null;let t=new Il([...e.providers,{provide:Fs,useValue:this},{provide:za,useValue:this.componentFactoryResolver}],e.parent||Ly(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Ka(i,e,t=null){return new vy({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function u_(i,e,t){return i[e]=t}function XL(i,e){return i[e]}function Ga(i,e,t){let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function YL(i,e,t,n){let r=Ga(i,e,t);return Ga(i,e+1,n)||r}function ZL(i){return(i.flags&32)===32}function KL(i,e,t,n,r,s,o,a,c){let l=e.consts,u=mh(e,i,4,o||null,a||null);vT(e,t,u,zf(l,c)),jy(e,u);let d=u.tView=r_(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function JL(i,e,t,n,r,s,o,a,c,l){let u=t+Xi,d=e.firstCreatePass?KL(u,e,i,n,r,s,o,a,c):e.data[u];Vl(d,!1);let f=QL(e,i,d,t);Hy()&&n_(e,i,f,d),ji(f,i);let h=xT(f,i,f,d);return i[u]=h,gh(i,h),wL(h,d,i),Fy(d)&&pT(e,i,d),c!=null&&mT(i,d,l),d}function vh(i,e,t,n,r,s,o,a){let c=Bt(),l=Qi(),u=zf(l.consts,s);return JL(c,l,i,e,t,n,r,u,o,a),vh}var QL=eF;function eF(i,e,t,n){return Gy(!0),e[On].createComment("")}var Pa=function(i){return i[i.EarlyRead=0]="EarlyRead",i[i.Write=1]="Write",i[i.MixedReadWrite=2]="MixedReadWrite",i[i.Read=3]="Read",i}(Pa||{}),BT=(()=>{class i{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=ke({token:i,providedIn:"root",factory:()=>new i})}}return i})(),yy=class i{constructor(){this.ngZone=ee(At),this.scheduler=ee(Va),this.errorHandler=ee(Yi,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[Pa.EarlyRead,Pa.Write,Pa.MixedReadWrite,Pa.Read]}execute(){this.executing=!0;for(let e of i.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(n){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(n)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=ke({token:i,providedIn:"root",factory:()=>new i})}},_y=class{constructor(e,t,n,r){this.impl=e,this.hooks=t,this.once=n,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function Hl(i,e){!e?.injector&&$a(Hl);let t=e?.injector??ee(un);return YP(t)?(Za("NgAfterNextRender"),nF(i,t,e,!0)):iF}function tF(i,e){if(i instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=i,t}else return[i.earlyRead,i.write,i.mixedReadWrite,i.read]}function nF(i,e,t,n){let r=e.get(BT);r.impl??=e.get(yy);let s=t?.phase??Pa.MixedReadWrite,o=t?.manualCleanup!==!0?e.get(Yn):null,a=new _y(r.impl,tF(i,s),n,o);return r.impl.register(a),a}var iF={destroy(){}};function rF(i,e,t,n){return Ga(i,SE(),t)?e+Ay(t)+n:Us}function Ef(i,e){return i<<17|e<<2}function Mo(i){return i>>17&32767}function sF(i){return(i&2)==2}function oF(i,e){return i&131071|e<<17}function xy(i){return i|2}function ja(i){return(i&131068)>>2}function Ev(i,e){return i&-131069|e<<2}function aF(i){return(i&1)===1}function My(i){return i|1}function cF(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Mo(o),c=ja(o);i[n]=t;let l=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||Fl(d,u)>0)&&(l=!0)}else u=t;if(r)if(c!==0){let f=Mo(i[a+1]);i[n+1]=Ef(f,a),f!==0&&(i[f+1]=Ev(i[f+1],n)),i[a+1]=oF(i[a+1],n)}else i[n+1]=Ef(a,0),a!==0&&(i[a+1]=Ev(i[a+1],n)),a=n;else i[n+1]=Ef(c,0),a===0?a=n:i[c+1]=Ev(i[c+1],n),c=n;l&&(i[n+1]=xy(i[n+1])),xw(i,u,n,!0),xw(i,u,n,!1),lF(e,u,i,n,s),o=Ef(a,c),s?e.classBindings=o:e.styleBindings=o}function lF(i,e,t,n,r){let s=r?i.residualClasses:i.residualStyles;s!=null&&typeof e=="string"&&Fl(s,e)>=0&&(t[n+1]=My(t[n+1]))}function xw(i,e,t,n){let r=i[t+1],s=e===null,o=n?Mo(r):ja(r),a=!1;for(;o!==0&&(a===!1||s);){let c=i[o],l=i[o+1];uF(c,e)&&(a=!0,i[o+1]=n?My(l):xy(l)),o=n?Mo(l):ja(l)}a&&(i[t+1]=n?xy(r):My(r))}function uF(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?Fl(i,e)>=0:!1}function yn(i,e,t){let n=Bt(),r=SE();if(Ga(n,r,e)){let s=Qi(),o=qN();TO(s,o,n,i,e,n[On],t,!1)}return yn}function Mw(i,e,t,n,r){let s=e.inputs,o=r?"class":"style";s_(i,t,s[o],o,n)}function Ja(i,e,t){return dF(i,e,t,!1),Ja}function dF(i,e,t,n){let r=Bt(),s=Qi(),o=VN(2);if(s.firstUpdatePass&&hF(s,i,o,n),e!==Us&&Ga(r,o,e)){let a=s.data[Xa()];yF(s,a,r,r[On],i,r[o+1]=_F(e,t),n,o)}}function fF(i,e){return e>=i.expandoStartIndex}function hF(i,e,t,n){let r=i.data;if(r[t+1]===null){let s=r[Xa()],o=fF(i,t);xF(s,n)&&e===null&&!o&&(e=!1),e=pF(r,s,e,n),cF(r,s,e,t,o,n)}}function pF(i,e,t,n){let r=jN(i),s=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=Tv(null,i,e,t,n),t=Ol(t,e.attrs,n),s=null);else{let o=e.directiveStylingLast;if(o===-1||i[o]!==r)if(t=Tv(r,i,e,t,n),s===null){let c=mF(i,e,n);c!==void 0&&Array.isArray(c)&&(c=Tv(null,i,e,c[1],n),c=Ol(c,e.attrs,n),gF(i,e,n,c))}else s=vF(i,e,n)}return s!==void 0&&(n?e.residualClasses=s:e.residualStyles=s),t}function mF(i,e,t){let n=t?e.classBindings:e.styleBindings;if(ja(n)!==0)return i[Mo(n)]}function gF(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[Mo(r)]=n}function vF(i,e,t){let n,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=i[s].hostAttrs;n=Ol(n,o,t)}return Ol(n,e.attrs,t)}function Tv(i,e,t,n,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],n=Ol(n,s.hostAttrs,r),s!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function Ol(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),$1(i,o,t?!0:e[++s]))}return i===void 0?null:i}function yF(i,e,t,n,r,s,o,a){if(!(e.type&3))return;let c=i.data,l=c[a+1],u=aF(l)?Sw(c,e,t,r,ja(l),o):void 0;if(!th(u)){th(s)||sF(l)&&(s=Sw(c,null,t,r,a,o));let d=uE(Xa(),t);pO(n,o,d,r,s)}}function Sw(i,e,t,n,r,s){let o=e===null,a;for(;r>0;){let c=i[r],l=Array.isArray(c),u=l?c[1]:c,d=u===null,f=t[r+1];f===Us&&(f=d?li:void 0);let h=d?gv(f,n):u===n?f:void 0;if(l&&!th(h)&&(h=gv(c,n)),th(h)&&(a=h,o))return a;let p=i[r+1];r=o?Mo(p):ja(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=gv(c,n))}return a}function th(i){return i!==void 0}function _F(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=Wn(Qy(i)))),i}function xF(i,e){return(i.flags&(e?8:16))!==0}function MF(i,e,t,n,r,s){let o=e.consts,a=zf(o,r),c=mh(e,i,2,n,a);return vT(e,t,c,zf(o,s)),c.attrs!==null&&ly(c,c.attrs,!1),c.mergedAttrs!==null&&ly(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function $t(i,e,t,n){let r=Bt(),s=Qi(),o=Xi+i,a=r[On],c=s.firstCreatePass?MF(o,s,r,e,t,n):s.data[o],l=SF(s,r,c,a,e,i);r[o]=l;let u=Fy(c);return Vl(c,!0),aT(a,l,c),!ZL(c)&&Hy()&&n_(s,r,l,c),RN()===0&&ji(l,r),NN(),u&&(pT(s,r,c),hT(s,c,r)),n!==null&&mT(r,c),$t}function Qt(){let i=Ai();xE()?UN():(i=i.parent,Vl(i,!1));let e=i;LN(e)&&FN(),PN();let t=Qi();return t.firstCreatePass&&(jy(t,i),sE(i)&&t.queries.elementEnd(i)),e.classesWithoutHost!=null&&JN(e)&&Mw(t,e,Bt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&QN(e)&&Mw(t,e,Bt(),e.stylesWithoutHost,!1),Qt}function Zn(i,e,t,n){return $t(i,e,t,n),Qt(),Zn}var SF=(i,e,t,n,r,s)=>(Gy(!0),QE(n,r,XN()));function VT(){return Bt()}var nh="en-US";var bF=nh;function wF(i){typeof i=="string"&&(bF=i.toLowerCase().replace(/_/g,"-"))}var EF=(i,e,t)=>{};function er(i,e,t,n){let r=Bt(),s=Qi(),o=Ai();return CF(s,r,r[On],o,i,e,n),er}function TF(i,e,t,n){let r=i.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===n){let a=e[Rl],c=r[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function CF(i,e,t,n,r,s,o){let a=Fy(n),l=i.firstCreatePass&&bT(i),u=e[qn],d=ST(e),f=!0;if(n.type&3||o){let v=Ji(n,e),g=o?o(v):v,m=d.length,_=o?y=>o(Ln(y[n.index])):n.index,x=null;if(!o&&a&&(x=TF(i,e,r,n.index)),x!==null){let y=x.__ngLastListenerFn__||x;y.__ngNextListenerFn__=s,x.__ngLastListenerFn__=s,f=!1}else{s=ww(n,e,u,s),EF(v,r,s);let y=t.listen(g,r,s);d.push(s,y),l&&l.push(r,_,m,m+1)}}else s=ww(n,e,u,s);let h=n.outputs,p;if(f&&h!==null&&(p=h[r])){let v=p.length;if(v)for(let g=0;g<v;g+=2){let m=p[g],_=p[g+1],D=e[m][_].subscribe(s),w=d.length;d.push(s,D),l&&l.push(r,n.index,w,-(w+1))}}}function bw(i,e,t,n){let r=gt(null);try{return hr(6,e,t),t(n)!==!1}catch(s){return wT(i,s),!1}finally{hr(7,e,t),gt(r)}}function ww(i,e,t,n){return function r(s){if(s===Function)return n;let o=i.componentOffset>-1?gr(i.index,e):e;a_(o,5);let a=bw(e,t,n,s),c=r.__ngNextListenerFn__;for(;c;)a=bw(e,t,c,s)&&a,c=c.__ngNextListenerFn__;return a}}function Gl(i,e,t,n){UL(i,RL(e,t,n))}function yh(i=1){By(WN()+i)}function Ii(i,e=""){let t=Bt(),n=Qi(),r=i+Xi,s=n.firstCreatePass?mh(n,r,1,e,null):n.data[r],o=AF(n,t,s,e,i);t[r]=o,Hy()&&n_(n,t,o,s),Vl(s,!1)}var AF=(i,e,t,n,r)=>(Gy(!0),KP(e[On],n));function jl(i){return _h("",i,""),jl}function _h(i,e,t){let n=Bt(),r=rF(n,i,e,t);return r!==Us&&VO(n,Xa(),r),_h}function DF(i,e,t){let n=Qi();if(n.firstCreatePass){let r=qa(i);Sy(t,n.data,n.blueprint,r,!0),Sy(e,n.data,n.blueprint,r,!1)}}function Sy(i,e,t,n,r){if(i=Nn(i),Array.isArray(i))for(let s=0;s<i.length;s++)Sy(i[s],e,t,n,r);else{let s=Qi(),o=Bt(),a=Ai(),c=ka(i)?i:Nn(i.provide),l=tE(i),u=a.providerIndexes&1048575,d=a.directiveStart,f=a.providerIndexes>>20;if(ka(i)||!i.multi){let h=new vo(l,r,yr),p=Av(c,e,r?u:u+f,d);p===-1?(jv(jf(a,o),s,c),Cv(s,i,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(h),o.push(h)):(t[p]=h,o[p]=h)}else{let h=Av(c,e,u+f,d),p=Av(c,e,u,u+f),v=h>=0&&t[h],g=p>=0&&t[p];if(r&&!g||!r&&!v){jv(jf(a,o),s,c);let m=NF(r?RF:IF,t.length,r,n,l);!r&&g&&(t[p].providerFactory=m),Cv(s,i,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(m),o.push(m)}else{let m=zT(t[r?p:h],l,!r&&n);Cv(s,i,h>-1?h:p,m)}!r&&n&&g&&t[p].componentProviders++}}}function Cv(i,e,t,n){let r=ka(e),s=pN(e);if(r||s){let c=(s?Nn(e.useClass):e).prototype.ngOnDestroy;if(c){let l=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){let u=l.indexOf(t);u===-1?l.push(t,[n,c]):l[u+1].push(n,c)}else l.push(t,c)}}}function zT(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function Av(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function IF(i,e,t,n){return by(this.multi,[])}function RF(i,e,t,n){let r=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=yo(t,t[Oe],this.providerFactory.index,n);s=a.slice(0,o),by(r,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],by(r,s);return s}function by(i,e){for(let t=0;t<i.length;t++){let n=i[t];e.push(n())}return e}function NF(i,e,t,n,r){let s=new vo(i,t,yr);return s.multi=[],s.index=e,s.componentProviders=0,zT(s,r,n&&!t),s}function HT(i,e=[]){return t=>{t.providersResolver=(n,r)=>DF(n,r?r(i):i,e)}}var PF=(()=>{class i{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let n=Jw(!1,t.type),r=n.length>0?Ka([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=ke({token:i,providedIn:"environment",factory:()=>new i(qe(Pn))})}}return i})();function Eo(i){Za("NgStandalone"),i.getStandaloneInjector=e=>e.get(PF).getOrCreateStandaloneInjector(i)}function Wl(i,e,t){let n=Uy()+i,r=Bt();return r[n]===Us?u_(r,n,t?e.call(t):e()):XL(r,n)}function Qa(i,e,t,n){return OF(Bt(),Uy(),i,e,t,n)}function d_(i,e,t,n,r){return LF(Bt(),Uy(),i,e,t,n,r)}function GT(i,e){let t=i[e];return t===Us?void 0:t}function OF(i,e,t,n,r,s){let o=e+t;return Ga(i,o,r)?u_(i,o+1,s?n.call(s,r):n(r)):GT(i,o+1)}function LF(i,e,t,n,r,s,o){let a=e+t;return YL(i,a,r,s)?u_(i,a+2,o?n.call(o,r,s):n(r,s)):GT(i,a+2)}var Tf=null;function FF(i){Tf!==null&&(i.defaultEncapsulation!==Tf.defaultEncapsulation||i.preserveWhitespaces!==Tf.preserveWhitespaces)||(Tf=i)}var xh=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"platform"})}}return i})();var f_=new Ue(""),$l=new Ue(""),Mh=(()=>{class i{constructor(t,n,r){this._ngZone=t,this.registry=n,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,h_||(kF(r),r.addToWindow(n)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>n.updateCb&&n.updateCb(t)?(clearTimeout(n.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t()},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,n,r){return[]}static{this.\u0275fac=function(n){return new(n||i)(qe(At),qe(Sh),qe($l))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),Sh=(()=>{class i{constructor(){this._applications=new Map}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return h_?.findTestabilityInTree(this,t,n)??null}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"platform"})}}return i})();function kF(i){h_=i}var h_;function ql(i){return!!i&&typeof i.then=="function"}function jT(i){return!!i&&typeof i.subscribe=="function"}var bh=new Ue(""),WT=(()=>{class i{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,n)=>{this.resolve=t,this.reject=n}),this.appInits=ee(bh,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let s=r();if(ql(s))t.push(s);else if(jT(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let n=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),t.length===0&&n(),this.initialized=!0}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),p_=new Ue("");function UF(){ob(()=>{throw new Le(600,!1)})}function BF(i){return i.isBoundToModule}var VF=10;function zF(i,e,t){try{let n=t();return ql(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}function $T(i,e){return Array.isArray(e)?e.reduce($T,i):ie(ie({},i),e)}var Bs=(()=>{class i{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ee(yP),this.afterRenderManager=ee(BT),this.zonelessEnabled=ee(l_),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Kt,this.afterTick=new Kt,this.componentTypes=[],this.components=[],this.isStable=ee(wo).hasPendingTasks.pipe(yt(t=>!t)),this._injector=ee(Pn)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(n=>{t=this.isStable.subscribe({next:r=>{r&&n()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,n){let r=t instanceof Zf;if(!this._injector.get(WT).done){let f=!r&&Xw(t),h=!1;throw new Le(405,h)}let o;r?o=t:o=this._injector.get(za).resolveComponentFactory(t),this.componentTypes.push(o.componentType);let a=BF(o)?void 0:this._injector.get(Fs),c=n||o.selector,l=o.create(un.NULL,[],c,a),u=l.location.nativeElement,d=l.injector.get(f_,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),Pf(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new Le(101,!1);let t=gt(null);try{this._runningTick=!0,this.synchronize()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1,gt(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(Hr,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;this.dirtyFlags!==0&&n++<VF;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(n);for(let{_lView:r,notifyErrorHandler:s}of this._views)HF(r,s,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>uh(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){let n=t;Pf(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let n=this._injector.get(p_,[]);[...this._bootstrapListeners,...n].forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Pf(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Le(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Pf(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function HF(i,e,t,n){if(!t&&!uh(i))return;CT(i,e,t&&!n?0:1)}var wy=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},wh=(()=>{class i{compileModuleSync(t){return new eh(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let n=this.compileModuleSync(t),r=Yw(t),s=JE(r.declarations).reduce((o,a)=>{let c=Ps(a);return c&&o.push(new Ha(c)),o},[]);return new wy(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),GF=new Ue("");function jF(i,e,t){let n=new eh(t);return Promise.resolve(n)}function Ew(i){for(let e=i.length-1;e>=0;e--)if(i[e]!==void 0)return i[e]}var WF=(()=>{class i{constructor(){this.zone=ee(At),this.changeDetectionScheduler=ee(Va),this.applicationRef=ee(Bs)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function $F({ngZoneFactory:i,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return i??=()=>new At(tt(ie({},qT()),{scheduleInRootZone:t})),[{provide:At,useFactory:i},{provide:Rs,multi:!0,useFactory:()=>{let n=ee(WF,{optional:!0});return()=>n.initialize()}},{provide:Rs,multi:!0,useFactory:()=>{let n=ee(qF);return()=>{n.initialize()}}},e===!0?{provide:RT,useValue:!0}:[],{provide:NT,useValue:t??VE}]}function qT(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var qF=(()=>{class i{constructor(){this.subscription=new jt,this.initialized=!1,this.zone=ee(At),this.pendingTasks=ee(wo)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{At.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{At.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var XF=(()=>{class i{constructor(){this.appRef=ee(Bs),this.taskService=ee(wo),this.ngZone=ee(At),this.zonelessEnabled=ee(l_),this.disableScheduling=ee(RT,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new jt,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get($f):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ee(NT,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof qf||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let n=this.useMicrotaskScheduler?iw:zE;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>n(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>n(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get($f+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(n){throw this.taskService.remove(t),n}finally{this.cleanup()}this.useMicrotaskScheduler=!0,iw(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function YF(){return typeof $localize<"u"&&$localize.locale||nh}var m_=new Ue("",{providedIn:"root",factory:()=>ee(m_,ct.Optional|ct.SkipSelf)||YF()});var ih=new Ue("");function Cf(i){return!i.moduleRef}function ZF(i){let e=Cf(i)?i.r3Injector:i.moduleRef.injector,t=e.get(At);return t.run(()=>{Cf(i)?i.r3Injector.resolveInjectorInitializers():i.moduleRef.resolveInjectorInitializers();let n=e.get(Yi,null),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{n.handleError(s)}})}),Cf(i)){let s=()=>e.destroy(),o=i.platformInjector.get(ih);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else{let s=()=>i.moduleRef.destroy(),o=i.platformInjector.get(ih);o.add(s),i.moduleRef.onDestroy(()=>{Pf(i.allPlatformModules,i.moduleRef),r.unsubscribe(),o.delete(s)})}return zF(n,t,()=>{let s=e.get(WT);return s.runInitializers(),s.donePromise.then(()=>{let o=e.get(m_,nh);if(wF(o||nh),Cf(i)){let a=e.get(Bs);return i.rootComponent!==void 0&&a.bootstrap(i.rootComponent),a}else return KF(i.moduleRef,i.allPlatformModules),i.moduleRef})})})}function KF(i,e){let t=i.injector.get(Bs);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(n=>t.bootstrap(n));else if(i.instance.ngDoBootstrap)i.instance.ngDoBootstrap(t);else throw new Le(-403,!1);e.push(i)}var XT=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){let r=n?.scheduleInRootZone,s=()=>vP(n?.ngZone,tt(ie({},qT({eventCoalescing:n?.ngZoneEventCoalescing,runCoalescing:n?.ngZoneRunCoalescing})),{scheduleInRootZone:r})),o=n?.ignoreChangesOutsideZone,a=[$F({ngZoneFactory:s,ignoreChangesOutsideZone:o}),{provide:Va,useExisting:XF}],c=qL(t.moduleType,this.injector,a);return ZF({moduleRef:c,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,n=[]){let r=$T({},n);return jF(this.injector,r,t).then(s=>this.bootstrapModuleFactory(s,r))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Le(404,!1);this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n());let t=this._injector.get(ih,null);t&&(t.forEach(n=>n()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(n){return new(n||i)(qe(un))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"platform"})}}return i})(),Cl=null,YT=new Ue("");function JF(i){if(Cl&&!Cl.get(YT,!1))throw new Le(400,!1);UF(),Cl=i;let e=i.get(XT);return t2(i),e}function g_(i,e,t=[]){let n=`Platform: ${e}`,r=new Ue(n);return(s=[])=>{let o=ZT();if(!o||o.injector.get(YT,!1)){let a=[...t,...s,{provide:r,useValue:!0}];i?i(a):JF(QF(a,n))}return e2(r)}}function QF(i=[],e){return un.create({name:e,providers:[{provide:ch,useValue:"platform"},{provide:ih,useValue:new Set([()=>Cl=null])},...i]})}function e2(i){let e=ZT();if(!e)throw new Le(401,!1);return e}function ZT(){return Cl?.get(XT)??null}function t2(i){i.get(Zy,null)?.forEach(t=>t())}var Vs=(()=>{class i{static{this.__NG_ELEMENT_ID__=n2}}return i})();function n2(i){return i2(Ai(),Bt(),(i&16)===16)}function i2(i,e,t){if(Bl(i)&&!t){let n=gr(i.index,e);return new _o(n,n)}else if(i.type&175){let n=e[qi];return new _o(n,e)}return null}var So=class{constructor(e){this.nativeNode=e}get parent(){let e=this.nativeNode.parentNode;return e?new Wa(e):null}get injector(){return LP(this.nativeNode)}get componentInstance(){let e=this.nativeNode;return e&&(lw(e)||OP(e))}get context(){return lw(this.nativeNode)||PP(this.nativeNode)}get listeners(){return UP(this.nativeNode).filter(e=>e.type==="dom")}get references(){return kP(this.nativeNode)}get providerTokens(){return FP(this.nativeNode)}},Wa=class extends So{constructor(e){super(e)}get nativeElement(){return this.nativeNode.nodeType==Node.ELEMENT_NODE?this.nativeNode:null}get name(){let e=$i(this.nativeNode),t=e?e.lView:null;return t!==null?t[Oe].data[e.nodeIndex].value:this.nativeNode.nodeName}get properties(){let e=$i(this.nativeNode),t=e?e.lView:null;if(t===null)return{};let n=t[Oe].data,r=n[e.nodeIndex],s={};return r2(this.nativeElement,s),o2(s,r,t,n),s}get attributes(){let e={},t=this.nativeElement;if(!t)return e;let n=$i(t),r=n?n.lView:null;if(r===null)return{};let s=r[Oe].data[n.nodeIndex].attrs,o=[];if(s){let a=0;for(;a<s.length;){let c=s[a];if(typeof c!="string")break;let l=s[a+1];e[c]=l,o.push(c.toLowerCase()),a+=2}}for(let a of t.attributes)o.includes(a.name)||(e[a.name]=a.value);return e}get styles(){return this.nativeElement?.style??{}}get classes(){let e={},n=this.nativeElement.className;return(typeof n!="string"?n.baseVal.split(" "):n.split(" ")).forEach(s=>e[s]=!0),e}get childNodes(){let e=this.nativeNode.childNodes,t=[];for(let n=0;n<e.length;n++){let r=e[n];t.push(rh(r))}return t}get children(){let e=this.nativeElement;if(!e)return[];let t=e.children,n=[];for(let r=0;r<t.length;r++){let s=t[r];n.push(rh(s))}return n}query(e){return this.queryAll(e)[0]||null}queryAll(e){let t=[];return Tw(this,e,t,!0),t}queryAllNodes(e){let t=[];return Tw(this,e,t,!1),t}triggerEventHandler(e,t){let n=this.nativeNode,r=[];this.listeners.forEach(s=>{if(s.name===e){let o=s.callback;o.call(n,t),r.push(o)}}),typeof n.eventListeners=="function"&&n.eventListeners(e).forEach(s=>{if(s.toString().indexOf("__ngUnwrap__")!==-1){let o=s("__ngUnwrap__");return r.indexOf(o)===-1&&o.call(n,t)}})}};function r2(i,e){if(i){let t=Object.getPrototypeOf(i),n=Node.prototype;for(;t!==null&&t!==n;){let r=Object.getOwnPropertyDescriptors(t);for(let s in r)if(!s.startsWith("__")&&!s.startsWith("on")){let o=i[s];s2(o)&&(e[s]=o)}t=Object.getPrototypeOf(t)}}}function s2(i){return typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i===null}function Tw(i,e,t,n){let r=$i(i.nativeNode),s=r?r.lView:null;if(s!==null){let o=s[Oe].data[r.nodeIndex];po(o,s,e,t,n,i.nativeNode)}else v_(i.nativeNode,e,t,n)}function po(i,e,t,n,r,s){let o=AN(i,e);if(i.type&11){if(Dv(o,t,n,r,s),Bl(i)){let c=gr(i.index,e);c&&c[Oe].firstChild&&po(c[Oe].firstChild,c,t,n,r,s)}else i.child&&po(i.child,e,t,n,r,s),o&&v_(o,t,n,r);let a=e[i.index];vr(a)&&Cw(a,t,n,r,s)}else if(i.type&4){let a=e[i.index];Dv(a[Os],t,n,r,s),Cw(a,t,n,r,s)}else if(i.type&16){let a=e[qi],l=a[Ci].projection[i.projection];if(Array.isArray(l))for(let u of l)Dv(u,t,n,r,s);else if(l){let u=a[wn],d=u[Oe].data[l.index];po(d,u,t,n,r,s)}}else i.child&&po(i.child,e,t,n,r,s);if(s!==o){let a=i.flags&2?i.projectionNext:i.next;a&&po(a,e,t,n,r,s)}}function Cw(i,e,t,n,r){for(let s=$n;s<i.length;s++){let o=i[s],a=o[Oe].firstChild;a&&po(a,o,e,t,n,r)}}function Dv(i,e,t,n,r){if(r!==i){let s=rh(i);if(!s)return;(n&&s instanceof Wa&&e(s)&&t.indexOf(s)===-1||!n&&e(s)&&t.indexOf(s)===-1)&&t.push(s)}}function v_(i,e,t,n){let r=i.childNodes,s=r.length;for(let o=0;o<s;o++){let a=r[o],c=rh(a);c&&((n&&c instanceof Wa&&e(c)&&t.indexOf(c)===-1||!n&&e(c)&&t.indexOf(c)===-1)&&t.push(c),v_(a,e,t,n))}}function o2(i,e,t,n){let r=e.propertyBindings;if(r!==null)for(let s=0;s<r.length;s++){let o=r[s],c=n[o].split(XP),l=c[0];if(c.length>1){let u=c[1];for(let d=1;d<c.length-1;d++)u+=Ay(t[o+d-1])+c[d+1];i[l]=u}else i[l]=t[o]}}var Iv="__ng_debug__";function rh(i){return i instanceof Node?(i.hasOwnProperty(Iv)||(i[Iv]=i.nodeType==Node.ELEMENT_NODE?new Wa(i):new So(i)),i[Iv]):null}var KT=g_(null,"core",[]),JT=(()=>{class i{constructor(t){}static{this.\u0275fac=function(n){return new(n||i)(qe(Bs))}}static{this.\u0275mod=Ki({type:i})}static{this.\u0275inj=Zi({})}}return i})();function zs(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function xr(i,e){Za("NgSignals");let t=Qg(i);return e?.equal&&(t[bi].equal=e.equal),t}function dn(i){let e=gt(null);try{return i()}finally{gt(e)}}var a2=new Ue("",{providedIn:"root",factory:()=>ee(c2)}),c2=(()=>{class i{static{this.\u0275prov=ke({token:i,providedIn:"root",factory:()=>new Ey})}}return i})(),Ey=class{constructor(){this.queuedEffectCount=0,this.queues=new Map,this.pendingTasks=ee(wo),this.taskId=null}scheduleEffect(e){if(this.enqueue(e),this.taskId===null){let t=this.taskId=this.pendingTasks.add();queueMicrotask(()=>{this.flush(),this.pendingTasks.remove(t),this.taskId=null})}}enqueue(e){let t=e.creationZone;this.queues.has(t)||this.queues.set(t,new Set);let n=this.queues.get(t);n.has(e)||(this.queuedEffectCount++,n.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}},Ty=class{constructor(e,t,n,r,s,o){this.scheduler=e,this.effectFn=t,this.creationZone=n,this.injector=s,this.watcher=lb(a=>this.runEffect(a),()=>this.schedule(),o),this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}runEffect(e){try{this.effectFn(e)}catch(t){this.injector.get(Yi,null,{optional:!0})?.handleError(t)}}run(){this.watcher.run()}schedule(){this.scheduler.scheduleEffect(this)}destroy(){this.watcher.destroy(),this.unregisterOnDestroy?.()}};function Wr(i,e){Za("NgSignals"),!e?.injector&&$a(Wr);let t=e?.injector??ee(un),n=e?.manualCleanup!==!0?t.get(Yn):null,r=new Ty(t.get(a2),i,typeof Zone>"u"?null:Zone.current,n,t,e?.allowSignalWrites??!1),s=t.get(Vs,null,{optional:!0});return!s||!(s._lView[Ye]&8)?r.watcher.notify():(s._lView[Df]??=[]).push(r.watcher.notify),r}function QT(i){let e=Ps(i);if(!e)return null;let t=new Ha(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var iC=null;function To(){return iC}function rC(i){iC??=i}var Eh=class{};var fn=new Ue(""),M_=(()=>{class i{historyGo(t){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>ee(f2),providedIn:"platform"})}}return i})(),sC=new Ue(""),f2=(()=>{class i extends M_{constructor(){super(),this._doc=ee(fn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return To().getBaseHref(this._doc)}onPopState(t){let n=To().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){let n=To().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){this._history.pushState(t,n,r)}replaceState(t,n,r){this._history.replaceState(t,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>new i,providedIn:"platform"})}}return i})();function S_(i,e){if(i.length==0)return e;if(e.length==0)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?i+e.substring(1):t==1?i+e:i+"/"+e}function eC(i){let e=i.match(/#|\?|$/),t=e&&e.index||i.length,n=t-(i[t-1]==="/"?1:0);return i.slice(0,n)+i.slice(t)}function $r(i){return i&&i[0]!=="?"?"?"+i:i}var Co=(()=>{class i{historyGo(t){throw new Error("")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>ee(b_),providedIn:"root"})}}return i})(),oC=new Ue(""),b_=(()=>{class i extends Co{constructor(t,n){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??ee(fn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return S_(this._baseHref,t)}path(t=!1){let n=this._platformLocation.pathname+$r(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+$r(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+$r(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(n){return new(n||i)(qe(M_),qe(oC,8))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),aC=(()=>{class i extends Co{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],n!=null&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(t){let n=S_(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+$r(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+$r(s));o.length==0&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(n){return new(n||i)(qe(M_),qe(oC,8))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),ec=(()=>{class i{constructor(t){this._subject=new tn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let n=this._locationStrategy.getBaseHref();this._basePath=m2(eC(tC(n))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+$r(n))}normalize(t){return i.stripTrailingSlash(p2(this._basePath,tC(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$r(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+$r(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}static{this.normalizeQueryParams=$r}static{this.joinWithSlash=S_}static{this.stripTrailingSlash=eC}static{this.\u0275fac=function(n){return new(n||i)(qe(Co))}}static{this.\u0275prov=ke({token:i,factory:()=>h2(),providedIn:"root"})}}return i})();function h2(){return new ec(qe(Co))}function p2(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function tC(i){return i.replace(/\/index.html$/,"")}function m2(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}function cC(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,s]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var lC=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=Ki({type:i})}static{this.\u0275inj=Zi({})}}return i})(),w_="browser",g2="server";function v2(i){return i===w_}function E_(i){return i===g2}var uC=(()=>{class i{static{this.\u0275prov=ke({token:i,providedIn:"root",factory:()=>v2(ee(ks))?new y_(ee(fn),window):new __})}}return i})(),y_=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=y2(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}};function y2(i,e){let t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if(typeof i.createTreeWalker=="function"&&i.body&&typeof i.body.attachShadow=="function"){let n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT),r=n.currentNode;for(;r;){let s=r.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}var __=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Th=class{};var A_=class extends Eh{constructor(){super(...arguments),this.supportsDOMEvents=!0}},D_=class i extends A_{static makeCurrent(){rC(new i)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=_2();return t==null?null:x2(t)}resetBaseElement(){Xl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cC(document.cookie,e)}},Xl=null;function _2(){return Xl=Xl||document.querySelector("base"),Xl?Xl.getAttribute("href"):null}function x2(i){return new URL(i,document.baseURI).pathname}var I_=class{addToWindow(e){Gr.getAngularTestability=(n,r=!0)=>{let s=e.findTestabilityInTree(n,r);if(s==null)throw new Le(5103,!1);return s},Gr.getAllAngularTestabilities=()=>e.getAllTestabilities(),Gr.getAllAngularRootElements=()=>e.getAllRootElements();let t=n=>{let r=Gr.getAllAngularTestabilities(),s=r.length,o=function(){s--,s==0&&n()};r.forEach(a=>{a.whenStable(o)})};Gr.frameworkStabilizers||(Gr.frameworkStabilizers=[]),Gr.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,n){if(t==null)return null;let r=e.getTestability(t);return r??(n?To().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},M2=(()=>{class i{build(){return new XMLHttpRequest}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),R_=new Ue(""),pC=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(s=>s.supports(t)),!n)throw new Le(5101,!1);return this._eventNameToPlugin.set(t,n),n}static{this.\u0275fac=function(n){return new(n||i)(qe(R_),qe(At))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),Ch=class{constructor(e){this._doc=e}},T_="ng-app-id",mC=(()=>{class i{constructor(t,n,r,s={}){this.doc=t,this.appId=n,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=E_(s),this.resetHostNodes()}addStyles(t){for(let n of t)this.changeUsageCount(n,1)===1&&this.onStyleAdded(n)}removeStyles(t){for(let n of t)this.changeUsageCount(n,-1)<=0&&this.onStyleRemoved(n)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(n=>n.remove()),t.clear());for(let n of this.getAllStyles())this.onStyleRemoved(n);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let n of this.getAllStyles())this.addStyleToHost(t,n)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let n of this.hostNodes)this.addStyleToHost(n,t)}onStyleRemoved(t){let n=this.styleRef;n.get(t)?.elements?.forEach(r=>r.remove()),n.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${T_}="${this.appId}"]`);if(t?.length){let n=new Map;return t.forEach(r=>{r.textContent!=null&&n.set(r.textContent,r)}),n}return null}changeUsageCount(t,n){let r=this.styleRef;if(r.has(t)){let s=r.get(t);return s.usage+=n,s.usage}return r.set(t,{usage:n,elements:[]}),n}getStyleElement(t,n){let r=this.styleNodesInDOM,s=r?.get(n);if(s?.parentNode===t)return r.delete(n),s.removeAttribute(T_),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=n,this.platformIsServer&&o.setAttribute(T_,this.appId),t.appendChild(o),o}}addStyleToHost(t,n){let r=this.getStyleElement(t,n),s=this.styleRef,o=s.get(n)?.elements;o?o.push(r):s.set(n,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(n){return new(n||i)(qe(fn),qe(fh),qe(Ky,8),qe(ks))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),C_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},P_=/%COMP%/g,gC="%COMP%",S2=`_nghost-${gC}`,b2=`_ngcontent-${gC}`,w2=!0,E2=new Ue("",{providedIn:"root",factory:()=>w2});function T2(i){return b2.replace(P_,i)}function C2(i){return S2.replace(P_,i)}function vC(i,e){return e.map(t=>t.replace(P_,i))}var dC=(()=>{class i{constructor(t,n,r,s,o,a,c,l=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=E_(a),this.defaultRenderer=new Yl(t,o,c,this.platformIsServer)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===mr.ShadowDom&&(n=tt(ie({},n),{encapsulation:mr.Emulated}));let r=this.getOrCreateRenderer(t,n);return r instanceof Ah?r.applyToHost(t):r instanceof Zl&&r.applyStyles(),r}getOrCreateRenderer(t,n){let r=this.rendererByCompId,s=r.get(n.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(n.encapsulation){case mr.Emulated:s=new Ah(c,l,n,this.appId,u,o,a,d);break;case mr.ShadowDom:return new N_(c,l,t,n,o,a,this.nonce,d);default:s=new Zl(c,l,n,u,o,a,d);break}r.set(n.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(n){return new(n||i)(qe(pC),qe(mC),qe(fh),qe(E2),qe(fn),qe(ks),qe(At),qe(Ky))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),Yl=class{constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(C_[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(fC(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(fC(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new Le(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let s=C_[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=C_[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(zr.DashCase|zr.Important)?e.style.setProperty(t,n,r&zr.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&zr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=To().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function fC(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var N_=class extends Yl{constructor(e,t,n,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=vC(r.id,r.styles);for(let u of l){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Zl=class extends Yl{constructor(e,t,n,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?vC(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ah=class extends Zl{constructor(e,t,n,r,s,o,a,c){let l=r+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=T2(l),this.hostAttr=C2(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},A2=(()=>{class i extends Ch{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}static{this.\u0275fac=function(n){return new(n||i)(qe(fn))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),hC=["alt","control","meta","shift"],D2={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},I2={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},R2=(()=>{class i extends Ch{constructor(t){super(t)}supports(t){return i.parseEventName(t)!=null}addEventListener(t,n,r){let s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>To().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let n=t.toLowerCase().split("."),r=n.shift();if(n.length===0||!(r==="keydown"||r==="keyup"))return null;let s=i._normalizeKey(n.pop()),o="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),o="code."),hC.forEach(l=>{let u=n.indexOf(l);u>-1&&(n.splice(u,1),o+=l+".")}),o+=s,n.length!=0||s.length===0)return null;let c={};return c.domEventName=r,c.fullKey=o,c}static matchEventFullKeyCode(t,n){let r=D2[t.key]||t.key,s="";return n.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),hC.forEach(o=>{if(o!==r){let a=I2[o];a(t)&&(s+=o+".")}}),s+=r,s===n)}static eventCallback(t,n,r){return s=>{i.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(n){return new(n||i)(qe(fn))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})();function N2(){D_.makeCurrent()}function P2(){return new Yi}function O2(){return ZE(document),document}var L2=[{provide:ks,useValue:w_},{provide:Zy,useValue:N2,multi:!0},{provide:fn,useFactory:O2,deps:[]}],yC=g_(KT,"browser",L2),F2=new Ue(""),k2=[{provide:$l,useClass:I_,deps:[]},{provide:f_,useClass:Mh,deps:[At,Sh,$l]},{provide:Mh,useClass:Mh,deps:[At,Sh,$l]}],U2=[{provide:ch,useValue:"root"},{provide:Yi,useFactory:P2,deps:[]},{provide:R_,useClass:A2,multi:!0,deps:[fn,At,ks]},{provide:R_,useClass:R2,multi:!0,deps:[fn]},dC,mC,pC,{provide:Hr,useExisting:dC},{provide:Th,useClass:M2,deps:[]},[]],_C=(()=>{class i{constructor(t){}static withServerTransition(t){return{ngModule:i,providers:[{provide:fh,useValue:t.appId}]}}static{this.\u0275fac=function(n){return new(n||i)(qe(F2,12))}}static{this.\u0275mod=Ki({type:i})}static{this.\u0275inj=Zi({providers:[...U2,...k2],imports:[lC,JT]})}}return i})();var xC=(()=>{class i{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(n){return new(n||i)(qe(fn))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function tc(i){i||($a(tc),i=ee(Yn));let e=new vt(t=>i.onDestroy(t.next.bind(t)));return t=>t.pipe(Ts(e))}var O_=class{constructor(e){this.source=e,this.destroyed=!1,this.destroyRef=ee(Yn),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}subscribe(e){if(this.destroyed)throw new Le(953,!1);let t=this.source.pipe(tc(this.destroyRef)).subscribe({next:n=>e(n)});return{unsubscribe:()=>t.unsubscribe()}}};function SC(i,e){return new O_(i)}function nc(i,e,t){!e&&$a(i);let n=e??ee(un);return t?Xn(n,t):n}function bC(i){return function(n={}){var r=n,{injector:e}=r,t=ml(r,["injector"]);return e=nc(this,e),Xn(e,()=>ee(i,t))}}function wC(i,e,t={}){let{deps:n=[],multi:r=!1,extraProviders:s=[],isFunctionValue:o=!1}=t;return(a,c=o)=>{let l;return typeof a<"u"?l={provide:i,useFactory:typeof a=="function"?c?()=>a:a:()=>a,multi:r}:l={provide:i,useFactory:e,deps:n,multi:r},[s,l]}}function Kl(i,e){let t=i.name||i.toString(),n=e??{isRoot:!0};if(n.isRoot??=!0,n.multi&&(n.isRoot=!1),n.isRoot){if(n.token)throw new Error(`createInjectionToken is creating a root InjectionToken but an external token is passed in.
`);let s=new Ue(`Token for ${t}`,{factory:()=>n.deps&&Array.isArray(n.deps)?i(...n.deps.map(a=>(a=Array.isArray(a)?a.at(-1):a,ee(a)))):i()}),o=bC(s);return[o,wC(s,i,n),s,()=>({provide:Rs,useValue:()=>o(),multi:!0})]}let r=n.token||new Ue(`Token for ${t}`);return[bC(r),wC(r,i,n),r,()=>[]]}var B2={box:"content-box",scroll:!1,offsetSize:!1,debounce:{scroll:50,resize:0},emitInZone:!0,emitInitialResult:!1},[V2,TC,AX]=Kl(()=>B2);var CC=(()=>{class i{constructor(){this.ngxResizeOptions={},this.ngxResize=new tn,this.host=ee(di),this.zone=ee(At),this.document=ee(fn),this.resizeOptions=V2(),this.destroyRef=ee(Yn)}ngOnInit(){let t=ie(ie({},this.resizeOptions),this.ngxResizeOptions);z2(t,this.host.nativeElement,this.document,this.zone).pipe(tc(this.destroyRef)).subscribe(this.ngxResize)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=bo({type:i,selectors:[["","ngxResize",""]],inputs:{ngxResizeOptions:"ngxResizeOptions"},outputs:{ngxResize:"ngxResize"},standalone:!0})}}return i})();function z2({debounce:i,scroll:e,offsetSize:t,box:n,emitInZone:r,emitInitialResult:s},o,a,c){let l=a.defaultView,u=l?.screen,d=!!l?.ResizeObserver,f,h,p=[],v=new uo,g=AC(o,l,a.body),m=i?typeof i=="number"?i:i.scroll:null,_=i?typeof i=="number"?i:i.resize:null,x=y=>xl(Sf(y??0),Ts(v));return new vt(y=>{if(!d){y.error("[ngx-resize] your browser does not support ResizeObserver. Please consider using a polyfill");return}return c.runOutsideAngular(()=>{if(s){let[E]=EC(o,l,t,[]);r?c.run(()=>void y.next(E)):y.next(E)}let D=E=>{p=E;let[C,S]=EC(o,l,t,E);r?c.run(()=>void y.next(C)):y.next(C),G2(h||{},S)||(h=S)},w=()=>void D(p);f=new ResizeObserver(D),f.observe(o,{box:n}),e&&(g&&g.forEach(E=>{kr(E,"scroll",{capture:!0,passive:!0}).pipe(x(m)).subscribe(w)}),kr(l,"scroll",{capture:!0,passive:!0}).pipe(x(m)).subscribe(w)),kr(l,"resize").pipe(x(_)).subscribe(w),u&&"orientation"in u&&"addEventListener"in u.orientation?kr(u.orientation,"change").pipe(x(m)).subscribe(w):l&&"orientationchange"in l&&kr(l,"orientationchange").pipe(x(m)).subscribe(w)}),()=>{f&&(f.unobserve(o),f.disconnect()),v.next(),v.complete()}}).pipe(Sf(m??0),pv({connector:()=>new uo(1)}))}function EC(i,e,t,n){let{left:r,top:s,width:o,height:a,bottom:c,right:l,x:u,y:d}=i.getBoundingClientRect(),f={left:r,top:s,width:o,height:a,bottom:c,right:l,x:u,y:d};return i instanceof HTMLElement&&t&&(f.height=i.offsetHeight,f.width=i.offsetWidth),Object.freeze(f),[ie({entries:n,dpr:e.devicePixelRatio},f),f]}function AC(i,e,t){let n=[];if(!i||!e||i===t)return n;let{overflow:r,overflowX:s,overflowY:o}=e.getComputedStyle(i);return[r,s,o].some(a=>a==="auto"||a==="scroll")&&n.push(i),[...n,...AC(i.parentElement,e,t)]}var H2=["x","y","top","bottom","left","right","width","height"],G2=(i,e)=>H2.every(t=>i[t]===e[t]);var cd={};zR(cd,{ACESFilmicToneMapping:()=>rg,AddEquation:()=>Ys,AddOperation:()=>ID,AdditiveAnimationBlendMode:()=>eM,AdditiveBlending:()=>b0,AgXToneMapping:()=>LD,AlphaFormat:()=>Xx,AlwaysCompare:()=>ZD,AlwaysDepth:()=>wp,AlwaysStencilFunc:()=>C0,AmbientLight:()=>qm,AnimationAction:()=>ng,AnimationClip:()=>hs,AnimationLoader:()=>ix,AnimationMixer:()=>yx,AnimationObjectGroup:()=>vx,AnimationUtils:()=>MH,ArcCurve:()=>mm,ArrayCamera:()=>am,ArrowHelper:()=>Bx,AttachedBindMode:()=>T0,Audio:()=>eg,AudioAnalyser:()=>mx,AudioContext:()=>Qu,AudioListener:()=>hx,AudioLoader:()=>dx,AxesHelper:()=>Vx,BackSide:()=>Bn,BasicDepthPacking:()=>zD,BasicShadowMap:()=>jx,BatchedMesh:()=>fm,Bone:()=>aa,BooleanKeyframeTrack:()=>ds,Box2:()=>Tx,Box3:()=>hn,Box3Helper:()=>kx,BoxGeometry:()=>ia,BoxHelper:()=>Fx,BufferAttribute:()=>xt,BufferGeometry:()=>et,BufferGeometryLoader:()=>Qm,ByteType:()=>Wx,Cache:()=>ns,Camera:()=>Ic,CameraHelper:()=>Lx,CanvasTexture:()=>J0,CapsuleGeometry:()=>Mm,CatmullRomCurve3:()=>gm,CineonToneMapping:()=>PD,CircleGeometry:()=>Sm,ClampToEdgeWrapping:()=>ei,Clock:()=>Hc,Color:()=>de,ColorKeyframeTrack:()=>Yu,ColorManagement:()=>it,CompressedArrayTexture:()=>Z0,CompressedCubeTexture:()=>K0,CompressedTexture:()=>kc,CompressedTextureLoader:()=>rx,ConeGeometry:()=>bm,ConstantAlphaFactor:()=>CD,ConstantColorFactor:()=>ED,Controls:()=>Hx,CubeCamera:()=>sm,CubeReflectionMapping:()=>os,CubeRefractionMapping:()=>Ks,CubeTexture:()=>ra,CubeTextureLoader:()=>sx,CubeUVReflectionMapping:()=>Wc,CubicBezierCurve:()=>ku,CubicBezierCurve3:()=>vm,CubicInterpolant:()=>Gm,CullFaceBack:()=>S0,CullFaceFront:()=>uD,CullFaceFrontBack:()=>j2,CullFaceNone:()=>lD,Curve:()=>yi,CurvePath:()=>xm,CustomBlending:()=>dD,CustomToneMapping:()=>OD,CylinderGeometry:()=>Js,Cylindrical:()=>wx,Data3DTexture:()=>Au,DataArrayTexture:()=>Ac,DataTexture:()=>Fi,DataTextureLoader:()=>ox,DataUtils:()=>Jk,DecrementStencilOp:()=>tk,DecrementWrapStencilOp:()=>ik,DefaultLoadingManager:()=>pI,DepthFormat:()=>Yo,DepthStencilFormat:()=>ea,DepthTexture:()=>Nu,DetachedBindMode:()=>kD,DirectionalLight:()=>zc,DirectionalLightHelper:()=>Ox,DiscreteInterpolant:()=>jm,DodecahedronGeometry:()=>wm,DoubleSide:()=>Qn,DstAlphaFactor:()=>xD,DstColorFactor:()=>SD,DynamicCopyUsage:()=>yk,DynamicDrawUsage:()=>fk,DynamicReadUsage:()=>mk,EdgesGeometry:()=>Em,EllipseCurve:()=>Uc,EqualCompare:()=>$D,EqualDepth:()=>Tp,EqualStencilFunc:()=>ak,EquirectangularReflectionMapping:()=>Su,EquirectangularRefractionMapping:()=>bu,Euler:()=>Er,EventDispatcher:()=>ni,ExtrudeGeometry:()=>Tm,FileLoader:()=>si,Float16BufferAttribute:()=>F0,Float32BufferAttribute:()=>Ce,FloatType:()=>ti,Fog:()=>lm,FogExp2:()=>cm,FramebufferTexture:()=>Y0,FrontSide:()=>or,Frustum:()=>sa,GLBufferAttribute:()=>Sx,GLSL1:()=>xk,GLSL3:()=>A0,GreaterCompare:()=>qD,GreaterDepth:()=>Ap,GreaterEqualCompare:()=>YD,GreaterEqualDepth:()=>Cp,GreaterEqualStencilFunc:()=>dk,GreaterStencilFunc:()=>lk,GridHelper:()=>Nx,Group:()=>Li,HalfFloatType:()=>$c,HemisphereLight:()=>$m,HemisphereLightHelper:()=>Rx,IcosahedronGeometry:()=>Cm,ImageBitmapLoader:()=>Ju,ImageLoader:()=>da,ImageUtils:()=>im,IncrementStencilOp:()=>ek,IncrementWrapStencilOp:()=>nk,InstancedBufferAttribute:()=>ar,InstancedBufferGeometry:()=>Jm,InstancedInterleavedBuffer:()=>Mx,InstancedMesh:()=>Oc,Int16BufferAttribute:()=>O0,Int32BufferAttribute:()=>L0,Int8BufferAttribute:()=>R0,IntType:()=>sg,InterleavedBuffer:()=>ls,InterleavedBufferAttribute:()=>Cr,Interpolant:()=>us,InterpolateDiscrete:()=>ta,InterpolateLinear:()=>na,InterpolateSmooth:()=>xp,InvertStencilOp:()=>rk,KeepStencilOp:()=>zo,KeyframeTrack:()=>_i,LOD:()=>dm,LatheGeometry:()=>Hu,Layers:()=>Tr,LessCompare:()=>WD,LessDepth:()=>Ep,LessEqualCompare:()=>nM,LessEqualDepth:()=>Ko,LessEqualStencilFunc:()=>ck,LessStencilFunc:()=>ok,Light:()=>Nr,LightProbe:()=>Zm,Line:()=>Ui,Line3:()=>Cx,LineBasicMaterial:()=>gn,LineCurve:()=>Uu,LineCurve3:()=>ym,LineDashedMaterial:()=>Hm,LineLoop:()=>Lc,LineSegments:()=>ri,LinearFilter:()=>Ht,LinearInterpolant:()=>Xu,LinearMipMapLinearFilter:()=>X2,LinearMipMapNearestFilter:()=>q2,LinearMipmapLinearFilter:()=>pi,LinearMipmapNearestFilter:()=>Xo,LinearSRGBColorSpace:()=>Tn,LinearToneMapping:()=>RD,LinearTransfer:()=>od,Loader:()=>zn,LoaderUtils:()=>cr,LoadingManager:()=>Zu,LoopOnce:()=>UD,LoopPingPong:()=>VD,LoopRepeat:()=>BD,LuminanceAlphaFormat:()=>Kx,LuminanceFormat:()=>Zx,MOUSE:()=>eo,Material:()=>Zt,MaterialLoader:()=>Km,MathUtils:()=>ad,Matrix2:()=>Ex,Matrix3:()=>nt,Matrix4:()=>Ve,MaxEquation:()=>mD,Mesh:()=>Ft,MeshBasicMaterial:()=>In,MeshDepthMaterial:()=>Pu,MeshDistanceMaterial:()=>Ou,MeshLambertMaterial:()=>Vm,MeshMatcapMaterial:()=>zm,MeshNormalMaterial:()=>Bm,MeshPhongMaterial:()=>km,MeshPhysicalMaterial:()=>Vn,MeshStandardMaterial:()=>Ar,MeshToonMaterial:()=>Um,MinEquation:()=>pD,MirroredRepeatWrapping:()=>Jo,MixOperation:()=>DD,MultiplyBlending:()=>E0,MultiplyOperation:()=>nd,NearestFilter:()=>on,NearestMipMapLinearFilter:()=>$2,NearestMipMapNearestFilter:()=>W2,NearestMipmapLinearFilter:()=>Zs,NearestMipmapNearestFilter:()=>id,NeutralToneMapping:()=>FD,NeverCompare:()=>jD,NeverDepth:()=>bp,NeverStencilFunc:()=>sk,NoBlending:()=>is,NoColorSpace:()=>Qr,NoToneMapping:()=>sr,NormalAnimationBlendMode:()=>dg,NormalBlending:()=>qo,NotEqualCompare:()=>XD,NotEqualDepth:()=>Dp,NotEqualStencilFunc:()=>uk,NumberKeyframeTrack:()=>Dr,Object3D:()=>Rt,ObjectLoader:()=>ux,ObjectSpaceNormalMap:()=>GD,OctahedronGeometry:()=>$u,OneFactor:()=>vD,OneMinusConstantAlphaFactor:()=>AD,OneMinusConstantColorFactor:()=>TD,OneMinusDstAlphaFactor:()=>MD,OneMinusDstColorFactor:()=>bD,OneMinusSrcAlphaFactor:()=>Sp,OneMinusSrcColorFactor:()=>_D,OrthographicCamera:()=>ii,PCFShadowMap:()=>td,PCFSoftShadowMap:()=>jc,PMREMGenerator:()=>Ru,Path:()=>la,PerspectiveCamera:()=>Ot,Plane:()=>Oi,PlaneGeometry:()=>Rc,PlaneHelper:()=>Ux,PointLight:()=>Vc,PointLightHelper:()=>Ix,Points:()=>Fc,PointsMaterial:()=>ca,PolarGridHelper:()=>Px,PolyhedronGeometry:()=>Qs,PositionalAudio:()=>px,PropertyBinding:()=>Nt,PropertyMixer:()=>tg,QuadraticBezierCurve:()=>Bu,QuadraticBezierCurve3:()=>Vu,Quaternion:()=>Yt,QuaternionKeyframeTrack:()=>Ir,QuaternionLinearInterpolant:()=>Wm,RED_GREEN_RGTC2_Format:()=>tm,RED_RGTC1_Format:()=>Qx,REVISION:()=>ig,RGBADepthPacking:()=>HD,RGBAFormat:()=>En,RGBAIntegerFormat:()=>ug,RGBA_ASTC_10x10_Format:()=>Yp,RGBA_ASTC_10x5_Format:()=>$p,RGBA_ASTC_10x6_Format:()=>qp,RGBA_ASTC_10x8_Format:()=>Xp,RGBA_ASTC_12x10_Format:()=>Zp,RGBA_ASTC_12x12_Format:()=>Kp,RGBA_ASTC_4x4_Format:()=>Up,RGBA_ASTC_5x4_Format:()=>Bp,RGBA_ASTC_5x5_Format:()=>Vp,RGBA_ASTC_6x5_Format:()=>zp,RGBA_ASTC_6x6_Format:()=>Hp,RGBA_ASTC_8x5_Format:()=>Gp,RGBA_ASTC_8x6_Format:()=>jp,RGBA_ASTC_8x8_Format:()=>Wp,RGBA_BPTC_Format:()=>vu,RGBA_ETC2_EAC_Format:()=>kp,RGBA_PVRTC_2BPPV1_Format:()=>Op,RGBA_PVRTC_4BPPV1_Format:()=>Pp,RGBA_S3TC_DXT1_Format:()=>pu,RGBA_S3TC_DXT3_Format:()=>mu,RGBA_S3TC_DXT5_Format:()=>gu,RGBDepthPacking:()=>Z2,RGBFormat:()=>Yx,RGBIntegerFormat:()=>Y2,RGB_BPTC_SIGNED_Format:()=>Jp,RGB_BPTC_UNSIGNED_Format:()=>Qp,RGB_ETC1_Format:()=>Lp,RGB_ETC2_Format:()=>Fp,RGB_PVRTC_2BPPV1_Format:()=>Np,RGB_PVRTC_4BPPV1_Format:()=>Rp,RGB_S3TC_DXT1_Format:()=>hu,RGDepthPacking:()=>K2,RGFormat:()=>Jx,RGIntegerFormat:()=>lg,RawShaderMaterial:()=>Fm,Ray:()=>wr,Raycaster:()=>ed,RectAreaLight:()=>Xm,RedFormat:()=>cg,RedIntegerFormat:()=>rd,ReinhardToneMapping:()=>ND,RenderTarget:()=>rm,RepeatWrapping:()=>as,ReplaceStencilOp:()=>Q2,ReverseSubtractEquation:()=>hD,RingGeometry:()=>Am,SIGNED_RED_GREEN_RGTC2_Format:()=>nm,SIGNED_RED_RGTC1_Format:()=>em,SRGBColorSpace:()=>sn,SRGBTransfer:()=>It,Scene:()=>oa,ShaderChunk:()=>ot,ShaderLib:()=>rr,ShaderMaterial:()=>vi,ShadowMaterial:()=>Lm,Shape:()=>ss,ShapeGeometry:()=>Dm,ShapePath:()=>zx,ShapeUtils:()=>br,ShortType:()=>$x,Skeleton:()=>Pc,SkeletonHelper:()=>Dx,SkinnedMesh:()=>Nc,Source:()=>ts,Sphere:()=>an,SphereGeometry:()=>qu,Spherical:()=>Gc,SphericalHarmonics3:()=>Ym,SplineCurve:()=>zu,SpotLight:()=>Bc,SpotLightHelper:()=>Ax,Sprite:()=>um,SpriteMaterial:()=>Fu,SrcAlphaFactor:()=>Mp,SrcAlphaSaturateFactor:()=>wD,SrcColorFactor:()=>yD,StaticCopyUsage:()=>vk,StaticDrawUsage:()=>Eu,StaticReadUsage:()=>pk,StereoCamera:()=>fx,StreamCopyUsage:()=>_k,StreamDrawUsage:()=>hk,StreamReadUsage:()=>gk,StringKeyframeTrack:()=>fs,SubtractEquation:()=>fD,SubtractiveBlending:()=>w0,TOUCH:()=>to,TangentSpaceNormalMap:()=>no,TetrahedronGeometry:()=>Im,Texture:()=>cn,TextureLoader:()=>fa,TextureUtils:()=>Iz,TorusGeometry:()=>Rm,TorusKnotGeometry:()=>Nm,Triangle:()=>Mr,TriangleFanDrawMode:()=>qc,TriangleStripDrawMode:()=>sd,TrianglesDrawMode:()=>tM,TubeGeometry:()=>Pm,UVMapping:()=>Ip,Uint16BufferAttribute:()=>Du,Uint32BufferAttribute:()=>Iu,Uint8BufferAttribute:()=>N0,Uint8ClampedBufferAttribute:()=>P0,Uniform:()=>_x,UniformsGroup:()=>xx,UniformsLib:()=>me,UniformsUtils:()=>tI,UnsignedByteType:()=>ki,UnsignedInt248Type:()=>Qo,UnsignedInt5999Type:()=>qx,UnsignedIntType:()=>cs,UnsignedShort4444Type:()=>og,UnsignedShort5551Type:()=>ag,UnsignedShortType:()=>Tc,VSMShadowMap:()=>Pi,Vector2:()=>q,Vector3:()=>A,Vector4:()=>_t,VectorKeyframeTrack:()=>Rr,VideoTexture:()=>X0,WebGL3DRenderTarget:()=>I0,WebGLArrayRenderTarget:()=>D0,WebGLCoordinateSystem:()=>Sr,WebGLCubeRenderTarget:()=>om,WebGLMultipleRenderTargets:()=>Gx,WebGLRenderTarget:()=>gi,WebGLRenderer:()=>Lu,WebGLUtils:()=>aI,WebGPUCoordinateSystem:()=>Tu,WireframeGeometry:()=>Om,WrapAroundEnding:()=>wu,ZeroCurvatureEnding:()=>jo,ZeroFactor:()=>gD,ZeroSlopeEnding:()=>Wo,ZeroStencilOp:()=>J2,createCanvasElement:()=>JD});var ig="170",eo={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},to={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},lD=0,S0=1,uD=2,j2=3,jx=0,td=1,jc=2,Pi=3,or=0,Bn=1,Qn=2,is=0,qo=1,b0=2,w0=3,E0=4,dD=5,Ys=100,fD=101,hD=102,pD=103,mD=104,gD=200,vD=201,yD=202,_D=203,Mp=204,Sp=205,xD=206,MD=207,SD=208,bD=209,wD=210,ED=211,TD=212,CD=213,AD=214,bp=0,wp=1,Ep=2,Ko=3,Tp=4,Cp=5,Ap=6,Dp=7,nd=0,DD=1,ID=2,sr=0,RD=1,ND=2,PD=3,rg=4,OD=5,LD=6,FD=7,T0="attached",kD="detached",Ip=300,os=301,Ks=302,Su=303,bu=304,Wc=306,as=1e3,ei=1001,Jo=1002,on=1003,id=1004,W2=1004,Zs=1005,$2=1005,Ht=1006,Xo=1007,q2=1007,pi=1008,X2=1008,ki=1009,Wx=1010,$x=1011,Tc=1012,sg=1013,cs=1014,ti=1015,$c=1016,og=1017,ag=1018,Qo=1020,qx=35902,Xx=1021,Yx=1022,En=1023,Zx=1024,Kx=1025,Yo=1026,ea=1027,cg=1028,rd=1029,Jx=1030,lg=1031,Y2=1032,ug=1033,hu=33776,pu=33777,mu=33778,gu=33779,Rp=35840,Np=35841,Pp=35842,Op=35843,Lp=36196,Fp=37492,kp=37496,Up=37808,Bp=37809,Vp=37810,zp=37811,Hp=37812,Gp=37813,jp=37814,Wp=37815,$p=37816,qp=37817,Xp=37818,Yp=37819,Zp=37820,Kp=37821,vu=36492,Jp=36494,Qp=36495,Qx=36283,em=36284,tm=36285,nm=36286,UD=2200,BD=2201,VD=2202,ta=2300,na=2301,xp=2302,jo=2400,Wo=2401,wu=2402,dg=2500,eM=2501,tM=0,sd=1,qc=2,zD=3200,HD=3201,Z2=3202,K2=3203,no=0,GD=1,Qr="",sn="srgb",Tn="srgb-linear",od="linear",It="srgb",J2=0,zo=7680,Q2=7681,ek=7682,tk=7683,nk=34055,ik=34056,rk=5386,sk=512,ok=513,ak=514,ck=515,lk=516,uk=517,dk=518,C0=519,jD=512,WD=513,$D=514,nM=515,qD=516,XD=517,YD=518,ZD=519,Eu=35044,fk=35048,hk=35040,pk=35045,mk=35049,gk=35041,vk=35046,yk=35050,_k=35042,xk="100",A0="300 es",Sr=2e3,Tu=2001,ni=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let n=this._listeners[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},Cn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],DC=1234567,Zo=Math.PI/180,Cc=180/Math.PI;function mi(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Cn[i&255]+Cn[i>>8&255]+Cn[i>>16&255]+Cn[i>>24&255]+"-"+Cn[e&255]+Cn[e>>8&255]+"-"+Cn[e>>16&15|64]+Cn[e>>24&255]+"-"+Cn[t&63|128]+Cn[t>>8&255]+"-"+Cn[t>>16&255]+Cn[t>>24&255]+Cn[n&255]+Cn[n>>8&255]+Cn[n>>16&255]+Cn[n>>24&255]).toLowerCase()}function Xt(i,e,t){return Math.max(e,Math.min(t,i))}function iM(i,e){return(i%e+e)%e}function Mk(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function Sk(i,e,t){return i!==e?(t-i)/(e-i):0}function yu(i,e,t){return(1-t)*i+t*e}function bk(i,e,t,n){return yu(i,e,1-Math.exp(-t*n))}function wk(i,e=1){return e-Math.abs(iM(i,e*2)-e)}function Ek(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function Tk(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function Ck(i,e){return i+Math.floor(Math.random()*(e-i+1))}function Ak(i,e){return i+Math.random()*(e-i)}function Dk(i){return i*(.5-Math.random())}function Ik(i){i!==void 0&&(DC=i);let e=DC+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Rk(i){return i*Zo}function Nk(i){return i*Cc}function Pk(i){return(i&i-1)===0&&i!==0}function Ok(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Lk(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function Fk(i,e,t,n,r){let s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),l=s((e+n)/2),u=o((e+n)/2),d=s((e-n)/2),f=o((e-n)/2),h=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":i.set(a*u,c*d,c*f,a*l);break;case"YZY":i.set(c*f,a*u,c*d,a*l);break;case"ZXZ":i.set(c*d,c*f,a*u,a*l);break;case"XZX":i.set(a*u,c*p,c*h,a*l);break;case"YXY":i.set(c*h,a*u,c*p,a*l);break;case"ZYZ":i.set(c*p,c*h,a*u,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Un(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function rt(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var ad={DEG2RAD:Zo,RAD2DEG:Cc,generateUUID:mi,clamp:Xt,euclideanModulo:iM,mapLinear:Mk,inverseLerp:Sk,lerp:yu,damp:bk,pingpong:wk,smoothstep:Ek,smootherstep:Tk,randInt:Ck,randFloat:Ak,randFloatSpread:Dk,seededRandom:Ik,degToRad:Rk,radToDeg:Nk,isPowerOfTwo:Pk,ceilPowerOfTwo:Ok,floorPowerOfTwo:Lk,setQuaternionFromProperEuler:Fk,normalize:rt,denormalize:Un},q=class i{constructor(e=0,t=0){i.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Xt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},nt=class i{constructor(e,t,n,r,s,o,a,c,l){i.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,c,l)}set(e,t,n,r,s,o,a,c,l){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=n,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],c=n[6],l=n[1],u=n[4],d=n[7],f=n[2],h=n[5],p=n[8],v=r[0],g=r[3],m=r[6],_=r[1],x=r[4],y=r[7],D=r[2],w=r[5],E=r[8];return s[0]=o*v+a*_+c*D,s[3]=o*g+a*x+c*w,s[6]=o*m+a*y+c*E,s[1]=l*v+u*_+d*D,s[4]=l*g+u*x+d*w,s[7]=l*m+u*y+d*E,s[2]=f*v+h*_+p*D,s[5]=f*g+h*x+p*w,s[8]=f*m+h*y+p*E,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-n*s*u+n*a*c+r*s*l-r*o*c}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=u*o-a*l,f=a*c-u*s,h=l*s-o*c,p=t*d+n*f+r*h;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let v=1/p;return e[0]=d*v,e[1]=(r*l-u*n)*v,e[2]=(a*n-r*o)*v,e[3]=f*v,e[4]=(u*t-r*c)*v,e[5]=(r*s-a*t)*v,e[6]=h*v,e[7]=(n*c-l*t)*v,e[8]=(o*t-n*s)*v,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){let c=Math.cos(s),l=Math.sin(s);return this.set(n*c,n*l,-n*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(L_.makeScale(e,t)),this}rotate(e){return this.premultiply(L_.makeRotation(-e)),this}translate(e,t){return this.premultiply(L_.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}},L_=new nt;function KD(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}var kk={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Mc(i,e){return new kk[i](e)}function Cu(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function JD(){let i=Cu("canvas");return i.style.display="block",i}var IC={};function uu(i){i in IC||(IC[i]=!0,console.warn(i))}function Uk(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}function Bk(i){let e=i.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function Vk(i){let e=i.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}var it={enabled:!0,workingColorSpace:Tn,spaces:{},convert:function(i,e,t){return this.enabled===!1||e===t||!e||!t||(this.spaces[e].transfer===It&&(i.r=rs(i.r),i.g=rs(i.g),i.b=rs(i.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(i.applyMatrix3(this.spaces[e].toXYZ),i.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===It&&(i.r=wc(i.r),i.g=wc(i.g),i.b=wc(i.b))),i},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Qr?od:this.spaces[i].transfer},getLuminanceCoefficients:function(i,e=this.workingColorSpace){return i.fromArray(this.spaces[e].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,e,t){return i.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}};function rs(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function wc(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var RC=[.64,.33,.3,.6,.15,.06],NC=[.2126,.7152,.0722],PC=[.3127,.329],OC=new nt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),LC=new nt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);it.define({[Tn]:{primaries:RC,whitePoint:PC,transfer:od,toXYZ:OC,fromXYZ:LC,luminanceCoefficients:NC,workingColorSpaceConfig:{unpackColorSpace:sn},outputColorSpaceConfig:{drawingBufferColorSpace:sn}},[sn]:{primaries:RC,whitePoint:PC,transfer:It,toXYZ:OC,fromXYZ:LC,luminanceCoefficients:NC,outputColorSpaceConfig:{drawingBufferColorSpace:sn}}});var ic,im=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ic===void 0&&(ic=Cu("canvas")),ic.width=e.width,ic.height=e.height;let n=ic.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ic}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Cu("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=rs(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(rs(t[n]/255)*255):t[n]=rs(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},zk=0,ts=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:zk++}),this.uuid=mi(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(F_(r[o].image)):s.push(F_(r[o]))}else s=F_(r);n.url=s}return t||(e.images[this.uuid]=n),n}};function F_(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?im.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Hk=0,cn=(()=>{class i extends ni{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=ei,s=ei,o=Ht,a=pi,c=En,l=ki,u=i.DEFAULT_ANISOTROPY,d=Qr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Hk++}),this.uuid=mi(),this.name="",this.source=new ts(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new q(0,0),this.repeat=new q(1,1),this.center=new q(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new nt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Ip)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case as:t.x=t.x-Math.floor(t.x);break;case ei:t.x=t.x<0?0:1;break;case Jo:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case as:t.y=t.y-Math.floor(t.y);break;case ei:t.y=t.y<0?0:1;break;case Jo:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=Ip,i.DEFAULT_ANISOTROPY=1,i})(),_t=class i{constructor(e=0,t=0,n=0,r=1){i.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s,c=e.elements,l=c[0],u=c[4],d=c[8],f=c[1],h=c[5],p=c[9],v=c[2],g=c[6],m=c[10];if(Math.abs(u-f)<.01&&Math.abs(d-v)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+f)<.1&&Math.abs(d+v)<.1&&Math.abs(p+g)<.1&&Math.abs(l+h+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let x=(l+1)/2,y=(h+1)/2,D=(m+1)/2,w=(u+f)/4,E=(d+v)/4,C=(p+g)/4;return x>y&&x>D?x<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(x),r=w/n,s=E/n):y>D?y<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(y),n=w/r,s=C/r):D<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(D),n=E/s,r=C/s),this.set(n,r,s,t),this}let _=Math.sqrt((g-p)*(g-p)+(d-v)*(d-v)+(f-u)*(f-u));return Math.abs(_)<.001&&(_=1),this.x=(g-p)/_,this.y=(d-v)/_,this.z=(f-u)/_,this.w=Math.acos((l+h+m-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},rm=class extends ni{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new _t(0,0,e,t),this.scissorTest=!1,this.viewport=new _t(0,0,e,t);let r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ht,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let s=new cn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new ts(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},gi=class extends rm{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},Ac=class extends cn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=on,this.minFilter=on,this.wrapR=ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},D0=class extends gi{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Ac(null,e,t,n),this.texture.isRenderTargetTexture=!0}},Au=class extends cn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=on,this.minFilter=on,this.wrapR=ei,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},I0=class extends gi{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Au(null,e,t,n),this.texture.isRenderTargetTexture=!0}},Yt=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let c=n[r+0],l=n[r+1],u=n[r+2],d=n[r+3],f=s[o+0],h=s[o+1],p=s[o+2],v=s[o+3];if(a===0){e[t+0]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d;return}if(a===1){e[t+0]=f,e[t+1]=h,e[t+2]=p,e[t+3]=v;return}if(d!==v||c!==f||l!==h||u!==p){let g=1-a,m=c*f+l*h+u*p+d*v,_=m>=0?1:-1,x=1-m*m;if(x>Number.EPSILON){let D=Math.sqrt(x),w=Math.atan2(D,m*_);g=Math.sin(g*w)/D,a=Math.sin(a*w)/D}let y=a*_;if(c=c*g+f*y,l=l*g+h*y,u=u*g+p*y,d=d*g+v*y,g===1-a){let D=1/Math.sqrt(c*c+l*l+u*u+d*d);c*=D,l*=D,u*=D,d*=D}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,r,s,o){let a=n[r],c=n[r+1],l=n[r+2],u=n[r+3],d=s[o],f=s[o+1],h=s[o+2],p=s[o+3];return e[t]=a*p+u*d+c*h-l*f,e[t+1]=c*p+u*f+l*d-a*h,e[t+2]=l*p+u*h+a*f-c*d,e[t+3]=u*p-a*d-c*f-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(n/2),u=a(r/2),d=a(s/2),f=c(n/2),h=c(r/2),p=c(s/2);switch(o){case"XYZ":this._x=f*u*d+l*h*p,this._y=l*h*d-f*u*p,this._z=l*u*p+f*h*d,this._w=l*u*d-f*h*p;break;case"YXZ":this._x=f*u*d+l*h*p,this._y=l*h*d-f*u*p,this._z=l*u*p-f*h*d,this._w=l*u*d+f*h*p;break;case"ZXY":this._x=f*u*d-l*h*p,this._y=l*h*d+f*u*p,this._z=l*u*p+f*h*d,this._w=l*u*d-f*h*p;break;case"ZYX":this._x=f*u*d-l*h*p,this._y=l*h*d+f*u*p,this._z=l*u*p-f*h*d,this._w=l*u*d+f*h*p;break;case"YZX":this._x=f*u*d+l*h*p,this._y=l*h*d+f*u*p,this._z=l*u*p-f*h*d,this._w=l*u*d-f*h*p;break;case"XZY":this._x=f*u*d-l*h*p,this._y=l*h*d-f*u*p,this._z=l*u*p+f*h*d,this._w=l*u*d+f*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],d=t[10],f=n+a+d;if(f>0){let h=.5/Math.sqrt(f+1);this._w=.25/h,this._x=(u-c)*h,this._y=(s-l)*h,this._z=(o-r)*h}else if(n>a&&n>d){let h=2*Math.sqrt(1+n-a-d);this._w=(u-c)/h,this._x=.25*h,this._y=(r+o)/h,this._z=(s+l)/h}else if(a>d){let h=2*Math.sqrt(1+a-n-d);this._w=(s-l)/h,this._x=(r+o)/h,this._y=.25*h,this._z=(c+u)/h}else{let h=2*Math.sqrt(1+d-n-a);this._w=(o-r)/h,this._x=(s+l)/h,this._y=(c+u)/h,this._z=.25*h}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xt(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=n*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-n*l,this._z=s*u+o*l+n*c-r*a,this._w=o*u-n*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;let c=1-a*a;if(c<=Number.EPSILON){let h=1-t;return this._w=h*o+t*this._w,this._x=h*n+t*this._x,this._y=h*r+t*this._y,this._z=h*s+t*this._z,this.normalize(),this}let l=Math.sqrt(c),u=Math.atan2(l,a),d=Math.sin((1-t)*u)/l,f=Math.sin(t*u)/l;return this._w=o*d+this._w*f,this._x=n*d+this._x*f,this._y=r*d+this._y*f,this._z=s*d+this._z*f,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},A=class i{constructor(e=0,t=0,n=0){i.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(FC.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(FC.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=2*(o*r-a*n),u=2*(a*t-s*r),d=2*(s*n-o*t);return this.x=t+c*l+o*d-a*u,this.y=n+c*u+a*l-s*d,this.z=r+c*d+s*u-o*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-n*c,this.z=n*a-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return k_.copy(this).projectOnVector(e),this.sub(k_)}reflect(e){return this.sub(k_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Xt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},k_=new A,FC=new Yt,hn=class{constructor(e=new A(1/0,1/0,1/0),t=new A(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(tr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(tr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=tr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,tr):tr.fromBufferAttribute(s,o),tr.applyMatrix4(e.matrixWorld),this.expandByPoint(tr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Dh.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Dh.copy(n.boundingBox)),Dh.applyMatrix4(e.matrixWorld),this.union(Dh)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,tr),tr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Jl),Ih.subVectors(this.max,Jl),rc.subVectors(e.a,Jl),sc.subVectors(e.b,Jl),oc.subVectors(e.c,Jl),Hs.subVectors(sc,rc),Gs.subVectors(oc,sc),Ao.subVectors(rc,oc);let t=[0,-Hs.z,Hs.y,0,-Gs.z,Gs.y,0,-Ao.z,Ao.y,Hs.z,0,-Hs.x,Gs.z,0,-Gs.x,Ao.z,0,-Ao.x,-Hs.y,Hs.x,0,-Gs.y,Gs.x,0,-Ao.y,Ao.x,0];return!U_(t,rc,sc,oc,Ih)||(t=[1,0,0,0,1,0,0,0,1],!U_(t,rc,sc,oc,Ih))?!1:(Rh.crossVectors(Hs,Gs),t=[Rh.x,Rh.y,Rh.z],U_(t,rc,sc,oc,Ih))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,tr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(tr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(qr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),qr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),qr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),qr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),qr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),qr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),qr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),qr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(qr),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},qr=[new A,new A,new A,new A,new A,new A,new A,new A],tr=new A,Dh=new hn,rc=new A,sc=new A,oc=new A,Hs=new A,Gs=new A,Ao=new A,Jl=new A,Ih=new A,Rh=new A,Do=new A;function U_(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Do.fromArray(i,s);let a=r.x*Math.abs(Do.x)+r.y*Math.abs(Do.y)+r.z*Math.abs(Do.z),c=e.dot(Do),l=t.dot(Do),u=n.dot(Do);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}var Gk=new hn,Ql=new A,B_=new A,an=class{constructor(e=new A,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):Gk.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ql.subVectors(e,this.center);let t=Ql.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(Ql,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(B_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ql.copy(e.center).add(B_)),this.expandByPoint(Ql.copy(e.center).sub(B_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Xr=new A,V_=new A,Nh=new A,js=new A,z_=new A,Ph=new A,H_=new A,wr=class{constructor(e=new A,t=new A(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Xr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Xr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Xr.copy(this.origin).addScaledVector(this.direction,t),Xr.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){V_.copy(e).add(t).multiplyScalar(.5),Nh.copy(t).sub(e).normalize(),js.copy(this.origin).sub(V_);let s=e.distanceTo(t)*.5,o=-this.direction.dot(Nh),a=js.dot(this.direction),c=-js.dot(Nh),l=js.lengthSq(),u=Math.abs(1-o*o),d,f,h,p;if(u>0)if(d=o*c-a,f=o*a-c,p=s*u,d>=0)if(f>=-p)if(f<=p){let v=1/u;d*=v,f*=v,h=d*(d+o*f+2*a)+f*(o*d+f+2*c)+l}else f=s,d=Math.max(0,-(o*f+a)),h=-d*d+f*(f+2*c)+l;else f=-s,d=Math.max(0,-(o*f+a)),h=-d*d+f*(f+2*c)+l;else f<=-p?(d=Math.max(0,-(-o*s+a)),f=d>0?-s:Math.min(Math.max(-s,-c),s),h=-d*d+f*(f+2*c)+l):f<=p?(d=0,f=Math.min(Math.max(-s,-c),s),h=f*(f+2*c)+l):(d=Math.max(0,-(o*s+a)),f=d>0?s:Math.min(Math.max(-s,-c),s),h=-d*d+f*(f+2*c)+l);else f=o>0?-s:s,d=Math.max(0,-(o*f+a)),h=-d*d+f*(f+2*c)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(V_).addScaledVector(Nh,f),h}intersectSphere(e,t){Xr.subVectors(e.center,this.origin);let n=Xr.dot(this.direction),r=Xr.dot(Xr)-n*n,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=n-o,c=n+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,c,l=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,f=this.origin;return l>=0?(n=(e.min.x-f.x)*l,r=(e.max.x-f.x)*l):(n=(e.max.x-f.x)*l,r=(e.min.x-f.x)*l),u>=0?(s=(e.min.y-f.y)*u,o=(e.max.y-f.y)*u):(s=(e.max.y-f.y)*u,o=(e.min.y-f.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-f.z)*d,c=(e.max.z-f.z)*d):(a=(e.max.z-f.z)*d,c=(e.min.z-f.z)*d),n>c||a>r)||((a>n||n!==n)&&(n=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Xr)!==null}intersectTriangle(e,t,n,r,s){z_.subVectors(t,e),Ph.subVectors(n,e),H_.crossVectors(z_,Ph);let o=this.direction.dot(H_),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;js.subVectors(this.origin,e);let c=a*this.direction.dot(Ph.crossVectors(js,Ph));if(c<0)return null;let l=a*this.direction.dot(z_.cross(js));if(l<0||c+l>o)return null;let u=-a*js.dot(H_);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ve=class i{constructor(e,t,n,r,s,o,a,c,l,u,d,f,h,p,v,g){i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,c,l,u,d,f,h,p,v,g)}set(e,t,n,r,s,o,a,c,l,u,d,f,h,p,v,g){let m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=c,m[2]=l,m[6]=u,m[10]=d,m[14]=f,m[3]=h,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new i().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,r=1/ac.setFromMatrixColumn(e,0).length(),s=1/ac.setFromMatrixColumn(e,1).length(),o=1/ac.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){let f=o*u,h=o*d,p=a*u,v=a*d;t[0]=c*u,t[4]=-c*d,t[8]=l,t[1]=h+p*l,t[5]=f-v*l,t[9]=-a*c,t[2]=v-f*l,t[6]=p+h*l,t[10]=o*c}else if(e.order==="YXZ"){let f=c*u,h=c*d,p=l*u,v=l*d;t[0]=f+v*a,t[4]=p*a-h,t[8]=o*l,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=h*a-p,t[6]=v+f*a,t[10]=o*c}else if(e.order==="ZXY"){let f=c*u,h=c*d,p=l*u,v=l*d;t[0]=f-v*a,t[4]=-o*d,t[8]=p+h*a,t[1]=h+p*a,t[5]=o*u,t[9]=v-f*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){let f=o*u,h=o*d,p=a*u,v=a*d;t[0]=c*u,t[4]=p*l-h,t[8]=f*l+v,t[1]=c*d,t[5]=v*l+f,t[9]=h*l-p,t[2]=-l,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){let f=o*c,h=o*l,p=a*c,v=a*l;t[0]=c*u,t[4]=v-f*d,t[8]=p*d+h,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=h*d+p,t[10]=f-v*d}else if(e.order==="XZY"){let f=o*c,h=o*l,p=a*c,v=a*l;t[0]=c*u,t[4]=-d,t[8]=l*u,t[1]=f*d+v,t[5]=o*u,t[9]=h*d-p,t[2]=p*d-h,t[6]=a*u,t[10]=v*d+f}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(jk,e,Wk)}lookAt(e,t,n){let r=this.elements;return fi.subVectors(e,t),fi.lengthSq()===0&&(fi.z=1),fi.normalize(),Ws.crossVectors(n,fi),Ws.lengthSq()===0&&(Math.abs(n.z)===1?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),Ws.crossVectors(n,fi)),Ws.normalize(),Oh.crossVectors(fi,Ws),r[0]=Ws.x,r[4]=Oh.x,r[8]=fi.x,r[1]=Ws.y,r[5]=Oh.y,r[9]=fi.y,r[2]=Ws.z,r[6]=Oh.z,r[10]=fi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],c=n[8],l=n[12],u=n[1],d=n[5],f=n[9],h=n[13],p=n[2],v=n[6],g=n[10],m=n[14],_=n[3],x=n[7],y=n[11],D=n[15],w=r[0],E=r[4],C=r[8],S=r[12],M=r[1],R=r[5],B=r[9],k=r[13],j=r[2],Y=r[6],V=r[10],$=r[14],z=r[3],ce=r[7],ge=r[11],we=r[15];return s[0]=o*w+a*M+c*j+l*z,s[4]=o*E+a*R+c*Y+l*ce,s[8]=o*C+a*B+c*V+l*ge,s[12]=o*S+a*k+c*$+l*we,s[1]=u*w+d*M+f*j+h*z,s[5]=u*E+d*R+f*Y+h*ce,s[9]=u*C+d*B+f*V+h*ge,s[13]=u*S+d*k+f*$+h*we,s[2]=p*w+v*M+g*j+m*z,s[6]=p*E+v*R+g*Y+m*ce,s[10]=p*C+v*B+g*V+m*ge,s[14]=p*S+v*k+g*$+m*we,s[3]=_*w+x*M+y*j+D*z,s[7]=_*E+x*R+y*Y+D*ce,s[11]=_*C+x*B+y*V+D*ge,s[15]=_*S+x*k+y*$+D*we,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],d=e[6],f=e[10],h=e[14],p=e[3],v=e[7],g=e[11],m=e[15];return p*(+s*c*d-r*l*d-s*a*f+n*l*f+r*a*h-n*c*h)+v*(+t*c*h-t*l*f+s*o*f-r*o*h+r*l*u-s*c*u)+g*(+t*l*d-t*a*h-s*o*d+n*o*h+s*a*u-n*l*u)+m*(-r*a*u-t*c*d+t*a*f+r*o*d-n*o*f+n*c*u)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],f=e[10],h=e[11],p=e[12],v=e[13],g=e[14],m=e[15],_=d*g*l-v*f*l+v*c*h-a*g*h-d*c*m+a*f*m,x=p*f*l-u*g*l-p*c*h+o*g*h+u*c*m-o*f*m,y=u*v*l-p*d*l+p*a*h-o*v*h-u*a*m+o*d*m,D=p*d*c-u*v*c-p*a*f+o*v*f+u*a*g-o*d*g,w=t*_+n*x+r*y+s*D;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let E=1/w;return e[0]=_*E,e[1]=(v*f*s-d*g*s-v*r*h+n*g*h+d*r*m-n*f*m)*E,e[2]=(a*g*s-v*c*s+v*r*l-n*g*l-a*r*m+n*c*m)*E,e[3]=(d*c*s-a*f*s-d*r*l+n*f*l+a*r*h-n*c*h)*E,e[4]=x*E,e[5]=(u*g*s-p*f*s+p*r*h-t*g*h-u*r*m+t*f*m)*E,e[6]=(p*c*s-o*g*s-p*r*l+t*g*l+o*r*m-t*c*m)*E,e[7]=(o*f*s-u*c*s+u*r*l-t*f*l-o*r*h+t*c*h)*E,e[8]=y*E,e[9]=(p*d*s-u*v*s-p*n*h+t*v*h+u*n*m-t*d*m)*E,e[10]=(o*v*s-p*a*s+p*n*l-t*v*l-o*n*m+t*a*m)*E,e[11]=(u*a*s-o*d*s-u*n*l+t*d*l+o*n*h-t*a*h)*E,e[12]=D*E,e[13]=(u*v*r-p*d*r+p*n*f-t*v*f-u*n*g+t*d*g)*E,e[14]=(p*a*r-o*v*r-p*n*c+t*v*c+o*n*g-t*a*g)*E,e[15]=(o*d*r-u*a*r+u*n*c-t*d*c-o*n*f+t*a*f)*E,this}scale(e){let t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+n,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+n,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,d=a+a,f=s*l,h=s*u,p=s*d,v=o*u,g=o*d,m=a*d,_=c*l,x=c*u,y=c*d,D=n.x,w=n.y,E=n.z;return r[0]=(1-(v+m))*D,r[1]=(h+y)*D,r[2]=(p-x)*D,r[3]=0,r[4]=(h-y)*w,r[5]=(1-(f+m))*w,r[6]=(g+_)*w,r[7]=0,r[8]=(p+x)*E,r[9]=(g-_)*E,r[10]=(1-(f+v))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements,s=ac.set(r[0],r[1],r[2]).length(),o=ac.set(r[4],r[5],r[6]).length(),a=ac.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],nr.copy(this);let l=1/s,u=1/o,d=1/a;return nr.elements[0]*=l,nr.elements[1]*=l,nr.elements[2]*=l,nr.elements[4]*=u,nr.elements[5]*=u,nr.elements[6]*=u,nr.elements[8]*=d,nr.elements[9]*=d,nr.elements[10]*=d,t.setFromRotationMatrix(nr),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o,a=Sr){let c=this.elements,l=2*s/(t-e),u=2*s/(n-r),d=(t+e)/(t-e),f=(n+r)/(n-r),h,p;if(a===Sr)h=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===Tu)h=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=l,c[4]=0,c[8]=d,c[12]=0,c[1]=0,c[5]=u,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=h,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,r,s,o,a=Sr){let c=this.elements,l=1/(t-e),u=1/(n-r),d=1/(o-s),f=(t+e)*l,h=(n+r)*u,p,v;if(a===Sr)p=(o+s)*d,v=-2*d;else if(a===Tu)p=s*d,v=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-h,c[2]=0,c[6]=0,c[10]=v,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},ac=new A,nr=new Ve,jk=new A(0,0,0),Wk=new A(1,1,1),Ws=new A,Oh=new A,fi=new A,kC=new Ve,UC=new Yt,Er=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){let s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],d=s[9],f=s[2],h=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(Xt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Xt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,o),this._z=0);break;case"ZXY":this._x=Math.asin(Xt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-f,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-Xt(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(h,p),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Xt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-f,o)):(this._x=0,this._y=Math.atan2(c,p));break;case"XZY":this._z=Math.asin(-Xt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return kC.makeRotationFromQuaternion(t),this.setFromRotationMatrix(kC,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return UC.setFromEuler(this),this.setFromQuaternion(UC,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})(),Tr=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},$k=0,BC=new A,cc=new Yt,Yr=new Ve,Lh=new A,eu=new A,qk=new A,Xk=new Yt,VC=new A(1,0,0),zC=new A(0,1,0),HC=new A(0,0,1),GC={type:"added"},Yk={type:"removed"},lc={type:"childadded",child:null},G_={type:"childremoved",child:null},Rt=(()=>{class i extends ni{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:$k++}),this.uuid=mi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();let t=new A,n=new Er,r=new Yt,s=new A(1,1,1);function o(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ve},normalMatrix:{value:new nt}}),this.matrix=new Ve,this.matrixWorld=new Ve,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Tr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return cc.setFromAxisAngle(t,n),this.quaternion.multiply(cc),this}rotateOnWorldAxis(t,n){return cc.setFromAxisAngle(t,n),this.quaternion.premultiply(cc),this}rotateX(t){return this.rotateOnAxis(VC,t)}rotateY(t){return this.rotateOnAxis(zC,t)}rotateZ(t){return this.rotateOnAxis(HC,t)}translateOnAxis(t,n){return BC.copy(t).applyQuaternion(this.quaternion),this.position.add(BC.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(VC,t)}translateY(t){return this.translateOnAxis(zC,t)}translateZ(t){return this.translateOnAxis(HC,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Yr.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?Lh.copy(t):Lh.set(t,n,r);let s=this.parent;this.updateWorldMatrix(!0,!1),eu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Yr.lookAt(eu,Lh,this.up):Yr.lookAt(Lh,eu,this.up),this.quaternion.setFromRotationMatrix(Yr),s&&(Yr.extractRotation(s.matrixWorld),cc.setFromRotationMatrix(Yr),this.quaternion.premultiply(cc.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(GC),lc.child=t,this.dispatchEvent(lc),lc.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Yk),G_.child=t,this.dispatchEvent(G_),G_.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Yr.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Yr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Yr),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(GC),lc.child=t,this.dispatchEvent(lc),lc.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectByProperty(t,n);if(a!==void 0)return a}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eu,t,qk),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eu,Xk,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){let n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){let r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){let n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(c,l){return c[l.uuid]===void 0&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);let c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){let l=c.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){let f=l[u];o(t.shapes,f)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){let l=this.animations[c];s.animations.push(o(t.animations,l))}}if(n){let c=a(t.geometries),l=a(t.materials),u=a(t.textures),d=a(t.images),f=a(t.shapes),h=a(t.skeletons),p=a(t.animations),v=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),f.length>0&&(r.shapes=f),h.length>0&&(r.skeletons=h),p.length>0&&(r.animations=p),v.length>0&&(r.nodes=v)}return r.object=s,r;function a(c){let l=[];for(let u in c){let d=c[u];delete d.metadata,l.push(d)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){let s=t.children[r];this.add(s.clone())}return this}}return i.DEFAULT_UP=new A(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})(),ir=new A,Zr=new A,j_=new A,Kr=new A,uc=new A,dc=new A,jC=new A,W_=new A,$_=new A,q_=new A,X_=new _t,Y_=new _t,Z_=new _t,Mr=class i{constructor(e=new A,t=new A,n=new A){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),ir.subVectors(e,t),r.cross(ir);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){ir.subVectors(r,t),Zr.subVectors(n,t),j_.subVectors(e,t);let o=ir.dot(ir),a=ir.dot(Zr),c=ir.dot(j_),l=Zr.dot(Zr),u=Zr.dot(j_),d=o*l-a*a;if(d===0)return s.set(0,0,0),null;let f=1/d,h=(l*c-a*u)*f,p=(o*u-a*c)*f;return s.set(1-h-p,p,h)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Kr)===null?!1:Kr.x>=0&&Kr.y>=0&&Kr.x+Kr.y<=1}static getInterpolation(e,t,n,r,s,o,a,c){return this.getBarycoord(e,t,n,r,Kr)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Kr.x),c.addScaledVector(o,Kr.y),c.addScaledVector(a,Kr.z),c)}static getInterpolatedAttribute(e,t,n,r,s,o){return X_.setScalar(0),Y_.setScalar(0),Z_.setScalar(0),X_.fromBufferAttribute(e,t),Y_.fromBufferAttribute(e,n),Z_.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(X_,s.x),o.addScaledVector(Y_,s.y),o.addScaledVector(Z_,s.z),o}static isFrontFacing(e,t,n,r){return ir.subVectors(n,t),Zr.subVectors(e,t),ir.cross(Zr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ir.subVectors(this.c,this.b),Zr.subVectors(this.a,this.b),ir.cross(Zr).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return i.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return i.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return i.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return i.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return i.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,s=this.c,o,a;uc.subVectors(r,n),dc.subVectors(s,n),W_.subVectors(e,n);let c=uc.dot(W_),l=dc.dot(W_);if(c<=0&&l<=0)return t.copy(n);$_.subVectors(e,r);let u=uc.dot($_),d=dc.dot($_);if(u>=0&&d<=u)return t.copy(r);let f=c*d-u*l;if(f<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(n).addScaledVector(uc,o);q_.subVectors(e,s);let h=uc.dot(q_),p=dc.dot(q_);if(p>=0&&h<=p)return t.copy(s);let v=h*l-c*p;if(v<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(n).addScaledVector(dc,a);let g=u*p-h*d;if(g<=0&&d-u>=0&&h-p>=0)return jC.subVectors(s,r),a=(d-u)/(d-u+(h-p)),t.copy(r).addScaledVector(jC,a);let m=1/(g+v+f);return o=v*m,a=f*m,t.copy(n).addScaledVector(uc,o).addScaledVector(dc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},QD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$s={h:0,s:0,l:0},Fh={h:0,s:0,l:0};function K_(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}var de=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=sn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,it.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=it.workingColorSpace){return this.r=e,this.g=t,this.b=n,it.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=it.workingColorSpace){if(e=iM(e,1),t=Xt(t,0,1),n=Xt(n,0,1),t===0)this.r=this.g=this.b=n;else{let s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=K_(o,s,e+1/3),this.g=K_(o,s,e),this.b=K_(o,s,e-1/3)}return it.toWorkingColorSpace(this,r),this}setStyle(e,t=sn){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=sn){let n=QD[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=rs(e.r),this.g=rs(e.g),this.b=rs(e.b),this}copyLinearToSRGB(e){return this.r=wc(e.r),this.g=wc(e.g),this.b=wc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=sn){return it.fromWorkingColorSpace(An.copy(this),e),Math.round(Xt(An.r*255,0,255))*65536+Math.round(Xt(An.g*255,0,255))*256+Math.round(Xt(An.b*255,0,255))}getHexString(e=sn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=it.workingColorSpace){it.fromWorkingColorSpace(An.copy(this),t);let n=An.r,r=An.g,s=An.b,o=Math.max(n,r,s),a=Math.min(n,r,s),c,l,u=(a+o)/2;if(a===o)c=0,l=0;else{let d=o-a;switch(l=u<=.5?d/(o+a):d/(2-o-a),o){case n:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-n)/d+2;break;case s:c=(n-r)/d+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=it.workingColorSpace){return it.fromWorkingColorSpace(An.copy(this),t),e.r=An.r,e.g=An.g,e.b=An.b,e}getStyle(e=sn){it.fromWorkingColorSpace(An.copy(this),e);let t=An.r,n=An.g,r=An.b;return e!==sn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL($s),this.setHSL($s.h+e,$s.s+t,$s.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL($s),e.getHSL(Fh);let n=yu($s.h,Fh.h,t),r=yu($s.s,Fh.s,t),s=yu($s.l,Fh.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},An=new de;de.NAMES=QD;var Zk=0,Zt=class extends ni{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Zk++}),this.uuid=mi(),this.name="",this.blending=qo,this.side=or,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Mp,this.blendDst=Sp,this.blendEquation=Ys,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new de(0,0,0),this.blendAlpha=0,this.depthFunc=Ko,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=C0,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zo,this.stencilZFail=zo,this.stencilZPass=zo,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==qo&&(n.blending=this.blending),this.side!==or&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Mp&&(n.blendSrc=this.blendSrc),this.blendDst!==Sp&&(n.blendDst=this.blendDst),this.blendEquation!==Ys&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Ko&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==C0&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==zo&&(n.stencilFail=this.stencilFail),this.stencilZFail!==zo&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==zo&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){let o=[];for(let a in s){let c=s[a];delete c.metadata,o.push(c)}return o}if(t){let s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},In=class extends Zt{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new de(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Er,this.combine=nd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},es=Kk();function Kk(){let i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){let l=c-127;l<-27?(n[c]=0,n[c|256]=32768,r[c]=24,r[c|256]=24):l<-14?(n[c]=1024>>-l-14,n[c|256]=1024>>-l-14|32768,r[c]=-l-1,r[c|256]=-l-1):l<=15?(n[c]=l+15<<10,n[c|256]=l+15<<10|32768,r[c]=13,r[c|256]=13):l<128?(n[c]=31744,n[c|256]=64512,r[c]=24,r[c|256]=24):(n[c]=31744,n[c|256]=64512,r[c]=13,r[c|256]=13)}let s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;!(l&8388608);)l<<=1,u-=8388608;l&=-8388609,u+=947912704,s[c]=l|u}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Jn(i){Math.abs(i)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),i=Xt(i,-65504,65504),es.floatView[0]=i;let e=es.uint32View[0],t=e>>23&511;return es.baseTable[t]+((e&8388607)>>es.shiftTable[t])}function du(i){let e=i>>10;return es.uint32View[0]=es.mantissaTable[es.offsetTable[e]+(i&1023)]+es.exponentTable[e],es.floatView[0]}var Jk={toHalfFloat:Jn,fromHalfFloat:du},rn=new A,kh=new q,xt=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Eu,this.updateRanges=[],this.gpuType=ti,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)kh.fromBufferAttribute(this,t),kh.applyMatrix3(e),this.setXY(t,kh.x,kh.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)rn.fromBufferAttribute(this,t),rn.applyMatrix3(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)rn.fromBufferAttribute(this,t),rn.applyMatrix4(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)rn.fromBufferAttribute(this,t),rn.applyNormalMatrix(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)rn.fromBufferAttribute(this,t),rn.transformDirection(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Un(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=rt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Un(t,this.array)),t}setX(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Un(t,this.array)),t}setY(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Un(t,this.array)),t}setZ(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Un(t,this.array)),t}setW(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array),s=rt(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Eu&&(e.usage=this.usage),e}},R0=class extends xt{constructor(e,t,n){super(new Int8Array(e),t,n)}},N0=class extends xt{constructor(e,t,n){super(new Uint8Array(e),t,n)}},P0=class extends xt{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},O0=class extends xt{constructor(e,t,n){super(new Int16Array(e),t,n)}},Du=class extends xt{constructor(e,t,n){super(new Uint16Array(e),t,n)}},L0=class extends xt{constructor(e,t,n){super(new Int32Array(e),t,n)}},Iu=class extends xt{constructor(e,t,n){super(new Uint32Array(e),t,n)}},F0=class extends xt{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=du(this.array[e*this.itemSize]);return this.normalized&&(t=Un(t,this.array)),t}setX(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize]=Jn(t),this}getY(e){let t=du(this.array[e*this.itemSize+1]);return this.normalized&&(t=Un(t,this.array)),t}setY(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+1]=Jn(t),this}getZ(e){let t=du(this.array[e*this.itemSize+2]);return this.normalized&&(t=Un(t,this.array)),t}setZ(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+2]=Jn(t),this}getW(e){let t=du(this.array[e*this.itemSize+3]);return this.normalized&&(t=Un(t,this.array)),t}setW(e,t){return this.normalized&&(t=rt(t,this.array)),this.array[e*this.itemSize+3]=Jn(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array)),this.array[e+0]=Jn(t),this.array[e+1]=Jn(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array)),this.array[e+0]=Jn(t),this.array[e+1]=Jn(n),this.array[e+2]=Jn(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array),s=rt(s,this.array)),this.array[e+0]=Jn(t),this.array[e+1]=Jn(n),this.array[e+2]=Jn(r),this.array[e+3]=Jn(s),this}},Ce=class extends xt{constructor(e,t,n){super(new Float32Array(e),t,n)}},Qk=0,Ni=new Ve,J_=new Rt,fc=new A,hi=new hn,tu=new hn,_n=new A,et=class i extends ni{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Qk++}),this.uuid=mi(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(KD(e)?Iu:Du)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let s=new nt().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ni.makeRotationFromQuaternion(e),this.applyMatrix4(Ni),this}rotateX(e){return Ni.makeRotationX(e),this.applyMatrix4(Ni),this}rotateY(e){return Ni.makeRotationY(e),this.applyMatrix4(Ni),this}rotateZ(e){return Ni.makeRotationZ(e),this.applyMatrix4(Ni),this}translate(e,t,n){return Ni.makeTranslation(e,t,n),this.applyMatrix4(Ni),this}scale(e,t,n){return Ni.makeScale(e,t,n),this.applyMatrix4(Ni),this}lookAt(e){return J_.lookAt(e),J_.updateMatrix(),this.applyMatrix4(J_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(fc).negate(),this.translate(fc.x,fc.y,fc.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let n=[];for(let r=0,s=e.length;r<s;r++){let o=e[r];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Ce(n,3))}else{for(let n=0,r=t.count;n<r;n++){let s=e[n];t.setXYZ(n,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){let s=t[n];hi.setFromBufferAttribute(s),this.morphTargetsRelative?(_n.addVectors(this.boundingBox.min,hi.min),this.boundingBox.expandByPoint(_n),_n.addVectors(this.boundingBox.max,hi.max),this.boundingBox.expandByPoint(_n)):(this.boundingBox.expandByPoint(hi.min),this.boundingBox.expandByPoint(hi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new an);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new A,1/0);return}if(e){let n=this.boundingSphere.center;if(hi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){let a=t[s];tu.setFromBufferAttribute(a),this.morphTargetsRelative?(_n.addVectors(hi.min,tu.min),hi.expandByPoint(_n),_n.addVectors(hi.max,tu.max),hi.expandByPoint(_n)):(hi.expandByPoint(tu.min),hi.expandByPoint(tu.max))}hi.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)_n.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(_n));if(t)for(let s=0,o=t.length;s<o;s++){let a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)_n.fromBufferAttribute(a,l),c&&(fc.fromBufferAttribute(e,l),_n.add(fc)),r=Math.max(r,n.distanceToSquared(_n))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new xt(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),a=[],c=[];for(let C=0;C<n.count;C++)a[C]=new A,c[C]=new A;let l=new A,u=new A,d=new A,f=new q,h=new q,p=new q,v=new A,g=new A;function m(C,S,M){l.fromBufferAttribute(n,C),u.fromBufferAttribute(n,S),d.fromBufferAttribute(n,M),f.fromBufferAttribute(s,C),h.fromBufferAttribute(s,S),p.fromBufferAttribute(s,M),u.sub(l),d.sub(l),h.sub(f),p.sub(f);let R=1/(h.x*p.y-p.x*h.y);isFinite(R)&&(v.copy(u).multiplyScalar(p.y).addScaledVector(d,-h.y).multiplyScalar(R),g.copy(d).multiplyScalar(h.x).addScaledVector(u,-p.x).multiplyScalar(R),a[C].add(v),a[S].add(v),a[M].add(v),c[C].add(g),c[S].add(g),c[M].add(g))}let _=this.groups;_.length===0&&(_=[{start:0,count:e.count}]);for(let C=0,S=_.length;C<S;++C){let M=_[C],R=M.start,B=M.count;for(let k=R,j=R+B;k<j;k+=3)m(e.getX(k+0),e.getX(k+1),e.getX(k+2))}let x=new A,y=new A,D=new A,w=new A;function E(C){D.fromBufferAttribute(r,C),w.copy(D);let S=a[C];x.copy(S),x.sub(D.multiplyScalar(D.dot(S))).normalize(),y.crossVectors(w,S);let R=y.dot(c[C])<0?-1:1;o.setXYZW(C,x.x,x.y,x.z,R)}for(let C=0,S=_.length;C<S;++C){let M=_[C],R=M.start,B=M.count;for(let k=R,j=R+B;k<j;k+=3)E(e.getX(k+0)),E(e.getX(k+1)),E(e.getX(k+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new xt(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let f=0,h=n.count;f<h;f++)n.setXYZ(f,0,0,0);let r=new A,s=new A,o=new A,a=new A,c=new A,l=new A,u=new A,d=new A;if(e)for(let f=0,h=e.count;f<h;f+=3){let p=e.getX(f+0),v=e.getX(f+1),g=e.getX(f+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(n,p),c.fromBufferAttribute(n,v),l.fromBufferAttribute(n,g),a.add(u),c.add(u),l.add(u),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(v,c.x,c.y,c.z),n.setXYZ(g,l.x,l.y,l.z)}else for(let f=0,h=t.count;f<h;f+=3)r.fromBufferAttribute(t,f+0),s.fromBufferAttribute(t,f+1),o.fromBufferAttribute(t,f+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),n.setXYZ(f+0,u.x,u.y,u.z),n.setXYZ(f+1,u.x,u.y,u.z),n.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)_n.fromBufferAttribute(e,t),_n.normalize(),e.setXYZ(t,_n.x,_n.y,_n.z)}toNonIndexed(){function e(a,c){let l=a.array,u=a.itemSize,d=a.normalized,f=new l.constructor(c.length*u),h=0,p=0;for(let v=0,g=c.length;v<g;v++){a.isInterleavedBufferAttribute?h=c[v]*a.data.stride+a.offset:h=c[v]*u;for(let m=0;m<u;m++)f[p++]=l[h++]}return new xt(f,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new i,n=this.index.array,r=this.attributes;for(let a in r){let c=r[a],l=e(c,n);t.setAttribute(a,l)}let s=this.morphAttributes;for(let a in s){let c=[],l=s[a];for(let u=0,d=l.length;u<d;u++){let f=l[u],h=e(f,n);c.push(h)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,c=o.length;a<c;a++){let l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let c=this.parameters;for(let l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let c in n){let l=n[c];e.data.attributes[c]=l.toJSON(e.data)}let r={},s=!1;for(let c in this.morphAttributes){let l=this.morphAttributes[c],u=[];for(let d=0,f=l.length;d<f;d++){let h=l[d];u.push(h.toJSON(e.data))}u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let r=e.attributes;for(let l in r){let u=r[l];this.setAttribute(l,u.clone(t))}let s=e.morphAttributes;for(let l in s){let u=[],d=s[l];for(let f=0,h=d.length;f<h;f++)u.push(d[f].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let l=0,u=o.length;l<u;l++){let d=o[l];this.addGroup(d.start,d.count,d.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},WC=new Ve,Io=new wr,Uh=new an,$C=new A,Bh=new A,Vh=new A,zh=new A,Q_=new A,Hh=new A,qC=new A,Gh=new A,Ft=class extends Rt{constructor(e=new et,t=new In){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){Hh.set(0,0,0);for(let c=0,l=s.length;c<l;c++){let u=a[c],d=s[c];u!==0&&(Q_.fromBufferAttribute(d,e),o?Hh.addScaledVector(Q_,u):Hh.addScaledVector(Q_.sub(t),u))}t.add(Hh)}return t}raycast(e,t){let n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Uh.copy(n.boundingSphere),Uh.applyMatrix4(s),Io.copy(e.ray).recast(e.near),!(Uh.containsPoint(Io.origin)===!1&&(Io.intersectSphere(Uh,$C)===null||Io.origin.distanceToSquared($C)>(e.far-e.near)**2))&&(WC.copy(s).invert(),Io.copy(e.ray).applyMatrix4(WC),!(n.boundingBox!==null&&Io.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Io)))}_computeIntersections(e,t,n){let r,s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,f=s.groups,h=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,v=f.length;p<v;p++){let g=f[p],m=o[g.materialIndex],_=Math.max(g.start,h.start),x=Math.min(a.count,Math.min(g.start+g.count,h.start+h.count));for(let y=_,D=x;y<D;y+=3){let w=a.getX(y),E=a.getX(y+1),C=a.getX(y+2);r=jh(this,m,e,n,l,u,d,w,E,C),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=g.materialIndex,t.push(r))}}else{let p=Math.max(0,h.start),v=Math.min(a.count,h.start+h.count);for(let g=p,m=v;g<m;g+=3){let _=a.getX(g),x=a.getX(g+1),y=a.getX(g+2);r=jh(this,o,e,n,l,u,d,_,x,y),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(o))for(let p=0,v=f.length;p<v;p++){let g=f[p],m=o[g.materialIndex],_=Math.max(g.start,h.start),x=Math.min(c.count,Math.min(g.start+g.count,h.start+h.count));for(let y=_,D=x;y<D;y+=3){let w=y,E=y+1,C=y+2;r=jh(this,m,e,n,l,u,d,w,E,C),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=g.materialIndex,t.push(r))}}else{let p=Math.max(0,h.start),v=Math.min(c.count,h.start+h.count);for(let g=p,m=v;g<m;g+=3){let _=g,x=g+1,y=g+2;r=jh(this,o,e,n,l,u,d,_,x,y),r&&(r.faceIndex=Math.floor(g/3),t.push(r))}}}};function eU(i,e,t,n,r,s,o,a){let c;if(e.side===Bn?c=n.intersectTriangle(o,s,r,!0,a):c=n.intersectTriangle(r,s,o,e.side===or,a),c===null)return null;Gh.copy(a),Gh.applyMatrix4(i.matrixWorld);let l=t.ray.origin.distanceTo(Gh);return l<t.near||l>t.far?null:{distance:l,point:Gh.clone(),object:i}}function jh(i,e,t,n,r,s,o,a,c,l){i.getVertexPosition(a,Bh),i.getVertexPosition(c,Vh),i.getVertexPosition(l,zh);let u=eU(i,e,t,n,Bh,Vh,zh,qC);if(u){let d=new A;Mr.getBarycoord(qC,Bh,Vh,zh,d),r&&(u.uv=Mr.getInterpolatedAttribute(r,a,c,l,d,new q)),s&&(u.uv1=Mr.getInterpolatedAttribute(s,a,c,l,d,new q)),o&&(u.normal=Mr.getInterpolatedAttribute(o,a,c,l,d,new A),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));let f={a,b:c,c:l,normal:new A,materialIndex:0};Mr.getNormal(Bh,Vh,zh,f.normal),u.face=f,u.barycoord=d}return u}var ia=class i extends et{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let c=[],l=[],u=[],d=[],f=0,h=0;p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(c),this.setAttribute("position",new Ce(l,3)),this.setAttribute("normal",new Ce(u,3)),this.setAttribute("uv",new Ce(d,2));function p(v,g,m,_,x,y,D,w,E,C,S){let M=y/E,R=D/C,B=y/2,k=D/2,j=w/2,Y=E+1,V=C+1,$=0,z=0,ce=new A;for(let ge=0;ge<V;ge++){let we=ge*R-k;for(let Je=0;Je<Y;Je++){let Mt=Je*M-B;ce[v]=Mt*_,ce[g]=we*x,ce[m]=j,l.push(ce.x,ce.y,ce.z),ce[v]=0,ce[g]=0,ce[m]=w>0?1:-1,u.push(ce.x,ce.y,ce.z),d.push(Je/E),d.push(1-ge/C),$+=1}}for(let ge=0;ge<C;ge++)for(let we=0;we<E;we++){let Je=f+we+Y*ge,Mt=f+we+Y*(ge+1),J=f+(we+1)+Y*(ge+1),le=f+(we+1)+Y*ge;c.push(Je,Mt,le),c.push(Mt,J,le),z+=6}a.addGroup(h,z,S),h+=z,f+=$}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Dc(i){let e={};for(let t in i){e[t]={};for(let n in i[t]){let r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function kn(i){let e={};for(let t=0;t<i.length;t++){let n=Dc(i[t]);for(let r in n)e[r]=n[r]}return e}function tU(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function eI(i){let e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:it.workingColorSpace}var tI={clone:Dc,merge:kn},nU=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,iU=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,vi=class extends Zt{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=nU,this.fragmentShader=iU,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Dc(e.uniforms),this.uniformsGroups=tU(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},Ic=class extends Rt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ve,this.projectionMatrix=new Ve,this.projectionMatrixInverse=new Ve,this.coordinateSystem=Sr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},qs=new A,XC=new q,YC=new q,Ot=class extends Ic{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Cc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Zo*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Cc*2*Math.atan(Math.tan(Zo*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){qs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(qs.x,qs.y).multiplyScalar(-e/qs.z),qs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(qs.x,qs.y).multiplyScalar(-e/qs.z)}getViewSize(e,t){return this.getViewBounds(e,XC,YC),t.subVectors(YC,XC)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Zo*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*n/l,r*=o.width/c,n*=o.height/l}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},hc=-90,pc=1,sm=class extends Rt{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new Ot(hc,pc,e,t);r.layers=this.layers,this.add(r);let s=new Ot(hc,pc,e,t);s.layers=this.layers,this.add(s);let o=new Ot(hc,pc,e,t);o.layers=this.layers,this.add(o);let a=new Ot(hc,pc,e,t);a.layers=this.layers,this.add(a);let c=new Ot(hc,pc,e,t);c.layers=this.layers,this.add(c);let l=new Ot(hc,pc,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,a,c]=t;for(let l of t)this.remove(l);if(e===Sr)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Tu)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let l of t)this.add(l),l.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,c,l,u]=this.children,d=e.getRenderTarget(),f=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;let v=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,c),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=v,e.setRenderTarget(n,5,r),e.render(t,u),e.setRenderTarget(d,f,h),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}},ra=class extends cn{constructor(e,t,n,r,s,o,a,c,l,u){e=e!==void 0?e:[],t=t!==void 0?t:os,super(e,t,n,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},om=class extends gi{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new ra(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ht}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ia(5,5,5),s=new vi({name:"CubemapFromEquirect",uniforms:Dc(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Bn,blending:is});s.uniforms.tEquirect.value=t;let o=new Ft(r,s),a=t.minFilter;return t.minFilter===pi&&(t.minFilter=Ht),new sm(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}},e0=new A,rU=new A,sU=new nt,Oi=class{constructor(e=new A(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=e0.subVectors(n,t).cross(rU.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(e0),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||sU.getNormalMatrix(e),r=this.coplanarPoint(e0).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ro=new an,Wh=new A,sa=class{constructor(e=new Oi,t=new Oi,n=new Oi,r=new Oi,s=new Oi,o=new Oi){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Sr){let n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],d=r[6],f=r[7],h=r[8],p=r[9],v=r[10],g=r[11],m=r[12],_=r[13],x=r[14],y=r[15];if(n[0].setComponents(c-s,f-l,g-h,y-m).normalize(),n[1].setComponents(c+s,f+l,g+h,y+m).normalize(),n[2].setComponents(c+o,f+u,g+p,y+_).normalize(),n[3].setComponents(c-o,f-u,g-p,y-_).normalize(),n[4].setComponents(c-a,f-d,g-v,y-x).normalize(),t===Sr)n[5].setComponents(c+a,f+d,g+v,y+x).normalize();else if(t===Tu)n[5].setComponents(a,d,v,x).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ro.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Ro.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ro)}intersectsSprite(e){return Ro.center.set(0,0,0),Ro.radius=.7071067811865476,Ro.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ro)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r=t[n];if(Wh.x=r.normal.x>0?e.max.x:e.min.x,Wh.y=r.normal.y>0?e.max.y:e.min.y,Wh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Wh)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function nI(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function oU(i){let e=new WeakMap;function t(a,c){let l=a.array,u=a.usage,d=l.byteLength,f=i.createBuffer();i.bindBuffer(c,f),i.bufferData(c,l,u),a.onUploadCallback();let h;if(l instanceof Float32Array)h=i.FLOAT;else if(l instanceof Uint16Array)a.isFloat16BufferAttribute?h=i.HALF_FLOAT:h=i.UNSIGNED_SHORT;else if(l instanceof Int16Array)h=i.SHORT;else if(l instanceof Uint32Array)h=i.UNSIGNED_INT;else if(l instanceof Int32Array)h=i.INT;else if(l instanceof Int8Array)h=i.BYTE;else if(l instanceof Uint8Array)h=i.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)h=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:f,type:h,bytesPerElement:l.BYTES_PER_ELEMENT,version:a.version,size:d}}function n(a,c,l){let u=c.array,d=c.updateRanges;if(i.bindBuffer(l,a),d.length===0)i.bufferSubData(l,0,u);else{d.sort((h,p)=>h.start-p.start);let f=0;for(let h=1;h<d.length;h++){let p=d[f],v=d[h];v.start<=p.start+p.count+1?p.count=Math.max(p.count,v.start+v.count-p.start):(++f,d[f]=v)}d.length=f+1;for(let h=0,p=d.length;h<p;h++){let v=d[h];i.bufferSubData(l,v.start*u.BYTES_PER_ELEMENT,u,v.start,v.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);let c=e.get(a);c&&(i.deleteBuffer(c.buffer),e.delete(a))}function o(a,c){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let l=e.get(a);if(l===void 0)e.set(a,t(a,c));else if(l.version<a.version){if(l.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(l.buffer,a,c),l.version=a.version}}return{get:r,remove:s,update:o}}var Rc=class i extends et{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let s=e/2,o=t/2,a=Math.floor(n),c=Math.floor(r),l=a+1,u=c+1,d=e/a,f=t/c,h=[],p=[],v=[],g=[];for(let m=0;m<u;m++){let _=m*f-o;for(let x=0;x<l;x++){let y=x*d-s;p.push(y,-_,0),v.push(0,0,1),g.push(x/a),g.push(1-m/c)}}for(let m=0;m<c;m++)for(let _=0;_<a;_++){let x=_+l*m,y=_+l*(m+1),D=_+1+l*(m+1),w=_+1+l*m;h.push(x,y,w),h.push(y,D,w)}this.setIndex(h),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(v,3)),this.setAttribute("uv",new Ce(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.widthSegments,e.heightSegments)}},aU=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,cU=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,lU=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,uU=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,dU=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,fU=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,hU=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,pU=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,mU=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,gU=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,vU=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,yU=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,_U=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,xU=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,MU=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,SU=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,bU=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,wU=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,EU=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,TU=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,CU=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,AU=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,DU=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,IU=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,RU=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,NU=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,PU=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,OU=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,LU=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,FU=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,kU="gl_FragColor = linearToOutputTexel( gl_FragColor );",UU=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,BU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,VU=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,zU=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,HU=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,GU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,jU=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,WU=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,$U=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,qU=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,XU=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,YU=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ZU=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,KU=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,JU=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,QU=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,eB=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,tB=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,nB=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,iB=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,rB=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,sB=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,oB=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,aB=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,cB=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,lB=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,uB=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,dB=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,fB=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,hB=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,pB=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,mB=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,gB=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,vB=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,yB=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,_B=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,xB=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,MB=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,SB=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,bB=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,wB=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,EB=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,TB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,CB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,AB=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,DB=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,IB=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,RB=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,NB=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,PB=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,OB=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,LB=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,FB=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,kB=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,UB=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,BB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,VB=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,zB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,HB=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,GB=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,jB=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,WB=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,$B=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,qB=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,XB=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,YB=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,ZB=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,KB=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,JB=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,QB=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,e3=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,t3=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,n3=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,i3=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,r3=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,s3=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,o3=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,a3=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,c3=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,l3=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,u3=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,d3=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,f3=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,h3=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,p3=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,m3=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,g3=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,v3=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,y3=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,_3=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,x3=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,M3=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,S3=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,b3=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,w3=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,E3=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,T3=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,C3=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,A3=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,D3=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,I3=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,R3=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N3=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,P3=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,O3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,L3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,F3=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,k3=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,U3=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,B3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ot={alphahash_fragment:aU,alphahash_pars_fragment:cU,alphamap_fragment:lU,alphamap_pars_fragment:uU,alphatest_fragment:dU,alphatest_pars_fragment:fU,aomap_fragment:hU,aomap_pars_fragment:pU,batching_pars_vertex:mU,batching_vertex:gU,begin_vertex:vU,beginnormal_vertex:yU,bsdfs:_U,iridescence_fragment:xU,bumpmap_pars_fragment:MU,clipping_planes_fragment:SU,clipping_planes_pars_fragment:bU,clipping_planes_pars_vertex:wU,clipping_planes_vertex:EU,color_fragment:TU,color_pars_fragment:CU,color_pars_vertex:AU,color_vertex:DU,common:IU,cube_uv_reflection_fragment:RU,defaultnormal_vertex:NU,displacementmap_pars_vertex:PU,displacementmap_vertex:OU,emissivemap_fragment:LU,emissivemap_pars_fragment:FU,colorspace_fragment:kU,colorspace_pars_fragment:UU,envmap_fragment:BU,envmap_common_pars_fragment:VU,envmap_pars_fragment:zU,envmap_pars_vertex:HU,envmap_physical_pars_fragment:QU,envmap_vertex:GU,fog_vertex:jU,fog_pars_vertex:WU,fog_fragment:$U,fog_pars_fragment:qU,gradientmap_pars_fragment:XU,lightmap_pars_fragment:YU,lights_lambert_fragment:ZU,lights_lambert_pars_fragment:KU,lights_pars_begin:JU,lights_toon_fragment:eB,lights_toon_pars_fragment:tB,lights_phong_fragment:nB,lights_phong_pars_fragment:iB,lights_physical_fragment:rB,lights_physical_pars_fragment:sB,lights_fragment_begin:oB,lights_fragment_maps:aB,lights_fragment_end:cB,logdepthbuf_fragment:lB,logdepthbuf_pars_fragment:uB,logdepthbuf_pars_vertex:dB,logdepthbuf_vertex:fB,map_fragment:hB,map_pars_fragment:pB,map_particle_fragment:mB,map_particle_pars_fragment:gB,metalnessmap_fragment:vB,metalnessmap_pars_fragment:yB,morphinstance_vertex:_B,morphcolor_vertex:xB,morphnormal_vertex:MB,morphtarget_pars_vertex:SB,morphtarget_vertex:bB,normal_fragment_begin:wB,normal_fragment_maps:EB,normal_pars_fragment:TB,normal_pars_vertex:CB,normal_vertex:AB,normalmap_pars_fragment:DB,clearcoat_normal_fragment_begin:IB,clearcoat_normal_fragment_maps:RB,clearcoat_pars_fragment:NB,iridescence_pars_fragment:PB,opaque_fragment:OB,packing:LB,premultiplied_alpha_fragment:FB,project_vertex:kB,dithering_fragment:UB,dithering_pars_fragment:BB,roughnessmap_fragment:VB,roughnessmap_pars_fragment:zB,shadowmap_pars_fragment:HB,shadowmap_pars_vertex:GB,shadowmap_vertex:jB,shadowmask_pars_fragment:WB,skinbase_vertex:$B,skinning_pars_vertex:qB,skinning_vertex:XB,skinnormal_vertex:YB,specularmap_fragment:ZB,specularmap_pars_fragment:KB,tonemapping_fragment:JB,tonemapping_pars_fragment:QB,transmission_fragment:e3,transmission_pars_fragment:t3,uv_pars_fragment:n3,uv_pars_vertex:i3,uv_vertex:r3,worldpos_vertex:s3,background_vert:o3,background_frag:a3,backgroundCube_vert:c3,backgroundCube_frag:l3,cube_vert:u3,cube_frag:d3,depth_vert:f3,depth_frag:h3,distanceRGBA_vert:p3,distanceRGBA_frag:m3,equirect_vert:g3,equirect_frag:v3,linedashed_vert:y3,linedashed_frag:_3,meshbasic_vert:x3,meshbasic_frag:M3,meshlambert_vert:S3,meshlambert_frag:b3,meshmatcap_vert:w3,meshmatcap_frag:E3,meshnormal_vert:T3,meshnormal_frag:C3,meshphong_vert:A3,meshphong_frag:D3,meshphysical_vert:I3,meshphysical_frag:R3,meshtoon_vert:N3,meshtoon_frag:P3,points_vert:O3,points_frag:L3,shadow_vert:F3,shadow_frag:k3,sprite_vert:U3,sprite_frag:B3},me={common:{diffuse:{value:new de(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new nt},alphaMap:{value:null},alphaMapTransform:{value:new nt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new nt}},envmap:{envMap:{value:null},envMapRotation:{value:new nt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new nt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new nt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new nt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new nt},normalScale:{value:new q(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new nt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new nt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new nt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new nt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new de(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new de(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new nt},alphaTest:{value:0},uvTransform:{value:new nt}},sprite:{diffuse:{value:new de(16777215)},opacity:{value:1},center:{value:new q(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new nt},alphaMap:{value:null},alphaMapTransform:{value:new nt},alphaTest:{value:0}}},rr={basic:{uniforms:kn([me.common,me.specularmap,me.envmap,me.aomap,me.lightmap,me.fog]),vertexShader:ot.meshbasic_vert,fragmentShader:ot.meshbasic_frag},lambert:{uniforms:kn([me.common,me.specularmap,me.envmap,me.aomap,me.lightmap,me.emissivemap,me.bumpmap,me.normalmap,me.displacementmap,me.fog,me.lights,{emissive:{value:new de(0)}}]),vertexShader:ot.meshlambert_vert,fragmentShader:ot.meshlambert_frag},phong:{uniforms:kn([me.common,me.specularmap,me.envmap,me.aomap,me.lightmap,me.emissivemap,me.bumpmap,me.normalmap,me.displacementmap,me.fog,me.lights,{emissive:{value:new de(0)},specular:{value:new de(1118481)},shininess:{value:30}}]),vertexShader:ot.meshphong_vert,fragmentShader:ot.meshphong_frag},standard:{uniforms:kn([me.common,me.envmap,me.aomap,me.lightmap,me.emissivemap,me.bumpmap,me.normalmap,me.displacementmap,me.roughnessmap,me.metalnessmap,me.fog,me.lights,{emissive:{value:new de(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ot.meshphysical_vert,fragmentShader:ot.meshphysical_frag},toon:{uniforms:kn([me.common,me.aomap,me.lightmap,me.emissivemap,me.bumpmap,me.normalmap,me.displacementmap,me.gradientmap,me.fog,me.lights,{emissive:{value:new de(0)}}]),vertexShader:ot.meshtoon_vert,fragmentShader:ot.meshtoon_frag},matcap:{uniforms:kn([me.common,me.bumpmap,me.normalmap,me.displacementmap,me.fog,{matcap:{value:null}}]),vertexShader:ot.meshmatcap_vert,fragmentShader:ot.meshmatcap_frag},points:{uniforms:kn([me.points,me.fog]),vertexShader:ot.points_vert,fragmentShader:ot.points_frag},dashed:{uniforms:kn([me.common,me.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ot.linedashed_vert,fragmentShader:ot.linedashed_frag},depth:{uniforms:kn([me.common,me.displacementmap]),vertexShader:ot.depth_vert,fragmentShader:ot.depth_frag},normal:{uniforms:kn([me.common,me.bumpmap,me.normalmap,me.displacementmap,{opacity:{value:1}}]),vertexShader:ot.meshnormal_vert,fragmentShader:ot.meshnormal_frag},sprite:{uniforms:kn([me.sprite,me.fog]),vertexShader:ot.sprite_vert,fragmentShader:ot.sprite_frag},background:{uniforms:{uvTransform:{value:new nt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ot.background_vert,fragmentShader:ot.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new nt}},vertexShader:ot.backgroundCube_vert,fragmentShader:ot.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ot.cube_vert,fragmentShader:ot.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ot.equirect_vert,fragmentShader:ot.equirect_frag},distanceRGBA:{uniforms:kn([me.common,me.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ot.distanceRGBA_vert,fragmentShader:ot.distanceRGBA_frag},shadow:{uniforms:kn([me.lights,me.fog,{color:{value:new de(0)},opacity:{value:1}}]),vertexShader:ot.shadow_vert,fragmentShader:ot.shadow_frag}};rr.physical={uniforms:kn([rr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new nt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new nt},clearcoatNormalScale:{value:new q(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new nt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new nt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new nt},sheen:{value:0},sheenColor:{value:new de(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new nt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new nt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new nt},transmissionSamplerSize:{value:new q},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new nt},attenuationDistance:{value:0},attenuationColor:{value:new de(0)},specularColor:{value:new de(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new nt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new nt},anisotropyVector:{value:new q},anisotropyMap:{value:null},anisotropyMapTransform:{value:new nt}}]),vertexShader:ot.meshphysical_vert,fragmentShader:ot.meshphysical_frag};var $h={r:0,b:0,g:0},No=new Er,V3=new Ve;function z3(i,e,t,n,r,s,o){let a=new de(0),c=s===!0?0:1,l,u,d=null,f=0,h=null;function p(_){let x=_.isScene===!0?_.background:null;return x&&x.isTexture&&(x=(_.backgroundBlurriness>0?t:e).get(x)),x}function v(_){let x=!1,y=p(_);y===null?m(a,c):y&&y.isColor&&(m(y,1),x=!0);let D=i.xr.getEnvironmentBlendMode();D==="additive"?n.buffers.color.setClear(0,0,0,1,o):D==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||x)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function g(_,x){let y=p(x);y&&(y.isCubeTexture||y.mapping===Wc)?(u===void 0&&(u=new Ft(new ia(1,1,1),new vi({name:"BackgroundCubeMaterial",uniforms:Dc(rr.backgroundCube.uniforms),vertexShader:rr.backgroundCube.vertexShader,fragmentShader:rr.backgroundCube.fragmentShader,side:Bn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(D,w,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),No.copy(x.backgroundRotation),No.x*=-1,No.y*=-1,No.z*=-1,y.isCubeTexture&&y.isRenderTargetTexture===!1&&(No.y*=-1,No.z*=-1),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(V3.makeRotationFromEuler(No)),u.material.toneMapped=it.getTransfer(y.colorSpace)!==It,(d!==y||f!==y.version||h!==i.toneMapping)&&(u.material.needsUpdate=!0,d=y,f=y.version,h=i.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(l===void 0&&(l=new Ft(new Rc(2,2),new vi({name:"BackgroundMaterial",uniforms:Dc(rr.background.uniforms),vertexShader:rr.background.vertexShader,fragmentShader:rr.background.fragmentShader,side:or,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,l.material.toneMapped=it.getTransfer(y.colorSpace)!==It,y.matrixAutoUpdate===!0&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||f!==y.version||h!==i.toneMapping)&&(l.material.needsUpdate=!0,d=y,f=y.version,h=i.toneMapping),l.layers.enableAll(),_.unshift(l,l.geometry,l.material,0,0,null))}function m(_,x){_.getRGB($h,eI(i)),n.buffers.color.setClear($h.r,$h.g,$h.b,x,o)}return{getClearColor:function(){return a},setClearColor:function(_,x=1){a.set(_),c=x,m(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(_){c=_,m(a,c)},render:v,addToRenderList:g}}function H3(i,e){let t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=f(null),s=r,o=!1;function a(M,R,B,k,j){let Y=!1,V=d(k,B,R);s!==V&&(s=V,l(s.object)),Y=h(M,k,B,j),Y&&p(M,k,B,j),j!==null&&e.update(j,i.ELEMENT_ARRAY_BUFFER),(Y||o)&&(o=!1,y(M,R,B,k),j!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(j).buffer))}function c(){return i.createVertexArray()}function l(M){return i.bindVertexArray(M)}function u(M){return i.deleteVertexArray(M)}function d(M,R,B){let k=B.wireframe===!0,j=n[M.id];j===void 0&&(j={},n[M.id]=j);let Y=j[R.id];Y===void 0&&(Y={},j[R.id]=Y);let V=Y[k];return V===void 0&&(V=f(c()),Y[k]=V),V}function f(M){let R=[],B=[],k=[];for(let j=0;j<t;j++)R[j]=0,B[j]=0,k[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:R,enabledAttributes:B,attributeDivisors:k,object:M,attributes:{},index:null}}function h(M,R,B,k){let j=s.attributes,Y=R.attributes,V=0,$=B.getAttributes();for(let z in $)if($[z].location>=0){let ge=j[z],we=Y[z];if(we===void 0&&(z==="instanceMatrix"&&M.instanceMatrix&&(we=M.instanceMatrix),z==="instanceColor"&&M.instanceColor&&(we=M.instanceColor)),ge===void 0||ge.attribute!==we||we&&ge.data!==we.data)return!0;V++}return s.attributesNum!==V||s.index!==k}function p(M,R,B,k){let j={},Y=R.attributes,V=0,$=B.getAttributes();for(let z in $)if($[z].location>=0){let ge=Y[z];ge===void 0&&(z==="instanceMatrix"&&M.instanceMatrix&&(ge=M.instanceMatrix),z==="instanceColor"&&M.instanceColor&&(ge=M.instanceColor));let we={};we.attribute=ge,ge&&ge.data&&(we.data=ge.data),j[z]=we,V++}s.attributes=j,s.attributesNum=V,s.index=k}function v(){let M=s.newAttributes;for(let R=0,B=M.length;R<B;R++)M[R]=0}function g(M){m(M,0)}function m(M,R){let B=s.newAttributes,k=s.enabledAttributes,j=s.attributeDivisors;B[M]=1,k[M]===0&&(i.enableVertexAttribArray(M),k[M]=1),j[M]!==R&&(i.vertexAttribDivisor(M,R),j[M]=R)}function _(){let M=s.newAttributes,R=s.enabledAttributes;for(let B=0,k=R.length;B<k;B++)R[B]!==M[B]&&(i.disableVertexAttribArray(B),R[B]=0)}function x(M,R,B,k,j,Y,V){V===!0?i.vertexAttribIPointer(M,R,B,j,Y):i.vertexAttribPointer(M,R,B,k,j,Y)}function y(M,R,B,k){v();let j=k.attributes,Y=B.getAttributes(),V=R.defaultAttributeValues;for(let $ in Y){let z=Y[$];if(z.location>=0){let ce=j[$];if(ce===void 0&&($==="instanceMatrix"&&M.instanceMatrix&&(ce=M.instanceMatrix),$==="instanceColor"&&M.instanceColor&&(ce=M.instanceColor)),ce!==void 0){let ge=ce.normalized,we=ce.itemSize,Je=e.get(ce);if(Je===void 0)continue;let Mt=Je.buffer,J=Je.type,le=Je.bytesPerElement,Ae=J===i.INT||J===i.UNSIGNED_INT||ce.gpuType===sg;if(ce.isInterleavedBufferAttribute){let fe=ce.data,Be=fe.stride,Ze=ce.offset;if(fe.isInstancedInterleavedBuffer){for(let $e=0;$e<z.locationSize;$e++)m(z.location+$e,fe.meshPerAttribute);M.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let $e=0;$e<z.locationSize;$e++)g(z.location+$e);i.bindBuffer(i.ARRAY_BUFFER,Mt);for(let $e=0;$e<z.locationSize;$e++)x(z.location+$e,we/z.locationSize,J,ge,Be*le,(Ze+we/z.locationSize*$e)*le,Ae)}else{if(ce.isInstancedBufferAttribute){for(let fe=0;fe<z.locationSize;fe++)m(z.location+fe,ce.meshPerAttribute);M.isInstancedMesh!==!0&&k._maxInstanceCount===void 0&&(k._maxInstanceCount=ce.meshPerAttribute*ce.count)}else for(let fe=0;fe<z.locationSize;fe++)g(z.location+fe);i.bindBuffer(i.ARRAY_BUFFER,Mt);for(let fe=0;fe<z.locationSize;fe++)x(z.location+fe,we/z.locationSize,J,ge,we*le,we/z.locationSize*fe*le,Ae)}}else if(V!==void 0){let ge=V[$];if(ge!==void 0)switch(ge.length){case 2:i.vertexAttrib2fv(z.location,ge);break;case 3:i.vertexAttrib3fv(z.location,ge);break;case 4:i.vertexAttrib4fv(z.location,ge);break;default:i.vertexAttrib1fv(z.location,ge)}}}}_()}function D(){C();for(let M in n){let R=n[M];for(let B in R){let k=R[B];for(let j in k)u(k[j].object),delete k[j];delete R[B]}delete n[M]}}function w(M){if(n[M.id]===void 0)return;let R=n[M.id];for(let B in R){let k=R[B];for(let j in k)u(k[j].object),delete k[j];delete R[B]}delete n[M.id]}function E(M){for(let R in n){let B=n[R];if(B[M.id]===void 0)continue;let k=B[M.id];for(let j in k)u(k[j].object),delete k[j];delete B[M.id]}}function C(){S(),o=!0,s!==r&&(s=r,l(s.object))}function S(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:C,resetDefaultState:S,dispose:D,releaseStatesOfGeometry:w,releaseStatesOfProgram:E,initAttributes:v,enableAttribute:g,disableUnusedAttributes:_}}function G3(i,e,t){let n;function r(l){n=l}function s(l,u){i.drawArrays(n,l,u),t.update(u,n,1)}function o(l,u,d){d!==0&&(i.drawArraysInstanced(n,l,u,d),t.update(u,n,d))}function a(l,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,l,0,u,0,d);let h=0;for(let p=0;p<d;p++)h+=u[p];t.update(h,n,1)}function c(l,u,d,f){if(d===0)return;let h=e.get("WEBGL_multi_draw");if(h===null)for(let p=0;p<l.length;p++)o(l[p],u[p],f[p]);else{h.multiDrawArraysInstancedWEBGL(n,l,0,u,0,f,0,d);let p=0;for(let v=0;v<d;v++)p+=u[v]*f[v];t.update(p,n,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=c}function j3(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(E){return!(E!==En&&n.convert(E)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(E){let C=E===$c&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(E!==ki&&n.convert(E)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&E!==ti&&!C)}function c(E){if(E==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=t.precision!==void 0?t.precision:"highp",u=c(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);let d=t.logarithmicDepthBuffer===!0,f=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),h=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),p=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=i.getParameter(i.MAX_TEXTURE_SIZE),g=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),m=i.getParameter(i.MAX_VERTEX_ATTRIBS),_=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),x=i.getParameter(i.MAX_VARYING_VECTORS),y=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),D=p>0,w=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:o,textureTypeReadable:a,precision:l,logarithmicDepthBuffer:d,reverseDepthBuffer:f,maxTextures:h,maxVertexTextures:p,maxTextureSize:v,maxCubemapSize:g,maxAttributes:m,maxVertexUniforms:_,maxVaryings:x,maxFragmentUniforms:y,vertexTextures:D,maxSamples:w}}function W3(i){let e=this,t=null,n=0,r=!1,s=!1,o=new Oi,a=new nt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,f){let h=d.length!==0||f||n!==0||r;return r=f,n=d.length,h},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,f){t=u(d,f,0)},this.setState=function(d,f,h){let p=d.clippingPlanes,v=d.clipIntersection,g=d.clipShadows,m=i.get(d);if(!r||p===null||p.length===0||s&&!g)s?u(null):l();else{let _=s?0:n,x=_*4,y=m.clippingState||null;c.value=y,y=u(p,f,x,h);for(let D=0;D!==x;++D)y[D]=t[D];m.clippingState=y,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=_}};function l(){c.value!==t&&(c.value=t,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(d,f,h,p){let v=d!==null?d.length:0,g=null;if(v!==0){if(g=c.value,p!==!0||g===null){let m=h+v*4,_=f.matrixWorldInverse;a.getNormalMatrix(_),(g===null||g.length<m)&&(g=new Float32Array(m));for(let x=0,y=h;x!==v;++x,y+=4)o.copy(d[x]).applyMatrix4(_,a),o.normal.toArray(g,y),g[y+3]=o.constant}c.value=g,c.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function $3(i){let e=new WeakMap;function t(o,a){return a===Su?o.mapping=os:a===bu&&(o.mapping=Ks),o}function n(o){if(o&&o.isTexture){let a=o.mapping;if(a===Su||a===bu)if(e.has(o)){let c=e.get(o).texture;return t(c,o.mapping)}else{let c=o.image;if(c&&c.height>0){let l=new om(c.height);return l.fromEquirectangularTexture(i,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}var ii=class extends Ic{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=n-e,o=n+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Sc=4,ZC=[.125,.215,.35,.446,.526,.582],Go=20,t0=new ii,KC=new de,n0=null,i0=0,r0=0,s0=!1,Ho=(1+Math.sqrt(5))/2,mc=1/Ho,JC=[new A(-Ho,mc,0),new A(Ho,mc,0),new A(-mc,0,Ho),new A(mc,0,Ho),new A(0,Ho,-mc),new A(0,Ho,mc),new A(-1,1,-1),new A(1,1,-1),new A(-1,1,1),new A(1,1,1)],Ru=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){n0=this._renderer.getRenderTarget(),i0=this._renderer.getActiveCubeFace(),r0=this._renderer.getActiveMipmapLevel(),s0=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=tA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=eA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(n0,i0,r0),this._renderer.xr.enabled=s0,e.scissorTest=!1,qh(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===os||e.mapping===Ks?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),n0=this._renderer.getRenderTarget(),i0=this._renderer.getActiveCubeFace(),r0=this._renderer.getActiveMipmapLevel(),s0=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Ht,minFilter:Ht,generateMipmaps:!1,type:$c,format:En,colorSpace:Tn,depthBuffer:!1},r=QC(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=QC(e,t,n);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=q3(s)),this._blurMaterial=X3(s,e,t)}return r}_compileMaterial(e){let t=new Ft(this._lodPlanes[0],e);this._renderer.compile(t,t0)}_sceneToCubeUV(e,t,n,r){let a=new Ot(90,1,t,n),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,f=u.toneMapping;u.getClearColor(KC),u.toneMapping=sr,u.autoClear=!1;let h=new In({name:"PMREM.Background",side:Bn,depthWrite:!1,depthTest:!1}),p=new Ft(new ia,h),v=!1,g=e.background;g?g.isColor&&(h.color.copy(g),e.background=null,v=!0):(h.color.copy(KC),v=!0);for(let m=0;m<6;m++){let _=m%3;_===0?(a.up.set(0,c[m],0),a.lookAt(l[m],0,0)):_===1?(a.up.set(0,0,c[m]),a.lookAt(0,l[m],0)):(a.up.set(0,c[m],0),a.lookAt(0,0,l[m]));let x=this._cubeSize;qh(r,_*x,m>2?x:0,x,x),u.setRenderTarget(r),v&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=f,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===os||e.mapping===Ks;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=tA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=eA());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new Ft(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let c=this._cubeSize;qh(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(o,t0)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let r=this._lodPlanes.length;for(let s=1;s<r;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=JC[(r-s-1)%JC.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){let c=this._renderer,l=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,d=new Ft(this._lodPlanes[r],l),f=l.uniforms,h=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*h):2*Math.PI/(2*Go-1),v=s/p,g=isFinite(s)?1+Math.floor(u*v):Go;g>Go&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Go}`);let m=[],_=0;for(let E=0;E<Go;++E){let C=E/v,S=Math.exp(-C*C/2);m.push(S),E===0?_+=S:E<g&&(_+=2*S)}for(let E=0;E<m.length;E++)m[E]=m[E]/_;f.envMap.value=e.texture,f.samples.value=g,f.weights.value=m,f.latitudinal.value=o==="latitudinal",a&&(f.poleAxis.value=a);let{_lodMax:x}=this;f.dTheta.value=p,f.mipInt.value=x-n;let y=this._sizeLods[r],D=3*y*(r>x-Sc?r-x+Sc:0),w=4*(this._cubeSize-y);qh(t,D,w,3*y,2*y),c.setRenderTarget(t),c.render(d,t0)}};function q3(i){let e=[],t=[],n=[],r=i,s=i-Sc+1+ZC.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);t.push(a);let c=1/a;o>i-Sc?c=ZC[o-i+Sc-1]:o===0&&(c=0),n.push(c);let l=1/(a-2),u=-l,d=1+l,f=[u,u,d,u,d,d,u,u,d,d,u,d],h=6,p=6,v=3,g=2,m=1,_=new Float32Array(v*p*h),x=new Float32Array(g*p*h),y=new Float32Array(m*p*h);for(let w=0;w<h;w++){let E=w%3*2/3-1,C=w>2?0:-1,S=[E,C,0,E+2/3,C,0,E+2/3,C+1,0,E,C,0,E+2/3,C+1,0,E,C+1,0];_.set(S,v*p*w),x.set(f,g*p*w);let M=[w,w,w,w,w,w];y.set(M,m*p*w)}let D=new et;D.setAttribute("position",new xt(_,v)),D.setAttribute("uv",new xt(x,g)),D.setAttribute("faceIndex",new xt(y,m)),e.push(D),r>Sc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function QC(i,e,t){let n=new gi(i,e,t);return n.texture.mapping=Wc,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function qh(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function X3(i,e,t){let n=new Float32Array(Go),r=new A(0,1,0);return new vi({name:"SphericalGaussianBlur",defines:{n:Go,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:rM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:is,depthTest:!1,depthWrite:!1})}function eA(){return new vi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:rM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:is,depthTest:!1,depthWrite:!1})}function tA(){return new vi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:rM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:is,depthTest:!1,depthWrite:!1})}function rM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Y3(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){let c=a.mapping,l=c===Su||c===bu,u=c===os||c===Ks;if(l||u){let d=e.get(a),f=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==f)return t===null&&(t=new Ru(i)),d=l?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{let h=a.image;return l&&h&&h.height>0||u&&h&&r(h)?(t===null&&(t=new Ru(i)),d=l?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let c=0,l=6;for(let u=0;u<l;u++)a[u]!==void 0&&c++;return c===l}function s(a){let c=a.target;c.removeEventListener("dispose",s);let l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function Z3(i){let e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){let r=t(n);return r===null&&uu("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function K3(i,e,t,n){let r={},s=new WeakMap;function o(d){let f=d.target;f.index!==null&&e.remove(f.index);for(let p in f.attributes)e.remove(f.attributes[p]);for(let p in f.morphAttributes){let v=f.morphAttributes[p];for(let g=0,m=v.length;g<m;g++)e.remove(v[g])}f.removeEventListener("dispose",o),delete r[f.id];let h=s.get(f);h&&(e.remove(h),s.delete(f)),n.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,t.memory.geometries--}function a(d,f){return r[f.id]===!0||(f.addEventListener("dispose",o),r[f.id]=!0,t.memory.geometries++),f}function c(d){let f=d.attributes;for(let p in f)e.update(f[p],i.ARRAY_BUFFER);let h=d.morphAttributes;for(let p in h){let v=h[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],i.ARRAY_BUFFER)}}function l(d){let f=[],h=d.index,p=d.attributes.position,v=0;if(h!==null){let _=h.array;v=h.version;for(let x=0,y=_.length;x<y;x+=3){let D=_[x+0],w=_[x+1],E=_[x+2];f.push(D,w,w,E,E,D)}}else if(p!==void 0){let _=p.array;v=p.version;for(let x=0,y=_.length/3-1;x<y;x+=3){let D=x+0,w=x+1,E=x+2;f.push(D,w,w,E,E,D)}}else return;let g=new(KD(f)?Iu:Du)(f,1);g.version=v;let m=s.get(d);m&&e.remove(m),s.set(d,g)}function u(d){let f=s.get(d);if(f){let h=d.index;h!==null&&f.version<h.version&&l(d)}else l(d);return s.get(d)}return{get:a,update:c,getWireframeAttribute:u}}function J3(i,e,t){let n;function r(f){n=f}let s,o;function a(f){s=f.type,o=f.bytesPerElement}function c(f,h){i.drawElements(n,h,s,f*o),t.update(h,n,1)}function l(f,h,p){p!==0&&(i.drawElementsInstanced(n,h,s,f*o,p),t.update(h,n,p))}function u(f,h,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,h,0,s,f,0,p);let g=0;for(let m=0;m<p;m++)g+=h[m];t.update(g,n,1)}function d(f,h,p,v){if(p===0)return;let g=e.get("WEBGL_multi_draw");if(g===null)for(let m=0;m<f.length;m++)l(f[m]/o,h[m],v[m]);else{g.multiDrawElementsInstancedWEBGL(n,h,0,s,f,0,v,0,p);let m=0;for(let _=0;_<p;_++)m+=h[_]*v[_];t.update(m,n,1)}}this.setMode=r,this.setIndex=a,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function Q3(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=a*(s/3);break;case i.LINES:t.lines+=a*(s/2);break;case i.LINE_STRIP:t.lines+=a*(s-1);break;case i.LINE_LOOP:t.lines+=a*s;break;case i.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function eV(i,e,t){let n=new WeakMap,r=new _t;function s(o,a,c){let l=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=u!==void 0?u.length:0,f=n.get(a);if(f===void 0||f.count!==d){let M=function(){C.dispose(),n.delete(a),a.removeEventListener("dispose",M)};var h=M;f!==void 0&&f.texture.dispose();let p=a.morphAttributes.position!==void 0,v=a.morphAttributes.normal!==void 0,g=a.morphAttributes.color!==void 0,m=a.morphAttributes.position||[],_=a.morphAttributes.normal||[],x=a.morphAttributes.color||[],y=0;p===!0&&(y=1),v===!0&&(y=2),g===!0&&(y=3);let D=a.attributes.position.count*y,w=1;D>e.maxTextureSize&&(w=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);let E=new Float32Array(D*w*4*d),C=new Ac(E,D,w,d);C.type=ti,C.needsUpdate=!0;let S=y*4;for(let R=0;R<d;R++){let B=m[R],k=_[R],j=x[R],Y=D*w*4*R;for(let V=0;V<B.count;V++){let $=V*S;p===!0&&(r.fromBufferAttribute(B,V),E[Y+$+0]=r.x,E[Y+$+1]=r.y,E[Y+$+2]=r.z,E[Y+$+3]=0),v===!0&&(r.fromBufferAttribute(k,V),E[Y+$+4]=r.x,E[Y+$+5]=r.y,E[Y+$+6]=r.z,E[Y+$+7]=0),g===!0&&(r.fromBufferAttribute(j,V),E[Y+$+8]=r.x,E[Y+$+9]=r.y,E[Y+$+10]=r.z,E[Y+$+11]=j.itemSize===4?r.w:1)}}f={count:d,texture:C,size:new q(D,w)},n.set(a,f),a.addEventListener("dispose",M)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)c.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let p=0;for(let g=0;g<l.length;g++)p+=l[g];let v=a.morphTargetsRelative?1:1-p;c.getUniforms().setValue(i,"morphTargetBaseInfluence",v),c.getUniforms().setValue(i,"morphTargetInfluences",l)}c.getUniforms().setValue(i,"morphTargetsTexture",f.texture,t),c.getUniforms().setValue(i,"morphTargetsTextureSize",f.size)}return{update:s}}function tV(i,e,t,n){let r=new WeakMap;function s(c){let l=n.render.frame,u=c.geometry,d=e.get(c,u);if(r.get(d)!==l&&(e.update(d),r.set(d,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,i.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,i.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){let f=c.skeleton;r.get(f)!==l&&(f.update(),r.set(f,l))}return d}function o(){r=new WeakMap}function a(c){let l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:s,dispose:o}}var Nu=class extends cn{constructor(e,t,n,r,s,o,a,c,l,u=Yo){if(u!==Yo&&u!==ea)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===Yo&&(n=cs),n===void 0&&u===ea&&(n=Qo),super(null,r,s,o,a,c,u,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:on,this.minFilter=c!==void 0?c:on,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},iI=new cn,nA=new Nu(1,1),rI=new Ac,sI=new Au,oI=new ra,iA=[],rA=[],sA=new Float32Array(16),oA=new Float32Array(9),aA=new Float32Array(4);function Xc(i,e,t){let n=i[0];if(n<=0||n>0)return i;let r=e*t,s=iA[r];if(s===void 0&&(s=new Float32Array(r),iA[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function pn(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function mn(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function fg(i,e){let t=rA[e];t===void 0&&(t=new Int32Array(e),rA[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function nV(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function iV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(pn(t,e))return;i.uniform2fv(this.addr,e),mn(t,e)}}function rV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(pn(t,e))return;i.uniform3fv(this.addr,e),mn(t,e)}}function sV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(pn(t,e))return;i.uniform4fv(this.addr,e),mn(t,e)}}function oV(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(pn(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),mn(t,e)}else{if(pn(t,n))return;aA.set(n),i.uniformMatrix2fv(this.addr,!1,aA),mn(t,n)}}function aV(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(pn(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),mn(t,e)}else{if(pn(t,n))return;oA.set(n),i.uniformMatrix3fv(this.addr,!1,oA),mn(t,n)}}function cV(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(pn(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),mn(t,e)}else{if(pn(t,n))return;sA.set(n),i.uniformMatrix4fv(this.addr,!1,sA),mn(t,n)}}function lV(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function uV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(pn(t,e))return;i.uniform2iv(this.addr,e),mn(t,e)}}function dV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(pn(t,e))return;i.uniform3iv(this.addr,e),mn(t,e)}}function fV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(pn(t,e))return;i.uniform4iv(this.addr,e),mn(t,e)}}function hV(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function pV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(pn(t,e))return;i.uniform2uiv(this.addr,e),mn(t,e)}}function mV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(pn(t,e))return;i.uniform3uiv(this.addr,e),mn(t,e)}}function gV(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(pn(t,e))return;i.uniform4uiv(this.addr,e),mn(t,e)}}function vV(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(nA.compareFunction=nM,s=nA):s=iI,t.setTexture2D(e||s,r)}function yV(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||sI,r)}function _V(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||oI,r)}function xV(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||rI,r)}function MV(i){switch(i){case 5126:return nV;case 35664:return iV;case 35665:return rV;case 35666:return sV;case 35674:return oV;case 35675:return aV;case 35676:return cV;case 5124:case 35670:return lV;case 35667:case 35671:return uV;case 35668:case 35672:return dV;case 35669:case 35673:return fV;case 5125:return hV;case 36294:return pV;case 36295:return mV;case 36296:return gV;case 35678:case 36198:case 36298:case 36306:case 35682:return vV;case 35679:case 36299:case 36307:return yV;case 35680:case 36300:case 36308:case 36293:return _V;case 36289:case 36303:case 36311:case 36292:return xV}}function SV(i,e){i.uniform1fv(this.addr,e)}function bV(i,e){let t=Xc(e,this.size,2);i.uniform2fv(this.addr,t)}function wV(i,e){let t=Xc(e,this.size,3);i.uniform3fv(this.addr,t)}function EV(i,e){let t=Xc(e,this.size,4);i.uniform4fv(this.addr,t)}function TV(i,e){let t=Xc(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function CV(i,e){let t=Xc(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function AV(i,e){let t=Xc(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function DV(i,e){i.uniform1iv(this.addr,e)}function IV(i,e){i.uniform2iv(this.addr,e)}function RV(i,e){i.uniform3iv(this.addr,e)}function NV(i,e){i.uniform4iv(this.addr,e)}function PV(i,e){i.uniform1uiv(this.addr,e)}function OV(i,e){i.uniform2uiv(this.addr,e)}function LV(i,e){i.uniform3uiv(this.addr,e)}function FV(i,e){i.uniform4uiv(this.addr,e)}function kV(i,e,t){let n=this.cache,r=e.length,s=fg(t,r);pn(n,s)||(i.uniform1iv(this.addr,s),mn(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||iI,s[o])}function UV(i,e,t){let n=this.cache,r=e.length,s=fg(t,r);pn(n,s)||(i.uniform1iv(this.addr,s),mn(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||sI,s[o])}function BV(i,e,t){let n=this.cache,r=e.length,s=fg(t,r);pn(n,s)||(i.uniform1iv(this.addr,s),mn(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||oI,s[o])}function VV(i,e,t){let n=this.cache,r=e.length,s=fg(t,r);pn(n,s)||(i.uniform1iv(this.addr,s),mn(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||rI,s[o])}function zV(i){switch(i){case 5126:return SV;case 35664:return bV;case 35665:return wV;case 35666:return EV;case 35674:return TV;case 35675:return CV;case 35676:return AV;case 5124:case 35670:return DV;case 35667:case 35671:return IV;case 35668:case 35672:return RV;case 35669:case 35673:return NV;case 5125:return PV;case 36294:return OV;case 36295:return LV;case 36296:return FV;case 35678:case 36198:case 36298:case 36306:case 35682:return kV;case 35679:case 36299:case 36307:return UV;case 35680:case 36300:case 36308:case 36293:return BV;case 36289:case 36303:case 36311:case 36292:return VV}}var k0=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=MV(t.type)}},U0=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=zV(t.type)}},B0=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,t[a.id],n)}}},o0=/(\w+)(\])?(\[|\.)?/g;function cA(i,e){i.seq.push(e),i.map[e.id]=e}function HV(i,e,t){let n=i.name,r=n.length;for(o0.lastIndex=0;;){let s=o0.exec(n),o=o0.lastIndex,a=s[1],c=s[2]==="]",l=s[3];if(c&&(a=a|0),l===void 0||l==="["&&o+2===r){cA(t,l===void 0?new k0(a,i,e):new U0(a,i,e));break}else{let d=t.map[a];d===void 0&&(d=new B0(a),cA(t,d)),t=d}}}var Ec=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){let s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);HV(s,o,this)}}setValue(e,t,n,r){let s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){let r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){let a=t[s],c=n[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){let n=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in t&&n.push(o)}return n}};function lA(i,e,t){let n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}var GV=37297,jV=0;function WV(i,e){let t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}var uA=new nt;function $V(i){it._getMatrix(uA,it.workingColorSpace,i);let e=`mat3( ${uA.elements.map(t=>t.toFixed(4))} )`;switch(it.getTransfer(i)){case od:return[e,"LinearTransferOETF"];case It:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function dA(i,e,t){let n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+WV(i.getShaderSource(e),o)}else return r}function qV(i,e){let t=$V(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function XV(i,e){let t;switch(e){case RD:t="Linear";break;case ND:t="Reinhard";break;case PD:t="Cineon";break;case rg:t="ACESFilmic";break;case LD:t="AgX";break;case FD:t="Neutral";break;case OD:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}var Xh=new A;function YV(){it.getLuminanceCoefficients(Xh);let i=Xh.x.toFixed(4),e=Xh.y.toFixed(4),t=Xh.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function ZV(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(fu).join(`
`)}function KV(i){let e=[];for(let t in i){let n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function JV(i,e){let t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let s=i.getActiveAttrib(e,r),o=s.name,a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function fu(i){return i!==""}function fA(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function hA(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var QV=/^[ \t]*#include +<([\w\d./]+)>/gm;function V0(i){return i.replace(QV,tz)}var ez=new Map;function tz(i,e){let t=ot[e];if(t===void 0){let n=ez.get(e);if(n!==void 0)t=ot[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return V0(t)}var nz=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pA(i){return i.replace(nz,iz)}function iz(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function mA(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function rz(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===td?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===jc?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===Pi&&(e="SHADOWMAP_TYPE_VSM"),e}function sz(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case os:case Ks:e="ENVMAP_TYPE_CUBE";break;case Wc:e="ENVMAP_TYPE_CUBE_UV";break}return e}function oz(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case Ks:e="ENVMAP_MODE_REFRACTION";break}return e}function az(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case nd:e="ENVMAP_BLENDING_MULTIPLY";break;case DD:e="ENVMAP_BLENDING_MIX";break;case ID:e="ENVMAP_BLENDING_ADD";break}return e}function cz(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function lz(i,e,t,n){let r=i.getContext(),s=t.defines,o=t.vertexShader,a=t.fragmentShader,c=rz(t),l=sz(t),u=oz(t),d=az(t),f=cz(t),h=ZV(t),p=KV(s),v=r.createProgram(),g,m,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(fu).join(`
`),g.length>0&&(g+=`
`),m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(fu).join(`
`),m.length>0&&(m+=`
`)):(g=[mA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(fu).join(`
`),m=[mA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==sr?"#define TONE_MAPPING":"",t.toneMapping!==sr?ot.tonemapping_pars_fragment:"",t.toneMapping!==sr?XV("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ot.colorspace_pars_fragment,qV("linearToOutputTexel",t.outputColorSpace),YV(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(fu).join(`
`)),o=V0(o),o=fA(o,t),o=hA(o,t),a=V0(a),a=fA(a,t),a=hA(a,t),o=pA(o),a=pA(a),t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,g=[h,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",t.glslVersion===A0?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===A0?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);let x=_+g+o,y=_+m+a,D=lA(r,r.VERTEX_SHADER,x),w=lA(r,r.FRAGMENT_SHADER,y);r.attachShader(v,D),r.attachShader(v,w),t.index0AttributeName!==void 0?r.bindAttribLocation(v,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v);function E(R){if(i.debug.checkShaderErrors){let B=r.getProgramInfoLog(v).trim(),k=r.getShaderInfoLog(D).trim(),j=r.getShaderInfoLog(w).trim(),Y=!0,V=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(Y=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,v,D,w);else{let $=dA(r,D,"vertex"),z=dA(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+`

Material Name: `+R.name+`
Material Type: `+R.type+`

Program Info Log: `+B+`
`+$+`
`+z)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):(k===""||j==="")&&(V=!1);V&&(R.diagnostics={runnable:Y,programLog:B,vertexShader:{log:k,prefix:g},fragmentShader:{log:j,prefix:m}})}r.deleteShader(D),r.deleteShader(w),C=new Ec(r,v),S=JV(r,v)}let C;this.getUniforms=function(){return C===void 0&&E(this),C};let S;this.getAttributes=function(){return S===void 0&&E(this),S};let M=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return M===!1&&(M=r.getProgramParameter(v,GV)),M},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=jV++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=D,this.fragmentShader=w,this}var uz=0,z0=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new H0(e),t.set(e,n)),n}},H0=class{constructor(e){this.id=uz++,this.code=e,this.usedTimes=0}};function dz(i,e,t,n,r,s,o){let a=new Tr,c=new z0,l=new Set,u=[],d=r.logarithmicDepthBuffer,f=r.vertexTextures,h=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(S){return l.add(S),S===0?"uv":`uv${S}`}function g(S,M,R,B,k){let j=B.fog,Y=k.geometry,V=S.isMeshStandardMaterial?B.environment:null,$=(S.isMeshStandardMaterial?t:e).get(S.envMap||V),z=$&&$.mapping===Wc?$.image.height:null,ce=p[S.type];S.precision!==null&&(h=r.getMaxPrecision(S.precision),h!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",h,"instead."));let ge=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,we=ge!==void 0?ge.length:0,Je=0;Y.morphAttributes.position!==void 0&&(Je=1),Y.morphAttributes.normal!==void 0&&(Je=2),Y.morphAttributes.color!==void 0&&(Je=3);let Mt,J,le,Ae;if(ce){let mt=rr[ce];Mt=mt.vertexShader,J=mt.fragmentShader}else Mt=S.vertexShader,J=S.fragmentShader,c.update(S),le=c.getVertexShaderID(S),Ae=c.getFragmentShaderID(S);let fe=i.getRenderTarget(),Be=i.state.buffers.depth.getReversed(),Ze=k.isInstancedMesh===!0,$e=k.isBatchedMesh===!0,pt=!!S.map,te=!!S.matcap,ae=!!$,N=!!S.aoMap,Ie=!!S.lightMap,re=!!S.bumpMap,Me=!!S.normalMap,he=!!S.displacementMap,He=!!S.emissiveMap,Se=!!S.metalnessMap,I=!!S.roughnessMap,b=S.anisotropy>0,U=S.clearcoat>0,X=S.dispersion>0,ne=S.iridescence>0,K=S.sheen>0,De=S.transmission>0,pe=b&&!!S.anisotropyMap,be=U&&!!S.clearcoatMap,lt=U&&!!S.clearcoatNormalMap,se=U&&!!S.clearcoatRoughnessMap,Te=ne&&!!S.iridescenceMap,We=ne&&!!S.iridescenceThicknessMap,Xe=K&&!!S.sheenColorMap,Ee=K&&!!S.sheenRoughnessMap,O=!!S.specularMap,Z=!!S.specularColorMap,ve=!!S.specularIntensityMap,P=De&&!!S.transmissionMap,oe=De&&!!S.thicknessMap,W=!!S.gradientMap,Q=!!S.alphaMap,_e=S.alphaTest>0,ye=!!S.alphaHash,Ge=!!S.extensions,wt=sr;S.toneMapped&&(fe===null||fe.isXRRenderTarget===!0)&&(wt=i.toneMapping);let Gt={shaderID:ce,shaderType:S.type,shaderName:S.name,vertexShader:Mt,fragmentShader:J,defines:S.defines,customVertexShaderID:le,customFragmentShaderID:Ae,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:h,batching:$e,batchingColor:$e&&k._colorsTexture!==null,instancing:Ze,instancingColor:Ze&&k.instanceColor!==null,instancingMorph:Ze&&k.morphTexture!==null,supportsVertexTextures:f,outputColorSpace:fe===null?i.outputColorSpace:fe.isXRRenderTarget===!0?fe.texture.colorSpace:Tn,alphaToCoverage:!!S.alphaToCoverage,map:pt,matcap:te,envMap:ae,envMapMode:ae&&$.mapping,envMapCubeUVHeight:z,aoMap:N,lightMap:Ie,bumpMap:re,normalMap:Me,displacementMap:f&&he,emissiveMap:He,normalMapObjectSpace:Me&&S.normalMapType===GD,normalMapTangentSpace:Me&&S.normalMapType===no,metalnessMap:Se,roughnessMap:I,anisotropy:b,anisotropyMap:pe,clearcoat:U,clearcoatMap:be,clearcoatNormalMap:lt,clearcoatRoughnessMap:se,dispersion:X,iridescence:ne,iridescenceMap:Te,iridescenceThicknessMap:We,sheen:K,sheenColorMap:Xe,sheenRoughnessMap:Ee,specularMap:O,specularColorMap:Z,specularIntensityMap:ve,transmission:De,transmissionMap:P,thicknessMap:oe,gradientMap:W,opaque:S.transparent===!1&&S.blending===qo&&S.alphaToCoverage===!1,alphaMap:Q,alphaTest:_e,alphaHash:ye,combine:S.combine,mapUv:pt&&v(S.map.channel),aoMapUv:N&&v(S.aoMap.channel),lightMapUv:Ie&&v(S.lightMap.channel),bumpMapUv:re&&v(S.bumpMap.channel),normalMapUv:Me&&v(S.normalMap.channel),displacementMapUv:he&&v(S.displacementMap.channel),emissiveMapUv:He&&v(S.emissiveMap.channel),metalnessMapUv:Se&&v(S.metalnessMap.channel),roughnessMapUv:I&&v(S.roughnessMap.channel),anisotropyMapUv:pe&&v(S.anisotropyMap.channel),clearcoatMapUv:be&&v(S.clearcoatMap.channel),clearcoatNormalMapUv:lt&&v(S.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:se&&v(S.clearcoatRoughnessMap.channel),iridescenceMapUv:Te&&v(S.iridescenceMap.channel),iridescenceThicknessMapUv:We&&v(S.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&v(S.sheenColorMap.channel),sheenRoughnessMapUv:Ee&&v(S.sheenRoughnessMap.channel),specularMapUv:O&&v(S.specularMap.channel),specularColorMapUv:Z&&v(S.specularColorMap.channel),specularIntensityMapUv:ve&&v(S.specularIntensityMap.channel),transmissionMapUv:P&&v(S.transmissionMap.channel),thicknessMapUv:oe&&v(S.thicknessMap.channel),alphaMapUv:Q&&v(S.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Me||b),vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:k.isPoints===!0&&!!Y.attributes.uv&&(pt||Q),fog:!!j,useFog:S.fog===!0,fogExp2:!!j&&j.isFogExp2,flatShading:S.flatShading===!0,sizeAttenuation:S.sizeAttenuation===!0,logarithmicDepthBuffer:d,reverseDepthBuffer:Be,skinning:k.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:we,morphTextureStride:Je,numDirLights:M.directional.length,numPointLights:M.point.length,numSpotLights:M.spot.length,numSpotLightMaps:M.spotLightMap.length,numRectAreaLights:M.rectArea.length,numHemiLights:M.hemi.length,numDirLightShadows:M.directionalShadowMap.length,numPointLightShadows:M.pointShadowMap.length,numSpotLightShadows:M.spotShadowMap.length,numSpotLightShadowsWithMaps:M.numSpotLightShadowsWithMaps,numLightProbes:M.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:S.dithering,shadowMapEnabled:i.shadowMap.enabled&&R.length>0,shadowMapType:i.shadowMap.type,toneMapping:wt,decodeVideoTexture:pt&&S.map.isVideoTexture===!0&&it.getTransfer(S.map.colorSpace)===It,decodeVideoTextureEmissive:He&&S.emissiveMap.isVideoTexture===!0&&it.getTransfer(S.emissiveMap.colorSpace)===It,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===Qn,flipSided:S.side===Bn,useDepthPacking:S.depthPacking>=0,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionClipCullDistance:Ge&&S.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ge&&S.extensions.multiDraw===!0||$e)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:S.customProgramCacheKey()};return Gt.vertexUv1s=l.has(1),Gt.vertexUv2s=l.has(2),Gt.vertexUv3s=l.has(3),l.clear(),Gt}function m(S){let M=[];if(S.shaderID?M.push(S.shaderID):(M.push(S.customVertexShaderID),M.push(S.customFragmentShaderID)),S.defines!==void 0)for(let R in S.defines)M.push(R),M.push(S.defines[R]);return S.isRawShaderMaterial===!1&&(_(M,S),x(M,S),M.push(i.outputColorSpace)),M.push(S.customProgramCacheKey),M.join()}function _(S,M){S.push(M.precision),S.push(M.outputColorSpace),S.push(M.envMapMode),S.push(M.envMapCubeUVHeight),S.push(M.mapUv),S.push(M.alphaMapUv),S.push(M.lightMapUv),S.push(M.aoMapUv),S.push(M.bumpMapUv),S.push(M.normalMapUv),S.push(M.displacementMapUv),S.push(M.emissiveMapUv),S.push(M.metalnessMapUv),S.push(M.roughnessMapUv),S.push(M.anisotropyMapUv),S.push(M.clearcoatMapUv),S.push(M.clearcoatNormalMapUv),S.push(M.clearcoatRoughnessMapUv),S.push(M.iridescenceMapUv),S.push(M.iridescenceThicknessMapUv),S.push(M.sheenColorMapUv),S.push(M.sheenRoughnessMapUv),S.push(M.specularMapUv),S.push(M.specularColorMapUv),S.push(M.specularIntensityMapUv),S.push(M.transmissionMapUv),S.push(M.thicknessMapUv),S.push(M.combine),S.push(M.fogExp2),S.push(M.sizeAttenuation),S.push(M.morphTargetsCount),S.push(M.morphAttributeCount),S.push(M.numDirLights),S.push(M.numPointLights),S.push(M.numSpotLights),S.push(M.numSpotLightMaps),S.push(M.numHemiLights),S.push(M.numRectAreaLights),S.push(M.numDirLightShadows),S.push(M.numPointLightShadows),S.push(M.numSpotLightShadows),S.push(M.numSpotLightShadowsWithMaps),S.push(M.numLightProbes),S.push(M.shadowMapType),S.push(M.toneMapping),S.push(M.numClippingPlanes),S.push(M.numClipIntersection),S.push(M.depthPacking)}function x(S,M){a.disableAll(),M.supportsVertexTextures&&a.enable(0),M.instancing&&a.enable(1),M.instancingColor&&a.enable(2),M.instancingMorph&&a.enable(3),M.matcap&&a.enable(4),M.envMap&&a.enable(5),M.normalMapObjectSpace&&a.enable(6),M.normalMapTangentSpace&&a.enable(7),M.clearcoat&&a.enable(8),M.iridescence&&a.enable(9),M.alphaTest&&a.enable(10),M.vertexColors&&a.enable(11),M.vertexAlphas&&a.enable(12),M.vertexUv1s&&a.enable(13),M.vertexUv2s&&a.enable(14),M.vertexUv3s&&a.enable(15),M.vertexTangents&&a.enable(16),M.anisotropy&&a.enable(17),M.alphaHash&&a.enable(18),M.batching&&a.enable(19),M.dispersion&&a.enable(20),M.batchingColor&&a.enable(21),S.push(a.mask),a.disableAll(),M.fog&&a.enable(0),M.useFog&&a.enable(1),M.flatShading&&a.enable(2),M.logarithmicDepthBuffer&&a.enable(3),M.reverseDepthBuffer&&a.enable(4),M.skinning&&a.enable(5),M.morphTargets&&a.enable(6),M.morphNormals&&a.enable(7),M.morphColors&&a.enable(8),M.premultipliedAlpha&&a.enable(9),M.shadowMapEnabled&&a.enable(10),M.doubleSided&&a.enable(11),M.flipSided&&a.enable(12),M.useDepthPacking&&a.enable(13),M.dithering&&a.enable(14),M.transmission&&a.enable(15),M.sheen&&a.enable(16),M.opaque&&a.enable(17),M.pointsUvs&&a.enable(18),M.decodeVideoTexture&&a.enable(19),M.decodeVideoTextureEmissive&&a.enable(20),M.alphaToCoverage&&a.enable(21),S.push(a.mask)}function y(S){let M=p[S.type],R;if(M){let B=rr[M];R=tI.clone(B.uniforms)}else R=S.uniforms;return R}function D(S,M){let R;for(let B=0,k=u.length;B<k;B++){let j=u[B];if(j.cacheKey===M){R=j,++R.usedTimes;break}}return R===void 0&&(R=new lz(i,M,S,s),u.push(R)),R}function w(S){if(--S.usedTimes===0){let M=u.indexOf(S);u[M]=u[u.length-1],u.pop(),S.destroy()}}function E(S){c.remove(S)}function C(){c.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:y,acquireProgram:D,releaseProgram:w,releaseShaderCache:E,programs:u,dispose:C}}function fz(){let i=new WeakMap;function e(o){return i.has(o)}function t(o){let a=i.get(o);return a===void 0&&(a={},i.set(o,a)),a}function n(o){i.delete(o)}function r(o,a,c){i.get(o)[a]=c}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function hz(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function gA(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function vA(){let i=[],e=0,t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(d,f,h,p,v,g){let m=i[e];return m===void 0?(m={id:d.id,object:d,geometry:f,material:h,groupOrder:p,renderOrder:d.renderOrder,z:v,group:g},i[e]=m):(m.id=d.id,m.object=d,m.geometry=f,m.material=h,m.groupOrder=p,m.renderOrder=d.renderOrder,m.z=v,m.group=g),e++,m}function a(d,f,h,p,v,g){let m=o(d,f,h,p,v,g);h.transmission>0?n.push(m):h.transparent===!0?r.push(m):t.push(m)}function c(d,f,h,p,v,g){let m=o(d,f,h,p,v,g);h.transmission>0?n.unshift(m):h.transparent===!0?r.unshift(m):t.unshift(m)}function l(d,f){t.length>1&&t.sort(d||hz),n.length>1&&n.sort(f||gA),r.length>1&&r.sort(f||gA)}function u(){for(let d=e,f=i.length;d<f;d++){let h=i[d];if(h.id===null)break;h.id=null,h.object=null,h.geometry=null,h.material=null,h.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:c,finish:u,sort:l}}function pz(){let i=new WeakMap;function e(n,r){let s=i.get(n),o;return s===void 0?(o=new vA,i.set(n,[o])):r>=s.length?(o=new vA,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function mz(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new A,color:new de};break;case"SpotLight":t={position:new A,direction:new A,color:new de,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new A,color:new de,distance:0,decay:0};break;case"HemisphereLight":t={direction:new A,skyColor:new de,groundColor:new de};break;case"RectAreaLight":t={color:new de,position:new A,halfWidth:new A,halfHeight:new A};break}return i[e.id]=t,t}}}function gz(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new q};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new q};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new q,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var vz=0;function yz(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function _z(i){let e=new mz,t=gz(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)n.probe.push(new A);let r=new A,s=new Ve,o=new Ve;function a(l){let u=0,d=0,f=0;for(let S=0;S<9;S++)n.probe[S].set(0,0,0);let h=0,p=0,v=0,g=0,m=0,_=0,x=0,y=0,D=0,w=0,E=0;l.sort(yz);for(let S=0,M=l.length;S<M;S++){let R=l[S],B=R.color,k=R.intensity,j=R.distance,Y=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)u+=B.r*k,d+=B.g*k,f+=B.b*k;else if(R.isLightProbe){for(let V=0;V<9;V++)n.probe[V].addScaledVector(R.sh.coefficients[V],k);E++}else if(R.isDirectionalLight){let V=e.get(R);if(V.color.copy(R.color).multiplyScalar(R.intensity),R.castShadow){let $=R.shadow,z=t.get(R);z.shadowIntensity=$.intensity,z.shadowBias=$.bias,z.shadowNormalBias=$.normalBias,z.shadowRadius=$.radius,z.shadowMapSize=$.mapSize,n.directionalShadow[h]=z,n.directionalShadowMap[h]=Y,n.directionalShadowMatrix[h]=R.shadow.matrix,_++}n.directional[h]=V,h++}else if(R.isSpotLight){let V=e.get(R);V.position.setFromMatrixPosition(R.matrixWorld),V.color.copy(B).multiplyScalar(k),V.distance=j,V.coneCos=Math.cos(R.angle),V.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),V.decay=R.decay,n.spot[v]=V;let $=R.shadow;if(R.map&&(n.spotLightMap[D]=R.map,D++,$.updateMatrices(R),R.castShadow&&w++),n.spotLightMatrix[v]=$.matrix,R.castShadow){let z=t.get(R);z.shadowIntensity=$.intensity,z.shadowBias=$.bias,z.shadowNormalBias=$.normalBias,z.shadowRadius=$.radius,z.shadowMapSize=$.mapSize,n.spotShadow[v]=z,n.spotShadowMap[v]=Y,y++}v++}else if(R.isRectAreaLight){let V=e.get(R);V.color.copy(B).multiplyScalar(k),V.halfWidth.set(R.width*.5,0,0),V.halfHeight.set(0,R.height*.5,0),n.rectArea[g]=V,g++}else if(R.isPointLight){let V=e.get(R);if(V.color.copy(R.color).multiplyScalar(R.intensity),V.distance=R.distance,V.decay=R.decay,R.castShadow){let $=R.shadow,z=t.get(R);z.shadowIntensity=$.intensity,z.shadowBias=$.bias,z.shadowNormalBias=$.normalBias,z.shadowRadius=$.radius,z.shadowMapSize=$.mapSize,z.shadowCameraNear=$.camera.near,z.shadowCameraFar=$.camera.far,n.pointShadow[p]=z,n.pointShadowMap[p]=Y,n.pointShadowMatrix[p]=R.shadow.matrix,x++}n.point[p]=V,p++}else if(R.isHemisphereLight){let V=e.get(R);V.skyColor.copy(R.color).multiplyScalar(k),V.groundColor.copy(R.groundColor).multiplyScalar(k),n.hemi[m]=V,m++}}g>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=me.LTC_FLOAT_1,n.rectAreaLTC2=me.LTC_FLOAT_2):(n.rectAreaLTC1=me.LTC_HALF_1,n.rectAreaLTC2=me.LTC_HALF_2)),n.ambient[0]=u,n.ambient[1]=d,n.ambient[2]=f;let C=n.hash;(C.directionalLength!==h||C.pointLength!==p||C.spotLength!==v||C.rectAreaLength!==g||C.hemiLength!==m||C.numDirectionalShadows!==_||C.numPointShadows!==x||C.numSpotShadows!==y||C.numSpotMaps!==D||C.numLightProbes!==E)&&(n.directional.length=h,n.spot.length=v,n.rectArea.length=g,n.point.length=p,n.hemi.length=m,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=x,n.pointShadowMap.length=x,n.spotShadow.length=y,n.spotShadowMap.length=y,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=x,n.spotLightMatrix.length=y+D-w,n.spotLightMap.length=D,n.numSpotLightShadowsWithMaps=w,n.numLightProbes=E,C.directionalLength=h,C.pointLength=p,C.spotLength=v,C.rectAreaLength=g,C.hemiLength=m,C.numDirectionalShadows=_,C.numPointShadows=x,C.numSpotShadows=y,C.numSpotMaps=D,C.numLightProbes=E,n.version=vz++)}function c(l,u){let d=0,f=0,h=0,p=0,v=0,g=u.matrixWorldInverse;for(let m=0,_=l.length;m<_;m++){let x=l[m];if(x.isDirectionalLight){let y=n.directional[d];y.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(g),d++}else if(x.isSpotLight){let y=n.spot[h];y.position.setFromMatrixPosition(x.matrixWorld),y.position.applyMatrix4(g),y.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(g),h++}else if(x.isRectAreaLight){let y=n.rectArea[p];y.position.setFromMatrixPosition(x.matrixWorld),y.position.applyMatrix4(g),o.identity(),s.copy(x.matrixWorld),s.premultiply(g),o.extractRotation(s),y.halfWidth.set(x.width*.5,0,0),y.halfHeight.set(0,x.height*.5,0),y.halfWidth.applyMatrix4(o),y.halfHeight.applyMatrix4(o),p++}else if(x.isPointLight){let y=n.point[f];y.position.setFromMatrixPosition(x.matrixWorld),y.position.applyMatrix4(g),f++}else if(x.isHemisphereLight){let y=n.hemi[v];y.direction.setFromMatrixPosition(x.matrixWorld),y.direction.transformDirection(g),v++}}}return{setup:a,setupView:c,state:n}}function yA(i){let e=new _z(i),t=[],n=[];function r(u){l.camera=u,t.length=0,n.length=0}function s(u){t.push(u)}function o(u){n.push(u)}function a(){e.setup(t)}function c(u){e.setupView(t,u)}let l={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:a,setupLightsView:c,pushLight:s,pushShadow:o}}function xz(i){let e=new WeakMap;function t(r,s=0){let o=e.get(r),a;return o===void 0?(a=new yA(i),e.set(r,[a])):s>=o.length?(a=new yA(i),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}var Pu=class extends Zt{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=zD,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Ou=class extends Zt{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Mz=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Sz=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function bz(i,e,t){let n=new sa,r=new q,s=new q,o=new _t,a=new Pu({depthPacking:HD}),c=new Ou,l={},u=t.maxTextureSize,d={[or]:Bn,[Bn]:or,[Qn]:Qn},f=new vi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new q},radius:{value:4}},vertexShader:Mz,fragmentShader:Sz}),h=f.clone();h.defines.HORIZONTAL_PASS=1;let p=new et;p.setAttribute("position",new xt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new Ft(p,f),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=td;let m=this.type;this.render=function(w,E,C){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||w.length===0)return;let S=i.getRenderTarget(),M=i.getActiveCubeFace(),R=i.getActiveMipmapLevel(),B=i.state;B.setBlending(is),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);let k=m!==Pi&&this.type===Pi,j=m===Pi&&this.type!==Pi;for(let Y=0,V=w.length;Y<V;Y++){let $=w[Y],z=$.shadow;if(z===void 0){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}if(z.autoUpdate===!1&&z.needsUpdate===!1)continue;r.copy(z.mapSize);let ce=z.getFrameExtents();if(r.multiply(ce),s.copy(z.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/ce.x),r.x=s.x*ce.x,z.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/ce.y),r.y=s.y*ce.y,z.mapSize.y=s.y)),z.map===null||k===!0||j===!0){let we=this.type!==Pi?{minFilter:on,magFilter:on}:{};z.map!==null&&z.map.dispose(),z.map=new gi(r.x,r.y,we),z.map.texture.name=$.name+".shadowMap",z.camera.updateProjectionMatrix()}i.setRenderTarget(z.map),i.clear();let ge=z.getViewportCount();for(let we=0;we<ge;we++){let Je=z.getViewport(we);o.set(s.x*Je.x,s.y*Je.y,s.x*Je.z,s.y*Je.w),B.viewport(o),z.updateMatrices($,we),n=z.getFrustum(),y(E,C,z.camera,$,this.type)}z.isPointLightShadow!==!0&&this.type===Pi&&_(z,C),z.needsUpdate=!1}m=this.type,g.needsUpdate=!1,i.setRenderTarget(S,M,R)};function _(w,E){let C=e.update(v);f.defines.VSM_SAMPLES!==w.blurSamples&&(f.defines.VSM_SAMPLES=w.blurSamples,h.defines.VSM_SAMPLES=w.blurSamples,f.needsUpdate=!0,h.needsUpdate=!0),w.mapPass===null&&(w.mapPass=new gi(r.x,r.y)),f.uniforms.shadow_pass.value=w.map.texture,f.uniforms.resolution.value=w.mapSize,f.uniforms.radius.value=w.radius,i.setRenderTarget(w.mapPass),i.clear(),i.renderBufferDirect(E,null,C,f,v,null),h.uniforms.shadow_pass.value=w.mapPass.texture,h.uniforms.resolution.value=w.mapSize,h.uniforms.radius.value=w.radius,i.setRenderTarget(w.map),i.clear(),i.renderBufferDirect(E,null,C,h,v,null)}function x(w,E,C,S){let M=null,R=C.isPointLight===!0?w.customDistanceMaterial:w.customDepthMaterial;if(R!==void 0)M=R;else if(M=C.isPointLight===!0?c:a,i.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0){let B=M.uuid,k=E.uuid,j=l[B];j===void 0&&(j={},l[B]=j);let Y=j[k];Y===void 0&&(Y=M.clone(),j[k]=Y,E.addEventListener("dispose",D)),M=Y}if(M.visible=E.visible,M.wireframe=E.wireframe,S===Pi?M.side=E.shadowSide!==null?E.shadowSide:E.side:M.side=E.shadowSide!==null?E.shadowSide:d[E.side],M.alphaMap=E.alphaMap,M.alphaTest=E.alphaTest,M.map=E.map,M.clipShadows=E.clipShadows,M.clippingPlanes=E.clippingPlanes,M.clipIntersection=E.clipIntersection,M.displacementMap=E.displacementMap,M.displacementScale=E.displacementScale,M.displacementBias=E.displacementBias,M.wireframeLinewidth=E.wireframeLinewidth,M.linewidth=E.linewidth,C.isPointLight===!0&&M.isMeshDistanceMaterial===!0){let B=i.properties.get(M);B.light=C}return M}function y(w,E,C,S,M){if(w.visible===!1)return;if(w.layers.test(E.layers)&&(w.isMesh||w.isLine||w.isPoints)&&(w.castShadow||w.receiveShadow&&M===Pi)&&(!w.frustumCulled||n.intersectsObject(w))){w.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,w.matrixWorld);let k=e.update(w),j=w.material;if(Array.isArray(j)){let Y=k.groups;for(let V=0,$=Y.length;V<$;V++){let z=Y[V],ce=j[z.materialIndex];if(ce&&ce.visible){let ge=x(w,ce,S,M);w.onBeforeShadow(i,w,E,C,k,ge,z),i.renderBufferDirect(C,null,k,ge,w,z),w.onAfterShadow(i,w,E,C,k,ge,z)}}}else if(j.visible){let Y=x(w,j,S,M);w.onBeforeShadow(i,w,E,C,k,Y,null),i.renderBufferDirect(C,null,k,Y,w,null),w.onAfterShadow(i,w,E,C,k,Y,null)}}let B=w.children;for(let k=0,j=B.length;k<j;k++)y(B[k],E,C,S,M)}function D(w){w.target.removeEventListener("dispose",D);for(let C in l){let S=l[C],M=w.target.uuid;M in S&&(S[M].dispose(),delete S[M])}}}var wz={[bp]:wp,[Ep]:Ap,[Tp]:Dp,[Ko]:Cp,[wp]:bp,[Ap]:Ep,[Dp]:Tp,[Cp]:Ko};function Ez(i,e){function t(){let P=!1,oe=new _t,W=null,Q=new _t(0,0,0,0);return{setMask:function(_e){W!==_e&&!P&&(i.colorMask(_e,_e,_e,_e),W=_e)},setLocked:function(_e){P=_e},setClear:function(_e,ye,Ge,wt,Gt){Gt===!0&&(_e*=wt,ye*=wt,Ge*=wt),oe.set(_e,ye,Ge,wt),Q.equals(oe)===!1&&(i.clearColor(_e,ye,Ge,wt),Q.copy(oe))},reset:function(){P=!1,W=null,Q.set(-1,0,0,0)}}}function n(){let P=!1,oe=!1,W=null,Q=null,_e=null;return{setReversed:function(ye){if(oe!==ye){let Ge=e.get("EXT_clip_control");oe?Ge.clipControlEXT(Ge.LOWER_LEFT_EXT,Ge.ZERO_TO_ONE_EXT):Ge.clipControlEXT(Ge.LOWER_LEFT_EXT,Ge.NEGATIVE_ONE_TO_ONE_EXT);let wt=_e;_e=null,this.setClear(wt)}oe=ye},getReversed:function(){return oe},setTest:function(ye){ye?fe(i.DEPTH_TEST):Be(i.DEPTH_TEST)},setMask:function(ye){W!==ye&&!P&&(i.depthMask(ye),W=ye)},setFunc:function(ye){if(oe&&(ye=wz[ye]),Q!==ye){switch(ye){case bp:i.depthFunc(i.NEVER);break;case wp:i.depthFunc(i.ALWAYS);break;case Ep:i.depthFunc(i.LESS);break;case Ko:i.depthFunc(i.LEQUAL);break;case Tp:i.depthFunc(i.EQUAL);break;case Cp:i.depthFunc(i.GEQUAL);break;case Ap:i.depthFunc(i.GREATER);break;case Dp:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Q=ye}},setLocked:function(ye){P=ye},setClear:function(ye){_e!==ye&&(oe&&(ye=1-ye),i.clearDepth(ye),_e=ye)},reset:function(){P=!1,W=null,Q=null,_e=null,oe=!1}}}function r(){let P=!1,oe=null,W=null,Q=null,_e=null,ye=null,Ge=null,wt=null,Gt=null;return{setTest:function(mt){P||(mt?fe(i.STENCIL_TEST):Be(i.STENCIL_TEST))},setMask:function(mt){oe!==mt&&!P&&(i.stencilMask(mt),oe=mt)},setFunc:function(mt,Mn,Hn){(W!==mt||Q!==Mn||_e!==Hn)&&(i.stencilFunc(mt,Mn,Hn),W=mt,Q=Mn,_e=Hn)},setOp:function(mt,Mn,Hn){(ye!==mt||Ge!==Mn||wt!==Hn)&&(i.stencilOp(mt,Mn,Hn),ye=mt,Ge=Mn,wt=Hn)},setLocked:function(mt){P=mt},setClear:function(mt){Gt!==mt&&(i.clearStencil(mt),Gt=mt)},reset:function(){P=!1,oe=null,W=null,Q=null,_e=null,ye=null,Ge=null,wt=null,Gt=null}}}let s=new t,o=new n,a=new r,c=new WeakMap,l=new WeakMap,u={},d={},f=new WeakMap,h=[],p=null,v=!1,g=null,m=null,_=null,x=null,y=null,D=null,w=null,E=new de(0,0,0),C=0,S=!1,M=null,R=null,B=null,k=null,j=null,Y=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),V=!1,$=0,z=i.getParameter(i.VERSION);z.indexOf("WebGL")!==-1?($=parseFloat(/^WebGL (\d)/.exec(z)[1]),V=$>=1):z.indexOf("OpenGL ES")!==-1&&($=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),V=$>=2);let ce=null,ge={},we=i.getParameter(i.SCISSOR_BOX),Je=i.getParameter(i.VIEWPORT),Mt=new _t().fromArray(we),J=new _t().fromArray(Je);function le(P,oe,W,Q){let _e=new Uint8Array(4),ye=i.createTexture();i.bindTexture(P,ye),i.texParameteri(P,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(P,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Ge=0;Ge<W;Ge++)P===i.TEXTURE_3D||P===i.TEXTURE_2D_ARRAY?i.texImage3D(oe,0,i.RGBA,1,1,Q,0,i.RGBA,i.UNSIGNED_BYTE,_e):i.texImage2D(oe+Ge,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,_e);return ye}let Ae={};Ae[i.TEXTURE_2D]=le(i.TEXTURE_2D,i.TEXTURE_2D,1),Ae[i.TEXTURE_CUBE_MAP]=le(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ae[i.TEXTURE_2D_ARRAY]=le(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Ae[i.TEXTURE_3D]=le(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),fe(i.DEPTH_TEST),o.setFunc(Ko),re(!1),Me(S0),fe(i.CULL_FACE),N(is);function fe(P){u[P]!==!0&&(i.enable(P),u[P]=!0)}function Be(P){u[P]!==!1&&(i.disable(P),u[P]=!1)}function Ze(P,oe){return d[P]!==oe?(i.bindFramebuffer(P,oe),d[P]=oe,P===i.DRAW_FRAMEBUFFER&&(d[i.FRAMEBUFFER]=oe),P===i.FRAMEBUFFER&&(d[i.DRAW_FRAMEBUFFER]=oe),!0):!1}function $e(P,oe){let W=h,Q=!1;if(P){W=f.get(oe),W===void 0&&(W=[],f.set(oe,W));let _e=P.textures;if(W.length!==_e.length||W[0]!==i.COLOR_ATTACHMENT0){for(let ye=0,Ge=_e.length;ye<Ge;ye++)W[ye]=i.COLOR_ATTACHMENT0+ye;W.length=_e.length,Q=!0}}else W[0]!==i.BACK&&(W[0]=i.BACK,Q=!0);Q&&i.drawBuffers(W)}function pt(P){return p!==P?(i.useProgram(P),p=P,!0):!1}let te={[Ys]:i.FUNC_ADD,[fD]:i.FUNC_SUBTRACT,[hD]:i.FUNC_REVERSE_SUBTRACT};te[pD]=i.MIN,te[mD]=i.MAX;let ae={[gD]:i.ZERO,[vD]:i.ONE,[yD]:i.SRC_COLOR,[Mp]:i.SRC_ALPHA,[wD]:i.SRC_ALPHA_SATURATE,[SD]:i.DST_COLOR,[xD]:i.DST_ALPHA,[_D]:i.ONE_MINUS_SRC_COLOR,[Sp]:i.ONE_MINUS_SRC_ALPHA,[bD]:i.ONE_MINUS_DST_COLOR,[MD]:i.ONE_MINUS_DST_ALPHA,[ED]:i.CONSTANT_COLOR,[TD]:i.ONE_MINUS_CONSTANT_COLOR,[CD]:i.CONSTANT_ALPHA,[AD]:i.ONE_MINUS_CONSTANT_ALPHA};function N(P,oe,W,Q,_e,ye,Ge,wt,Gt,mt){if(P===is){v===!0&&(Be(i.BLEND),v=!1);return}if(v===!1&&(fe(i.BLEND),v=!0),P!==dD){if(P!==g||mt!==S){if((m!==Ys||y!==Ys)&&(i.blendEquation(i.FUNC_ADD),m=Ys,y=Ys),mt)switch(P){case qo:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case b0:i.blendFunc(i.ONE,i.ONE);break;case w0:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case E0:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",P);break}else switch(P){case qo:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case b0:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case w0:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case E0:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",P);break}_=null,x=null,D=null,w=null,E.set(0,0,0),C=0,g=P,S=mt}return}_e=_e||oe,ye=ye||W,Ge=Ge||Q,(oe!==m||_e!==y)&&(i.blendEquationSeparate(te[oe],te[_e]),m=oe,y=_e),(W!==_||Q!==x||ye!==D||Ge!==w)&&(i.blendFuncSeparate(ae[W],ae[Q],ae[ye],ae[Ge]),_=W,x=Q,D=ye,w=Ge),(wt.equals(E)===!1||Gt!==C)&&(i.blendColor(wt.r,wt.g,wt.b,Gt),E.copy(wt),C=Gt),g=P,S=!1}function Ie(P,oe){P.side===Qn?Be(i.CULL_FACE):fe(i.CULL_FACE);let W=P.side===Bn;oe&&(W=!W),re(W),P.blending===qo&&P.transparent===!1?N(is):N(P.blending,P.blendEquation,P.blendSrc,P.blendDst,P.blendEquationAlpha,P.blendSrcAlpha,P.blendDstAlpha,P.blendColor,P.blendAlpha,P.premultipliedAlpha),o.setFunc(P.depthFunc),o.setTest(P.depthTest),o.setMask(P.depthWrite),s.setMask(P.colorWrite);let Q=P.stencilWrite;a.setTest(Q),Q&&(a.setMask(P.stencilWriteMask),a.setFunc(P.stencilFunc,P.stencilRef,P.stencilFuncMask),a.setOp(P.stencilFail,P.stencilZFail,P.stencilZPass)),He(P.polygonOffset,P.polygonOffsetFactor,P.polygonOffsetUnits),P.alphaToCoverage===!0?fe(i.SAMPLE_ALPHA_TO_COVERAGE):Be(i.SAMPLE_ALPHA_TO_COVERAGE)}function re(P){M!==P&&(P?i.frontFace(i.CW):i.frontFace(i.CCW),M=P)}function Me(P){P!==lD?(fe(i.CULL_FACE),P!==R&&(P===S0?i.cullFace(i.BACK):P===uD?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Be(i.CULL_FACE),R=P}function he(P){P!==B&&(V&&i.lineWidth(P),B=P)}function He(P,oe,W){P?(fe(i.POLYGON_OFFSET_FILL),(k!==oe||j!==W)&&(i.polygonOffset(oe,W),k=oe,j=W)):Be(i.POLYGON_OFFSET_FILL)}function Se(P){P?fe(i.SCISSOR_TEST):Be(i.SCISSOR_TEST)}function I(P){P===void 0&&(P=i.TEXTURE0+Y-1),ce!==P&&(i.activeTexture(P),ce=P)}function b(P,oe,W){W===void 0&&(ce===null?W=i.TEXTURE0+Y-1:W=ce);let Q=ge[W];Q===void 0&&(Q={type:void 0,texture:void 0},ge[W]=Q),(Q.type!==P||Q.texture!==oe)&&(ce!==W&&(i.activeTexture(W),ce=W),i.bindTexture(P,oe||Ae[P]),Q.type=P,Q.texture=oe)}function U(){let P=ge[ce];P!==void 0&&P.type!==void 0&&(i.bindTexture(P.type,null),P.type=void 0,P.texture=void 0)}function X(){try{i.compressedTexImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function ne(){try{i.compressedTexImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function K(){try{i.texSubImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function De(){try{i.texSubImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function pe(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function be(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function lt(){try{i.texStorage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function se(){try{i.texStorage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function Te(){try{i.texImage2D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function We(){try{i.texImage3D.apply(i,arguments)}catch(P){console.error("THREE.WebGLState:",P)}}function Xe(P){Mt.equals(P)===!1&&(i.scissor(P.x,P.y,P.z,P.w),Mt.copy(P))}function Ee(P){J.equals(P)===!1&&(i.viewport(P.x,P.y,P.z,P.w),J.copy(P))}function O(P,oe){let W=l.get(oe);W===void 0&&(W=new WeakMap,l.set(oe,W));let Q=W.get(P);Q===void 0&&(Q=i.getUniformBlockIndex(oe,P.name),W.set(P,Q))}function Z(P,oe){let Q=l.get(oe).get(P);c.get(oe)!==Q&&(i.uniformBlockBinding(oe,Q,P.__bindingPointIndex),c.set(oe,Q))}function ve(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),o.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},ce=null,ge={},d={},f=new WeakMap,h=[],p=null,v=!1,g=null,m=null,_=null,x=null,y=null,D=null,w=null,E=new de(0,0,0),C=0,S=!1,M=null,R=null,B=null,k=null,j=null,Mt.set(0,0,i.canvas.width,i.canvas.height),J.set(0,0,i.canvas.width,i.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:fe,disable:Be,bindFramebuffer:Ze,drawBuffers:$e,useProgram:pt,setBlending:N,setMaterial:Ie,setFlipSided:re,setCullFace:Me,setLineWidth:he,setPolygonOffset:He,setScissorTest:Se,activeTexture:I,bindTexture:b,unbindTexture:U,compressedTexImage2D:X,compressedTexImage3D:ne,texImage2D:Te,texImage3D:We,updateUBOMapping:O,uniformBlockBinding:Z,texStorage2D:lt,texStorage3D:se,texSubImage2D:K,texSubImage3D:De,compressedTexSubImage2D:pe,compressedTexSubImage3D:be,scissor:Xe,viewport:Ee,reset:ve}}function Tz(i,e){let t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function Cz(i,e){let t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function Az(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function G0(i,e,t,n){let r=Dz(n);switch(t){case Xx:return i*e;case Zx:return i*e;case Kx:return i*e*2;case cg:return i*e/r.components*r.byteLength;case rd:return i*e/r.components*r.byteLength;case Jx:return i*e*2/r.components*r.byteLength;case lg:return i*e*2/r.components*r.byteLength;case Yx:return i*e*3/r.components*r.byteLength;case En:return i*e*4/r.components*r.byteLength;case ug:return i*e*4/r.components*r.byteLength;case hu:case pu:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case mu:case gu:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Np:case Op:return Math.max(i,16)*Math.max(e,8)/4;case Rp:case Pp:return Math.max(i,8)*Math.max(e,8)/2;case Lp:case Fp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case kp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Up:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Bp:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Vp:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case zp:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case Hp:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Gp:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case jp:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Wp:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case $p:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case qp:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Xp:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case Yp:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Zp:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Kp:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case vu:case Jp:case Qp:return Math.ceil(i/4)*Math.ceil(e/4)*16;case Qx:case em:return Math.ceil(i/4)*Math.ceil(e/4)*8;case tm:case nm:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Dz(i){switch(i){case ki:case Wx:return{byteLength:1,components:1};case Tc:case $x:case $c:return{byteLength:2,components:1};case og:case ag:return{byteLength:2,components:4};case cs:case sg:case ti:return{byteLength:4,components:1};case qx:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}var Iz={contain:Tz,cover:Cz,fill:Az,getByteLength:G0};function Rz(i,e,t,n,r,s,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new q,u=new WeakMap,d,f=new WeakMap,h=!1;try{h=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(I,b){return h?new OffscreenCanvas(I,b):Cu("canvas")}function v(I,b,U){let X=1,ne=Se(I);if((ne.width>U||ne.height>U)&&(X=U/Math.max(ne.width,ne.height)),X<1)if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap||typeof VideoFrame<"u"&&I instanceof VideoFrame){let K=Math.floor(X*ne.width),De=Math.floor(X*ne.height);d===void 0&&(d=p(K,De));let pe=b?p(K,De):d;return pe.width=K,pe.height=De,pe.getContext("2d").drawImage(I,0,0,K,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ne.width+"x"+ne.height+") to ("+K+"x"+De+")."),pe}else return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ne.width+"x"+ne.height+")."),I;return I}function g(I){return I.generateMipmaps}function m(I){i.generateMipmap(I)}function _(I){return I.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:I.isWebGL3DRenderTarget?i.TEXTURE_3D:I.isWebGLArrayRenderTarget||I.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function x(I,b,U,X,ne=!1){if(I!==null){if(i[I]!==void 0)return i[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let K=b;if(b===i.RED&&(U===i.FLOAT&&(K=i.R32F),U===i.HALF_FLOAT&&(K=i.R16F),U===i.UNSIGNED_BYTE&&(K=i.R8)),b===i.RED_INTEGER&&(U===i.UNSIGNED_BYTE&&(K=i.R8UI),U===i.UNSIGNED_SHORT&&(K=i.R16UI),U===i.UNSIGNED_INT&&(K=i.R32UI),U===i.BYTE&&(K=i.R8I),U===i.SHORT&&(K=i.R16I),U===i.INT&&(K=i.R32I)),b===i.RG&&(U===i.FLOAT&&(K=i.RG32F),U===i.HALF_FLOAT&&(K=i.RG16F),U===i.UNSIGNED_BYTE&&(K=i.RG8)),b===i.RG_INTEGER&&(U===i.UNSIGNED_BYTE&&(K=i.RG8UI),U===i.UNSIGNED_SHORT&&(K=i.RG16UI),U===i.UNSIGNED_INT&&(K=i.RG32UI),U===i.BYTE&&(K=i.RG8I),U===i.SHORT&&(K=i.RG16I),U===i.INT&&(K=i.RG32I)),b===i.RGB_INTEGER&&(U===i.UNSIGNED_BYTE&&(K=i.RGB8UI),U===i.UNSIGNED_SHORT&&(K=i.RGB16UI),U===i.UNSIGNED_INT&&(K=i.RGB32UI),U===i.BYTE&&(K=i.RGB8I),U===i.SHORT&&(K=i.RGB16I),U===i.INT&&(K=i.RGB32I)),b===i.RGBA_INTEGER&&(U===i.UNSIGNED_BYTE&&(K=i.RGBA8UI),U===i.UNSIGNED_SHORT&&(K=i.RGBA16UI),U===i.UNSIGNED_INT&&(K=i.RGBA32UI),U===i.BYTE&&(K=i.RGBA8I),U===i.SHORT&&(K=i.RGBA16I),U===i.INT&&(K=i.RGBA32I)),b===i.RGB&&U===i.UNSIGNED_INT_5_9_9_9_REV&&(K=i.RGB9_E5),b===i.RGBA){let De=ne?od:it.getTransfer(X);U===i.FLOAT&&(K=i.RGBA32F),U===i.HALF_FLOAT&&(K=i.RGBA16F),U===i.UNSIGNED_BYTE&&(K=De===It?i.SRGB8_ALPHA8:i.RGBA8),U===i.UNSIGNED_SHORT_4_4_4_4&&(K=i.RGBA4),U===i.UNSIGNED_SHORT_5_5_5_1&&(K=i.RGB5_A1)}return(K===i.R16F||K===i.R32F||K===i.RG16F||K===i.RG32F||K===i.RGBA16F||K===i.RGBA32F)&&e.get("EXT_color_buffer_float"),K}function y(I,b){let U;return I?b===null||b===cs||b===Qo?U=i.DEPTH24_STENCIL8:b===ti?U=i.DEPTH32F_STENCIL8:b===Tc&&(U=i.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):b===null||b===cs||b===Qo?U=i.DEPTH_COMPONENT24:b===ti?U=i.DEPTH_COMPONENT32F:b===Tc&&(U=i.DEPTH_COMPONENT16),U}function D(I,b){return g(I)===!0||I.isFramebufferTexture&&I.minFilter!==on&&I.minFilter!==Ht?Math.log2(Math.max(b.width,b.height))+1:I.mipmaps!==void 0&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?b.mipmaps.length:1}function w(I){let b=I.target;b.removeEventListener("dispose",w),C(b),b.isVideoTexture&&u.delete(b)}function E(I){let b=I.target;b.removeEventListener("dispose",E),M(b)}function C(I){let b=n.get(I);if(b.__webglInit===void 0)return;let U=I.source,X=f.get(U);if(X){let ne=X[b.__cacheKey];ne.usedTimes--,ne.usedTimes===0&&S(I),Object.keys(X).length===0&&f.delete(U)}n.remove(I)}function S(I){let b=n.get(I);i.deleteTexture(b.__webglTexture);let U=I.source,X=f.get(U);delete X[b.__cacheKey],o.memory.textures--}function M(I){let b=n.get(I);if(I.depthTexture&&(I.depthTexture.dispose(),n.remove(I.depthTexture)),I.isWebGLCubeRenderTarget)for(let X=0;X<6;X++){if(Array.isArray(b.__webglFramebuffer[X]))for(let ne=0;ne<b.__webglFramebuffer[X].length;ne++)i.deleteFramebuffer(b.__webglFramebuffer[X][ne]);else i.deleteFramebuffer(b.__webglFramebuffer[X]);b.__webglDepthbuffer&&i.deleteRenderbuffer(b.__webglDepthbuffer[X])}else{if(Array.isArray(b.__webglFramebuffer))for(let X=0;X<b.__webglFramebuffer.length;X++)i.deleteFramebuffer(b.__webglFramebuffer[X]);else i.deleteFramebuffer(b.__webglFramebuffer);if(b.__webglDepthbuffer&&i.deleteRenderbuffer(b.__webglDepthbuffer),b.__webglMultisampledFramebuffer&&i.deleteFramebuffer(b.__webglMultisampledFramebuffer),b.__webglColorRenderbuffer)for(let X=0;X<b.__webglColorRenderbuffer.length;X++)b.__webglColorRenderbuffer[X]&&i.deleteRenderbuffer(b.__webglColorRenderbuffer[X]);b.__webglDepthRenderbuffer&&i.deleteRenderbuffer(b.__webglDepthRenderbuffer)}let U=I.textures;for(let X=0,ne=U.length;X<ne;X++){let K=n.get(U[X]);K.__webglTexture&&(i.deleteTexture(K.__webglTexture),o.memory.textures--),n.remove(U[X])}n.remove(I)}let R=0;function B(){R=0}function k(){let I=R;return I>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+r.maxTextures),R+=1,I}function j(I){let b=[];return b.push(I.wrapS),b.push(I.wrapT),b.push(I.wrapR||0),b.push(I.magFilter),b.push(I.minFilter),b.push(I.anisotropy),b.push(I.internalFormat),b.push(I.format),b.push(I.type),b.push(I.generateMipmaps),b.push(I.premultiplyAlpha),b.push(I.flipY),b.push(I.unpackAlignment),b.push(I.colorSpace),b.join()}function Y(I,b){let U=n.get(I);if(I.isVideoTexture&&he(I),I.isRenderTargetTexture===!1&&I.version>0&&U.__version!==I.version){let X=I.image;if(X===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(X.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{J(U,I,b);return}}t.bindTexture(i.TEXTURE_2D,U.__webglTexture,i.TEXTURE0+b)}function V(I,b){let U=n.get(I);if(I.version>0&&U.__version!==I.version){J(U,I,b);return}t.bindTexture(i.TEXTURE_2D_ARRAY,U.__webglTexture,i.TEXTURE0+b)}function $(I,b){let U=n.get(I);if(I.version>0&&U.__version!==I.version){J(U,I,b);return}t.bindTexture(i.TEXTURE_3D,U.__webglTexture,i.TEXTURE0+b)}function z(I,b){let U=n.get(I);if(I.version>0&&U.__version!==I.version){le(U,I,b);return}t.bindTexture(i.TEXTURE_CUBE_MAP,U.__webglTexture,i.TEXTURE0+b)}let ce={[as]:i.REPEAT,[ei]:i.CLAMP_TO_EDGE,[Jo]:i.MIRRORED_REPEAT},ge={[on]:i.NEAREST,[id]:i.NEAREST_MIPMAP_NEAREST,[Zs]:i.NEAREST_MIPMAP_LINEAR,[Ht]:i.LINEAR,[Xo]:i.LINEAR_MIPMAP_NEAREST,[pi]:i.LINEAR_MIPMAP_LINEAR},we={[jD]:i.NEVER,[ZD]:i.ALWAYS,[WD]:i.LESS,[nM]:i.LEQUAL,[$D]:i.EQUAL,[YD]:i.GEQUAL,[qD]:i.GREATER,[XD]:i.NOTEQUAL};function Je(I,b){if(b.type===ti&&e.has("OES_texture_float_linear")===!1&&(b.magFilter===Ht||b.magFilter===Xo||b.magFilter===Zs||b.magFilter===pi||b.minFilter===Ht||b.minFilter===Xo||b.minFilter===Zs||b.minFilter===pi)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(I,i.TEXTURE_WRAP_S,ce[b.wrapS]),i.texParameteri(I,i.TEXTURE_WRAP_T,ce[b.wrapT]),(I===i.TEXTURE_3D||I===i.TEXTURE_2D_ARRAY)&&i.texParameteri(I,i.TEXTURE_WRAP_R,ce[b.wrapR]),i.texParameteri(I,i.TEXTURE_MAG_FILTER,ge[b.magFilter]),i.texParameteri(I,i.TEXTURE_MIN_FILTER,ge[b.minFilter]),b.compareFunction&&(i.texParameteri(I,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(I,i.TEXTURE_COMPARE_FUNC,we[b.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(b.magFilter===on||b.minFilter!==Zs&&b.minFilter!==pi||b.type===ti&&e.has("OES_texture_float_linear")===!1)return;if(b.anisotropy>1||n.get(b).__currentAnisotropy){let U=e.get("EXT_texture_filter_anisotropic");i.texParameterf(I,U.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,r.getMaxAnisotropy())),n.get(b).__currentAnisotropy=b.anisotropy}}}function Mt(I,b){let U=!1;I.__webglInit===void 0&&(I.__webglInit=!0,b.addEventListener("dispose",w));let X=b.source,ne=f.get(X);ne===void 0&&(ne={},f.set(X,ne));let K=j(b);if(K!==I.__cacheKey){ne[K]===void 0&&(ne[K]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,U=!0),ne[K].usedTimes++;let De=ne[I.__cacheKey];De!==void 0&&(ne[I.__cacheKey].usedTimes--,De.usedTimes===0&&S(b)),I.__cacheKey=K,I.__webglTexture=ne[K].texture}return U}function J(I,b,U){let X=i.TEXTURE_2D;(b.isDataArrayTexture||b.isCompressedArrayTexture)&&(X=i.TEXTURE_2D_ARRAY),b.isData3DTexture&&(X=i.TEXTURE_3D);let ne=Mt(I,b),K=b.source;t.bindTexture(X,I.__webglTexture,i.TEXTURE0+U);let De=n.get(K);if(K.version!==De.__version||ne===!0){t.activeTexture(i.TEXTURE0+U);let pe=it.getPrimaries(it.workingColorSpace),be=b.colorSpace===Qr?null:it.getPrimaries(b.colorSpace),lt=b.colorSpace===Qr||pe===be?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,b.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,b.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,lt);let se=v(b.image,!1,r.maxTextureSize);se=He(b,se);let Te=s.convert(b.format,b.colorSpace),We=s.convert(b.type),Xe=x(b.internalFormat,Te,We,b.colorSpace,b.isVideoTexture);Je(X,b);let Ee,O=b.mipmaps,Z=b.isVideoTexture!==!0,ve=De.__version===void 0||ne===!0,P=K.dataReady,oe=D(b,se);if(b.isDepthTexture)Xe=y(b.format===ea,b.type),ve&&(Z?t.texStorage2D(i.TEXTURE_2D,1,Xe,se.width,se.height):t.texImage2D(i.TEXTURE_2D,0,Xe,se.width,se.height,0,Te,We,null));else if(b.isDataTexture)if(O.length>0){Z&&ve&&t.texStorage2D(i.TEXTURE_2D,oe,Xe,O[0].width,O[0].height);for(let W=0,Q=O.length;W<Q;W++)Ee=O[W],Z?P&&t.texSubImage2D(i.TEXTURE_2D,W,0,0,Ee.width,Ee.height,Te,We,Ee.data):t.texImage2D(i.TEXTURE_2D,W,Xe,Ee.width,Ee.height,0,Te,We,Ee.data);b.generateMipmaps=!1}else Z?(ve&&t.texStorage2D(i.TEXTURE_2D,oe,Xe,se.width,se.height),P&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,se.width,se.height,Te,We,se.data)):t.texImage2D(i.TEXTURE_2D,0,Xe,se.width,se.height,0,Te,We,se.data);else if(b.isCompressedTexture)if(b.isCompressedArrayTexture){Z&&ve&&t.texStorage3D(i.TEXTURE_2D_ARRAY,oe,Xe,O[0].width,O[0].height,se.depth);for(let W=0,Q=O.length;W<Q;W++)if(Ee=O[W],b.format!==En)if(Te!==null)if(Z){if(P)if(b.layerUpdates.size>0){let _e=G0(Ee.width,Ee.height,b.format,b.type);for(let ye of b.layerUpdates){let Ge=Ee.data.subarray(ye*_e/Ee.data.BYTES_PER_ELEMENT,(ye+1)*_e/Ee.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,W,0,0,ye,Ee.width,Ee.height,1,Te,Ge)}b.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,W,0,0,0,Ee.width,Ee.height,se.depth,Te,Ee.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,W,Xe,Ee.width,Ee.height,se.depth,0,Ee.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Z?P&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,W,0,0,0,Ee.width,Ee.height,se.depth,Te,We,Ee.data):t.texImage3D(i.TEXTURE_2D_ARRAY,W,Xe,Ee.width,Ee.height,se.depth,0,Te,We,Ee.data)}else{Z&&ve&&t.texStorage2D(i.TEXTURE_2D,oe,Xe,O[0].width,O[0].height);for(let W=0,Q=O.length;W<Q;W++)Ee=O[W],b.format!==En?Te!==null?Z?P&&t.compressedTexSubImage2D(i.TEXTURE_2D,W,0,0,Ee.width,Ee.height,Te,Ee.data):t.compressedTexImage2D(i.TEXTURE_2D,W,Xe,Ee.width,Ee.height,0,Ee.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Z?P&&t.texSubImage2D(i.TEXTURE_2D,W,0,0,Ee.width,Ee.height,Te,We,Ee.data):t.texImage2D(i.TEXTURE_2D,W,Xe,Ee.width,Ee.height,0,Te,We,Ee.data)}else if(b.isDataArrayTexture)if(Z){if(ve&&t.texStorage3D(i.TEXTURE_2D_ARRAY,oe,Xe,se.width,se.height,se.depth),P)if(b.layerUpdates.size>0){let W=G0(se.width,se.height,b.format,b.type);for(let Q of b.layerUpdates){let _e=se.data.subarray(Q*W/se.data.BYTES_PER_ELEMENT,(Q+1)*W/se.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Q,se.width,se.height,1,Te,We,_e)}b.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,se.width,se.height,se.depth,Te,We,se.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,Xe,se.width,se.height,se.depth,0,Te,We,se.data);else if(b.isData3DTexture)Z?(ve&&t.texStorage3D(i.TEXTURE_3D,oe,Xe,se.width,se.height,se.depth),P&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,se.width,se.height,se.depth,Te,We,se.data)):t.texImage3D(i.TEXTURE_3D,0,Xe,se.width,se.height,se.depth,0,Te,We,se.data);else if(b.isFramebufferTexture){if(ve)if(Z)t.texStorage2D(i.TEXTURE_2D,oe,Xe,se.width,se.height);else{let W=se.width,Q=se.height;for(let _e=0;_e<oe;_e++)t.texImage2D(i.TEXTURE_2D,_e,Xe,W,Q,0,Te,We,null),W>>=1,Q>>=1}}else if(O.length>0){if(Z&&ve){let W=Se(O[0]);t.texStorage2D(i.TEXTURE_2D,oe,Xe,W.width,W.height)}for(let W=0,Q=O.length;W<Q;W++)Ee=O[W],Z?P&&t.texSubImage2D(i.TEXTURE_2D,W,0,0,Te,We,Ee):t.texImage2D(i.TEXTURE_2D,W,Xe,Te,We,Ee);b.generateMipmaps=!1}else if(Z){if(ve){let W=Se(se);t.texStorage2D(i.TEXTURE_2D,oe,Xe,W.width,W.height)}P&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Te,We,se)}else t.texImage2D(i.TEXTURE_2D,0,Xe,Te,We,se);g(b)&&m(X),De.__version=K.version,b.onUpdate&&b.onUpdate(b)}I.__version=b.version}function le(I,b,U){if(b.image.length!==6)return;let X=Mt(I,b),ne=b.source;t.bindTexture(i.TEXTURE_CUBE_MAP,I.__webglTexture,i.TEXTURE0+U);let K=n.get(ne);if(ne.version!==K.__version||X===!0){t.activeTexture(i.TEXTURE0+U);let De=it.getPrimaries(it.workingColorSpace),pe=b.colorSpace===Qr?null:it.getPrimaries(b.colorSpace),be=b.colorSpace===Qr||De===pe?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,b.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,b.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,be);let lt=b.isCompressedTexture||b.image[0].isCompressedTexture,se=b.image[0]&&b.image[0].isDataTexture,Te=[];for(let Q=0;Q<6;Q++)!lt&&!se?Te[Q]=v(b.image[Q],!0,r.maxCubemapSize):Te[Q]=se?b.image[Q].image:b.image[Q],Te[Q]=He(b,Te[Q]);let We=Te[0],Xe=s.convert(b.format,b.colorSpace),Ee=s.convert(b.type),O=x(b.internalFormat,Xe,Ee,b.colorSpace),Z=b.isVideoTexture!==!0,ve=K.__version===void 0||X===!0,P=ne.dataReady,oe=D(b,We);Je(i.TEXTURE_CUBE_MAP,b);let W;if(lt){Z&&ve&&t.texStorage2D(i.TEXTURE_CUBE_MAP,oe,O,We.width,We.height);for(let Q=0;Q<6;Q++){W=Te[Q].mipmaps;for(let _e=0;_e<W.length;_e++){let ye=W[_e];b.format!==En?Xe!==null?Z?P&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e,0,0,ye.width,ye.height,Xe,ye.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e,O,ye.width,ye.height,0,ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Z?P&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e,0,0,ye.width,ye.height,Xe,Ee,ye.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e,O,ye.width,ye.height,0,Xe,Ee,ye.data)}}}else{if(W=b.mipmaps,Z&&ve){W.length>0&&oe++;let Q=Se(Te[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,oe,O,Q.width,Q.height)}for(let Q=0;Q<6;Q++)if(se){Z?P&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,0,0,Te[Q].width,Te[Q].height,Xe,Ee,Te[Q].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,O,Te[Q].width,Te[Q].height,0,Xe,Ee,Te[Q].data);for(let _e=0;_e<W.length;_e++){let Ge=W[_e].image[Q].image;Z?P&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e+1,0,0,Ge.width,Ge.height,Xe,Ee,Ge.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e+1,O,Ge.width,Ge.height,0,Xe,Ee,Ge.data)}}else{Z?P&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,0,0,Xe,Ee,Te[Q]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,O,Xe,Ee,Te[Q]);for(let _e=0;_e<W.length;_e++){let ye=W[_e];Z?P&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e+1,0,0,Xe,Ee,ye.image[Q]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Q,_e+1,O,Xe,Ee,ye.image[Q])}}}g(b)&&m(i.TEXTURE_CUBE_MAP),K.__version=ne.version,b.onUpdate&&b.onUpdate(b)}I.__version=b.version}function Ae(I,b,U,X,ne,K){let De=s.convert(U.format,U.colorSpace),pe=s.convert(U.type),be=x(U.internalFormat,De,pe,U.colorSpace),lt=n.get(b),se=n.get(U);if(se.__renderTarget=b,!lt.__hasExternalTextures){let Te=Math.max(1,b.width>>K),We=Math.max(1,b.height>>K);ne===i.TEXTURE_3D||ne===i.TEXTURE_2D_ARRAY?t.texImage3D(ne,K,be,Te,We,b.depth,0,De,pe,null):t.texImage2D(ne,K,be,Te,We,0,De,pe,null)}t.bindFramebuffer(i.FRAMEBUFFER,I),Me(b)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,X,ne,se.__webglTexture,0,re(b)):(ne===i.TEXTURE_2D||ne>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ne<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,X,ne,se.__webglTexture,K),t.bindFramebuffer(i.FRAMEBUFFER,null)}function fe(I,b,U){if(i.bindRenderbuffer(i.RENDERBUFFER,I),b.depthBuffer){let X=b.depthTexture,ne=X&&X.isDepthTexture?X.type:null,K=y(b.stencilBuffer,ne),De=b.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,pe=re(b);Me(b)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,pe,K,b.width,b.height):U?i.renderbufferStorageMultisample(i.RENDERBUFFER,pe,K,b.width,b.height):i.renderbufferStorage(i.RENDERBUFFER,K,b.width,b.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,De,i.RENDERBUFFER,I)}else{let X=b.textures;for(let ne=0;ne<X.length;ne++){let K=X[ne],De=s.convert(K.format,K.colorSpace),pe=s.convert(K.type),be=x(K.internalFormat,De,pe,K.colorSpace),lt=re(b);U&&Me(b)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,lt,be,b.width,b.height):Me(b)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,lt,be,b.width,b.height):i.renderbufferStorage(i.RENDERBUFFER,be,b.width,b.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Be(I,b){if(b&&b.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,I),!(b.depthTexture&&b.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let X=n.get(b.depthTexture);X.__renderTarget=b,(!X.__webglTexture||b.depthTexture.image.width!==b.width||b.depthTexture.image.height!==b.height)&&(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0),Y(b.depthTexture,0);let ne=X.__webglTexture,K=re(b);if(b.depthTexture.format===Yo)Me(b)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ne,0,K):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,ne,0);else if(b.depthTexture.format===ea)Me(b)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ne,0,K):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,ne,0);else throw new Error("Unknown depthTexture format")}function Ze(I){let b=n.get(I),U=I.isWebGLCubeRenderTarget===!0;if(b.__boundDepthTexture!==I.depthTexture){let X=I.depthTexture;if(b.__depthDisposeCallback&&b.__depthDisposeCallback(),X){let ne=()=>{delete b.__boundDepthTexture,delete b.__depthDisposeCallback,X.removeEventListener("dispose",ne)};X.addEventListener("dispose",ne),b.__depthDisposeCallback=ne}b.__boundDepthTexture=X}if(I.depthTexture&&!b.__autoAllocateDepthBuffer){if(U)throw new Error("target.depthTexture not supported in Cube render targets");Be(b.__webglFramebuffer,I)}else if(U){b.__webglDepthbuffer=[];for(let X=0;X<6;X++)if(t.bindFramebuffer(i.FRAMEBUFFER,b.__webglFramebuffer[X]),b.__webglDepthbuffer[X]===void 0)b.__webglDepthbuffer[X]=i.createRenderbuffer(),fe(b.__webglDepthbuffer[X],I,!1);else{let ne=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,K=b.__webglDepthbuffer[X];i.bindRenderbuffer(i.RENDERBUFFER,K),i.framebufferRenderbuffer(i.FRAMEBUFFER,ne,i.RENDERBUFFER,K)}}else if(t.bindFramebuffer(i.FRAMEBUFFER,b.__webglFramebuffer),b.__webglDepthbuffer===void 0)b.__webglDepthbuffer=i.createRenderbuffer(),fe(b.__webglDepthbuffer,I,!1);else{let X=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ne=b.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,ne),i.framebufferRenderbuffer(i.FRAMEBUFFER,X,i.RENDERBUFFER,ne)}t.bindFramebuffer(i.FRAMEBUFFER,null)}function $e(I,b,U){let X=n.get(I);b!==void 0&&Ae(X.__webglFramebuffer,I,I.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),U!==void 0&&Ze(I)}function pt(I){let b=I.texture,U=n.get(I),X=n.get(b);I.addEventListener("dispose",E);let ne=I.textures,K=I.isWebGLCubeRenderTarget===!0,De=ne.length>1;if(De||(X.__webglTexture===void 0&&(X.__webglTexture=i.createTexture()),X.__version=b.version,o.memory.textures++),K){U.__webglFramebuffer=[];for(let pe=0;pe<6;pe++)if(b.mipmaps&&b.mipmaps.length>0){U.__webglFramebuffer[pe]=[];for(let be=0;be<b.mipmaps.length;be++)U.__webglFramebuffer[pe][be]=i.createFramebuffer()}else U.__webglFramebuffer[pe]=i.createFramebuffer()}else{if(b.mipmaps&&b.mipmaps.length>0){U.__webglFramebuffer=[];for(let pe=0;pe<b.mipmaps.length;pe++)U.__webglFramebuffer[pe]=i.createFramebuffer()}else U.__webglFramebuffer=i.createFramebuffer();if(De)for(let pe=0,be=ne.length;pe<be;pe++){let lt=n.get(ne[pe]);lt.__webglTexture===void 0&&(lt.__webglTexture=i.createTexture(),o.memory.textures++)}if(I.samples>0&&Me(I)===!1){U.__webglMultisampledFramebuffer=i.createFramebuffer(),U.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,U.__webglMultisampledFramebuffer);for(let pe=0;pe<ne.length;pe++){let be=ne[pe];U.__webglColorRenderbuffer[pe]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,U.__webglColorRenderbuffer[pe]);let lt=s.convert(be.format,be.colorSpace),se=s.convert(be.type),Te=x(be.internalFormat,lt,se,be.colorSpace,I.isXRRenderTarget===!0),We=re(I);i.renderbufferStorageMultisample(i.RENDERBUFFER,We,Te,I.width,I.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+pe,i.RENDERBUFFER,U.__webglColorRenderbuffer[pe])}i.bindRenderbuffer(i.RENDERBUFFER,null),I.depthBuffer&&(U.__webglDepthRenderbuffer=i.createRenderbuffer(),fe(U.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(K){t.bindTexture(i.TEXTURE_CUBE_MAP,X.__webglTexture),Je(i.TEXTURE_CUBE_MAP,b);for(let pe=0;pe<6;pe++)if(b.mipmaps&&b.mipmaps.length>0)for(let be=0;be<b.mipmaps.length;be++)Ae(U.__webglFramebuffer[pe][be],I,b,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+pe,be);else Ae(U.__webglFramebuffer[pe],I,b,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0);g(b)&&m(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(De){for(let pe=0,be=ne.length;pe<be;pe++){let lt=ne[pe],se=n.get(lt);t.bindTexture(i.TEXTURE_2D,se.__webglTexture),Je(i.TEXTURE_2D,lt),Ae(U.__webglFramebuffer,I,lt,i.COLOR_ATTACHMENT0+pe,i.TEXTURE_2D,0),g(lt)&&m(i.TEXTURE_2D)}t.unbindTexture()}else{let pe=i.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(pe=I.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(pe,X.__webglTexture),Je(pe,b),b.mipmaps&&b.mipmaps.length>0)for(let be=0;be<b.mipmaps.length;be++)Ae(U.__webglFramebuffer[be],I,b,i.COLOR_ATTACHMENT0,pe,be);else Ae(U.__webglFramebuffer,I,b,i.COLOR_ATTACHMENT0,pe,0);g(b)&&m(pe),t.unbindTexture()}I.depthBuffer&&Ze(I)}function te(I){let b=I.textures;for(let U=0,X=b.length;U<X;U++){let ne=b[U];if(g(ne)){let K=_(I),De=n.get(ne).__webglTexture;t.bindTexture(K,De),m(K),t.unbindTexture()}}}let ae=[],N=[];function Ie(I){if(I.samples>0){if(Me(I)===!1){let b=I.textures,U=I.width,X=I.height,ne=i.COLOR_BUFFER_BIT,K=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,De=n.get(I),pe=b.length>1;if(pe)for(let be=0;be<b.length;be++)t.bindFramebuffer(i.FRAMEBUFFER,De.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+be,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,De.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+be,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,De.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,De.__webglFramebuffer);for(let be=0;be<b.length;be++){if(I.resolveDepthBuffer&&(I.depthBuffer&&(ne|=i.DEPTH_BUFFER_BIT),I.stencilBuffer&&I.resolveStencilBuffer&&(ne|=i.STENCIL_BUFFER_BIT)),pe){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,De.__webglColorRenderbuffer[be]);let lt=n.get(b[be]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,lt,0)}i.blitFramebuffer(0,0,U,X,0,0,U,X,ne,i.NEAREST),c===!0&&(ae.length=0,N.length=0,ae.push(i.COLOR_ATTACHMENT0+be),I.depthBuffer&&I.resolveDepthBuffer===!1&&(ae.push(K),N.push(K),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,N)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,ae))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),pe)for(let be=0;be<b.length;be++){t.bindFramebuffer(i.FRAMEBUFFER,De.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+be,i.RENDERBUFFER,De.__webglColorRenderbuffer[be]);let lt=n.get(b[be]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,De.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+be,i.TEXTURE_2D,lt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,De.__webglMultisampledFramebuffer)}else if(I.depthBuffer&&I.resolveDepthBuffer===!1&&c){let b=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[b])}}}function re(I){return Math.min(r.maxSamples,I.samples)}function Me(I){let b=n.get(I);return I.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&b.__useRenderToTexture!==!1}function he(I){let b=o.render.frame;u.get(I)!==b&&(u.set(I,b),I.update())}function He(I,b){let U=I.colorSpace,X=I.format,ne=I.type;return I.isCompressedTexture===!0||I.isVideoTexture===!0||U!==Tn&&U!==Qr&&(it.getTransfer(U)===It?(X!==En||ne!==ki)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",U)),b}function Se(I){return typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement?(l.width=I.naturalWidth||I.width,l.height=I.naturalHeight||I.height):typeof VideoFrame<"u"&&I instanceof VideoFrame?(l.width=I.displayWidth,l.height=I.displayHeight):(l.width=I.width,l.height=I.height),l}this.allocateTextureUnit=k,this.resetTextureUnits=B,this.setTexture2D=Y,this.setTexture2DArray=V,this.setTexture3D=$,this.setTextureCube=z,this.rebindTextures=$e,this.setupRenderTarget=pt,this.updateRenderTargetMipmap=te,this.updateMultisampleRenderTarget=Ie,this.setupDepthRenderbuffer=Ze,this.setupFrameBufferTexture=Ae,this.useMultisampledRTT=Me}function aI(i,e){function t(n,r=Qr){let s,o=it.getTransfer(r);if(n===ki)return i.UNSIGNED_BYTE;if(n===og)return i.UNSIGNED_SHORT_4_4_4_4;if(n===ag)return i.UNSIGNED_SHORT_5_5_5_1;if(n===qx)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===Wx)return i.BYTE;if(n===$x)return i.SHORT;if(n===Tc)return i.UNSIGNED_SHORT;if(n===sg)return i.INT;if(n===cs)return i.UNSIGNED_INT;if(n===ti)return i.FLOAT;if(n===$c)return i.HALF_FLOAT;if(n===Xx)return i.ALPHA;if(n===Yx)return i.RGB;if(n===En)return i.RGBA;if(n===Zx)return i.LUMINANCE;if(n===Kx)return i.LUMINANCE_ALPHA;if(n===Yo)return i.DEPTH_COMPONENT;if(n===ea)return i.DEPTH_STENCIL;if(n===cg)return i.RED;if(n===rd)return i.RED_INTEGER;if(n===Jx)return i.RG;if(n===lg)return i.RG_INTEGER;if(n===ug)return i.RGBA_INTEGER;if(n===hu||n===pu||n===mu||n===gu)if(o===It)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===hu)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===pu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===mu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===gu)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===hu)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===pu)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===mu)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===gu)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Rp||n===Np||n===Pp||n===Op)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===Rp)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Np)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Pp)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Op)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Lp||n===Fp||n===kp)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===Lp||n===Fp)return o===It?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===kp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Up||n===Bp||n===Vp||n===zp||n===Hp||n===Gp||n===jp||n===Wp||n===$p||n===qp||n===Xp||n===Yp||n===Zp||n===Kp)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===Up)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Bp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Vp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===zp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Hp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Gp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===jp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Wp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===$p)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===qp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Xp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Yp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Zp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Kp)return o===It?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===vu||n===Jp||n===Qp)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===vu)return o===It?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Jp)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Qp)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Qx||n===em||n===tm||n===nm)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===vu)return s.COMPRESSED_RED_RGTC1_EXT;if(n===em)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===tm)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===nm)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Qo?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}var am=class extends Ot{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Li=class extends Rt{constructor(){super(),this.isGroup=!0,this.type="Group"}},Nz={type:"move"},_u=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Li,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Li,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new A,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new A),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Li,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new A,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new A),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null,a=this._targetRay,c=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){o=!0;for(let v of e.hand.values()){let g=t.getJointPose(v,n),m=this._getHandJoint(l,v);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}let u=l.joints["index-finger-tip"],d=l.joints["thumb-tip"],f=u.position.distanceTo(d.position),h=.02,p=.005;l.inputState.pinching&&f>h+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&f<=h-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Nz)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),l!==null&&(l.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new Li;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},Pz=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Oz=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,j0=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){let r=new cn,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,n=new vi({vertexShader:Pz,fragmentShader:Oz,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ft(new Rc(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},W0=class extends ni{constructor(e,t){super();let n=this,r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,d=null,f=null,h=null,p=null,v=new j0,g=t.getContextAttributes(),m=null,_=null,x=[],y=[],D=new q,w=null,E=new Ot;E.viewport=new _t;let C=new Ot;C.viewport=new _t;let S=[E,C],M=new am,R=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let le=x[J];return le===void 0&&(le=new _u,x[J]=le),le.getTargetRaySpace()},this.getControllerGrip=function(J){let le=x[J];return le===void 0&&(le=new _u,x[J]=le),le.getGripSpace()},this.getHand=function(J){let le=x[J];return le===void 0&&(le=new _u,x[J]=le),le.getHandSpace()};function k(J){let le=y.indexOf(J.inputSource);if(le===-1)return;let Ae=x[le];Ae!==void 0&&(Ae.update(J.inputSource,J.frame,l||o),Ae.dispatchEvent({type:J.type,data:J.inputSource}))}function j(){r.removeEventListener("select",k),r.removeEventListener("selectstart",k),r.removeEventListener("selectend",k),r.removeEventListener("squeeze",k),r.removeEventListener("squeezestart",k),r.removeEventListener("squeezeend",k),r.removeEventListener("end",j),r.removeEventListener("inputsourceschange",Y);for(let J=0;J<x.length;J++){let le=y[J];le!==null&&(y[J]=null,x[J].disconnect(le))}R=null,B=null,v.reset(),e.setRenderTarget(m),h=null,f=null,d=null,r=null,_=null,Mt.stop(),n.isPresenting=!1,e.setPixelRatio(w),e.setSize(D.width,D.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){s=J,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){a=J,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(J){l=J},this.getBaseLayer=function(){return f!==null?f:h},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(J){return Ss(this,null,function*(){if(r=J,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",k),r.addEventListener("selectstart",k),r.addEventListener("selectend",k),r.addEventListener("squeeze",k),r.addEventListener("squeezestart",k),r.addEventListener("squeezeend",k),r.addEventListener("end",j),r.addEventListener("inputsourceschange",Y),g.xrCompatible!==!0&&(yield t.makeXRCompatible()),w=e.getPixelRatio(),e.getSize(D),r.renderState.layers===void 0){let le={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};h=new XRWebGLLayer(r,t,le),r.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),_=new gi(h.framebufferWidth,h.framebufferHeight,{format:En,type:ki,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let le=null,Ae=null,fe=null;g.depth&&(fe=g.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,le=g.stencil?ea:Yo,Ae=g.stencil?Qo:cs);let Be={colorFormat:t.RGBA8,depthFormat:fe,scaleFactor:s};d=new XRWebGLBinding(r,t),f=d.createProjectionLayer(Be),r.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),_=new gi(f.textureWidth,f.textureHeight,{format:En,type:ki,depthTexture:new Nu(f.textureWidth,f.textureHeight,Ae,void 0,void 0,void 0,void 0,void 0,void 0,le),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:f.ignoreDepthValues===!1})}_.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),Mt.setContext(r),Mt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};function Y(J){for(let le=0;le<J.removed.length;le++){let Ae=J.removed[le],fe=y.indexOf(Ae);fe>=0&&(y[fe]=null,x[fe].disconnect(Ae))}for(let le=0;le<J.added.length;le++){let Ae=J.added[le],fe=y.indexOf(Ae);if(fe===-1){for(let Ze=0;Ze<x.length;Ze++)if(Ze>=y.length){y.push(Ae),fe=Ze;break}else if(y[Ze]===null){y[Ze]=Ae,fe=Ze;break}if(fe===-1)break}let Be=x[fe];Be&&Be.connect(Ae)}}let V=new A,$=new A;function z(J,le,Ae){V.setFromMatrixPosition(le.matrixWorld),$.setFromMatrixPosition(Ae.matrixWorld);let fe=V.distanceTo($),Be=le.projectionMatrix.elements,Ze=Ae.projectionMatrix.elements,$e=Be[14]/(Be[10]-1),pt=Be[14]/(Be[10]+1),te=(Be[9]+1)/Be[5],ae=(Be[9]-1)/Be[5],N=(Be[8]-1)/Be[0],Ie=(Ze[8]+1)/Ze[0],re=$e*N,Me=$e*Ie,he=fe/(-N+Ie),He=he*-N;if(le.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(He),J.translateZ(he),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert(),Be[10]===-1)J.projectionMatrix.copy(le.projectionMatrix),J.projectionMatrixInverse.copy(le.projectionMatrixInverse);else{let Se=$e+he,I=pt+he,b=re-He,U=Me+(fe-He),X=te*pt/I*Se,ne=ae*pt/I*Se;J.projectionMatrix.makePerspective(b,U,X,ne,Se,I),J.projectionMatrixInverse.copy(J.projectionMatrix).invert()}}function ce(J,le){le===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(le.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(r===null)return;let le=J.near,Ae=J.far;v.texture!==null&&(v.depthNear>0&&(le=v.depthNear),v.depthFar>0&&(Ae=v.depthFar)),M.near=C.near=E.near=le,M.far=C.far=E.far=Ae,(R!==M.near||B!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),R=M.near,B=M.far),E.layers.mask=J.layers.mask|2,C.layers.mask=J.layers.mask|4,M.layers.mask=E.layers.mask|C.layers.mask;let fe=J.parent,Be=M.cameras;ce(M,fe);for(let Ze=0;Ze<Be.length;Ze++)ce(Be[Ze],fe);Be.length===2?z(M,E,C):M.projectionMatrix.copy(E.projectionMatrix),ge(J,M,fe)};function ge(J,le,Ae){Ae===null?J.matrix.copy(le.matrixWorld):(J.matrix.copy(Ae.matrixWorld),J.matrix.invert(),J.matrix.multiply(le.matrixWorld)),J.matrix.decompose(J.position,J.quaternion,J.scale),J.updateMatrixWorld(!0),J.projectionMatrix.copy(le.projectionMatrix),J.projectionMatrixInverse.copy(le.projectionMatrixInverse),J.isPerspectiveCamera&&(J.fov=Cc*2*Math.atan(1/J.projectionMatrix.elements[5]),J.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(f===null&&h===null))return c},this.setFoveation=function(J){c=J,f!==null&&(f.fixedFoveation=J),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=J)},this.hasDepthSensing=function(){return v.texture!==null},this.getDepthSensingMesh=function(){return v.getMesh(M)};let we=null;function Je(J,le){if(u=le.getViewerPose(l||o),p=le,u!==null){let Ae=u.views;h!==null&&(e.setRenderTargetFramebuffer(_,h.framebuffer),e.setRenderTarget(_));let fe=!1;Ae.length!==M.cameras.length&&(M.cameras.length=0,fe=!0);for(let Ze=0;Ze<Ae.length;Ze++){let $e=Ae[Ze],pt=null;if(h!==null)pt=h.getViewport($e);else{let ae=d.getViewSubImage(f,$e);pt=ae.viewport,Ze===0&&(e.setRenderTargetTextures(_,ae.colorTexture,f.ignoreDepthValues?void 0:ae.depthStencilTexture),e.setRenderTarget(_))}let te=S[Ze];te===void 0&&(te=new Ot,te.layers.enable(Ze),te.viewport=new _t,S[Ze]=te),te.matrix.fromArray($e.transform.matrix),te.matrix.decompose(te.position,te.quaternion,te.scale),te.projectionMatrix.fromArray($e.projectionMatrix),te.projectionMatrixInverse.copy(te.projectionMatrix).invert(),te.viewport.set(pt.x,pt.y,pt.width,pt.height),Ze===0&&(M.matrix.copy(te.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),fe===!0&&M.cameras.push(te)}let Be=r.enabledFeatures;if(Be&&Be.includes("depth-sensing")){let Ze=d.getDepthInformation(Ae[0]);Ze&&Ze.isValid&&Ze.texture&&v.init(e,Ze,r.renderState)}}for(let Ae=0;Ae<x.length;Ae++){let fe=y[Ae],Be=x[Ae];fe!==null&&Be!==void 0&&Be.update(fe,le,l||o)}we&&we(J,le),le.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:le}),p=null}let Mt=new nI;Mt.setAnimationLoop(Je),this.setAnimationLoop=function(J){we=J},this.dispose=function(){}}},Po=new Er,Lz=new Ve;function Fz(i,e){function t(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function n(g,m){m.color.getRGB(g.fogColor.value,eI(i)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function r(g,m,_,x,y){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),d(g,m)):m.isMeshPhongMaterial?(s(g,m),u(g,m)):m.isMeshStandardMaterial?(s(g,m),f(g,m),m.isMeshPhysicalMaterial&&h(g,m,y)):m.isMeshMatcapMaterial?(s(g,m),p(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),v(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(o(g,m),m.isLineDashedMaterial&&a(g,m)):m.isPointsMaterial?c(g,m,_,x):m.isSpriteMaterial?l(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,t(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===Bn&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,t(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===Bn&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,t(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,t(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);let _=e.get(m),x=_.envMap,y=_.envMapRotation;x&&(g.envMap.value=x,Po.copy(y),Po.x*=-1,Po.y*=-1,Po.z*=-1,x.isCubeTexture&&x.isRenderTargetTexture===!1&&(Po.y*=-1,Po.z*=-1),g.envMapRotation.value.setFromMatrix4(Lz.makeRotationFromEuler(Po)),g.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap&&(g.lightMap.value=m.lightMap,g.lightMapIntensity.value=m.lightMapIntensity,t(m.lightMap,g.lightMapTransform)),m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,g.aoMapTransform))}function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform))}function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function c(g,m,_,x){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*_,g.scale.value=x*.5,m.map&&(g.map.value=m.map,t(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function l(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,t(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,t(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function u(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function d(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function f(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,g.roughnessMapTransform)),m.envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function h(g,m,_){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===Bn&&g.clearcoatNormalScale.value.negate())),m.dispersion>0&&(g.dispersion.value=m.dispersion),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=_.texture,g.transmissionSamplerSize.value.set(_.width,_.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,g.specularIntensityMapTransform))}function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}function v(g,m){let _=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(_.matrixWorld),g.nearDistance.value=_.shadow.camera.near,g.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function kz(i,e,t,n){let r={},s={},o=[],a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function c(_,x){let y=x.program;n.uniformBlockBinding(_,y)}function l(_,x){let y=r[_.id];y===void 0&&(p(_),y=u(_),r[_.id]=y,_.addEventListener("dispose",g));let D=x.program;n.updateUBOMapping(_,D);let w=e.render.frame;s[_.id]!==w&&(f(_),s[_.id]=w)}function u(_){let x=d();_.__bindingPointIndex=x;let y=i.createBuffer(),D=_.__size,w=_.usage;return i.bindBuffer(i.UNIFORM_BUFFER,y),i.bufferData(i.UNIFORM_BUFFER,D,w),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,x,y),y}function d(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(_){let x=r[_.id],y=_.uniforms,D=_.__cache;i.bindBuffer(i.UNIFORM_BUFFER,x);for(let w=0,E=y.length;w<E;w++){let C=Array.isArray(y[w])?y[w]:[y[w]];for(let S=0,M=C.length;S<M;S++){let R=C[S];if(h(R,w,S,D)===!0){let B=R.__offset,k=Array.isArray(R.value)?R.value:[R.value],j=0;for(let Y=0;Y<k.length;Y++){let V=k[Y],$=v(V);typeof V=="number"||typeof V=="boolean"?(R.__data[0]=V,i.bufferSubData(i.UNIFORM_BUFFER,B+j,R.__data)):V.isMatrix3?(R.__data[0]=V.elements[0],R.__data[1]=V.elements[1],R.__data[2]=V.elements[2],R.__data[3]=0,R.__data[4]=V.elements[3],R.__data[5]=V.elements[4],R.__data[6]=V.elements[5],R.__data[7]=0,R.__data[8]=V.elements[6],R.__data[9]=V.elements[7],R.__data[10]=V.elements[8],R.__data[11]=0):(V.toArray(R.__data,j),j+=$.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,B,R.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function h(_,x,y,D){let w=_.value,E=x+"_"+y;if(D[E]===void 0)return typeof w=="number"||typeof w=="boolean"?D[E]=w:D[E]=w.clone(),!0;{let C=D[E];if(typeof w=="number"||typeof w=="boolean"){if(C!==w)return D[E]=w,!0}else if(C.equals(w)===!1)return C.copy(w),!0}return!1}function p(_){let x=_.uniforms,y=0,D=16;for(let E=0,C=x.length;E<C;E++){let S=Array.isArray(x[E])?x[E]:[x[E]];for(let M=0,R=S.length;M<R;M++){let B=S[M],k=Array.isArray(B.value)?B.value:[B.value];for(let j=0,Y=k.length;j<Y;j++){let V=k[j],$=v(V),z=y%D,ce=z%$.boundary,ge=z+ce;y+=ce,ge!==0&&D-ge<$.storage&&(y+=D-ge),B.__data=new Float32Array($.storage/Float32Array.BYTES_PER_ELEMENT),B.__offset=y,y+=$.storage}}}let w=y%D;return w>0&&(y+=D-w),_.__size=y,_.__cache={},this}function v(_){let x={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(x.boundary=4,x.storage=4):_.isVector2?(x.boundary=8,x.storage=8):_.isVector3||_.isColor?(x.boundary=16,x.storage=12):_.isVector4?(x.boundary=16,x.storage=16):_.isMatrix3?(x.boundary=48,x.storage=48):_.isMatrix4?(x.boundary=64,x.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),x}function g(_){let x=_.target;x.removeEventListener("dispose",g);let y=o.indexOf(x.__bindingPointIndex);o.splice(y,1),i.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function m(){for(let _ in r)i.deleteBuffer(r[_]);o=[],r={},s={}}return{bind:c,update:l,dispose:m}}var Lu=class{constructor(e={}){let{canvas:t=JD(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reverseDepthBuffer:f=!1}=e;this.isWebGLRenderer=!0;let h;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");h=n.getContextAttributes().alpha}else h=o;let p=new Uint32Array(4),v=new Int32Array(4),g=null,m=null,_=[],x=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=sn,this.toneMapping=sr,this.toneMappingExposure=1;let y=this,D=!1,w=0,E=0,C=null,S=-1,M=null,R=new _t,B=new _t,k=null,j=new de(0),Y=0,V=t.width,$=t.height,z=1,ce=null,ge=null,we=new _t(0,0,V,$),Je=new _t(0,0,V,$),Mt=!1,J=new sa,le=!1,Ae=!1,fe=new Ve,Be=new Ve,Ze=new A,$e=new _t,pt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},te=!1;function ae(){return C===null?z:1}let N=n;function Ie(T,L){return t.getContext(T,L)}try{let T={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ig}`),t.addEventListener("webglcontextlost",Q,!1),t.addEventListener("webglcontextrestored",_e,!1),t.addEventListener("webglcontextcreationerror",ye,!1),N===null){let L="webgl2";if(N=Ie(L,T),N===null)throw Ie(L)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(T){throw console.error("THREE.WebGLRenderer: "+T.message),T}let re,Me,he,He,Se,I,b,U,X,ne,K,De,pe,be,lt,se,Te,We,Xe,Ee,O,Z,ve,P;function oe(){re=new Z3(N),re.init(),Z=new aI(N,re),Me=new j3(N,re,e,Z),he=new Ez(N,re),Me.reverseDepthBuffer&&f&&he.buffers.depth.setReversed(!0),He=new Q3(N),Se=new fz,I=new Rz(N,re,he,Se,Me,Z,He),b=new $3(y),U=new Y3(y),X=new oU(N),ve=new H3(N,X),ne=new K3(N,X,He,ve),K=new tV(N,ne,X,He),Xe=new eV(N,Me,I),se=new W3(Se),De=new dz(y,b,U,re,Me,ve,se),pe=new Fz(y,Se),be=new pz,lt=new xz(re),We=new z3(y,b,U,he,K,h,c),Te=new bz(y,K,Me),P=new kz(N,He,Me,he),Ee=new G3(N,re,He),O=new J3(N,re,He),He.programs=De.programs,y.capabilities=Me,y.extensions=re,y.properties=Se,y.renderLists=be,y.shadowMap=Te,y.state=he,y.info=He}oe();let W=new W0(y,N);this.xr=W,this.getContext=function(){return N},this.getContextAttributes=function(){return N.getContextAttributes()},this.forceContextLoss=function(){let T=re.get("WEBGL_lose_context");T&&T.loseContext()},this.forceContextRestore=function(){let T=re.get("WEBGL_lose_context");T&&T.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(T){T!==void 0&&(z=T,this.setSize(V,$,!1))},this.getSize=function(T){return T.set(V,$)},this.setSize=function(T,L,H=!0){if(W.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}V=T,$=L,t.width=Math.floor(T*z),t.height=Math.floor(L*z),H===!0&&(t.style.width=T+"px",t.style.height=L+"px"),this.setViewport(0,0,T,L)},this.getDrawingBufferSize=function(T){return T.set(V*z,$*z).floor()},this.setDrawingBufferSize=function(T,L,H){V=T,$=L,z=H,t.width=Math.floor(T*H),t.height=Math.floor(L*H),this.setViewport(0,0,T,L)},this.getCurrentViewport=function(T){return T.copy(R)},this.getViewport=function(T){return T.copy(we)},this.setViewport=function(T,L,H,G){T.isVector4?we.set(T.x,T.y,T.z,T.w):we.set(T,L,H,G),he.viewport(R.copy(we).multiplyScalar(z).round())},this.getScissor=function(T){return T.copy(Je)},this.setScissor=function(T,L,H,G){T.isVector4?Je.set(T.x,T.y,T.z,T.w):Je.set(T,L,H,G),he.scissor(B.copy(Je).multiplyScalar(z).round())},this.getScissorTest=function(){return Mt},this.setScissorTest=function(T){he.setScissorTest(Mt=T)},this.setOpaqueSort=function(T){ce=T},this.setTransparentSort=function(T){ge=T},this.getClearColor=function(T){return T.copy(We.getClearColor())},this.setClearColor=function(){We.setClearColor.apply(We,arguments)},this.getClearAlpha=function(){return We.getClearAlpha()},this.setClearAlpha=function(){We.setClearAlpha.apply(We,arguments)},this.clear=function(T=!0,L=!0,H=!0){let G=0;if(T){let F=!1;if(C!==null){let ue=C.texture.format;F=ue===ug||ue===lg||ue===rd}if(F){let ue=C.texture.type,xe=ue===ki||ue===cs||ue===Tc||ue===Qo||ue===og||ue===ag,Re=We.getClearColor(),Ne=We.getClearAlpha(),Qe=Re.r,st=Re.g,Pe=Re.b;xe?(p[0]=Qe,p[1]=st,p[2]=Pe,p[3]=Ne,N.clearBufferuiv(N.COLOR,0,p)):(v[0]=Qe,v[1]=st,v[2]=Pe,v[3]=Ne,N.clearBufferiv(N.COLOR,0,v))}else G|=N.COLOR_BUFFER_BIT}L&&(G|=N.DEPTH_BUFFER_BIT),H&&(G|=N.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),N.clear(G)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Q,!1),t.removeEventListener("webglcontextrestored",_e,!1),t.removeEventListener("webglcontextcreationerror",ye,!1),be.dispose(),lt.dispose(),Se.dispose(),b.dispose(),U.dispose(),K.dispose(),ve.dispose(),P.dispose(),De.dispose(),W.dispose(),W.removeEventListener("sessionstart",kS),W.removeEventListener("sessionend",US),oo.stop()};function Q(T){T.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function _e(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;let T=He.autoReset,L=Te.enabled,H=Te.autoUpdate,G=Te.needsUpdate,F=Te.type;oe(),He.autoReset=T,Te.enabled=L,Te.autoUpdate=H,Te.needsUpdate=G,Te.type=F}function ye(T){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",T.statusMessage)}function Ge(T){let L=T.target;L.removeEventListener("dispose",Ge),wt(L)}function wt(T){Gt(T),Se.remove(T)}function Gt(T){let L=Se.get(T).programs;L!==void 0&&(L.forEach(function(H){De.releaseProgram(H)}),T.isShaderMaterial&&De.releaseShaderCache(T))}this.renderBufferDirect=function(T,L,H,G,F,ue){L===null&&(L=pt);let xe=F.isMesh&&F.matrixWorld.determinant()<0,Re=FR(T,L,H,G,F);he.setMaterial(G,xe);let Ne=H.index,Qe=1;if(G.wireframe===!0){if(Ne=ne.getWireframeAttribute(H),Ne===void 0)return;Qe=2}let st=H.drawRange,Pe=H.attributes.position,Et=st.start*Qe,Lt=(st.start+st.count)*Qe;ue!==null&&(Et=Math.max(Et,ue.start*Qe),Lt=Math.min(Lt,(ue.start+ue.count)*Qe)),Ne!==null?(Et=Math.max(Et,0),Lt=Math.min(Lt,Ne.count)):Pe!=null&&(Et=Math.max(Et,0),Lt=Math.min(Lt,Pe.count));let kt=Lt-Et;if(kt<0||kt===1/0)return;ve.setup(F,G,Re,H,Ne);let Gn,Tt=Ee;if(Ne!==null&&(Gn=X.get(Ne),Tt=O,Tt.setIndex(Gn)),F.isMesh)G.wireframe===!0?(he.setLineWidth(G.wireframeLinewidth*ae()),Tt.setMode(N.LINES)):Tt.setMode(N.TRIANGLES);else if(F.isLine){let Fe=G.linewidth;Fe===void 0&&(Fe=1),he.setLineWidth(Fe*ae()),F.isLineSegments?Tt.setMode(N.LINES):F.isLineLoop?Tt.setMode(N.LINE_LOOP):Tt.setMode(N.LINE_STRIP)}else F.isPoints?Tt.setMode(N.POINTS):F.isSprite&&Tt.setMode(N.TRIANGLES);if(F.isBatchedMesh)if(F._multiDrawInstances!==null)Tt.renderMultiDrawInstances(F._multiDrawStarts,F._multiDrawCounts,F._multiDrawCount,F._multiDrawInstances);else if(re.get("WEBGL_multi_draw"))Tt.renderMultiDraw(F._multiDrawStarts,F._multiDrawCounts,F._multiDrawCount);else{let Fe=F._multiDrawStarts,Or=F._multiDrawCounts,Ct=F._multiDrawCount,zi=Ne?X.get(Ne).bytesPerElement:1,ga=Se.get(G).currentProgram.getUniforms();for(let oi=0;oi<Ct;oi++)ga.setValue(N,"_gl_DrawID",oi),Tt.render(Fe[oi]/zi,Or[oi])}else if(F.isInstancedMesh)Tt.renderInstances(Et,kt,F.count);else if(H.isInstancedBufferGeometry){let Fe=H._maxInstanceCount!==void 0?H._maxInstanceCount:1/0,Or=Math.min(H.instanceCount,Fe);Tt.renderInstances(Et,kt,Or)}else Tt.render(Et,kt)};function mt(T,L,H){T.transparent===!0&&T.side===Qn&&T.forceSinglePass===!1?(T.side=Bn,T.needsUpdate=!0,Gd(T,L,H),T.side=or,T.needsUpdate=!0,Gd(T,L,H),T.side=Qn):Gd(T,L,H)}this.compile=function(T,L,H=null){H===null&&(H=T),m=lt.get(H),m.init(L),x.push(m),H.traverseVisible(function(F){F.isLight&&F.layers.test(L.layers)&&(m.pushLight(F),F.castShadow&&m.pushShadow(F))}),T!==H&&T.traverseVisible(function(F){F.isLight&&F.layers.test(L.layers)&&(m.pushLight(F),F.castShadow&&m.pushShadow(F))}),m.setupLights();let G=new Set;return T.traverse(function(F){if(!(F.isMesh||F.isPoints||F.isLine||F.isSprite))return;let ue=F.material;if(ue)if(Array.isArray(ue))for(let xe=0;xe<ue.length;xe++){let Re=ue[xe];mt(Re,H,F),G.add(Re)}else mt(ue,H,F),G.add(ue)}),x.pop(),m=null,G},this.compileAsync=function(T,L,H=null){let G=this.compile(T,L,H);return new Promise(F=>{function ue(){if(G.forEach(function(xe){Se.get(xe).currentProgram.isReady()&&G.delete(xe)}),G.size===0){F(T);return}setTimeout(ue,10)}re.get("KHR_parallel_shader_compile")!==null?ue():setTimeout(ue,10)})};let Mn=null;function Hn(T){Mn&&Mn(T)}function kS(){oo.stop()}function US(){oo.start()}let oo=new nI;oo.setAnimationLoop(Hn),typeof self<"u"&&oo.setContext(self),this.setAnimationLoop=function(T){Mn=T,W.setAnimationLoop(T),T===null?oo.stop():oo.start()},W.addEventListener("sessionstart",kS),W.addEventListener("sessionend",US),this.render=function(T,L){if(L!==void 0&&L.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;if(T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld(),L.parent===null&&L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld(),W.enabled===!0&&W.isPresenting===!0&&(W.cameraAutoUpdate===!0&&W.updateCamera(L),L=W.getCamera()),T.isScene===!0&&T.onBeforeRender(y,T,L,C),m=lt.get(T,x.length),m.init(L),x.push(m),Be.multiplyMatrices(L.projectionMatrix,L.matrixWorldInverse),J.setFromProjectionMatrix(Be),Ae=this.localClippingEnabled,le=se.init(this.clippingPlanes,Ae),g=be.get(T,_.length),g.init(),_.push(g),W.enabled===!0&&W.isPresenting===!0){let ue=y.xr.getDepthSensingMesh();ue!==null&&Yg(ue,L,-1/0,y.sortObjects)}Yg(T,L,0,y.sortObjects),g.finish(),y.sortObjects===!0&&g.sort(ce,ge),te=W.enabled===!1||W.isPresenting===!1||W.hasDepthSensing()===!1,te&&We.addToRenderList(g,T),this.info.render.frame++,le===!0&&se.beginShadows();let H=m.state.shadowsArray;Te.render(H,T,L),le===!0&&se.endShadows(),this.info.autoReset===!0&&this.info.reset();let G=g.opaque,F=g.transmissive;if(m.setupLights(),L.isArrayCamera){let ue=L.cameras;if(F.length>0)for(let xe=0,Re=ue.length;xe<Re;xe++){let Ne=ue[xe];VS(G,F,T,Ne)}te&&We.render(T);for(let xe=0,Re=ue.length;xe<Re;xe++){let Ne=ue[xe];BS(g,T,Ne,Ne.viewport)}}else F.length>0&&VS(G,F,T,L),te&&We.render(T),BS(g,T,L);C!==null&&(I.updateMultisampleRenderTarget(C),I.updateRenderTargetMipmap(C)),T.isScene===!0&&T.onAfterRender(y,T,L),ve.resetDefaultState(),S=-1,M=null,x.pop(),x.length>0?(m=x[x.length-1],le===!0&&se.setGlobalState(y.clippingPlanes,m.state.camera)):m=null,_.pop(),_.length>0?g=_[_.length-1]:g=null};function Yg(T,L,H,G){if(T.visible===!1)return;if(T.layers.test(L.layers)){if(T.isGroup)H=T.renderOrder;else if(T.isLOD)T.autoUpdate===!0&&T.update(L);else if(T.isLight)m.pushLight(T),T.castShadow&&m.pushShadow(T);else if(T.isSprite){if(!T.frustumCulled||J.intersectsSprite(T)){G&&$e.setFromMatrixPosition(T.matrixWorld).applyMatrix4(Be);let xe=K.update(T),Re=T.material;Re.visible&&g.push(T,xe,Re,H,$e.z,null)}}else if((T.isMesh||T.isLine||T.isPoints)&&(!T.frustumCulled||J.intersectsObject(T))){let xe=K.update(T),Re=T.material;if(G&&(T.boundingSphere!==void 0?(T.boundingSphere===null&&T.computeBoundingSphere(),$e.copy(T.boundingSphere.center)):(xe.boundingSphere===null&&xe.computeBoundingSphere(),$e.copy(xe.boundingSphere.center)),$e.applyMatrix4(T.matrixWorld).applyMatrix4(Be)),Array.isArray(Re)){let Ne=xe.groups;for(let Qe=0,st=Ne.length;Qe<st;Qe++){let Pe=Ne[Qe],Et=Re[Pe.materialIndex];Et&&Et.visible&&g.push(T,xe,Et,H,$e.z,Pe)}}else Re.visible&&g.push(T,xe,Re,H,$e.z,null)}}let ue=T.children;for(let xe=0,Re=ue.length;xe<Re;xe++)Yg(ue[xe],L,H,G)}function BS(T,L,H,G){let F=T.opaque,ue=T.transmissive,xe=T.transparent;m.setupLightsView(H),le===!0&&se.setGlobalState(y.clippingPlanes,H),G&&he.viewport(R.copy(G)),F.length>0&&Hd(F,L,H),ue.length>0&&Hd(ue,L,H),xe.length>0&&Hd(xe,L,H),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1)}function VS(T,L,H,G){if((H.isScene===!0?H.overrideMaterial:null)!==null)return;m.state.transmissionRenderTarget[G.id]===void 0&&(m.state.transmissionRenderTarget[G.id]=new gi(1,1,{generateMipmaps:!0,type:re.has("EXT_color_buffer_half_float")||re.has("EXT_color_buffer_float")?$c:ki,minFilter:pi,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:it.workingColorSpace}));let ue=m.state.transmissionRenderTarget[G.id],xe=G.viewport||R;ue.setSize(xe.z,xe.w);let Re=y.getRenderTarget();y.setRenderTarget(ue),y.getClearColor(j),Y=y.getClearAlpha(),Y<1&&y.setClearColor(16777215,.5),y.clear(),te&&We.render(H);let Ne=y.toneMapping;y.toneMapping=sr;let Qe=G.viewport;if(G.viewport!==void 0&&(G.viewport=void 0),m.setupLightsView(G),le===!0&&se.setGlobalState(y.clippingPlanes,G),Hd(T,H,G),I.updateMultisampleRenderTarget(ue),I.updateRenderTargetMipmap(ue),re.has("WEBGL_multisampled_render_to_texture")===!1){let st=!1;for(let Pe=0,Et=L.length;Pe<Et;Pe++){let Lt=L[Pe],kt=Lt.object,Gn=Lt.geometry,Tt=Lt.material,Fe=Lt.group;if(Tt.side===Qn&&kt.layers.test(G.layers)){let Or=Tt.side;Tt.side=Bn,Tt.needsUpdate=!0,zS(kt,H,G,Gn,Tt,Fe),Tt.side=Or,Tt.needsUpdate=!0,st=!0}}st===!0&&(I.updateMultisampleRenderTarget(ue),I.updateRenderTargetMipmap(ue))}y.setRenderTarget(Re),y.setClearColor(j,Y),Qe!==void 0&&(G.viewport=Qe),y.toneMapping=Ne}function Hd(T,L,H){let G=L.isScene===!0?L.overrideMaterial:null;for(let F=0,ue=T.length;F<ue;F++){let xe=T[F],Re=xe.object,Ne=xe.geometry,Qe=G===null?xe.material:G,st=xe.group;Re.layers.test(H.layers)&&zS(Re,L,H,Ne,Qe,st)}}function zS(T,L,H,G,F,ue){T.onBeforeRender(y,L,H,G,F,ue),T.modelViewMatrix.multiplyMatrices(H.matrixWorldInverse,T.matrixWorld),T.normalMatrix.getNormalMatrix(T.modelViewMatrix),F.onBeforeRender(y,L,H,G,T,ue),F.transparent===!0&&F.side===Qn&&F.forceSinglePass===!1?(F.side=Bn,F.needsUpdate=!0,y.renderBufferDirect(H,L,G,F,T,ue),F.side=or,F.needsUpdate=!0,y.renderBufferDirect(H,L,G,F,T,ue),F.side=Qn):y.renderBufferDirect(H,L,G,F,T,ue),T.onAfterRender(y,L,H,G,F,ue)}function Gd(T,L,H){L.isScene!==!0&&(L=pt);let G=Se.get(T),F=m.state.lights,ue=m.state.shadowsArray,xe=F.state.version,Re=De.getParameters(T,F.state,ue,L,H),Ne=De.getProgramCacheKey(Re),Qe=G.programs;G.environment=T.isMeshStandardMaterial?L.environment:null,G.fog=L.fog,G.envMap=(T.isMeshStandardMaterial?U:b).get(T.envMap||G.environment),G.envMapRotation=G.environment!==null&&T.envMap===null?L.environmentRotation:T.envMapRotation,Qe===void 0&&(T.addEventListener("dispose",Ge),Qe=new Map,G.programs=Qe);let st=Qe.get(Ne);if(st!==void 0){if(G.currentProgram===st&&G.lightsStateVersion===xe)return GS(T,Re),st}else Re.uniforms=De.getUniforms(T),T.onBeforeCompile(Re,y),st=De.acquireProgram(Re,Ne),Qe.set(Ne,st),G.uniforms=Re.uniforms;let Pe=G.uniforms;return(!T.isShaderMaterial&&!T.isRawShaderMaterial||T.clipping===!0)&&(Pe.clippingPlanes=se.uniform),GS(T,Re),G.needsLights=UR(T),G.lightsStateVersion=xe,G.needsLights&&(Pe.ambientLightColor.value=F.state.ambient,Pe.lightProbe.value=F.state.probe,Pe.directionalLights.value=F.state.directional,Pe.directionalLightShadows.value=F.state.directionalShadow,Pe.spotLights.value=F.state.spot,Pe.spotLightShadows.value=F.state.spotShadow,Pe.rectAreaLights.value=F.state.rectArea,Pe.ltc_1.value=F.state.rectAreaLTC1,Pe.ltc_2.value=F.state.rectAreaLTC2,Pe.pointLights.value=F.state.point,Pe.pointLightShadows.value=F.state.pointShadow,Pe.hemisphereLights.value=F.state.hemi,Pe.directionalShadowMap.value=F.state.directionalShadowMap,Pe.directionalShadowMatrix.value=F.state.directionalShadowMatrix,Pe.spotShadowMap.value=F.state.spotShadowMap,Pe.spotLightMatrix.value=F.state.spotLightMatrix,Pe.spotLightMap.value=F.state.spotLightMap,Pe.pointShadowMap.value=F.state.pointShadowMap,Pe.pointShadowMatrix.value=F.state.pointShadowMatrix),G.currentProgram=st,G.uniformsList=null,st}function HS(T){if(T.uniformsList===null){let L=T.currentProgram.getUniforms();T.uniformsList=Ec.seqWithValue(L.seq,T.uniforms)}return T.uniformsList}function GS(T,L){let H=Se.get(T);H.outputColorSpace=L.outputColorSpace,H.batching=L.batching,H.batchingColor=L.batchingColor,H.instancing=L.instancing,H.instancingColor=L.instancingColor,H.instancingMorph=L.instancingMorph,H.skinning=L.skinning,H.morphTargets=L.morphTargets,H.morphNormals=L.morphNormals,H.morphColors=L.morphColors,H.morphTargetsCount=L.morphTargetsCount,H.numClippingPlanes=L.numClippingPlanes,H.numIntersection=L.numClipIntersection,H.vertexAlphas=L.vertexAlphas,H.vertexTangents=L.vertexTangents,H.toneMapping=L.toneMapping}function FR(T,L,H,G,F){L.isScene!==!0&&(L=pt),I.resetTextureUnits();let ue=L.fog,xe=G.isMeshStandardMaterial?L.environment:null,Re=C===null?y.outputColorSpace:C.isXRRenderTarget===!0?C.texture.colorSpace:Tn,Ne=(G.isMeshStandardMaterial?U:b).get(G.envMap||xe),Qe=G.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,st=!!H.attributes.tangent&&(!!G.normalMap||G.anisotropy>0),Pe=!!H.morphAttributes.position,Et=!!H.morphAttributes.normal,Lt=!!H.morphAttributes.color,kt=sr;G.toneMapped&&(C===null||C.isXRRenderTarget===!0)&&(kt=y.toneMapping);let Gn=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,Tt=Gn!==void 0?Gn.length:0,Fe=Se.get(G),Or=m.state.lights;if(le===!0&&(Ae===!0||T!==M)){let Si=T===M&&G.id===S;se.setState(G,T,Si)}let Ct=!1;G.version===Fe.__version?(Fe.needsLights&&Fe.lightsStateVersion!==Or.state.version||Fe.outputColorSpace!==Re||F.isBatchedMesh&&Fe.batching===!1||!F.isBatchedMesh&&Fe.batching===!0||F.isBatchedMesh&&Fe.batchingColor===!0&&F.colorTexture===null||F.isBatchedMesh&&Fe.batchingColor===!1&&F.colorTexture!==null||F.isInstancedMesh&&Fe.instancing===!1||!F.isInstancedMesh&&Fe.instancing===!0||F.isSkinnedMesh&&Fe.skinning===!1||!F.isSkinnedMesh&&Fe.skinning===!0||F.isInstancedMesh&&Fe.instancingColor===!0&&F.instanceColor===null||F.isInstancedMesh&&Fe.instancingColor===!1&&F.instanceColor!==null||F.isInstancedMesh&&Fe.instancingMorph===!0&&F.morphTexture===null||F.isInstancedMesh&&Fe.instancingMorph===!1&&F.morphTexture!==null||Fe.envMap!==Ne||G.fog===!0&&Fe.fog!==ue||Fe.numClippingPlanes!==void 0&&(Fe.numClippingPlanes!==se.numPlanes||Fe.numIntersection!==se.numIntersection)||Fe.vertexAlphas!==Qe||Fe.vertexTangents!==st||Fe.morphTargets!==Pe||Fe.morphNormals!==Et||Fe.morphColors!==Lt||Fe.toneMapping!==kt||Fe.morphTargetsCount!==Tt)&&(Ct=!0):(Ct=!0,Fe.__version=G.version);let zi=Fe.currentProgram;Ct===!0&&(zi=Gd(G,L,F));let ga=!1,oi=!1,hl=!1,Ut=zi.getUniforms(),dr=Fe.uniforms;if(he.useProgram(zi.program)&&(ga=!0,oi=!0,hl=!0),G.id!==S&&(S=G.id,oi=!0),ga||M!==T){he.buffers.depth.getReversed()?(fe.copy(T.projectionMatrix),Bk(fe),Vk(fe),Ut.setValue(N,"projectionMatrix",fe)):Ut.setValue(N,"projectionMatrix",T.projectionMatrix),Ut.setValue(N,"viewMatrix",T.matrixWorldInverse);let xs=Ut.map.cameraPosition;xs!==void 0&&xs.setValue(N,Ze.setFromMatrixPosition(T.matrixWorld)),Me.logarithmicDepthBuffer&&Ut.setValue(N,"logDepthBufFC",2/(Math.log(T.far+1)/Math.LN2)),(G.isMeshPhongMaterial||G.isMeshToonMaterial||G.isMeshLambertMaterial||G.isMeshBasicMaterial||G.isMeshStandardMaterial||G.isShaderMaterial)&&Ut.setValue(N,"isOrthographic",T.isOrthographicCamera===!0),M!==T&&(M=T,oi=!0,hl=!0)}if(F.isSkinnedMesh){Ut.setOptional(N,F,"bindMatrix"),Ut.setOptional(N,F,"bindMatrixInverse");let Si=F.skeleton;Si&&(Si.boneTexture===null&&Si.computeBoneTexture(),Ut.setValue(N,"boneTexture",Si.boneTexture,I))}F.isBatchedMesh&&(Ut.setOptional(N,F,"batchingTexture"),Ut.setValue(N,"batchingTexture",F._matricesTexture,I),Ut.setOptional(N,F,"batchingIdTexture"),Ut.setValue(N,"batchingIdTexture",F._indirectTexture,I),Ut.setOptional(N,F,"batchingColorTexture"),F._colorsTexture!==null&&Ut.setValue(N,"batchingColorTexture",F._colorsTexture,I));let pl=H.morphAttributes;if((pl.position!==void 0||pl.normal!==void 0||pl.color!==void 0)&&Xe.update(F,H,zi),(oi||Fe.receiveShadow!==F.receiveShadow)&&(Fe.receiveShadow=F.receiveShadow,Ut.setValue(N,"receiveShadow",F.receiveShadow)),G.isMeshGouraudMaterial&&G.envMap!==null&&(dr.envMap.value=Ne,dr.flipEnvMap.value=Ne.isCubeTexture&&Ne.isRenderTargetTexture===!1?-1:1),G.isMeshStandardMaterial&&G.envMap===null&&L.environment!==null&&(dr.envMapIntensity.value=L.environmentIntensity),oi&&(Ut.setValue(N,"toneMappingExposure",y.toneMappingExposure),Fe.needsLights&&kR(dr,hl),ue&&G.fog===!0&&pe.refreshFogUniforms(dr,ue),pe.refreshMaterialUniforms(dr,G,z,$,m.state.transmissionRenderTarget[T.id]),Ec.upload(N,HS(Fe),dr,I)),G.isShaderMaterial&&G.uniformsNeedUpdate===!0&&(Ec.upload(N,HS(Fe),dr,I),G.uniformsNeedUpdate=!1),G.isSpriteMaterial&&Ut.setValue(N,"center",F.center),Ut.setValue(N,"modelViewMatrix",F.modelViewMatrix),Ut.setValue(N,"normalMatrix",F.normalMatrix),Ut.setValue(N,"modelMatrix",F.matrixWorld),G.isShaderMaterial||G.isRawShaderMaterial){let Si=G.uniformsGroups;for(let xs=0,Ms=Si.length;xs<Ms;xs++){let jS=Si[xs];P.update(jS,zi),P.bind(jS,zi)}}return zi}function kR(T,L){T.ambientLightColor.needsUpdate=L,T.lightProbe.needsUpdate=L,T.directionalLights.needsUpdate=L,T.directionalLightShadows.needsUpdate=L,T.pointLights.needsUpdate=L,T.pointLightShadows.needsUpdate=L,T.spotLights.needsUpdate=L,T.spotLightShadows.needsUpdate=L,T.rectAreaLights.needsUpdate=L,T.hemisphereLights.needsUpdate=L}function UR(T){return T.isMeshLambertMaterial||T.isMeshToonMaterial||T.isMeshPhongMaterial||T.isMeshStandardMaterial||T.isShadowMaterial||T.isShaderMaterial&&T.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(T,L,H){Se.get(T.texture).__webglTexture=L,Se.get(T.depthTexture).__webglTexture=H;let G=Se.get(T);G.__hasExternalTextures=!0,G.__autoAllocateDepthBuffer=H===void 0,G.__autoAllocateDepthBuffer||re.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),G.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(T,L){let H=Se.get(T);H.__webglFramebuffer=L,H.__useDefaultFramebuffer=L===void 0},this.setRenderTarget=function(T,L=0,H=0){C=T,w=L,E=H;let G=!0,F=null,ue=!1,xe=!1;if(T){let Ne=Se.get(T);if(Ne.__useDefaultFramebuffer!==void 0)he.bindFramebuffer(N.FRAMEBUFFER,null),G=!1;else if(Ne.__webglFramebuffer===void 0)I.setupRenderTarget(T);else if(Ne.__hasExternalTextures)I.rebindTextures(T,Se.get(T.texture).__webglTexture,Se.get(T.depthTexture).__webglTexture);else if(T.depthBuffer){let Pe=T.depthTexture;if(Ne.__boundDepthTexture!==Pe){if(Pe!==null&&Se.has(Pe)&&(T.width!==Pe.image.width||T.height!==Pe.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");I.setupDepthRenderbuffer(T)}}let Qe=T.texture;(Qe.isData3DTexture||Qe.isDataArrayTexture||Qe.isCompressedArrayTexture)&&(xe=!0);let st=Se.get(T).__webglFramebuffer;T.isWebGLCubeRenderTarget?(Array.isArray(st[L])?F=st[L][H]:F=st[L],ue=!0):T.samples>0&&I.useMultisampledRTT(T)===!1?F=Se.get(T).__webglMultisampledFramebuffer:Array.isArray(st)?F=st[H]:F=st,R.copy(T.viewport),B.copy(T.scissor),k=T.scissorTest}else R.copy(we).multiplyScalar(z).floor(),B.copy(Je).multiplyScalar(z).floor(),k=Mt;if(he.bindFramebuffer(N.FRAMEBUFFER,F)&&G&&he.drawBuffers(T,F),he.viewport(R),he.scissor(B),he.setScissorTest(k),ue){let Ne=Se.get(T.texture);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+L,Ne.__webglTexture,H)}else if(xe){let Ne=Se.get(T.texture),Qe=L||0;N.framebufferTextureLayer(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,Ne.__webglTexture,H||0,Qe)}S=-1},this.readRenderTargetPixels=function(T,L,H,G,F,ue,xe){if(!(T&&T.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Re=Se.get(T).__webglFramebuffer;if(T.isWebGLCubeRenderTarget&&xe!==void 0&&(Re=Re[xe]),Re){he.bindFramebuffer(N.FRAMEBUFFER,Re);try{let Ne=T.texture,Qe=Ne.format,st=Ne.type;if(!Me.textureFormatReadable(Qe)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Me.textureTypeReadable(st)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}L>=0&&L<=T.width-G&&H>=0&&H<=T.height-F&&N.readPixels(L,H,G,F,Z.convert(Qe),Z.convert(st),ue)}finally{let Ne=C!==null?Se.get(C).__webglFramebuffer:null;he.bindFramebuffer(N.FRAMEBUFFER,Ne)}}},this.readRenderTargetPixelsAsync=function(T,L,H,G,F,ue,xe){return Ss(this,null,function*(){if(!(T&&T.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Re=Se.get(T).__webglFramebuffer;if(T.isWebGLCubeRenderTarget&&xe!==void 0&&(Re=Re[xe]),Re){let Ne=T.texture,Qe=Ne.format,st=Ne.type;if(!Me.textureFormatReadable(Qe))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Me.textureTypeReadable(st))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(L>=0&&L<=T.width-G&&H>=0&&H<=T.height-F){he.bindFramebuffer(N.FRAMEBUFFER,Re);let Pe=N.createBuffer();N.bindBuffer(N.PIXEL_PACK_BUFFER,Pe),N.bufferData(N.PIXEL_PACK_BUFFER,ue.byteLength,N.STREAM_READ),N.readPixels(L,H,G,F,Z.convert(Qe),Z.convert(st),0);let Et=C!==null?Se.get(C).__webglFramebuffer:null;he.bindFramebuffer(N.FRAMEBUFFER,Et);let Lt=N.fenceSync(N.SYNC_GPU_COMMANDS_COMPLETE,0);return N.flush(),yield Uk(N,Lt,4),N.bindBuffer(N.PIXEL_PACK_BUFFER,Pe),N.getBufferSubData(N.PIXEL_PACK_BUFFER,0,ue),N.deleteBuffer(Pe),N.deleteSync(Lt),ue}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}})},this.copyFramebufferToTexture=function(T,L=null,H=0){T.isTexture!==!0&&(uu("WebGLRenderer: copyFramebufferToTexture function signature has changed."),L=arguments[0]||null,T=arguments[1]);let G=Math.pow(2,-H),F=Math.floor(T.image.width*G),ue=Math.floor(T.image.height*G),xe=L!==null?L.x:0,Re=L!==null?L.y:0;I.setTexture2D(T,0),N.copyTexSubImage2D(N.TEXTURE_2D,H,0,0,xe,Re,F,ue),he.unbindTexture()},this.copyTextureToTexture=function(T,L,H=null,G=null,F=0){T.isTexture!==!0&&(uu("WebGLRenderer: copyTextureToTexture function signature has changed."),G=arguments[0]||null,T=arguments[1],L=arguments[2],F=arguments[3]||0,H=null);let ue,xe,Re,Ne,Qe,st,Pe,Et,Lt,kt=T.isCompressedTexture?T.mipmaps[F]:T.image;H!==null?(ue=H.max.x-H.min.x,xe=H.max.y-H.min.y,Re=H.isBox3?H.max.z-H.min.z:1,Ne=H.min.x,Qe=H.min.y,st=H.isBox3?H.min.z:0):(ue=kt.width,xe=kt.height,Re=kt.depth||1,Ne=0,Qe=0,st=0),G!==null?(Pe=G.x,Et=G.y,Lt=G.z):(Pe=0,Et=0,Lt=0);let Gn=Z.convert(L.format),Tt=Z.convert(L.type),Fe;L.isData3DTexture?(I.setTexture3D(L,0),Fe=N.TEXTURE_3D):L.isDataArrayTexture||L.isCompressedArrayTexture?(I.setTexture2DArray(L,0),Fe=N.TEXTURE_2D_ARRAY):(I.setTexture2D(L,0),Fe=N.TEXTURE_2D),N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,L.flipY),N.pixelStorei(N.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),N.pixelStorei(N.UNPACK_ALIGNMENT,L.unpackAlignment);let Or=N.getParameter(N.UNPACK_ROW_LENGTH),Ct=N.getParameter(N.UNPACK_IMAGE_HEIGHT),zi=N.getParameter(N.UNPACK_SKIP_PIXELS),ga=N.getParameter(N.UNPACK_SKIP_ROWS),oi=N.getParameter(N.UNPACK_SKIP_IMAGES);N.pixelStorei(N.UNPACK_ROW_LENGTH,kt.width),N.pixelStorei(N.UNPACK_IMAGE_HEIGHT,kt.height),N.pixelStorei(N.UNPACK_SKIP_PIXELS,Ne),N.pixelStorei(N.UNPACK_SKIP_ROWS,Qe),N.pixelStorei(N.UNPACK_SKIP_IMAGES,st);let hl=T.isDataArrayTexture||T.isData3DTexture,Ut=L.isDataArrayTexture||L.isData3DTexture;if(T.isRenderTargetTexture||T.isDepthTexture){let dr=Se.get(T),pl=Se.get(L),Si=Se.get(dr.__renderTarget),xs=Se.get(pl.__renderTarget);he.bindFramebuffer(N.READ_FRAMEBUFFER,Si.__webglFramebuffer),he.bindFramebuffer(N.DRAW_FRAMEBUFFER,xs.__webglFramebuffer);for(let Ms=0;Ms<Re;Ms++)hl&&N.framebufferTextureLayer(N.READ_FRAMEBUFFER,N.COLOR_ATTACHMENT0,Se.get(T).__webglTexture,F,st+Ms),T.isDepthTexture?(Ut&&N.framebufferTextureLayer(N.DRAW_FRAMEBUFFER,N.COLOR_ATTACHMENT0,Se.get(L).__webglTexture,F,Lt+Ms),N.blitFramebuffer(Ne,Qe,ue,xe,Pe,Et,ue,xe,N.DEPTH_BUFFER_BIT,N.NEAREST)):Ut?N.copyTexSubImage3D(Fe,F,Pe,Et,Lt+Ms,Ne,Qe,ue,xe):N.copyTexSubImage2D(Fe,F,Pe,Et,Lt+Ms,Ne,Qe,ue,xe);he.bindFramebuffer(N.READ_FRAMEBUFFER,null),he.bindFramebuffer(N.DRAW_FRAMEBUFFER,null)}else Ut?T.isDataTexture||T.isData3DTexture?N.texSubImage3D(Fe,F,Pe,Et,Lt,ue,xe,Re,Gn,Tt,kt.data):L.isCompressedArrayTexture?N.compressedTexSubImage3D(Fe,F,Pe,Et,Lt,ue,xe,Re,Gn,kt.data):N.texSubImage3D(Fe,F,Pe,Et,Lt,ue,xe,Re,Gn,Tt,kt):T.isDataTexture?N.texSubImage2D(N.TEXTURE_2D,F,Pe,Et,ue,xe,Gn,Tt,kt.data):T.isCompressedTexture?N.compressedTexSubImage2D(N.TEXTURE_2D,F,Pe,Et,kt.width,kt.height,Gn,kt.data):N.texSubImage2D(N.TEXTURE_2D,F,Pe,Et,ue,xe,Gn,Tt,kt);N.pixelStorei(N.UNPACK_ROW_LENGTH,Or),N.pixelStorei(N.UNPACK_IMAGE_HEIGHT,Ct),N.pixelStorei(N.UNPACK_SKIP_PIXELS,zi),N.pixelStorei(N.UNPACK_SKIP_ROWS,ga),N.pixelStorei(N.UNPACK_SKIP_IMAGES,oi),F===0&&L.generateMipmaps&&N.generateMipmap(Fe),he.unbindTexture()},this.copyTextureToTexture3D=function(T,L,H=null,G=null,F=0){return T.isTexture!==!0&&(uu("WebGLRenderer: copyTextureToTexture3D function signature has changed."),H=arguments[0]||null,G=arguments[1]||null,T=arguments[2],L=arguments[3],F=arguments[4]||0),uu('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(T,L,H,G,F)},this.initRenderTarget=function(T){Se.get(T).__webglFramebuffer===void 0&&I.setupRenderTarget(T)},this.initTexture=function(T){T.isCubeTexture?I.setTextureCube(T,0):T.isData3DTexture?I.setTexture3D(T,0):T.isDataArrayTexture||T.isCompressedArrayTexture?I.setTexture2DArray(T,0):I.setTexture2D(T,0),he.unbindTexture()},this.resetState=function(){w=0,E=0,C=null,he.reset(),ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Sr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorspace=it._getDrawingBufferColorSpace(e),t.unpackColorSpace=it._getUnpackColorSpace()}},cm=class i{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new de(e),this.density=t}clone(){return new i(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}},lm=class i{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new de(e),this.near=t,this.far=n}clone(){return new i(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}},oa=class extends Rt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Er,this.environmentIntensity=1,this.environmentRotation=new Er,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}},ls=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Eu,this.updateRanges=[],this.version=0,this.uuid=mi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=mi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=mi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Fn=new A,Cr=class i{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Fn.fromBufferAttribute(this,t),Fn.applyMatrix4(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Fn.fromBufferAttribute(this,t),Fn.applyNormalMatrix(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Fn.fromBufferAttribute(this,t),Fn.transformDirection(e),this.setXYZ(t,Fn.x,Fn.y,Fn.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Un(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=rt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=rt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Un(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Un(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Un(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Un(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=rt(t,this.array),n=rt(n,this.array),r=rt(r,this.array),s=rt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new xt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new i(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Fu=class extends Zt{static get type(){return"SpriteMaterial"}constructor(e){super(),this.isSpriteMaterial=!0,this.color=new de(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},gc,nu=new A,vc=new A,yc=new A,_c=new q,iu=new q,cI=new Ve,Yh=new A,ru=new A,Zh=new A,_A=new q,a0=new q,xA=new q,um=class extends Rt{constructor(e=new Fu){if(super(),this.isSprite=!0,this.type="Sprite",gc===void 0){gc=new et;let t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new ls(t,5);gc.setIndex([0,1,2,0,2,3]),gc.setAttribute("position",new Cr(n,3,0,!1)),gc.setAttribute("uv",new Cr(n,2,3,!1))}this.geometry=gc,this.material=e,this.center=new q(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vc.setFromMatrixScale(this.matrixWorld),cI.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),yc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&vc.multiplyScalar(-yc.z);let n=this.material.rotation,r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));let o=this.center;Kh(Yh.set(-.5,-.5,0),yc,o,vc,r,s),Kh(ru.set(.5,-.5,0),yc,o,vc,r,s),Kh(Zh.set(.5,.5,0),yc,o,vc,r,s),_A.set(0,0),a0.set(1,0),xA.set(1,1);let a=e.ray.intersectTriangle(Yh,ru,Zh,!1,nu);if(a===null&&(Kh(ru.set(-.5,.5,0),yc,o,vc,r,s),a0.set(0,1),a=e.ray.intersectTriangle(Yh,Zh,ru,!1,nu),a===null))return;let c=e.ray.origin.distanceTo(nu);c<e.near||c>e.far||t.push({distance:c,point:nu.clone(),uv:Mr.getInterpolation(nu,Yh,ru,Zh,_A,a0,xA,new q),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};function Kh(i,e,t,n,r,s){_c.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(iu.x=s*_c.x-r*_c.y,iu.y=r*_c.x+s*_c.y):iu.copy(_c),i.copy(e),i.x+=iu.x,i.y+=iu.y,i.applyMatrix4(cI)}var Jh=new A,MA=new A,dm=class extends Rt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let n=0,r=t.length;n<r;n++){let s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);let r=this.levels,s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){let t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){let r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Jh.setFromMatrixPosition(this.matrixWorld);let r=e.ray.origin.distanceTo(Jh);this.getObjectForDistance(r).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){Jh.setFromMatrixPosition(e.matrixWorld),MA.setFromMatrixPosition(this.matrixWorld);let n=Jh.distanceTo(MA)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),n>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let n=this.levels;for(let r=0,s=n.length;r<s;r++){let o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}},SA=new A,bA=new _t,wA=new _t,Uz=new A,EA=new Ve,Qh=new A,c0=new an,TA=new Ve,l0=new wr,Nc=class extends Ft{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=T0,this.bindMatrix=new Ve,this.bindMatrixInverse=new Ve,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new hn),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Qh),this.boundingBox.expandByPoint(Qh)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new an),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Qh),this.boundingSphere.expandByPoint(Qh)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),c0.copy(this.boundingSphere),c0.applyMatrix4(r),e.ray.intersectsSphere(c0)!==!1&&(TA.copy(r).invert(),l0.copy(e.ray).applyMatrix4(TA),!(this.boundingBox!==null&&l0.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,l0)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new _t,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);let s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===T0?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===kD?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let n=this.skeleton,r=this.geometry;bA.fromBufferAttribute(r.attributes.skinIndex,e),wA.fromBufferAttribute(r.attributes.skinWeight,e),SA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){let o=wA.getComponent(s);if(o!==0){let a=bA.getComponent(s);EA.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Uz.copy(SA).applyMatrix4(EA),o)}}return t.applyMatrix4(this.bindMatrixInverse)}},aa=class extends Rt{constructor(){super(),this.isBone=!0,this.type="Bone"}},Fi=class extends cn{constructor(e=null,t=1,n=1,r,s,o,a,c,l=on,u=on,d,f){super(null,o,a,c,l,u,r,s,d,f),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},CA=new Ve,Bz=new Ve,Pc=class i{constructor(e=[],t=[]){this.uuid=mi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ve)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let n=new Ve;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){let a=e[s]?e[s].matrixWorld:Bz;CA.multiplyMatrices(a,t[s]),CA.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new i(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new Fi(t,e,e,En,ti);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let s=e.bones[n],o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new aa),this.bones.push(o),this.boneInverses.push(new Ve().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){let o=t[r];e.bones.push(o.uuid);let a=n[r];e.boneInverses.push(a.toArray())}return e}},ar=class extends xt{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},xc=new Ve,AA=new Ve,ep=[],DA=new hn,Vz=new Ve,su=new Ft,ou=new an,Oc=class extends Ft{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ar(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Vz)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new hn),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,xc),DA.copy(e.boundingBox).applyMatrix4(xc),this.boundingBox.union(DA)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new an),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,xc),ou.copy(e.boundingSphere).applyMatrix4(xc),this.boundingSphere.union(ou)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,o=e*s+1;for(let a=0;a<n.length;a++)n[a]=r[o+a]}raycast(e,t){let n=this.matrixWorld,r=this.count;if(su.geometry=this.geometry,su.material=this.material,su.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),ou.copy(this.boundingSphere),ou.applyMatrix4(n),e.ray.intersectsSphere(ou)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,xc),AA.multiplyMatrices(n,xc),su.matrixWorld=AA,su.raycast(e,ep);for(let o=0,a=ep.length;o<a;o++){let c=ep[o];c.instanceId=s,c.object=this,t.push(c)}ep.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new ar(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Fi(new Float32Array(r*this.count),r,this.count,cg,ti));let s=this.morphTexture.source.data.data,o=0;for(let l=0;l<n.length;l++)o+=n[l];let a=this.geometry.morphTargetsRelative?1:1-o,c=r*e;s[c]=a,s.set(n,c+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}};function u0(i,e){return i-e}function zz(i,e){return i.z-e.z}function Hz(i,e){return e.z-i.z}var $0=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){let s=this.pool,o=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});let a=s[this.index];o.push(a),this.index++,a.start=e,a.count=t,a.z=n,a.index=r}reset(){this.list.length=0,this.index=0}},Kn=new Ve,Gz=new de(1,1,1),d0=new sa,tp=new hn,Oo=new an,au=new A,IA=new A,jz=new A,f0=new $0,Dn=new Ft,np=[];function Wz(i,e,t=0){let n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){let r=i.count;for(let s=0;s<r;s++)for(let o=0;o<n;o++)e.setComponent(s+t,o,i.getComponent(s,o))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Lo(i,e){if(i.constructor!==e.constructor){let t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{let t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}var fm=class extends Ft{get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}constructor(e,t,n=t*2,r){super(new et,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4),n=new Fi(t,e,e,En,ti);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let t=new Uint32Array(e*e),n=new Fi(t,e,e,rd,cs);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let t=new Float32Array(e*e*4).fill(1),n=new Fi(t,e,e,En,ti);n.colorSpace=it.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){let t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(let s in e.attributes){let o=e.getAttribute(s),{array:a,itemSize:c,normalized:l}=o,u=new a.constructor(n*c),d=new xt(u,c,l);t.setAttribute(s,d)}if(e.getIndex()!==null){let s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new xt(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(let n in t.attributes){if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);let r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new hn);let e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;let s=t[n].geometryIndex;this.getMatrixAt(n,Kn),this.getBoundingBoxAt(s,tp).applyMatrix4(Kn),e.union(tp)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new an);let e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;let s=t[n].geometryIndex;this.getMatrixAt(n,Kn),this.getBoundingSphereAt(s,Oo).applyMatrix4(Kn),e.union(Oo)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("BatchedMesh: Maximum item count reached.");let n={visible:!0,active:!0,geometryIndex:e},r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(u0),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));let s=this._matricesTexture;Kn.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;let o=this._colorsTexture;return o&&(Gz.toArray(o.image.data,r*4),o.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);let r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;let o=e.getIndex();if(o!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?o.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(u0),c=this._availableGeometryIds.shift(),s[c]=r):(c=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(c,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,c}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),o=t.getIndex(),a=this._geometryInfo[e];if(r&&o.count>a.reservedIndexCount||t.attributes.position.count>a.reservedVertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");let c=a.vertexStart,l=a.reservedVertexCount;a.vertexCount=t.getAttribute("position").count;for(let u in n.attributes){let d=t.getAttribute(u),f=n.getAttribute(u);Wz(d,f,c);let h=d.itemSize;for(let p=d.count,v=l;p<v;p++){let g=c+p;for(let m=0;m<h;m++)f.setComponent(g,m,0)}f.needsUpdate=!0,f.addUpdateRange(c*h,l*h)}if(r){let u=a.indexStart,d=a.reservedIndexCount;a.indexCount=t.getIndex().count;for(let f=0;f<o.count;f++)s.setX(u+f,c+o.getX(f));for(let f=o.count,h=d;f<h;f++)s.setX(u+f,c);s.needsUpdate=!0,s.addUpdateRange(u,a.reservedIndexCount)}return a.start=r?a.indexStart:a.vertexStart,a.count=r?a.indexCount:a.vertexCount,a.boundingBox=null,t.boundingBox!==null&&(a.boundingBox=t.boundingBox.clone()),a.boundingSphere=null,t.boundingSphere!==null&&(a.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;let n=this._instanceInfo;for(let r=0,s=n.length;r<s;r++)n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){let t=this._instanceInfo;return e>=t.length||t[e].active===!1?this:(t[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this)}optimize(){let e=0,t=0,n=this._geometryInfo,r=n.map((o,a)=>a).sort((o,a)=>n[o].vertexStart-n[a].vertexStart),s=this.geometry;for(let o=0,a=n.length;o<a;o++){let c=r[o],l=n[c];if(l.active!==!1){if(s.index!==null){if(l.indexStart!==t){let{indexStart:u,vertexStart:d,reservedIndexCount:f}=l,h=s.index,p=h.array,v=e-d;for(let g=u;g<u+f;g++)p[g]=p[g]+v;h.array.copyWithin(t,u,u+f),h.addUpdateRange(t,f),l.indexStart=t}t+=l.reservedIndexCount}if(l.vertexStart!==e){let{vertexStart:u,reservedVertexCount:d}=l,f=s.attributes;for(let h in f){let p=f[h],{array:v,itemSize:g}=p;v.copyWithin(e*g,u*g,(u+d)*g),p.addUpdateRange(e*g,d*g)}l.vertexStart=e}e+=l.reservedVertexCount,l.start=s.index?l.indexStart:l.vertexStart,this._nextIndexStart=s.index?l.indexStart+l.reservedIndexCount:0,this._nextVertexStart=l.vertexStart+l.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;let n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){let s=new hn,o=n.index,a=n.attributes.position;for(let c=r.start,l=r.start+r.count;c<l;c++){let u=c;o&&(u=o.getX(u)),s.expandByPoint(au.fromBufferAttribute(a,u))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;let n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){let s=new an;this.getBoundingBoxAt(e,tp),tp.getCenter(s.center);let o=n.index,a=n.attributes.position,c=0;for(let l=r.start,u=r.start+r.count;l<u;l++){let d=l;o&&(d=o.getX(d)),au.fromBufferAttribute(a,d),c=Math.max(c,s.center.distanceToSquared(au))}s.radius=Math.sqrt(c),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){let n=this._instanceInfo,r=this._matricesTexture,s=this._matricesTexture.image.data;return e>=n.length||n[e].active===!1?this:(t.toArray(s,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,t){let n=this._instanceInfo,r=this._matricesTexture.image.data;return e>=n.length||n[e].active===!1?null:t.fromArray(r,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();let n=this._colorsTexture,r=this._colorsTexture.image.data,s=this._instanceInfo;return e>=s.length||s[e].active===!1?this:(t.toArray(r,e*4),n.needsUpdate=!0,this)}getColorAt(e,t){let n=this._colorsTexture.image.data,r=this._instanceInfo;return e>=r.length||r[e].active===!1?null:t.fromArray(n,e*4)}setVisibleAt(e,t){let n=this._instanceInfo;return e>=n.length||n[e].active===!1||n[e].visible===t?this:(n[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){let t=this._instanceInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}setGeometryIdAt(e,t){let n=this._instanceInfo,r=this._geometryInfo;return e>=n.length||n[e].active===!1||t>=r.length||r[t].active===!1?null:(n[e].geometryIndex=t,this)}getGeometryIdAt(e){let t=this._instanceInfo;return e>=t.length||t[e].active===!1?-1:t[e].geometryIndex}getGeometryRangeAt(e,t={}){if(e<0||e>=this._geometryCount)return null;let n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){let t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(u0);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);let r=new Int32Array(e),s=new Int32Array(e);Lo(this._multiDrawCounts,r),Lo(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;let o=this._indirectTexture,a=this._matricesTexture,c=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Lo(o.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),Lo(a.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),Lo(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){let n=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...n.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(c=>c.indexStart+c.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);let s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new et,this._initializeGeometry(s));let o=this.geometry;s.index&&Lo(s.index.array,o.index.array);for(let a in s.attributes)Lo(s.attributes[a].array,o.attributes[a].array)}raycast(e,t){let n=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,o=this.geometry;Dn.material=this.material,Dn.geometry.index=o.index,Dn.geometry.attributes=o.attributes,Dn.geometry.boundingBox===null&&(Dn.geometry.boundingBox=new hn),Dn.geometry.boundingSphere===null&&(Dn.geometry.boundingSphere=new an);for(let a=0,c=n.length;a<c;a++){if(!n[a].visible||!n[a].active)continue;let l=n[a].geometryIndex,u=r[l];Dn.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(a,Dn.matrixWorld).premultiply(s),this.getBoundingBoxAt(l,Dn.geometry.boundingBox),this.getBoundingSphereAt(l,Dn.geometry.boundingSphere),Dn.raycast(e,np);for(let d=0,f=np.length;d<f;d++){let h=np[d];h.object=this,h.batchId=a,t.push(h)}np.length=0}Dn.material=null,Dn.geometry.index=null,Dn.geometry.attributes={},Dn.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>tt(ie({},t),{boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>ie({},t)),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,c=this._instanceInfo,l=this._multiDrawStarts,u=this._multiDrawCounts,d=this._geometryInfo,f=this.perObjectFrustumCulled,h=this._indirectTexture,p=h.image.data;f&&(Kn.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),d0.setFromProjectionMatrix(Kn,e.coordinateSystem));let v=0;if(this.sortObjects){Kn.copy(this.matrixWorld).invert(),au.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Kn),IA.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Kn);for(let _=0,x=c.length;_<x;_++)if(c[_].visible&&c[_].active){let y=c[_].geometryIndex;this.getMatrixAt(_,Kn),this.getBoundingSphereAt(y,Oo).applyMatrix4(Kn);let D=!1;if(f&&(D=!d0.intersectsSphere(Oo)),!D){let w=d[y],E=jz.subVectors(Oo.center,au).dot(IA);f0.push(w.start,w.count,E,_)}}let g=f0.list,m=this.customSort;m===null?g.sort(s.transparent?Hz:zz):m.call(this,g,n);for(let _=0,x=g.length;_<x;_++){let y=g[_];l[v]=y.start*a,u[v]=y.count,p[v]=y.index,v++}f0.reset()}else for(let g=0,m=c.length;g<m;g++)if(c[g].visible&&c[g].active){let _=c[g].geometryIndex,x=!1;if(f&&(this.getMatrixAt(g,Kn),this.getBoundingSphereAt(_,Oo).applyMatrix4(Kn),x=!d0.intersectsSphere(Oo)),!x){let y=d[_];l[v]=y.start*a,u[v]=y.count,p[v]=g,v++}}h.needsUpdate=!0,this._multiDrawCount=v,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,o){this.onBeforeRender(e,null,r,s,o)}},gn=class extends Zt{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new de(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},hm=new A,pm=new A,RA=new Ve,cu=new wr,ip=new an,h0=new A,NA=new A,Ui=class extends Rt{constructor(e=new et,t=new gn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)hm.fromBufferAttribute(t,r-1),pm.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=hm.distanceTo(pm);e.setAttribute("lineDistance",new Ce(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ip.copy(n.boundingSphere),ip.applyMatrix4(r),ip.radius+=s,e.ray.intersectsSphere(ip)===!1)return;RA.copy(r).invert(),cu.copy(e.ray).applyMatrix4(RA);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=this.isLineSegments?2:1,u=n.index,f=n.attributes.position;if(u!==null){let h=Math.max(0,o.start),p=Math.min(u.count,o.start+o.count);for(let v=h,g=p-1;v<g;v+=l){let m=u.getX(v),_=u.getX(v+1),x=rp(this,e,cu,c,m,_);x&&t.push(x)}if(this.isLineLoop){let v=u.getX(p-1),g=u.getX(h),m=rp(this,e,cu,c,v,g);m&&t.push(m)}}else{let h=Math.max(0,o.start),p=Math.min(f.count,o.start+o.count);for(let v=h,g=p-1;v<g;v+=l){let m=rp(this,e,cu,c,v,v+1);m&&t.push(m)}if(this.isLineLoop){let v=rp(this,e,cu,c,p-1,h);v&&t.push(v)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function rp(i,e,t,n,r,s){let o=i.geometry.attributes.position;if(hm.fromBufferAttribute(o,r),pm.fromBufferAttribute(o,s),t.distanceSqToSegment(hm,pm,h0,NA)>n)return;h0.applyMatrix4(i.matrixWorld);let c=e.ray.origin.distanceTo(h0);if(!(c<e.near||c>e.far))return{distance:c,point:NA.clone().applyMatrix4(i.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:i}}var PA=new A,OA=new A,ri=class extends Ui{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)PA.fromBufferAttribute(t,r),OA.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+PA.distanceTo(OA);e.setAttribute("lineDistance",new Ce(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},Lc=class extends Ui{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}},ca=class extends Zt{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new de(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},LA=new Ve,q0=new wr,sp=new an,op=new A,Fc=class extends Rt{constructor(e=new et,t=new ca){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),sp.copy(n.boundingSphere),sp.applyMatrix4(r),sp.radius+=s,e.ray.intersectsSphere(sp)===!1)return;LA.copy(r).invert(),q0.copy(e.ray).applyMatrix4(LA);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=n.index,d=n.attributes.position;if(l!==null){let f=Math.max(0,o.start),h=Math.min(l.count,o.start+o.count);for(let p=f,v=h;p<v;p++){let g=l.getX(p);op.fromBufferAttribute(d,g),FA(op,g,c,r,e,t,this)}}else{let f=Math.max(0,o.start),h=Math.min(d.count,o.start+o.count);for(let p=f,v=h;p<v;p++)op.fromBufferAttribute(d,p),FA(op,p,c,r,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function FA(i,e,t,n,r,s,o){let a=q0.distanceSqToPoint(i);if(a<t){let c=new A;q0.closestPointToPoint(i,c),c.applyMatrix4(n);let l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}var X0=class extends cn{constructor(e,t,n,r,s,o,a,c,l){super(e,t,n,r,s,o,a,c,l),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Ht,this.magFilter=s!==void 0?s:Ht,this.generateMipmaps=!1;let u=this;function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},Y0=class extends cn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=on,this.minFilter=on,this.generateMipmaps=!1,this.needsUpdate=!0}},kc=class extends cn{constructor(e,t,n,r,s,o,a,c,l,u,d,f){super(null,o,a,c,l,u,r,s,d,f),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}},Z0=class extends kc{constructor(e,t,n,r,s,o){super(e,t,n,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=ei,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},K0=class extends kc{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,os),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}},J0=class extends cn{constructor(e,t,n,r,s,o,a,c,l){super(e,t,n,r,s,o,a,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},yi=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),r=0,s=n.length,o;t?o=t:o=e*n[s-1];let a=0,c=s-1,l;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=n[r]-o,l<0)a=r+1;else if(l>0)c=r-1;else{c=r;break}if(r=c,n[r]===o)return r/(s-1);let u=n[r],f=n[r+1]-u,h=(o-u)/f;return(r+h)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);let o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new q:new A);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new A,r=[],s=[],o=[],a=new A,c=new Ve;for(let h=0;h<=e;h++){let p=h/e;r[h]=this.getTangentAt(p,new A)}s[0]=new A,o[0]=new A;let l=Number.MAX_VALUE,u=Math.abs(r[0].x),d=Math.abs(r[0].y),f=Math.abs(r[0].z);u<=l&&(l=u,n.set(1,0,0)),d<=l&&(l=d,n.set(0,1,0)),f<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let h=1;h<=e;h++){if(s[h]=s[h-1].clone(),o[h]=o[h-1].clone(),a.crossVectors(r[h-1],r[h]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(Xt(r[h-1].dot(r[h]),-1,1));s[h].applyMatrix4(c.makeRotationAxis(a,p))}o[h].crossVectors(r[h],s[h])}if(t===!0){let h=Math.acos(Xt(s[0].dot(s[e]),-1,1));h/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(h=-h);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],h*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Uc=class extends yi{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t=new q){let n=t,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);let a=this.aStartAngle+e*s,c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),f=c-this.aX,h=l-this.aY;c=f*u-h*d+this.aX,l=f*d+h*u+this.aY}return n.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},mm=class extends Uc{constructor(e,t,n,r,s,o){super(e,t,n,n,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}};function sM(){let i=0,e=0,t=0,n=0;function r(s,o,a,c){i=s,e=a,t=-3*s+3*o-2*a-c,n=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,l){r(o,a,l*(a-s),l*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,l,u,d){let f=(o-s)/l-(a-s)/(l+u)+(a-o)/u,h=(a-o)/u-(c-o)/(u+d)+(c-a)/d;f*=u,h*=u,r(o,a,f,h)},calc:function(s){let o=s*s,a=o*s;return i+e*s+t*o+n*a}}}var ap=new A,p0=new sM,m0=new sM,g0=new sM,gm=class extends yi{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new A){let n=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e,a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:c===0&&a===s-1&&(a=s-2,c=1);let l,u;this.closed||a>0?l=r[(a-1)%s]:(ap.subVectors(r[0],r[1]).add(r[0]),l=ap);let d=r[a%s],f=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(ap.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=ap),this.curveType==="centripetal"||this.curveType==="chordal"){let h=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(d),h),v=Math.pow(d.distanceToSquared(f),h),g=Math.pow(f.distanceToSquared(u),h);v<1e-4&&(v=1),p<1e-4&&(p=v),g<1e-4&&(g=v),p0.initNonuniformCatmullRom(l.x,d.x,f.x,u.x,p,v,g),m0.initNonuniformCatmullRom(l.y,d.y,f.y,u.y,p,v,g),g0.initNonuniformCatmullRom(l.z,d.z,f.z,u.z,p,v,g)}else this.curveType==="catmullrom"&&(p0.initCatmullRom(l.x,d.x,f.x,u.x,this.tension),m0.initCatmullRom(l.y,d.y,f.y,u.y,this.tension),g0.initCatmullRom(l.z,d.z,f.z,u.z,this.tension));return n.set(p0.calc(c),m0.calc(c),g0.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new A().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function kA(i,e,t,n,r){let s=(n-e)*.5,o=(r-t)*.5,a=i*i,c=i*a;return(2*t-2*n+s+o)*c+(-3*t+3*n-2*s-o)*a+s*i+t}function $z(i,e){let t=1-i;return t*t*e}function qz(i,e){return 2*(1-i)*i*e}function Xz(i,e){return i*i*e}function xu(i,e,t,n){return $z(i,e)+qz(i,t)+Xz(i,n)}function Yz(i,e){let t=1-i;return t*t*t*e}function Zz(i,e){let t=1-i;return 3*t*t*i*e}function Kz(i,e){return 3*(1-i)*i*i*e}function Jz(i,e){return i*i*i*e}function Mu(i,e,t,n,r){return Yz(i,e)+Zz(i,t)+Kz(i,n)+Jz(i,r)}var ku=class extends yi{constructor(e=new q,t=new q,n=new q,r=new q){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new q){let n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Mu(e,r.x,s.x,o.x,a.x),Mu(e,r.y,s.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},vm=class extends yi{constructor(e=new A,t=new A,n=new A,r=new A){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new A){let n=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return n.set(Mu(e,r.x,s.x,o.x,a.x),Mu(e,r.y,s.y,o.y,a.y),Mu(e,r.z,s.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Uu=class extends yi{constructor(e=new q,t=new q){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new q){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new q){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},ym=class extends yi{constructor(e=new A,t=new A){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new A){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new A){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Bu=class extends yi{constructor(e=new q,t=new q,n=new q){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new q){let n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(xu(e,r.x,s.x,o.x),xu(e,r.y,s.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Vu=class extends yi{constructor(e=new A,t=new A,n=new A){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new A){let n=t,r=this.v0,s=this.v1,o=this.v2;return n.set(xu(e,r.x,s.x,o.x),xu(e,r.y,s.y,o.y),xu(e,r.z,s.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},zu=class extends yi{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new q){let n=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[o===0?o:o-1],l=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return n.set(kA(a,c.x,l.x,u.x,d.x),kA(a,c.y,l.y,u.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new q().fromArray(r))}return this}},_m=Object.freeze({__proto__:null,ArcCurve:mm,CatmullRomCurve3:gm,CubicBezierCurve:ku,CubicBezierCurve3:vm,EllipseCurve:Uc,LineCurve:Uu,LineCurve3:ym,QuadraticBezierCurve:Bu,QuadraticBezierCurve3:Vu,SplineCurve:zu}),xm=class extends yi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new _m[n](t,e))}return this}getPoint(e,t){let n=e*this.getLength(),r=this.getCurveLengths(),s=0;for(;s<r.length;){if(r[s]>=n){let o=r[s]-n,a=this.curves[s],c=a.getLength(),l=c===0?0:1-o/c;return a.getPointAt(l,t)}s++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let r=0,s=this.curves;r<s.length;r++){let o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let l=0;l<c.length;l++){let u=c[l];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(new _m[r.type]().fromJSON(r))}return this}},la=class extends xm{constructor(e){super(),this.type="Path",this.currentPoint=new q,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new Uu(this.currentPoint.clone(),new q(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){let s=new Bu(this.currentPoint.clone(),new q(e,t),new q(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,o){let a=new ku(this.currentPoint.clone(),new q(e,t),new q(n,r),new q(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new zu(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,o){let a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,n,r,s,o),this}absarc(e,t,n,r,s,o){return this.absellipse(e,t,n,n,r,s,o),this}ellipse(e,t,n,r,s,o,a,c){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,r,s,o,a,c),this}absellipse(e,t,n,r,s,o,a,c){let l=new Uc(e,t,n,r,s,o,a,c);if(this.curves.length>0){let d=l.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Hu=class i extends et{constructor(e=[new q(0,-.5),new q(.5,0),new q(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Xt(r,0,Math.PI*2);let s=[],o=[],a=[],c=[],l=[],u=1/t,d=new A,f=new q,h=new A,p=new A,v=new A,g=0,m=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:g=e[_+1].x-e[_].x,m=e[_+1].y-e[_].y,h.x=m*1,h.y=-g,h.z=m*0,v.copy(h),h.normalize(),c.push(h.x,h.y,h.z);break;case e.length-1:c.push(v.x,v.y,v.z);break;default:g=e[_+1].x-e[_].x,m=e[_+1].y-e[_].y,h.x=m*1,h.y=-g,h.z=m*0,p.copy(h),h.x+=v.x,h.y+=v.y,h.z+=v.z,h.normalize(),c.push(h.x,h.y,h.z),v.copy(p)}for(let _=0;_<=t;_++){let x=n+_*u*r,y=Math.sin(x),D=Math.cos(x);for(let w=0;w<=e.length-1;w++){d.x=e[w].x*y,d.y=e[w].y,d.z=e[w].x*D,o.push(d.x,d.y,d.z),f.x=_/t,f.y=w/(e.length-1),a.push(f.x,f.y);let E=c[3*w+0]*y,C=c[3*w+1],S=c[3*w+0]*D;l.push(E,C,S)}}for(let _=0;_<t;_++)for(let x=0;x<e.length-1;x++){let y=x+_*e.length,D=y,w=y+e.length,E=y+e.length+1,C=y+1;s.push(D,w,C),s.push(E,C,w)}this.setIndex(s),this.setAttribute("position",new Ce(o,3)),this.setAttribute("uv",new Ce(a,2)),this.setAttribute("normal",new Ce(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.points,e.segments,e.phiStart,e.phiLength)}},Mm=class i extends Hu{constructor(e=1,t=1,n=4,r=8){let s=new la;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new i(e.radius,e.length,e.capSegments,e.radialSegments)}},Sm=class i extends et{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);let s=[],o=[],a=[],c=[],l=new A,u=new q;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let d=0,f=3;d<=t;d++,f+=3){let h=n+d/t*r;l.x=e*Math.cos(h),l.y=e*Math.sin(h),o.push(l.x,l.y,l.z),a.push(0,0,1),u.x=(o[f]/e+1)/2,u.y=(o[f+1]/e+1)/2,c.push(u.x,u.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new Ce(o,3)),this.setAttribute("normal",new Ce(a,3)),this.setAttribute("uv",new Ce(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.segments,e.thetaStart,e.thetaLength)}},Js=class i extends et{constructor(e=1,t=1,n=1,r=32,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};let l=this;r=Math.floor(r),s=Math.floor(s);let u=[],d=[],f=[],h=[],p=0,v=[],g=n/2,m=0;_(),o===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(u),this.setAttribute("position",new Ce(d,3)),this.setAttribute("normal",new Ce(f,3)),this.setAttribute("uv",new Ce(h,2));function _(){let y=new A,D=new A,w=0,E=(t-e)/n;for(let C=0;C<=s;C++){let S=[],M=C/s,R=M*(t-e)+e;for(let B=0;B<=r;B++){let k=B/r,j=k*c+a,Y=Math.sin(j),V=Math.cos(j);D.x=R*Y,D.y=-M*n+g,D.z=R*V,d.push(D.x,D.y,D.z),y.set(Y,E,V).normalize(),f.push(y.x,y.y,y.z),h.push(k,1-M),S.push(p++)}v.push(S)}for(let C=0;C<r;C++)for(let S=0;S<s;S++){let M=v[S][C],R=v[S+1][C],B=v[S+1][C+1],k=v[S][C+1];(e>0||S!==0)&&(u.push(M,R,k),w+=3),(t>0||S!==s-1)&&(u.push(R,B,k),w+=3)}l.addGroup(m,w,0),m+=w}function x(y){let D=p,w=new q,E=new A,C=0,S=y===!0?e:t,M=y===!0?1:-1;for(let B=1;B<=r;B++)d.push(0,g*M,0),f.push(0,M,0),h.push(.5,.5),p++;let R=p;for(let B=0;B<=r;B++){let j=B/r*c+a,Y=Math.cos(j),V=Math.sin(j);E.x=S*V,E.y=g*M,E.z=S*Y,d.push(E.x,E.y,E.z),f.push(0,M,0),w.x=Y*.5+.5,w.y=V*.5*M+.5,h.push(w.x,w.y),p++}for(let B=0;B<r;B++){let k=D+B,j=R+B;y===!0?u.push(j,j+1,k):u.push(j+1,j,k),C+=3}l.addGroup(m,C,y===!0?1:2),m+=C}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},bm=class i extends Js{constructor(e=1,t=1,n=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,n,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new i(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},Qs=class i extends et{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};let s=[],o=[];a(r),l(n),u(),this.setAttribute("position",new Ce(s,3)),this.setAttribute("normal",new Ce(s.slice(),3)),this.setAttribute("uv",new Ce(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(_){let x=new A,y=new A,D=new A;for(let w=0;w<t.length;w+=3)h(t[w+0],x),h(t[w+1],y),h(t[w+2],D),c(x,y,D,_)}function c(_,x,y,D){let w=D+1,E=[];for(let C=0;C<=w;C++){E[C]=[];let S=_.clone().lerp(y,C/w),M=x.clone().lerp(y,C/w),R=w-C;for(let B=0;B<=R;B++)B===0&&C===w?E[C][B]=S:E[C][B]=S.clone().lerp(M,B/R)}for(let C=0;C<w;C++)for(let S=0;S<2*(w-C)-1;S++){let M=Math.floor(S/2);S%2===0?(f(E[C][M+1]),f(E[C+1][M]),f(E[C][M])):(f(E[C][M+1]),f(E[C+1][M+1]),f(E[C+1][M]))}}function l(_){let x=new A;for(let y=0;y<s.length;y+=3)x.x=s[y+0],x.y=s[y+1],x.z=s[y+2],x.normalize().multiplyScalar(_),s[y+0]=x.x,s[y+1]=x.y,s[y+2]=x.z}function u(){let _=new A;for(let x=0;x<s.length;x+=3){_.x=s[x+0],_.y=s[x+1],_.z=s[x+2];let y=g(_)/2/Math.PI+.5,D=m(_)/Math.PI+.5;o.push(y,1-D)}p(),d()}function d(){for(let _=0;_<o.length;_+=6){let x=o[_+0],y=o[_+2],D=o[_+4],w=Math.max(x,y,D),E=Math.min(x,y,D);w>.9&&E<.1&&(x<.2&&(o[_+0]+=1),y<.2&&(o[_+2]+=1),D<.2&&(o[_+4]+=1))}}function f(_){s.push(_.x,_.y,_.z)}function h(_,x){let y=_*3;x.x=e[y+0],x.y=e[y+1],x.z=e[y+2]}function p(){let _=new A,x=new A,y=new A,D=new A,w=new q,E=new q,C=new q;for(let S=0,M=0;S<s.length;S+=9,M+=6){_.set(s[S+0],s[S+1],s[S+2]),x.set(s[S+3],s[S+4],s[S+5]),y.set(s[S+6],s[S+7],s[S+8]),w.set(o[M+0],o[M+1]),E.set(o[M+2],o[M+3]),C.set(o[M+4],o[M+5]),D.copy(_).add(x).add(y).divideScalar(3);let R=g(D);v(w,M+0,_,R),v(E,M+2,x,R),v(C,M+4,y,R)}}function v(_,x,y,D){D<0&&_.x===1&&(o[x]=_.x-1),y.x===0&&y.z===0&&(o[x]=D/2/Math.PI+.5)}function g(_){return Math.atan2(_.z,-_.x)}function m(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.vertices,e.indices,e.radius,e.details)}},wm=class i extends Qs{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},cp=new A,lp=new A,v0=new A,up=new Mr,Em=class extends et{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let r=Math.pow(10,4),s=Math.cos(Zo*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,l=[0,0,0],u=["a","b","c"],d=new Array(3),f={},h=[];for(let p=0;p<c;p+=3){o?(l[0]=o.getX(p),l[1]=o.getX(p+1),l[2]=o.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);let{a:v,b:g,c:m}=up;if(v.fromBufferAttribute(a,l[0]),g.fromBufferAttribute(a,l[1]),m.fromBufferAttribute(a,l[2]),up.getNormal(v0),d[0]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,d[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,d[2]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let _=0;_<3;_++){let x=(_+1)%3,y=d[_],D=d[x],w=up[u[_]],E=up[u[x]],C=`${y}_${D}`,S=`${D}_${y}`;S in f&&f[S]?(v0.dot(f[S].normal)<=s&&(h.push(w.x,w.y,w.z),h.push(E.x,E.y,E.z)),f[S]=null):C in f||(f[C]={index0:l[_],index1:l[x],normal:v0.clone()})}}for(let p in f)if(f[p]){let{index0:v,index1:g}=f[p];cp.fromBufferAttribute(a,v),lp.fromBufferAttribute(a,g),h.push(cp.x,cp.y,cp.z),h.push(lp.x,lp.y,lp.z)}this.setAttribute("position",new Ce(h,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}},ss=class extends la{constructor(e){super(e),this.uuid=mi(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(new la().fromJSON(r))}return this}},Qz={triangulate:function(i,e,t=2){let n=e&&e.length,r=n?e[0]*t:i.length,s=lI(i,0,r,t,!0),o=[];if(!s||s.next===s.prev)return o;let a,c,l,u,d,f,h;if(n&&(s=rH(i,e,s,t)),i.length>80*t){a=l=i[0],c=u=i[1];for(let p=t;p<r;p+=t)d=i[p],f=i[p+1],d<a&&(a=d),f<c&&(c=f),d>l&&(l=d),f>u&&(u=f);h=Math.max(l-a,u-c),h=h!==0?32767/h:0}return Gu(s,o,t,a,c,h,0),o}};function lI(i,e,t,n,r){let s,o;if(r===mH(i,e,t,n)>0)for(s=e;s<t;s+=n)o=UA(s,i[s],i[s+1],o);else for(s=t-n;s>=e;s-=n)o=UA(s,i[s],i[s+1],o);return o&&hg(o,o.next)&&(Wu(o),o=o.next),o}function ua(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(hg(t,t.next)||zt(t.prev,t,t.next)===0)){if(Wu(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Gu(i,e,t,n,r,s,o){if(!i)return;!o&&s&&lH(i,n,r,s);let a=i,c,l;for(;i.prev!==i.next;){if(c=i.prev,l=i.next,s?tH(i,n,r,s):eH(i)){e.push(c.i/t|0),e.push(i.i/t|0),e.push(l.i/t|0),Wu(i),i=l.next,a=l.next;continue}if(i=l,i===a){o?o===1?(i=nH(ua(i),e,t),Gu(i,e,t,n,r,s,2)):o===2&&iH(i,e,t,n,r,s):Gu(ua(i),e,t,n,r,s,1);break}}}function eH(i){let e=i.prev,t=i,n=i.next;if(zt(e,t,n)>=0)return!1;let r=e.x,s=t.x,o=n.x,a=e.y,c=t.y,l=n.y,u=r<s?r<o?r:o:s<o?s:o,d=a<c?a<l?a:l:c<l?c:l,f=r>s?r>o?r:o:s>o?s:o,h=a>c?a>l?a:l:c>l?c:l,p=n.next;for(;p!==e;){if(p.x>=u&&p.x<=f&&p.y>=d&&p.y<=h&&bc(r,a,s,c,o,l,p.x,p.y)&&zt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function tH(i,e,t,n){let r=i.prev,s=i,o=i.next;if(zt(r,s,o)>=0)return!1;let a=r.x,c=s.x,l=o.x,u=r.y,d=s.y,f=o.y,h=a<c?a<l?a:l:c<l?c:l,p=u<d?u<f?u:f:d<f?d:f,v=a>c?a>l?a:l:c>l?c:l,g=u>d?u>f?u:f:d>f?d:f,m=Q0(h,p,e,t,n),_=Q0(v,g,e,t,n),x=i.prevZ,y=i.nextZ;for(;x&&x.z>=m&&y&&y.z<=_;){if(x.x>=h&&x.x<=v&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&bc(a,u,c,d,l,f,x.x,x.y)&&zt(x.prev,x,x.next)>=0||(x=x.prevZ,y.x>=h&&y.x<=v&&y.y>=p&&y.y<=g&&y!==r&&y!==o&&bc(a,u,c,d,l,f,y.x,y.y)&&zt(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;x&&x.z>=m;){if(x.x>=h&&x.x<=v&&x.y>=p&&x.y<=g&&x!==r&&x!==o&&bc(a,u,c,d,l,f,x.x,x.y)&&zt(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;y&&y.z<=_;){if(y.x>=h&&y.x<=v&&y.y>=p&&y.y<=g&&y!==r&&y!==o&&bc(a,u,c,d,l,f,y.x,y.y)&&zt(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function nH(i,e,t){let n=i;do{let r=n.prev,s=n.next.next;!hg(r,s)&&uI(r,n,n.next,s)&&ju(r,s)&&ju(s,r)&&(e.push(r.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Wu(n),Wu(n.next),n=i=s),n=n.next}while(n!==i);return ua(n)}function iH(i,e,t,n,r,s){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&fH(o,a)){let c=dI(o,a);o=ua(o,o.next),c=ua(c,c.next),Gu(o,e,t,n,r,s,0),Gu(c,e,t,n,r,s,0);return}a=a.next}o=o.next}while(o!==i)}function rH(i,e,t,n){let r=[],s,o,a,c,l;for(s=0,o=e.length;s<o;s++)a=e[s]*n,c=s<o-1?e[s+1]*n:i.length,l=lI(i,a,c,n,!1),l===l.next&&(l.steiner=!0),r.push(dH(l));for(r.sort(sH),s=0;s<r.length;s++)t=oH(r[s],t);return t}function sH(i,e){return i.x-e.x}function oH(i,e){let t=aH(i,e);if(!t)return e;let n=dI(t,i);return ua(n,n.next),ua(t,t.next)}function aH(i,e){let t=e,n=-1/0,r,s=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let f=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=s&&f>n&&(n=f,r=t.x<t.next.x?t:t.next,f===s))return r}t=t.next}while(t!==e);if(!r)return null;let a=r,c=r.x,l=r.y,u=1/0,d;t=r;do s>=t.x&&t.x>=c&&s!==t.x&&bc(o<l?s:n,o,c,l,o<l?n:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),ju(t,i)&&(d<u||d===u&&(t.x>r.x||t.x===r.x&&cH(r,t)))&&(r=t,u=d)),t=t.next;while(t!==a);return r}function cH(i,e){return zt(i.prev,i,e.prev)<0&&zt(e.next,i,i.next)<0}function lH(i,e,t,n){let r=i;do r.z===0&&(r.z=Q0(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,uH(r)}function uH(i){let e,t,n,r,s,o,a,c,l=1;do{for(t=i,i=null,s=null,o=0;t;){for(o++,n=t,a=0,e=0;e<l&&(a++,n=n.nextZ,!!n);e++);for(c=l;a>0||c>0&&n;)a!==0&&(c===0||!n||t.z<=n.z)?(r=t,t=t.nextZ,a--):(r=n,n=n.nextZ,c--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;t=n}s.nextZ=null,l*=2}while(o>1);return i}function Q0(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function dH(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function bc(i,e,t,n,r,s,o,a){return(r-o)*(e-a)>=(i-o)*(s-a)&&(i-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(n-a)}function fH(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!hH(i,e)&&(ju(i,e)&&ju(e,i)&&pH(i,e)&&(zt(i.prev,i,e.prev)||zt(i,e.prev,e))||hg(i,e)&&zt(i.prev,i,i.next)>0&&zt(e.prev,e,e.next)>0)}function zt(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function hg(i,e){return i.x===e.x&&i.y===e.y}function uI(i,e,t,n){let r=fp(zt(i,e,t)),s=fp(zt(i,e,n)),o=fp(zt(t,n,i)),a=fp(zt(t,n,e));return!!(r!==s&&o!==a||r===0&&dp(i,t,e)||s===0&&dp(i,n,e)||o===0&&dp(t,i,n)||a===0&&dp(t,e,n))}function dp(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function fp(i){return i>0?1:i<0?-1:0}function hH(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&uI(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function ju(i,e){return zt(i.prev,i,i.next)<0?zt(i,e,i.next)>=0&&zt(i,i.prev,e)>=0:zt(i,e,i.prev)<0||zt(i,i.next,e)<0}function pH(i,e){let t=i,n=!1,r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function dI(i,e){let t=new ex(i.i,i.x,i.y),n=new ex(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function UA(i,e,t,n){let r=new ex(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Wu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function ex(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function mH(i,e,t,n){let r=0;for(let s=e,o=t-n;s<t;s+=n)r+=(i[o]-i[s])*(i[s+1]+i[o+1]),o=s;return r}var br=class i{static area(e){let t=e.length,n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return i.area(e)<0}static triangulateShape(e,t){let n=[],r=[],s=[];BA(e),VA(n,e);let o=e.length;t.forEach(BA);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,VA(n,t[c]);let a=Qz.triangulate(n,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}};function BA(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function VA(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}var Tm=class i extends et{constructor(e=new ss([new q(.5,.5),new q(-.5,.5),new q(-.5,-.5),new q(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++){let l=e[a];o(l)}this.setAttribute("position",new Ce(r,3)),this.setAttribute("uv",new Ce(s,2)),this.computeVertexNormals();function o(a){let c=[],l=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1,f=t.bevelEnabled!==void 0?t.bevelEnabled:!0,h=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:h-.1,v=t.bevelOffset!==void 0?t.bevelOffset:0,g=t.bevelSegments!==void 0?t.bevelSegments:3,m=t.extrudePath,_=t.UVGenerator!==void 0?t.UVGenerator:gH,x,y=!1,D,w,E,C;m&&(x=m.getSpacedPoints(u),y=!0,f=!1,D=m.computeFrenetFrames(u,!1),w=new A,E=new A,C=new A),f||(g=0,h=0,p=0,v=0);let S=a.extractPoints(l),M=S.shape,R=S.holes;if(!br.isClockWise(M)){M=M.reverse();for(let te=0,ae=R.length;te<ae;te++){let N=R[te];br.isClockWise(N)&&(R[te]=N.reverse())}}let k=br.triangulateShape(M,R),j=M;for(let te=0,ae=R.length;te<ae;te++){let N=R[te];M=M.concat(N)}function Y(te,ae,N){return ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),te.clone().addScaledVector(ae,N)}let V=M.length,$=k.length;function z(te,ae,N){let Ie,re,Me,he=te.x-ae.x,He=te.y-ae.y,Se=N.x-te.x,I=N.y-te.y,b=he*he+He*He,U=he*I-He*Se;if(Math.abs(U)>Number.EPSILON){let X=Math.sqrt(b),ne=Math.sqrt(Se*Se+I*I),K=ae.x-He/X,De=ae.y+he/X,pe=N.x-I/ne,be=N.y+Se/ne,lt=((pe-K)*I-(be-De)*Se)/(he*I-He*Se);Ie=K+he*lt-te.x,re=De+He*lt-te.y;let se=Ie*Ie+re*re;if(se<=2)return new q(Ie,re);Me=Math.sqrt(se/2)}else{let X=!1;he>Number.EPSILON?Se>Number.EPSILON&&(X=!0):he<-Number.EPSILON?Se<-Number.EPSILON&&(X=!0):Math.sign(He)===Math.sign(I)&&(X=!0),X?(Ie=-He,re=he,Me=Math.sqrt(b)):(Ie=he,re=He,Me=Math.sqrt(b/2))}return new q(Ie/Me,re/Me)}let ce=[];for(let te=0,ae=j.length,N=ae-1,Ie=te+1;te<ae;te++,N++,Ie++)N===ae&&(N=0),Ie===ae&&(Ie=0),ce[te]=z(j[te],j[N],j[Ie]);let ge=[],we,Je=ce.concat();for(let te=0,ae=R.length;te<ae;te++){let N=R[te];we=[];for(let Ie=0,re=N.length,Me=re-1,he=Ie+1;Ie<re;Ie++,Me++,he++)Me===re&&(Me=0),he===re&&(he=0),we[Ie]=z(N[Ie],N[Me],N[he]);ge.push(we),Je=Je.concat(we)}for(let te=0;te<g;te++){let ae=te/g,N=h*Math.cos(ae*Math.PI/2),Ie=p*Math.sin(ae*Math.PI/2)+v;for(let re=0,Me=j.length;re<Me;re++){let he=Y(j[re],ce[re],Ie);fe(he.x,he.y,-N)}for(let re=0,Me=R.length;re<Me;re++){let he=R[re];we=ge[re];for(let He=0,Se=he.length;He<Se;He++){let I=Y(he[He],we[He],Ie);fe(I.x,I.y,-N)}}}let Mt=p+v;for(let te=0;te<V;te++){let ae=f?Y(M[te],Je[te],Mt):M[te];y?(E.copy(D.normals[0]).multiplyScalar(ae.x),w.copy(D.binormals[0]).multiplyScalar(ae.y),C.copy(x[0]).add(E).add(w),fe(C.x,C.y,C.z)):fe(ae.x,ae.y,0)}for(let te=1;te<=u;te++)for(let ae=0;ae<V;ae++){let N=f?Y(M[ae],Je[ae],Mt):M[ae];y?(E.copy(D.normals[te]).multiplyScalar(N.x),w.copy(D.binormals[te]).multiplyScalar(N.y),C.copy(x[te]).add(E).add(w),fe(C.x,C.y,C.z)):fe(N.x,N.y,d/u*te)}for(let te=g-1;te>=0;te--){let ae=te/g,N=h*Math.cos(ae*Math.PI/2),Ie=p*Math.sin(ae*Math.PI/2)+v;for(let re=0,Me=j.length;re<Me;re++){let he=Y(j[re],ce[re],Ie);fe(he.x,he.y,d+N)}for(let re=0,Me=R.length;re<Me;re++){let he=R[re];we=ge[re];for(let He=0,Se=he.length;He<Se;He++){let I=Y(he[He],we[He],Ie);y?fe(I.x,I.y+x[u-1].y,x[u-1].x+N):fe(I.x,I.y,d+N)}}}J(),le();function J(){let te=r.length/3;if(f){let ae=0,N=V*ae;for(let Ie=0;Ie<$;Ie++){let re=k[Ie];Be(re[2]+N,re[1]+N,re[0]+N)}ae=u+g*2,N=V*ae;for(let Ie=0;Ie<$;Ie++){let re=k[Ie];Be(re[0]+N,re[1]+N,re[2]+N)}}else{for(let ae=0;ae<$;ae++){let N=k[ae];Be(N[2],N[1],N[0])}for(let ae=0;ae<$;ae++){let N=k[ae];Be(N[0]+V*u,N[1]+V*u,N[2]+V*u)}}n.addGroup(te,r.length/3-te,0)}function le(){let te=r.length/3,ae=0;Ae(j,ae),ae+=j.length;for(let N=0,Ie=R.length;N<Ie;N++){let re=R[N];Ae(re,ae),ae+=re.length}n.addGroup(te,r.length/3-te,1)}function Ae(te,ae){let N=te.length;for(;--N>=0;){let Ie=N,re=N-1;re<0&&(re=te.length-1);for(let Me=0,he=u+g*2;Me<he;Me++){let He=V*Me,Se=V*(Me+1),I=ae+Ie+He,b=ae+re+He,U=ae+re+Se,X=ae+Ie+Se;Ze(I,b,U,X)}}}function fe(te,ae,N){c.push(te),c.push(ae),c.push(N)}function Be(te,ae,N){$e(te),$e(ae),$e(N);let Ie=r.length/3,re=_.generateTopUV(n,r,Ie-3,Ie-2,Ie-1);pt(re[0]),pt(re[1]),pt(re[2])}function Ze(te,ae,N,Ie){$e(te),$e(ae),$e(Ie),$e(ae),$e(N),$e(Ie);let re=r.length/3,Me=_.generateSideWallUV(n,r,re-6,re-3,re-2,re-1);pt(Me[0]),pt(Me[1]),pt(Me[3]),pt(Me[1]),pt(Me[2]),pt(Me[3])}function $e(te){r.push(c[te*3+0]),r.push(c[te*3+1]),r.push(c[te*3+2])}function pt(te){s.push(te.x),s.push(te.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return vH(t,n,e)}static fromJSON(e,t){let n=[];for(let s=0,o=e.shapes.length;s<o;s++){let a=t[e.shapes[s]];n.push(a)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new _m[r.type]().fromJSON(r)),new i(n,e.options)}},gH={generateTopUV:function(i,e,t,n,r){let s=e[t*3],o=e[t*3+1],a=e[n*3],c=e[n*3+1],l=e[r*3],u=e[r*3+1];return[new q(s,o),new q(a,c),new q(l,u)]},generateSideWallUV:function(i,e,t,n,r,s){let o=e[t*3],a=e[t*3+1],c=e[t*3+2],l=e[n*3],u=e[n*3+1],d=e[n*3+2],f=e[r*3],h=e[r*3+1],p=e[r*3+2],v=e[s*3],g=e[s*3+1],m=e[s*3+2];return Math.abs(a-u)<Math.abs(o-l)?[new q(o,1-c),new q(l,1-d),new q(f,1-p),new q(v,1-m)]:[new q(a,1-c),new q(u,1-d),new q(h,1-p),new q(g,1-m)]}};function vH(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){let s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var Cm=class i extends Qs{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},$u=class i extends Qs{constructor(e=1,t=0){let n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},Am=class i extends et{constructor(e=.5,t=1,n=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:o},n=Math.max(3,n),r=Math.max(1,r);let a=[],c=[],l=[],u=[],d=e,f=(t-e)/r,h=new A,p=new q;for(let v=0;v<=r;v++){for(let g=0;g<=n;g++){let m=s+g/n*o;h.x=d*Math.cos(m),h.y=d*Math.sin(m),c.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(h.x/t+1)/2,p.y=(h.y/t+1)/2,u.push(p.x,p.y)}d+=f}for(let v=0;v<r;v++){let g=v*(n+1);for(let m=0;m<n;m++){let _=m+g,x=_,y=_+n+1,D=_+n+2,w=_+1;a.push(x,y,w),a.push(y,D,w)}}this.setIndex(a),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(l,3)),this.setAttribute("uv",new Ce(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}},Dm=class i extends et{constructor(e=new ss([new q(0,.5),new q(-.5,-.5),new q(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let n=[],r=[],s=[],o=[],a=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(a,c,u),a+=c,c=0;this.setIndex(n),this.setAttribute("position",new Ce(r,3)),this.setAttribute("normal",new Ce(s,3)),this.setAttribute("uv",new Ce(o,2));function l(u){let d=r.length/3,f=u.extractPoints(t),h=f.shape,p=f.holes;br.isClockWise(h)===!1&&(h=h.reverse());for(let g=0,m=p.length;g<m;g++){let _=p[g];br.isClockWise(_)===!0&&(p[g]=_.reverse())}let v=br.triangulateShape(h,p);for(let g=0,m=p.length;g<m;g++){let _=p[g];h=h.concat(_)}for(let g=0,m=h.length;g<m;g++){let _=h[g];r.push(_.x,_.y,0),s.push(0,0,1),o.push(_.x,_.y)}for(let g=0,m=v.length;g<m;g++){let _=v[g],x=_[0]+d,y=_[1]+d,D=_[2]+d;n.push(x,y,D),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return yH(t,e)}static fromJSON(e,t){let n=[];for(let r=0,s=e.shapes.length;r<s;r++){let o=t[e.shapes[r]];n.push(o)}return new i(n,e.curveSegments)}};function yH(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){let r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}var qu=class i extends et{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let c=Math.min(o+a,Math.PI),l=0,u=[],d=new A,f=new A,h=[],p=[],v=[],g=[];for(let m=0;m<=n;m++){let _=[],x=m/n,y=0;m===0&&o===0?y=.5/t:m===n&&c===Math.PI&&(y=-.5/t);for(let D=0;D<=t;D++){let w=D/t;d.x=-e*Math.cos(r+w*s)*Math.sin(o+x*a),d.y=e*Math.cos(o+x*a),d.z=e*Math.sin(r+w*s)*Math.sin(o+x*a),p.push(d.x,d.y,d.z),f.copy(d).normalize(),v.push(f.x,f.y,f.z),g.push(w+y,1-x),_.push(l++)}u.push(_)}for(let m=0;m<n;m++)for(let _=0;_<t;_++){let x=u[m][_+1],y=u[m][_],D=u[m+1][_],w=u[m+1][_+1];(m!==0||o>0)&&h.push(x,y,w),(m!==n-1||c<Math.PI)&&h.push(y,D,w)}this.setIndex(h),this.setAttribute("position",new Ce(p,3)),this.setAttribute("normal",new Ce(v,3)),this.setAttribute("uv",new Ce(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},Im=class i extends Qs{constructor(e=1,t=0){let n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},Rm=class i extends et{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);let o=[],a=[],c=[],l=[],u=new A,d=new A,f=new A;for(let h=0;h<=n;h++)for(let p=0;p<=r;p++){let v=p/r*s,g=h/n*Math.PI*2;d.x=(e+t*Math.cos(g))*Math.cos(v),d.y=(e+t*Math.cos(g))*Math.sin(v),d.z=t*Math.sin(g),a.push(d.x,d.y,d.z),u.x=e*Math.cos(v),u.y=e*Math.sin(v),f.subVectors(d,u).normalize(),c.push(f.x,f.y,f.z),l.push(p/r),l.push(h/n)}for(let h=1;h<=n;h++)for(let p=1;p<=r;p++){let v=(r+1)*h+p-1,g=(r+1)*(h-1)+p-1,m=(r+1)*(h-1)+p,_=(r+1)*h+p;o.push(v,g,_),o.push(g,m,_)}this.setIndex(o),this.setAttribute("position",new Ce(a,3)),this.setAttribute("normal",new Ce(c,3)),this.setAttribute("uv",new Ce(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},Nm=class i extends et{constructor(e=1,t=.4,n=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:o},n=Math.floor(n),r=Math.floor(r);let a=[],c=[],l=[],u=[],d=new A,f=new A,h=new A,p=new A,v=new A,g=new A,m=new A;for(let x=0;x<=n;++x){let y=x/n*s*Math.PI*2;_(y,s,o,e,h),_(y+.01,s,o,e,p),g.subVectors(p,h),m.addVectors(p,h),v.crossVectors(g,m),m.crossVectors(v,g),v.normalize(),m.normalize();for(let D=0;D<=r;++D){let w=D/r*Math.PI*2,E=-t*Math.cos(w),C=t*Math.sin(w);d.x=h.x+(E*m.x+C*v.x),d.y=h.y+(E*m.y+C*v.y),d.z=h.z+(E*m.z+C*v.z),c.push(d.x,d.y,d.z),f.subVectors(d,h).normalize(),l.push(f.x,f.y,f.z),u.push(x/n),u.push(D/r)}}for(let x=1;x<=n;x++)for(let y=1;y<=r;y++){let D=(r+1)*(x-1)+(y-1),w=(r+1)*x+(y-1),E=(r+1)*x+y,C=(r+1)*(x-1)+y;a.push(D,w,C),a.push(w,E,C)}this.setIndex(a),this.setAttribute("position",new Ce(c,3)),this.setAttribute("normal",new Ce(l,3)),this.setAttribute("uv",new Ce(u,2));function _(x,y,D,w,E){let C=Math.cos(x),S=Math.sin(x),M=D/y*x,R=Math.cos(M);E.x=w*(2+R)*.5*C,E.y=w*(2+R)*S*.5,E.z=w*Math.sin(M)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},Pm=class i extends et{constructor(e=new Vu(new A(-1,-1,0),new A(-1,1,0),new A(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};let o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let a=new A,c=new A,l=new q,u=new A,d=[],f=[],h=[],p=[];v(),this.setIndex(p),this.setAttribute("position",new Ce(d,3)),this.setAttribute("normal",new Ce(f,3)),this.setAttribute("uv",new Ce(h,2));function v(){for(let x=0;x<t;x++)g(x);g(s===!1?t:0),_(),m()}function g(x){u=e.getPointAt(x/t,u);let y=o.normals[x],D=o.binormals[x];for(let w=0;w<=r;w++){let E=w/r*Math.PI*2,C=Math.sin(E),S=-Math.cos(E);c.x=S*y.x+C*D.x,c.y=S*y.y+C*D.y,c.z=S*y.z+C*D.z,c.normalize(),f.push(c.x,c.y,c.z),a.x=u.x+n*c.x,a.y=u.y+n*c.y,a.z=u.z+n*c.z,d.push(a.x,a.y,a.z)}}function m(){for(let x=1;x<=t;x++)for(let y=1;y<=r;y++){let D=(r+1)*(x-1)+(y-1),w=(r+1)*x+(y-1),E=(r+1)*x+y,C=(r+1)*(x-1)+y;p.push(D,w,C),p.push(w,E,C)}}function _(){for(let x=0;x<=t;x++)for(let y=0;y<=r;y++)l.x=x/t,l.y=y/r,h.push(l.x,l.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new i(new _m[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}},Om=class extends et{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let t=[],n=new Set,r=new A,s=new A;if(e.index!==null){let o=e.attributes.position,a=e.index,c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){let d=c[l],f=d.start,h=d.count;for(let p=f,v=f+h;p<v;p+=3)for(let g=0;g<3;g++){let m=a.getX(p+g),_=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,m),s.fromBufferAttribute(o,_),zA(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{let o=e.attributes.position;for(let a=0,c=o.count/3;a<c;a++)for(let l=0;l<3;l++){let u=3*a+l,d=3*a+(l+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,d),zA(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ce(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};function zA(i,e,t){let n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var HA=Object.freeze({__proto__:null,BoxGeometry:ia,CapsuleGeometry:Mm,CircleGeometry:Sm,ConeGeometry:bm,CylinderGeometry:Js,DodecahedronGeometry:wm,EdgesGeometry:Em,ExtrudeGeometry:Tm,IcosahedronGeometry:Cm,LatheGeometry:Hu,OctahedronGeometry:$u,PlaneGeometry:Rc,PolyhedronGeometry:Qs,RingGeometry:Am,ShapeGeometry:Dm,SphereGeometry:qu,TetrahedronGeometry:Im,TorusGeometry:Rm,TorusKnotGeometry:Nm,TubeGeometry:Pm,WireframeGeometry:Om}),Lm=class extends Zt{static get type(){return"ShadowMaterial"}constructor(e){super(),this.isShadowMaterial=!0,this.color=new de(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},Fm=class extends vi{static get type(){return"RawShaderMaterial"}constructor(e){super(e),this.isRawShaderMaterial=!0}},Ar=class extends Zt{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new de(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Er,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Vn=class extends Ar{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new q(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Xt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new de(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new de(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new de(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},km=class extends Zt{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new de(16777215),this.specular=new de(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Er,this.combine=nd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Um=class extends Zt{static get type(){return"MeshToonMaterial"}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.color=new de(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Bm=class extends Zt{static get type(){return"MeshNormalMaterial"}constructor(e){super(),this.isMeshNormalMaterial=!0,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},Vm=class extends Zt{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new de(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Er,this.combine=nd,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},zm=class extends Zt{static get type(){return"MeshMatcapMaterial"}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.color=new de(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new q(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}},Hm=class extends gn{static get type(){return"LineDashedMaterial"}constructor(e){super(),this.isLineDashedMaterial=!0,this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};function $o(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function fI(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function hI(i){function e(r,s){return i[r]-i[s]}let t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function tx(i,e,t){let n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){let a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=i[a+c]}return r}function oM(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let o=s[n];if(o!==void 0)if(Array.isArray(o))do o=s[n],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=i[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[n],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do o=s[n],o!==void 0&&(e.push(s.time),t.push(o)),s=i[r++];while(s!==void 0)}function _H(i,e,t,n,r=30){let s=i.clone();s.name=e;let o=[];for(let c=0;c<s.tracks.length;++c){let l=s.tracks[c],u=l.getValueSize(),d=[],f=[];for(let h=0;h<l.times.length;++h){let p=l.times[h]*r;if(!(p<t||p>=n)){d.push(l.times[h]);for(let v=0;v<u;++v)f.push(l.values[h*u+v])}}d.length!==0&&(l.times=$o(d,l.times.constructor),l.values=$o(f,l.values.constructor),o.push(l))}s.tracks=o;let a=1/0;for(let c=0;c<s.tracks.length;++c)a>s.tracks[c].times[0]&&(a=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*a);return s.resetDuration(),s}function xH(i,e=0,t=i,n=30){n<=0&&(n=30);let r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){let a=t.tracks[o],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;let l=i.tracks.find(function(m){return m.name===a.name&&m.ValueTypeName===c});if(l===void 0)continue;let u=0,d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let f=0,h=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=h/3);let p=a.times.length-1,v;if(s<=a.times[0]){let m=u,_=d-u;v=a.values.slice(m,_)}else if(s>=a.times[p]){let m=p*d+u,_=m+d-u;v=a.values.slice(m,_)}else{let m=a.createInterpolant(),_=u,x=d-u;m.evaluate(s),v=m.resultBuffer.slice(_,x)}c==="quaternion"&&new Yt().fromArray(v).normalize().conjugate().toArray(v);let g=l.times.length;for(let m=0;m<g;++m){let _=m*h+f;if(c==="quaternion")Yt.multiplyQuaternionsFlat(l.values,_,v,0,l.values,_);else{let x=h-f*2;for(let y=0;y<x;++y)l.values[_+y]-=v[y]}}}return i.blendMode=eM,i}var MH={convertArray:$o,isTypedArray:fI,getKeyframeOrder:hI,sortedArray:tx,flattenJSON:oM,subclip:_H,makeClipAdditive:xH},us=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(!(e>=s)){let a=t[1];e<a&&(n=2,s=a);for(let c=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===c)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0;break n}break e}for(;n<o;){let a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Gm=class extends us{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:jo,endingEnd:jo}}intervalChanged_(e,t,n){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case Wo:s=e,a=2*t-n;break;case wu:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(c===void 0)switch(this.getSettings_().endingEnd){case Wo:o=e,c=2*n-t;break;case wu:o=1,c=n+r[1]-r[0];break;default:o=e-1,c=t}let l=(n-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,d=this._offsetNext,f=this._weightPrev,h=this._weightNext,p=(n-t)/(r-t),v=p*p,g=v*p,m=-f*g+2*f*v-f*p,_=(1+f)*g+(-1.5-2*f)*v+(-.5+f)*p+1,x=(-1-h)*g+(1.5+h)*v+.5*p,y=h*g-h*v;for(let D=0;D!==a;++D)s[D]=m*o[u+D]+_*o[l+D]+x*o[c+D]+y*o[d+D];return s}},Xu=class extends us{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(n-t)/(r-t),d=1-u;for(let f=0;f!==a;++f)s[f]=o[l+f]*d+o[c+f]*u;return s}},jm=class extends us{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}},_i=class{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=$o(t,this.TimeBufferType),this.values=$o(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:$o(e.times,Array),values:$o(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new jm(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Xu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Gm(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ta:t=this.InterpolantFactoryMethodDiscrete;break;case na:t=this.InterpolantFactoryMethodLinear;break;case xp:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ta;case this.InterpolantFactoryMethodLinear:return na;case this.InterpolantFactoryMethodSmooth:return xp}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let c=n[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&fI(r))for(let a=0,c=r.length;a!==c;++a){let l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===xp,s=e.length-1,o=1;for(let a=1;a<s;++a){let c=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(r)c=!0;else{let d=a*n,f=d-n,h=d+n;for(let p=0;p!==n;++p){let v=t[d+p];if(v!==t[f+p]||v!==t[h+p]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];let d=a*n,f=o*n;for(let h=0;h!==n;++h)t[f+h]=t[d+h]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,c=o*n,l=0;l!==n;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};_i.prototype.TimeBufferType=Float32Array;_i.prototype.ValueBufferType=Float32Array;_i.prototype.DefaultInterpolation=na;var ds=class extends _i{constructor(e,t,n){super(e,t,n)}};ds.prototype.ValueTypeName="bool";ds.prototype.ValueBufferType=Array;ds.prototype.DefaultInterpolation=ta;ds.prototype.InterpolantFactoryMethodLinear=void 0;ds.prototype.InterpolantFactoryMethodSmooth=void 0;var Yu=class extends _i{};Yu.prototype.ValueTypeName="color";var Dr=class extends _i{};Dr.prototype.ValueTypeName="number";var Wm=class extends us{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(n-t)/(r-t),l=e*a;for(let u=l+a;l!==u;l+=4)Yt.slerpFlat(s,0,o,l-a,o,l,c);return s}},Ir=class extends _i{InterpolantFactoryMethodLinear(e){return new Wm(this.times,this.values,this.getValueSize(),e)}};Ir.prototype.ValueTypeName="quaternion";Ir.prototype.InterpolantFactoryMethodSmooth=void 0;var fs=class extends _i{constructor(e,t,n){super(e,t,n)}};fs.prototype.ValueTypeName="string";fs.prototype.ValueBufferType=Array;fs.prototype.DefaultInterpolation=ta;fs.prototype.InterpolantFactoryMethodLinear=void 0;fs.prototype.InterpolantFactoryMethodSmooth=void 0;var Rr=class extends _i{};Rr.prototype.ValueTypeName="vector";var hs=class{constructor(e="",t=-1,n=[],r=dg){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=mi(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(bH(n[o]).scale(r));let s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){let t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(_i.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){let s=t.length,o=[];for(let a=0;a<s;a++){let c=[],l=[];c.push((a+s-1)%s,a,(a+1)%s),l.push(0,1,0);let u=hI(c);c=tx(c,1,u),l=tx(l,1,u),!r&&c[0]===0&&(c.push(s),l.push(l[0])),o.push(new Dr(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){let l=e[a],u=l.name.match(s);if(u&&u.length>1){let d=u[1],f=r[d];f||(r[d]=f=[]),f.push(l)}}let o=[];for(let a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(d,f,h,p,v){if(h.length!==0){let g=[],m=[];oM(h,g,m,p),g.length!==0&&v.push(new d(f,g,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode,c=e.length||-1,l=e.hierarchy||[];for(let d=0;d<l.length;d++){let f=l[d].keys;if(!(!f||f.length===0))if(f[0].morphTargets){let h={},p;for(p=0;p<f.length;p++)if(f[p].morphTargets)for(let v=0;v<f[p].morphTargets.length;v++)h[f[p].morphTargets[v]]=-1;for(let v in h){let g=[],m=[];for(let _=0;_!==f[p].morphTargets.length;++_){let x=f[p];g.push(x.time),m.push(x.morphTarget===v?1:0)}r.push(new Dr(".morphTargetInfluence["+v+"]",g,m))}c=h.length*o}else{let h=".bones["+t[d].name+"]";n(Rr,h+".position",f,"pos",r),n(Ir,h+".quaternion",f,"rot",r),n(Rr,h+".scale",f,"scl",r)}}return r.length===0?null:new this(s,c,r,a)}resetDuration(){let e=this.tracks,t=0;for(let n=0,r=e.length;n!==r;++n){let s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function SH(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Dr;case"vector":case"vector2":case"vector3":case"vector4":return Rr;case"color":return Yu;case"quaternion":return Ir;case"bool":case"boolean":return ds;case"string":return fs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function bH(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=SH(i.type);if(i.times===void 0){let t=[],n=[];oM(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var ns={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},Zu=class{constructor(e,t,n){let r=this,s=!1,o=0,a=0,c,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,d){return l.push(u,d),this},this.removeHandler=function(u){let d=l.indexOf(u);return d!==-1&&l.splice(d,2),this},this.getHandler=function(u){for(let d=0,f=l.length;d<f;d+=2){let h=l[d],p=l[d+1];if(h.global&&(h.lastIndex=0),h.test(u))return p}return null}}},pI=new Zu,zn=(()=>{class i{constructor(t){this.manager=t!==void 0?t:pI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){let r=this;return new Promise(function(s,o){r.load(t,s,n,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return i.DEFAULT_MATERIAL_NAME="__DEFAULT",i})(),Jr={},nx=class extends Error{constructor(e,t){super(e),this.response=t}},si=class extends zn{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=ns.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Jr[e]!==void 0){Jr[e].push({onLoad:t,onProgress:n,onError:r});return}Jr[e]=[],Jr[e].push({onLoad:t,onProgress:n,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let u=Jr[e],d=l.body.getReader(),f=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),h=f?parseInt(f):0,p=h!==0,v=0,g=new ReadableStream({start(m){_();function _(){d.read().then(({done:x,value:y})=>{if(x)m.close();else{v+=y.byteLength;let D=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:h});for(let w=0,E=u.length;w<E;w++){let C=u[w];C.onProgress&&C.onProgress(D)}m.enqueue(y),_()}},x=>{m.error(x)})}}});return new Response(g)}else throw new nx(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return l.json();default:if(a===void 0)return l.text();{let d=/charset="?([^;"\s]*)"?/i.exec(a),f=d&&d[1]?d[1].toLowerCase():void 0,h=new TextDecoder(f);return l.arrayBuffer().then(p=>h.decode(p))}}}).then(l=>{ns.add(e,l);let u=Jr[e];delete Jr[e];for(let d=0,f=u.length;d<f;d++){let h=u[d];h.onLoad&&h.onLoad(l)}}).catch(l=>{let u=Jr[e];if(u===void 0)throw this.manager.itemError(e),l;delete Jr[e];for(let d=0,f=u.length;d<f;d++){let h=u[d];h.onError&&h.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},ix=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=this,o=new si(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){let t=[];for(let n=0;n<e.length;n++){let r=hs.parse(e[n]);t.push(r)}return t}},rx=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=this,o=[],a=new kc,c=new si(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let l=0;function u(d){c.load(e[d],function(f){let h=s.parse(f,!0);o[d]={width:h.width,height:h.height,format:h.format,mipmaps:h.mipmaps},l+=1,l===6&&(h.mipmapCount===1&&(a.minFilter=Ht),a.image=o,a.format=h.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let d=0,f=e.length;d<f;++d)u(d);else c.load(e,function(d){let f=s.parse(d,!0);if(f.isCubemap){let h=f.mipmaps.length/f.mipmapCount;for(let p=0;p<h;p++){o[p]={mipmaps:[]};for(let v=0;v<f.mipmapCount;v++)o[p].mipmaps.push(f.mipmaps[p*f.mipmapCount+v]),o[p].format=f.format,o[p].width=f.width,o[p].height=f.height}a.image=o}else a.image.width=f.width,a.image.height=f.height,a.mipmaps=f.mipmaps;f.mipmapCount===1&&(a.minFilter=Ht),a.format=f.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}},da=class extends zn{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=ns.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;let a=Cu("img");function c(){u(),ns.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}},sx=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=new ra;s.colorSpace=sn;let o=new da(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(l){o.load(e[l],function(u){s.images[l]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return s}},ox=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=this,o=new Fi,a=new si(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){let l;try{l=s.parse(c)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}l.image!==void 0?o.image=l.image:l.data!==void 0&&(o.image.width=l.width,o.image.height=l.height,o.image.data=l.data),o.wrapS=l.wrapS!==void 0?l.wrapS:ei,o.wrapT=l.wrapT!==void 0?l.wrapT:ei,o.magFilter=l.magFilter!==void 0?l.magFilter:Ht,o.minFilter=l.minFilter!==void 0?l.minFilter:Ht,o.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.colorSpace!==void 0&&(o.colorSpace=l.colorSpace),l.flipY!==void 0&&(o.flipY=l.flipY),l.format!==void 0&&(o.format=l.format),l.type!==void 0&&(o.type=l.type),l.mipmaps!==void 0&&(o.mipmaps=l.mipmaps,o.minFilter=pi),l.mipmapCount===1&&(o.minFilter=Ht),l.generateMipmaps!==void 0&&(o.generateMipmaps=l.generateMipmaps),o.needsUpdate=!0,t&&t(o,l)},n,r),o}},fa=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=new cn,o=new da(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}},Nr=class extends Rt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new de(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}},$m=class extends Nr{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Rt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new de(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},y0=new Ve,GA=new A,jA=new A,Ku=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new q(512,512),this.map=null,this.mapPass=null,this.matrix=new Ve,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sa,this._frameExtents=new q(1,1),this._viewportCount=1,this._viewports=[new _t(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;GA.setFromMatrixPosition(e.matrixWorld),t.position.copy(GA),jA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(jA),t.updateMatrixWorld(),y0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(y0),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(y0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},ax=class extends Ku{constructor(){super(new Ot(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=Cc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},Bc=class extends Nr{constructor(e,t,n=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Rt.DEFAULT_UP),this.updateMatrix(),this.target=new Rt,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new ax}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},WA=new Ve,lu=new A,_0=new A,cx=class extends Ku{constructor(){super(new Ot(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new q(4,2),this._viewportCount=6,this._viewports=[new _t(2,1,1,1),new _t(0,1,1,1),new _t(3,1,1,1),new _t(1,1,1,1),new _t(3,0,1,1),new _t(1,0,1,1)],this._cubeDirections=[new A(1,0,0),new A(-1,0,0),new A(0,0,1),new A(0,0,-1),new A(0,1,0),new A(0,-1,0)],this._cubeUps=[new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,1,0),new A(0,0,1),new A(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),lu.setFromMatrixPosition(e.matrixWorld),n.position.copy(lu),_0.copy(n.position),_0.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(_0),n.updateMatrixWorld(),r.makeTranslation(-lu.x,-lu.y,-lu.z),WA.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(WA)}},Vc=class extends Nr{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new cx}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},lx=class extends Ku{constructor(){super(new ii(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},zc=class extends Nr{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Rt.DEFAULT_UP),this.updateMatrix(),this.target=new Rt,this.shadow=new lx}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},qm=class extends Nr{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},Xm=class extends Nr{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}},Ym=class{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new A)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(n*s)),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){let n=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*n*s),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){let n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){let n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}},Zm=class extends Nr{constructor(e=new Ym,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}},Km=class i extends zn{constructor(e){super(e),this.textures={}}load(e,t,n,r){let s=this,o=new si(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){let t=this.textures;function n(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}let r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new de().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let s in e.uniforms){let o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=n(o.value);break;case"c":r.uniforms[s].value=new de().setHex(o.value);break;case"v2":r.uniforms[s].value=new q().fromArray(o.value);break;case"v3":r.uniforms[s].value=new A().fromArray(o.value);break;case"v4":r.uniforms[s].value=new _t().fromArray(o.value);break;case"m3":r.uniforms[s].value=new nt().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Ve().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(let s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new q().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new q().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return i.createMaterialFromType(e)}static createMaterialFromType(e){let t={ShadowMaterial:Lm,SpriteMaterial:Fu,RawShaderMaterial:Fm,ShaderMaterial:vi,PointsMaterial:ca,MeshPhysicalMaterial:Vn,MeshStandardMaterial:Ar,MeshPhongMaterial:km,MeshToonMaterial:Um,MeshNormalMaterial:Bm,MeshLambertMaterial:Vm,MeshDepthMaterial:Pu,MeshDistanceMaterial:Ou,MeshBasicMaterial:In,MeshMatcapMaterial:zm,LineDashedMaterial:Hm,LineBasicMaterial:gn,Material:Zt};return new t[e]}},cr=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}},Jm=class extends et{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},Qm=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=this,o=new si(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}parse(e){let t={},n={};function r(h,p){if(t[p]!==void 0)return t[p];let g=h.interleavedBuffers[p],m=s(h,g.buffer),_=Mc(g.type,m),x=new ls(_,g.stride);return x.uuid=g.uuid,t[p]=x,x}function s(h,p){if(n[p]!==void 0)return n[p];let g=h.arrayBuffers[p],m=new Uint32Array(g).buffer;return n[p]=m,m}let o=e.isInstancedBufferGeometry?new Jm:new et,a=e.data.index;if(a!==void 0){let h=Mc(a.type,a.array);o.setIndex(new xt(h,1))}let c=e.data.attributes;for(let h in c){let p=c[h],v;if(p.isInterleavedBufferAttribute){let g=r(e.data,p.data);v=new Cr(g,p.itemSize,p.offset,p.normalized)}else{let g=Mc(p.type,p.array),m=p.isInstancedBufferAttribute?ar:xt;v=new m(g,p.itemSize,p.normalized)}p.name!==void 0&&(v.name=p.name),p.usage!==void 0&&v.setUsage(p.usage),o.setAttribute(h,v)}let l=e.data.morphAttributes;if(l)for(let h in l){let p=l[h],v=[];for(let g=0,m=p.length;g<m;g++){let _=p[g],x;if(_.isInterleavedBufferAttribute){let y=r(e.data,_.data);x=new Cr(y,_.itemSize,_.offset,_.normalized)}else{let y=Mc(_.type,_.array);x=new xt(y,_.itemSize,_.normalized)}_.name!==void 0&&(x.name=_.name),v.push(x)}o.morphAttributes[h]=v}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);let d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let h=0,p=d.length;h!==p;++h){let v=d[h];o.addGroup(v.start,v.count,v.materialIndex)}let f=e.data.boundingSphere;if(f!==void 0){let h=new A;f.center!==void 0&&h.fromArray(f.center),o.boundingSphere=new an(h,f.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}},ux=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=this,o=this.path===""?cr.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;let a=new si(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(d){r!==void 0&&r(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}let u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(l,t)},n,r)}loadAsync(e,t){return Ss(this,null,function*(){let n=this,r=this.path===""?cr.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;let s=new si(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);let o=yield s.loadAsync(e,t),a=JSON.parse(o),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return yield n.parseAsync(a)})}parse(e,t){let n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(l)}),a=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,s,c,a,n),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),this.bindLightTargets(l),t!==void 0){let d=!1;for(let f in o)if(o[f].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(l)}return l}parseAsync(e){return Ss(this,null,function*(){let t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=yield this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,r,a,o,t),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),this.bindLightTargets(c),c})}parseShapes(e){let t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){let s=new ss().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){let n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){let a=new Pc().fromJSON(e[s],r);n[a.uuid]=a}return n}parseGeometries(e,t){let n={};if(e!==void 0){let r=new Qm;for(let s=0,o=e.length;s<o;s++){let a,c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(c);break;default:c.type in HA?a=HA[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),c.userData!==void 0&&(a.userData=c.userData),n[c.uuid]=a}}return n}parseMaterials(e,t){let n={},r={};if(e!==void 0){let s=new Km;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){let c=e[o];n[c.uuid]===void 0&&(n[c.uuid]=s.parse(c)),r[c.uuid]=n[c.uuid]}}return r}parseAnimations(e){let t={};if(e!==void 0)for(let n=0;n<e.length;n++){let r=e[n],s=hs.parse(r);t[s.uuid]=s}return t}parseImages(e,t){let n=this,r={},s;function o(c){return n.manager.itemStart(c),s.load(c,function(){n.manager.itemEnd(c)},void 0,function(){n.manager.itemError(c),n.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){let l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:n.resourcePath+l;return o(u)}else return c.data?{data:Mc(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){let c=new Zu(t);s=new da(c),s.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){let d=e[l],f=d.url;if(Array.isArray(f)){let h=[];for(let p=0,v=f.length;p<v;p++){let g=f[p],m=a(g);m!==null&&(m instanceof HTMLImageElement?h.push(m):h.push(new Fi(m.data,m.width,m.height)))}r[d.uuid]=new ts(h)}else{let h=a(d.url);r[d.uuid]=new ts(h)}}}return r}parseImagesAsync(e){return Ss(this,null,function*(){let t=this,n={},r;function s(o){return Ss(this,null,function*(){if(typeof o=="string"){let a=o,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return yield r.loadAsync(c)}else return o.data?{data:Mc(o.type,o.data),width:o.width,height:o.height}:null})}if(e!==void 0&&e.length>0){r=new da(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){let c=e[o],l=c.url;if(Array.isArray(l)){let u=[];for(let d=0,f=l.length;d<f;d++){let h=l[d],p=yield s(h);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new Fi(p.data,p.width,p.height)))}n[c.uuid]=new ts(u)}else{let u=yield s(c.url);n[c.uuid]=new ts(u)}}}return n})}parseTextures(e,t){function n(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}let r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){let a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);let c=t[a.image],l=c.data,u;Array.isArray(l)?(u=new ra,l.length===6&&(u.needsUpdate=!0)):(l&&l.data?u=new Fi:u=new cn,l&&(u.needsUpdate=!0)),u.source=c,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=n(a.mapping,wH)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=n(a.wrap[0],$A),u.wrapT=n(a.wrap[1],$A)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.minFilter!==void 0&&(u.minFilter=n(a.minFilter,qA)),a.magFilter!==void 0&&(u.magFilter=n(a.magFilter,qA)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,n,r,s){let o;function a(f){return t[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",f),t[f]}function c(f){if(f!==void 0){if(Array.isArray(f)){let h=[];for(let p=0,v=f.length;p<v;p++){let g=f[p];n[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),h.push(n[g])}return h}return n[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",f),n[f]}}function l(f){return r[f]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",f),r[f]}let u,d;switch(e.type){case"Scene":o=new oa,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new de(e.background):o.background=l(e.background)),e.environment!==void 0&&(o.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new lm(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new cm(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Ot(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ii(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new qm(e.color,e.intensity);break;case"DirectionalLight":o=new zc(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Vc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Xm(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Bc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new $m(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new Zm().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),d=c(e.material),o=new Nc(u,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=c(e.material),o=new Ft(u,d);break;case"InstancedMesh":u=a(e.geometry),d=c(e.material);let f=e.count,h=e.instanceMatrix,p=e.instanceColor;o=new Oc(u,d,f),o.instanceMatrix=new ar(new Float32Array(h.array),16),p!==void 0&&(o.instanceColor=new ar(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=a(e.geometry),d=c(e.material),o=new fm(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(v=>{let g=new hn;g.min.fromArray(v.boxMin),g.max.fromArray(v.boxMax);let m=new an;return m.radius=v.sphereRadius,m.center.fromArray(v.sphereCenter),{boxInitialized:v.boxInitialized,box:g,sphereInitialized:v.sphereInitialized,sphere:m}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=l(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=l(e.colorsTexture.uuid));break;case"LOD":o=new dm;break;case"Line":o=new Ui(a(e.geometry),c(e.material));break;case"LineLoop":o=new Lc(a(e.geometry),c(e.material));break;case"LineSegments":o=new ri(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new Fc(a(e.geometry),c(e.material));break;case"Sprite":o=new um(c(e.material));break;case"Group":o=new Li;break;case"Bone":o=new aa;break;default:o=new Rt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){let f=e.children;for(let h=0;h<f.length;h++)o.add(this.parseObject(f[h],t,n,r,s))}if(e.animations!==void 0){let f=e.animations;for(let h=0;h<f.length;h++){let p=f[h];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);let f=e.levels;for(let h=0;h<f.length;h++){let p=f[h],v=o.getObjectByProperty("uuid",p.object);v!==void 0&&o.addLevel(v,p.distance,p.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){let r=t[n.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){let n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new Rt}})}},wH={UVMapping:Ip,CubeReflectionMapping:os,CubeRefractionMapping:Ks,EquirectangularReflectionMapping:Su,EquirectangularRefractionMapping:bu,CubeUVReflectionMapping:Wc},$A={RepeatWrapping:as,ClampToEdgeWrapping:ei,MirroredRepeatWrapping:Jo},qA={NearestFilter:on,NearestMipmapNearestFilter:id,NearestMipmapLinearFilter:Zs,LinearFilter:Ht,LinearMipmapNearestFilter:Xo,LinearMipmapLinearFilter:pi},Ju=class extends zn{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=ns.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(l=>{t&&t(l),s.manager.itemEnd(e)}).catch(l=>{r&&r(l)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;let c=fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){return ns.add(e,l),t&&t(l),s.manager.itemEnd(e),l}).catch(function(l){r&&r(l),ns.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});ns.add(e,c),s.manager.itemStart(e)}},hp,Qu=class{static getContext(){return hp===void 0&&(hp=new(window.AudioContext||window.webkitAudioContext)),hp}static setContext(e){hp=e}},dx=class extends zn{constructor(e){super(e)}load(e,t,n,r){let s=this,o=new si(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{let l=c.slice(0);Qu.getContext().decodeAudioData(l,function(d){t(d)}).catch(a)}catch(l){a(l)}},n,r);function a(c){r?r(c):console.error(c),s.manager.itemError(e)}}},XA=new Ve,YA=new Ve,Fo=new Ve,fx=class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ot,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ot,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){let t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Fo.copy(e.projectionMatrix);let r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Zo*t.fov*.5)/t.zoom,a,c;YA.elements[12]=-r,XA.elements[12]=r,a=-o*t.aspect+s,c=o*t.aspect+s,Fo.elements[0]=2*t.near/(c-a),Fo.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(Fo),a=-o*t.aspect-s,c=o*t.aspect-s,Fo.elements[0]=2*t.near/(c-a),Fo.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(Fo)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(YA),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(XA)}},Hc=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ZA(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=ZA();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function ZA(){return performance.now()}var ko=new A,KA=new Yt,EH=new A,Uo=new A,hx=class extends Rt{constructor(){super(),this.type="AudioListener",this.context=Qu.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Hc}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ko,KA,EH),Uo.set(0,0,-1).applyQuaternion(KA),t.positionX){let r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(ko.x,r),t.positionY.linearRampToValueAtTime(ko.y,r),t.positionZ.linearRampToValueAtTime(ko.z,r),t.forwardX.linearRampToValueAtTime(Uo.x,r),t.forwardY.linearRampToValueAtTime(Uo.y,r),t.forwardZ.linearRampToValueAtTime(Uo.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(ko.x,ko.y,ko.z),t.setOrientation(Uo.x,Uo.y,Uo.z,n.x,n.y,n.z)}},eg=class extends Rt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},Bo=new A,JA=new Yt,TH=new A,Vo=new A,px=class extends eg{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Bo,JA,TH),Vo.set(0,0,1).applyQuaternion(JA);let t=this.panner;if(t.positionX){let n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Bo.x,n),t.positionY.linearRampToValueAtTime(Bo.y,n),t.positionZ.linearRampToValueAtTime(Bo.z,n),t.orientationX.linearRampToValueAtTime(Vo.x,n),t.orientationY.linearRampToValueAtTime(Vo.y,n),t.orientationZ.linearRampToValueAtTime(Vo.z,n)}else t.setPosition(Bo.x,Bo.y,Bo.z),t.setOrientation(Vo.x,Vo.y,Vo.z)}},mx=class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}},tg=class{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let n=this.buffer,r=this.valueSize,s=e*r+r,o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)n[s+a]=n[a];o=t}else{o+=t;let a=t/o;this._mixBufferRegion(n,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){let t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){let c=t*this._origIndex;this._mixBufferRegion(n,r,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let c=t,l=t+t;c!==l;++c)if(n[c]!==n[c+t]){a.setValue(n,r);break}}saveOriginalState(){let e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,o=r;s!==o;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[n+o]}_slerp(e,t,n,r){Yt.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){let o=this._workIndex*s;Yt.multiplyQuaternionsFlat(e,o,e,t,e,n),Yt.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,n,r,s){let o=1-r;for(let a=0;a!==s;++a){let c=t+a;e[c]=e[c]*o+e[n+a]*r}}_lerpAdditive(e,t,n,r,s){for(let o=0;o!==s;++o){let a=t+o;e[a]=e[a]+e[n+o]*r}}},aM="\\[\\]\\.:\\/",CH=new RegExp("["+aM+"]","g"),cM="[^"+aM+"]",AH="[^"+aM.replace("\\.","")+"]",DH=/((?:WC+[\/:])*)/.source.replace("WC",cM),IH=/(WCOD+)?/.source.replace("WCOD",AH),RH=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cM),NH=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cM),PH=new RegExp("^"+DH+IH+RH+NH+"$"),OH=["material","materials","bones","map"],gx=class{constructor(e,t,n){let r=n||Nt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Nt=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(CH,"")}static parseTrackName(t){let n=PH.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){let o=r.nodeName.substring(s+1);OH.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){let r=t.skeleton.getBoneByName(n);if(r!==void 0)return r}if(t.children){let r=function(o){for(let a=0;a<o.length;a++){let c=o[a];if(c.name===n||c.uuid===n)return c;let l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node,n=this.parsedPath,r=n.objectName,s=n.propertyName,o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(u!==void 0){if(t[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[u]}}let a=t[s];if(a===void 0){let u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",t);return}let c=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=gx,i})();Nt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Nt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Nt.prototype.GetterByBindingType=[Nt.prototype._getValue_direct,Nt.prototype._getValue_array,Nt.prototype._getValue_arrayElement,Nt.prototype._getValue_toArray];Nt.prototype.SetterByBindingTypeAndVersioning=[[Nt.prototype._setValue_direct,Nt.prototype._setValue_direct_setNeedsUpdate,Nt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Nt.prototype._setValue_array,Nt.prototype._setValue_array_setNeedsUpdate,Nt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Nt.prototype._setValue_arrayElement,Nt.prototype._setValue_arrayElement_setNeedsUpdate,Nt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Nt.prototype._setValue_fromArray,Nt.prototype._setValue_fromArray_setNeedsUpdate,Nt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var vx=class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=mi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){let e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length,a,c=e.length,l=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){let f=arguments[u],h=f.uuid,p=t[h];if(p===void 0){p=c++,t[h]=p,e.push(f);for(let v=0,g=o;v!==g;++v)s[v].push(new Nt(f,n[v],r[v]))}else if(p<l){a=e[p];let v=--l,g=e[v];t[g.uuid]=p,e[p]=g,t[h]=v,e[v]=f;for(let m=0,_=o;m!==_;++m){let x=s[m],y=x[v],D=x[p];x[p]=y,D===void 0&&(D=new Nt(f,n[m],r[m])),x[v]=D}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){let c=arguments[o],l=c.uuid,u=t[l];if(u!==void 0&&u>=s){let d=s++,f=e[d];t[f.uuid]=u,e[u]=f,t[l]=d,e[d]=c;for(let h=0,p=r;h!==p;++h){let v=n[h],g=v[d],m=v[u];v[u]=g,v[d]=m}}}this.nCachedObjects_=s}uncache(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,s=this.nCachedObjects_,o=e.length;for(let a=0,c=arguments.length;a!==c;++a){let l=arguments[a],u=l.uuid,d=t[u];if(d!==void 0)if(delete t[u],d<s){let f=--s,h=e[f],p=--o,v=e[p];t[h.uuid]=d,e[d]=h,t[v.uuid]=f,e[f]=v,e.pop();for(let g=0,m=r;g!==m;++g){let _=n[g],x=_[f],y=_[p];_[d]=x,_[f]=y,_.pop()}}else{let f=--o,h=e[f];f>0&&(t[h.uuid]=d),e[d]=h,e.pop();for(let p=0,v=r;p!==v;++p){let g=n[p];g[d]=g[f],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){let n=this._bindingsIndicesByPath,r=n[e],s=this._bindings;if(r!==void 0)return s[r];let o=this._paths,a=this._parsedPaths,c=this._objects,l=c.length,u=this.nCachedObjects_,d=new Array(l);r=s.length,n[e]=r,o.push(e),a.push(t),s.push(d);for(let f=u,h=c.length;f!==h;++f){let p=c[f];d[f]=new Nt(p,e,t)}return d}unsubscribe_(e){let t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){let r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,c=o[a],l=e[a];t[l]=n,o[n]=c,o.pop(),s[n]=s[a],s.pop(),r[n]=r[a],r.pop()}}},ng=class{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;let s=t.tracks,o=s.length,a=new Array(o),c={endingStart:jo,endingEnd:jo};for(let l=0;l!==o;++l){let u=s[l].createInterpolant(null);a[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=BD,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){let r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){let r=this._mixer,s=r.time,o=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);let c=a.parameterPositions,l=a.sampleValues;return c[0]=s,c[1]=s+n,l[0]=e/o,l[1]=t/o,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}let s=this._startTime;if(s!==null){let c=(e-s)*n;c<0||n===0?t=0:(this._startTime=null,t=n*c)}t*=this._updateTimeScale(e);let o=this._updateTime(t),a=this._updateWeight(e);if(a>0){let c=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case eM:for(let u=0,d=c.length;u!==d;++u)c[u].evaluate(o),l[u].accumulateAdditive(a);break;case dg:default:for(let u=0,d=c.length;u!==d;++u)c[u].evaluate(o),l[u].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let n=this._weightInterpolant;if(n!==null){let r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let n=this._timeScaleInterpolant;if(n!==null){let r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,n=this.loop,r=this.time+e,s=this._loopCount,o=n===VD;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(n===UD){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){let a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);let c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){let l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){let r=this._interpolantSettings;n?(r.endingStart=Wo,r.endingEnd=Wo):(e?r.endingStart=this.zeroSlopeAtStart?Wo:jo:r.endingStart=wu,t?r.endingEnd=this.zeroSlopeAtEnd?Wo:jo:r.endingEnd=wu)}_scheduleFading(e,t,n){let r=this._mixer,s=r.time,o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);let a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=n,this}},LH=new Float32Array(1),yx=class extends ni{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,c=n.uuid,l=this._bindingsByRootAndName,u=l[c];u===void 0&&(u={},l[c]=u);for(let d=0;d!==s;++d){let f=r[d],h=f.name,p=u[h];if(p!==void 0)++p.referenceCount,o[d]=p;else{if(p=o[d],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,c,h));continue}let v=t&&t._propertyBindings[d].binding.parsedPath;p=new tg(Nt.create(n,h,v),f.ValueTypeName,f.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,c,h),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}let t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){let s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){let s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){let r=this._actions,s=this._actionsByClip,o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{let a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){let t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;let s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null;let d=a.actionByRoot,f=(e._localRoot||this._root).uuid;delete d[f],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){let s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){let t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){let t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){let r=this._bindingsByRootAndName,s=this._bindings,o=r[t];o===void 0&&(o={},r[t]=o),o[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){let t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,o=this._bindingsByRootAndName,a=o[r],c=t[t.length-1],l=e._cacheIndex;c._cacheIndex=l,t[l]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){let t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){let t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(n=new Xu(new Float32Array(2),new Float32Array(2),1,LH),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){let t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){let r=t||this._root,s=r.uuid,o=typeof e=="string"?hs.findByName(r,e):e,a=o!==null?o.uuid:e,c=this._actionsByClip[a],l=null;if(n===void 0&&(o!==null?n=o.blendMode:n=dg),c!==void 0){let d=c.actionByRoot[s];if(d!==void 0&&d.blendMode===n)return d;l=c.knownActions[0],o===null&&(o=l._clip)}if(o===null)return null;let u=new ng(this,o,t,n);return this._bindAction(u,l),this._addInactiveAction(u,a,s),u}existingAction(e,t){let n=t||this._root,r=n.uuid,s=typeof e=="string"?hs.findByName(n,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;let t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(r,e,s,o);let a=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)a[l].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){let o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){let l=o[a];this._deactivateAction(l);let u=l._cacheIndex,d=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}}uncacheRoot(e){let t=e.uuid,n=this._actionsByClip;for(let o in n){let a=n[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}let r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(let o in s){let a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}},_x=class i{constructor(e){this.value=e}clone(){return new i(this.value.clone===void 0?this.value:this.value.clone())}},FH=0,xx=class extends ni{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:FH++}),this.name="",this.usage=Eu,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){let t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;let t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){let s=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}},Mx=class extends ls{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}},Sx=class{constructor(e,t,n,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},QA=new Ve,ed=class{constructor(e,t,n=0,r=1/0){this.ray=new wr(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Tr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return QA.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(QA),this}intersectObject(e,t=!0,n=[]){return bx(e,this,n,t),n.sort(eD),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)bx(e[r],this,n,t);return n.sort(eD),n}};function eD(i,e){return i.distance-e.distance}function bx(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){let s=i.children;for(let o=0,a=s.length;o<a;o++)bx(s[o],e,t,!0)}}var Gc=class{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Xt(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},wx=class{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}},Ex=class i{constructor(e,t,n,r){i.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){let s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}},tD=new q,Tx=class{constructor(e=new q(1/0,1/0),t=new q(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=tD.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,tD).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},nD=new A,pp=new A,Cx=class{constructor(e=new A,t=new A){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){nD.subVectors(e,this.start),pp.subVectors(this.end,this.start);let n=pp.dot(pp),s=pp.dot(nD)/n;return t&&(s=Xt(s,0,1)),s}closestPointToPoint(e,t,n){let r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},iD=new A,Ax=class extends Rt{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let n=new et,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){let l=o/c*Math.PI*2,u=a/c*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new Ce(r,3));let s=new gn({fog:!1,toneMapped:!1});this.cone=new ri(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),iD.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(iD),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Xs=new A,mp=new Ve,x0=new Ve,Dx=class extends ri{constructor(e){let t=mI(e),n=new et,r=[],s=[],o=new de(0,0,1),a=new de(0,1,0);for(let l=0;l<t.length;l++){let u=t[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}n.setAttribute("position",new Ce(r,3)),n.setAttribute("color",new Ce(s,3));let c=new gn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){let t=this.bones,n=this.geometry,r=n.getAttribute("position");x0.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){let a=t[s];a.parent&&a.parent.isBone&&(mp.multiplyMatrices(x0,a.matrixWorld),Xs.setFromMatrixPosition(mp),r.setXYZ(o,Xs.x,Xs.y,Xs.z),mp.multiplyMatrices(x0,a.parent.matrixWorld),Xs.setFromMatrixPosition(mp),r.setXYZ(o+1,Xs.x,Xs.y,Xs.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}};function mI(i){let e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push.apply(e,mI(i.children[t]));return e}var Ix=class extends Ft{constructor(e,t,n){let r=new qu(t,4,2),s=new In({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},kH=new A,rD=new de,sD=new de,Rx=class extends Rt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";let r=new $u(t);r.rotateY(Math.PI*.5),this.material=new In({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);let s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new xt(o,3)),this.add(new Ft(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{let t=e.geometry.getAttribute("color");rD.copy(this.light.color),sD.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){let s=n<r/2?rD:sD;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(kH.setFromMatrixPosition(this.light.matrixWorld).negate())}},Nx=class extends ri{constructor(e=10,t=10,n=4473924,r=8947848){n=new de(n),r=new de(r);let s=t/2,o=e/t,a=e/2,c=[],l=[];for(let f=0,h=0,p=-a;f<=t;f++,p+=o){c.push(-a,0,p,a,0,p),c.push(p,0,-a,p,0,a);let v=f===s?n:r;v.toArray(l,h),h+=3,v.toArray(l,h),h+=3,v.toArray(l,h),h+=3,v.toArray(l,h),h+=3}let u=new et;u.setAttribute("position",new Ce(c,3)),u.setAttribute("color",new Ce(l,3));let d=new gn({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},Px=class extends ri{constructor(e=10,t=16,n=8,r=64,s=4473924,o=8947848){s=new de(s),o=new de(o);let a=[],c=[];if(t>1)for(let d=0;d<t;d++){let f=d/t*(Math.PI*2),h=Math.sin(f)*e,p=Math.cos(f)*e;a.push(0,0,0),a.push(h,0,p);let v=d&1?s:o;c.push(v.r,v.g,v.b),c.push(v.r,v.g,v.b)}for(let d=0;d<n;d++){let f=d&1?s:o,h=e-e/n*d;for(let p=0;p<r;p++){let v=p/r*(Math.PI*2),g=Math.sin(v)*h,m=Math.cos(v)*h;a.push(g,0,m),c.push(f.r,f.g,f.b),v=(p+1)/r*(Math.PI*2),g=Math.sin(v)*h,m=Math.cos(v)*h,a.push(g,0,m),c.push(f.r,f.g,f.b)}}let l=new et;l.setAttribute("position",new Ce(a,3)),l.setAttribute("color",new Ce(c,3));let u=new gn({vertexColors:!0,toneMapped:!1});super(l,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},oD=new A,gp=new A,aD=new A,Ox=class extends Rt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new et;r.setAttribute("position",new Ce([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let s=new gn({fog:!1,toneMapped:!1});this.lightPlane=new Ui(r,s),this.add(this.lightPlane),r=new et,r.setAttribute("position",new Ce([0,0,0,0,0,1],3)),this.targetLine=new Ui(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),oD.setFromMatrixPosition(this.light.matrixWorld),gp.setFromMatrixPosition(this.light.target.matrixWorld),aD.subVectors(gp,oD),this.lightPlane.lookAt(gp),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gp),this.targetLine.scale.z=aD.length()}},vp=new A,qt=new Ic,Lx=class extends ri{constructor(e){let t=new et,n=new gn({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,v){c(p),c(v)}function c(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}t.setAttribute("position",new Ce(r,3)),t.setAttribute("color",new Ce(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();let l=new de(16755200),u=new de(16711680),d=new de(43775),f=new de(16777215),h=new de(3355443);this.setColors(l,u,d,f,h)}setColors(e,t,n,r,s){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,n=1,r=1;qt.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),en("c",t,e,qt,0,0,-1),en("t",t,e,qt,0,0,1),en("n1",t,e,qt,-n,-r,-1),en("n2",t,e,qt,n,-r,-1),en("n3",t,e,qt,-n,r,-1),en("n4",t,e,qt,n,r,-1),en("f1",t,e,qt,-n,-r,1),en("f2",t,e,qt,n,-r,1),en("f3",t,e,qt,-n,r,1),en("f4",t,e,qt,n,r,1),en("u1",t,e,qt,n*.7,r*1.1,-1),en("u2",t,e,qt,-n*.7,r*1.1,-1),en("u3",t,e,qt,0,r*2,-1),en("cf1",t,e,qt,-n,0,1),en("cf2",t,e,qt,n,0,1),en("cf3",t,e,qt,0,-r,1),en("cf4",t,e,qt,0,r,1),en("cn1",t,e,qt,-n,0,-1),en("cn2",t,e,qt,n,0,-1),en("cn3",t,e,qt,0,-r,-1),en("cn4",t,e,qt,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function en(i,e,t,n,r,s,o){vp.set(r,s,o).unproject(n);let a=e[i];if(a!==void 0){let c=t.getAttribute("position");for(let l=0,u=a.length;l<u;l++)c.setXYZ(a[l],vp.x,vp.y,vp.z)}}var yp=new hn,Fx=class extends ri{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new et;s.setIndex(new xt(n,1)),s.setAttribute("position",new xt(r,3)),super(s,new gn({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&yp.setFromObject(this.object),yp.isEmpty())return;let t=yp.min,n=yp.max,r=this.geometry.attributes.position,s=r.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},kx=class extends ri{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new et;s.setIndex(new xt(n,1)),s.setAttribute("position",new Ce(r,3)),super(s,new gn({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},Ux=class extends Ui{constructor(e,t=1,n=16776960){let r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new et;o.setAttribute("position",new Ce(s,3)),o.computeBoundingSphere(),super(o,new gn({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;let a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new et;c.setAttribute("position",new Ce(a,3)),c.computeBoundingSphere(),this.add(new Ft(c,new In({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},cD=new A,_p,M0,Bx=class extends Rt{constructor(e=new A(0,0,1),t=new A(0,0,0),n=1,r=16776960,s=n*.2,o=s*.2){super(),this.type="ArrowHelper",_p===void 0&&(_p=new et,_p.setAttribute("position",new Ce([0,0,0,0,1,0],3)),M0=new Js(0,.5,1,5,1),M0.translate(0,-.5,0)),this.position.copy(t),this.line=new Ui(_p,new gn({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ft(M0,new In({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{cD.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(cD,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},Vx=class extends ri{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new et;r.setAttribute("position",new Ce(t,3)),r.setAttribute("color",new Ce(n,3));let s=new gn({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){let r=new de,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},zx=class{constructor(){this.type="ShapePath",this.color=new de,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new la,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,o){return this.currentPath.bezierCurveTo(e,t,n,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(m){let _=[];for(let x=0,y=m.length;x<y;x++){let D=m[x],w=new ss;w.curves=D.curves,_.push(w)}return _}function n(m,_){let x=_.length,y=!1;for(let D=x-1,w=0;w<x;D=w++){let E=_[D],C=_[w],S=C.x-E.x,M=C.y-E.y;if(Math.abs(M)>Number.EPSILON){if(M<0&&(E=_[w],S=-S,C=_[D],M=-M),m.y<E.y||m.y>C.y)continue;if(m.y===E.y){if(m.x===E.x)return!0}else{let R=M*(m.x-E.x)-S*(m.y-E.y);if(R===0)return!0;if(R<0)continue;y=!y}}else{if(m.y!==E.y)continue;if(C.x<=m.x&&m.x<=E.x||E.x<=m.x&&m.x<=C.x)return!0}}return y}let r=br.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,c,l=[];if(s.length===1)return a=s[0],c=new ss,c.curves=a.curves,l.push(c),l;let u=!r(s[0].getPoints());u=e?!u:u;let d=[],f=[],h=[],p=0,v;f[p]=void 0,h[p]=[];for(let m=0,_=s.length;m<_;m++)a=s[m],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!u&&f[p]&&p++,f[p]={s:new ss,p:v},f[p].s.curves=a.curves,u&&p++,h[p]=[]):h[p].push({h:a,p:v[0]});if(!f[0])return t(s);if(f.length>1){let m=!1,_=0;for(let x=0,y=f.length;x<y;x++)d[x]=[];for(let x=0,y=f.length;x<y;x++){let D=h[x];for(let w=0;w<D.length;w++){let E=D[w],C=!0;for(let S=0;S<f.length;S++)n(E.p,f[S].p)&&(x!==S&&_++,C?(C=!1,d[S].push(E)):m=!0);C&&d[x].push(E)}}_>0&&m===!1&&(h=d)}let g;for(let m=0,_=f.length;m<_;m++){c=f[m].s,l.push(c),g=h[m];for(let x=0,y=g.length;x<y;x++)c.holes.push(g[x].h)}return l}},Hx=class extends ni{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}},Gx=class extends gi{constructor(e=1,t=1,n=1,r={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,tt(ie({},r),{count:n})),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ig}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ig);var at="primary",wd=Symbol("RouteTitle"),hM=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function el(i){return new hM(i)}function UH(i,e,t){let n=t.path.split("/");if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let r={};for(let s=0;s<n.length;s++){let o=n[s],a=i[s];if(o[0]===":")r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function BH(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!Pr(i[t],e[t]))return!1;return!0}function Pr(i,e){let t=i?pM(i):void 0,n=e?pM(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!TI(i[r],e[r]))return!1;return!0}function pM(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function TI(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}else return i===e}function CI(i){return i.length>0?i[i.length-1]:null}function ro(i){return lv(i)?i:ql(i)?Jt(Promise.resolve(i)):Ke(i)}var VH={exact:DI,subset:II},AI={exact:zH,subset:HH,ignored:()=>!0};function gI(i,e,t){return VH[t.paths](i.root,e.root,t.matrixParams)&&AI[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function zH(i,e){return Pr(i,e)}function DI(i,e,t){if(!pa(i.segments,e.segments)||!gg(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!DI(i.children[n],e.children[n],t))return!1;return!0}function HH(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>TI(i[t],e[t]))}function II(i,e,t){return RI(i,e,e.segments,t)}function RI(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!pa(r,t)||e.hasChildren()||!gg(r,t,n))}else if(i.segments.length===t.length){if(!pa(i.segments,t)||!gg(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!II(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!pa(i.segments,r)||!gg(i.segments,r,n)||!i.children[at]?!1:RI(i.children[at],e,s,n)}}function gg(i,e,t){return e.every((n,r)=>AI[t](i[r].parameters,n.parameters))}var ms=class{constructor(e=new Dt([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=el(this.queryParams),this._queryParamMap}toString(){return WH.serialize(this)}},Dt=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vg(this)}},ha=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=el(this.parameters),this._parameterMap}toString(){return PI(this)}};function GH(i,e){return pa(i,e)&&i.every((t,n)=>Pr(t.parameters,e[n].parameters))}function pa(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function jH(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===at&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==at&&(t=t.concat(e(r,n)))}),t}var Ed=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>new tl,providedIn:"root"})}}return i})(),tl=class{parse(e){let t=new gM(e);return new ms(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ld(e.root,!0)}`,n=XH(e.queryParams),r=typeof e.fragment=="string"?`#${$H(e.fragment)}`:"";return`${t}${n}${r}`}},WH=new tl;function vg(i){return i.segments.map(e=>PI(e)).join("/")}function ld(i,e){if(!i.hasChildren())return vg(i);if(e){let t=i.children[at]?ld(i.children[at],!1):"",n=[];return Object.entries(i.children).forEach(([r,s])=>{r!==at&&n.push(`${r}:${ld(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=jH(i,(n,r)=>r===at?[ld(i.children[at],!1)]:[`${r}:${ld(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[at]!=null?`${vg(i)}/${t[0]}`:`${vg(i)}/(${t.join("//")})`}}function NI(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function pg(i){return NI(i).replace(/%3B/gi,";")}function $H(i){return encodeURI(i)}function mM(i){return NI(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function yg(i){return decodeURIComponent(i)}function vI(i){return yg(i.replace(/\+/g,"%20"))}function PI(i){return`${mM(i.path)}${qH(i.parameters)}`}function qH(i){return Object.entries(i).map(([e,t])=>`;${mM(e)}=${mM(t)}`).join("")}function XH(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${pg(t)}=${pg(r)}`).join("&"):`${pg(t)}=${pg(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var YH=/^[^\/()?;#]+/;function lM(i){let e=i.match(YH);return e?e[0]:""}var ZH=/^[^\/()?;=#]+/;function KH(i){let e=i.match(ZH);return e?e[0]:""}var JH=/^[^=?&#]+/;function QH(i){let e=i.match(JH);return e?e[0]:""}var eG=/^[^&#]+/;function tG(i){let e=i.match(eG);return e?e[0]:""}var gM=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Dt([],{}):new Dt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[at]=new Dt(e,t)),n}parseSegment(){let e=lM(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Le(4009,!1);return this.capture(e),new ha(yg(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=KH(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=lM(this.remaining);r&&(n=r,this.capture(n))}e[yg(t)]=yg(n)}parseQueryParam(e){let t=QH(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=tG(this.remaining);o&&(n=o,this.capture(n))}let r=vI(t),s=vI(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=lM(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new Le(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=at);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[at]:new Dt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Le(4011,!1)}};function OI(i){return i.segments.length>0?new Dt([],{[at]:i}):i}function LI(i){let e={};for(let[n,r]of Object.entries(i.children)){let s=LI(r);if(n===at&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new Dt(i.segments,e);return nG(t)}function nG(i){if(i.numberOfChildren===1&&i.children[at]){let e=i.children[at];return new Dt(i.segments.concat(e.segments),e.children)}return i}function md(i){return i instanceof ms}function iG(i,e,t=null,n=null){let r=FI(i);return kI(r,e,t,n)}function FI(i){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Dt(s.url,o);return s===i&&(e=a),a}let n=t(i.root),r=OI(n);return e??r}function kI(i,e,t,n){let r=i;for(;r.parent;)r=r.parent;if(e.length===0)return uM(r,r,r,t,n);let s=rG(e);if(s.toRoot())return uM(r,r,new Dt([],{}),t,n);let o=sG(s,r,i),a=o.processChildren?fd(o.segmentGroup,o.index,s.commands):BI(o.segmentGroup,o.index,s.commands);return uM(r,o.segmentGroup,a,t,n)}function _g(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function gd(i){return typeof i=="object"&&i!=null&&i.outlets}function uM(i,e,t,n,r){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;i===e?o=t:o=UI(i,e,t);let a=OI(LI(o));return new ms(a,s,r)}function UI(i,e,t){let n={};return Object.entries(i.children).forEach(([r,s])=>{s===e?n[r]=t:n[r]=UI(s,e,t)}),new Dt(i.segments,n)}var xg=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&_g(n[0]))throw new Le(4003,!1);let r=n.find(gd);if(r&&r!==CI(n))throw new Le(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function rG(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new xg(!0,0,i);let e=0,t=!1,n=i.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new xg(t,e,n)}var Kc=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function sG(i,e,t){if(i.isAbsolute)return new Kc(e,!0,0);if(!t)return new Kc(e,!1,NaN);if(t.parent===null)return new Kc(t,!0,0);let n=_g(i.commands[0])?0:1,r=t.segments.length-1+n;return oG(t,r,i.numberOfDoubleDots)}function oG(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Le(4005,!1);r=n.segments.length}return new Kc(n,!1,r-s)}function aG(i){return gd(i[0])?i[0].outlets:{[at]:i}}function BI(i,e,t){if(i??=new Dt([],{}),i.segments.length===0&&i.hasChildren())return fd(i,e,t);let n=cG(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let s=new Dt(i.segments.slice(0,n.pathIndex),{});return s.children[at]=new Dt(i.segments.slice(n.pathIndex),i.children),fd(s,0,r)}else return n.match&&r.length===0?new Dt(i.segments,{}):n.match&&!i.hasChildren()?vM(i,e,t):n.match?fd(i,0,r):vM(i,e,t)}function fd(i,e,t){if(t.length===0)return new Dt(i.segments,{});{let n=aG(t),r={};if(Object.keys(n).some(s=>s!==at)&&i.children[at]&&i.numberOfChildren===1&&i.children[at].segments.length===0){let s=fd(i.children[at],e,t);return new Dt(i.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=BI(i.children[s],e,o))}),Object.entries(i.children).forEach(([s,o])=>{n[s]===void 0&&(r[s]=o)}),new Dt(i.segments,r)}}function cG(i,e,t){let n=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;let o=i.segments[r],a=t[n];if(gd(a))break;let c=`${a}`,l=n<t.length-1?t[n+1]:null;if(r>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!_I(c,l,o))return s;n+=2}else{if(!_I(c,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function vM(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(gd(s)){let c=lG(s.outlets);return new Dt(n,c)}if(r===0&&_g(t[0])){let c=i.segments[e];n.push(new ha(c.path,yI(t[0]))),r++;continue}let o=gd(s)?s.outlets[at]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&_g(a)?(n.push(new ha(o,yI(a))),r+=2):(n.push(new ha(o,{})),r++)}return new Dt(n,{})}function lG(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=vM(new Dt([],{}),0,n))}),e}function yI(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function _I(i,e,t){return i==t.path&&Pr(e,t.parameters)}var hd="imperative",xn=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(xn||{}),Bi=class{constructor(e,t){this.id=e,this.url=t}},nl=class extends Bi{constructor(e,t,n="imperative",r=null){super(e,t),this.type=xn.NavigationStart,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},gs=class extends Bi{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=xn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Mi=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(Mi||{}),Mg=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(Mg||{}),ps=class extends Bi{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=xn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},io=class extends Bi{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=xn.NavigationSkipped}},vd=class extends Bi{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=xn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Sg=class extends Bi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=xn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yM=class extends Bi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=xn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},_M=class extends Bi{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=xn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},xM=class extends Bi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=xn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},MM=class extends Bi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=xn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},SM=class{constructor(e){this.route=e,this.type=xn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},bM=class{constructor(e){this.route=e,this.type=xn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},wM=class{constructor(e){this.snapshot=e,this.type=xn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},EM=class{constructor(e){this.snapshot=e,this.type=xn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},TM=class{constructor(e){this.snapshot=e,this.type=xn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yd=class{constructor(e){this.snapshot=e,this.type=xn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bg=class{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=xn.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},_d=class{},il=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function uG(i,e){return i.providers&&!i._injector&&(i._injector=Ka(i.providers,e,`Route: ${i.path}`)),i._injector??e}function lr(i){return i.outlet||at}function dG(i,e){let t=i.filter(n=>lr(n)===e);return t.push(...i.filter(n=>lr(n)!==e)),t}function Td(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var CM=class{get injector(){return Td(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Cd(this.rootInjector),this.attachRef=null}},Cd=(()=>{class i{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,n){let r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){let n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new CM(this.rootInjector),this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(n){return new(n||i)(qe(Pn))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),wg=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=AM(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=AM(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=DM(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return DM(e,this._root).map(t=>t.value)}};function AM(i,e){if(i===e.value)return e;for(let t of e.children){let n=AM(i,t);if(n)return n}return null}function DM(i,e){if(i===e.value)return[e];for(let t of e.children){let n=DM(i,t);if(n.length)return n.unshift(e),n}return[]}var xi=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Zc(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var Eg=class extends wg{constructor(e,t){super(e),this.snapshot=t,UM(this,e)}toString(){return this.snapshot.toString()}};function VI(i){let e=fG(i),t=new Sn([new ha("",{})]),n=new Sn({}),r=new Sn({}),s=new Sn({}),o=new Sn(""),a=new rl(t,n,s,o,r,at,i,e.root);return a.snapshot=e.root,new Eg(new xi(a,[]),e)}function fG(i){let e={},t={},n={},r="",s=new Jc([],e,n,r,t,at,i,null,{});return new Cg("",new xi(s,[]))}var rl=class{constructor(e,t,n,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(yt(l=>l[wd]))??Ke(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(yt(e=>el(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(yt(e=>el(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Tg(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:ie(ie({},e.params),i.params),data:ie(ie({},e.data),i.data),resolve:ie(ie(ie(ie({},i.data),e.data),r?.data),i._resolvedData)}:n={params:ie({},i.params),data:ie({},i.data),resolve:ie(ie({},i.data),i._resolvedData??{})},r&&HI(r)&&(n.resolve[wd]=r.title),n}var Jc=class{get title(){return this.data?.[wd]}constructor(e,t,n,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=el(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=el(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Cg=class extends wg{constructor(e,t){super(t),this.url=e,UM(this,t)}toString(){return zI(this._root)}};function UM(i,e){e.value._routerState=i,e.children.forEach(t=>UM(i,t))}function zI(i){let e=i.children.length>0?` { ${i.children.map(zI).join(", ")} } `:"";return`${i.value}${e}`}function dM(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,Pr(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),Pr(e.params,t.params)||i.paramsSubject.next(t.params),BH(e.url,t.url)||i.urlSubject.next(t.url),Pr(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function IM(i,e){let t=Pr(i.params,e.params)&&GH(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||IM(i.parent,e.parent))}function HI(i){return typeof i.title=="string"||i.title===null}var Ad=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=at,this.activateEvents=new tn,this.deactivateEvents=new tn,this.attachEvents=new tn,this.detachEvents=new tn,this.parentContexts=ee(Cd),this.location=ee(_r),this.changeDetector=ee(Vs),this.inputBinder=ee(Ng,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Le(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Le(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Le(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Le(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new RM(t,a,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:c,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=bo({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[lh]})}}return i})(),RM=class i{__ngOutletInjector(e){return new i(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===rl?this.route:e===Cd?this.childContexts:this.parent.get(e,t)}},Ng=new Ue(""),xI=(()=>{class i{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:n}=t,r=bl([n.queryParams,n.params,n.data]).pipe(wi(([s,o,a],c)=>(a=ie(ie(ie({},s),o),a),c===0?Ke(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(t);return}let o=QT(n.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a])});this.outletDataSubscriptions.set(t,r)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})();function hG(i,e,t){let n=xd(i,e._root,t?t._root:void 0);return new Eg(n,e)}function xd(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=pG(i,e,t);return new xi(n,r)}else{if(i.shouldAttach(e.value)){let s=i.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>xd(i,a)),o}}let n=mG(e.value),r=e.children.map(s=>xd(i,s));return new xi(n,r)}}function pG(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return xd(i,n,r);return xd(i,n)})}function mG(i){return new rl(new Sn(i.url),new Sn(i.params),new Sn(i.queryParams),new Sn(i.fragment),new Sn(i.data),i.outlet,i.component,i)}var Md=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},GI="ngNavigationCancelingError";function Ag(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=md(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=jI(!1,Mi.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function jI(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[GI]=!0,t.cancellationCode=e,t}function gG(i){return WI(i)&&md(i.url)}function WI(i){return!!i&&i[GI]}var vG=(i,e,t,n)=>yt(r=>(new NM(e,r.targetRouterState,r.currentRouterState,t,n).activate(i),r)),NM=class{constructor(e,t,n,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),dM(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=Zc(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Zc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(n&&n.outlet){let o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Zc(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=Zc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new yd(s.value.snapshot))}),e.children.length&&this.forwardEvent(new EM(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(dM(r),r===s)if(r.component){let o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),dM(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,n)}},Dg=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Qc=class{constructor(e,t){this.component=e,this.route=t}};function yG(i,e,t){let n=i._root,r=e?e._root:null;return ud(n,r,t,[n.value])}function _G(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function ol(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!Pw(i)?i:e.get(i):n}function ud(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Zc(e);return i.children.forEach(o=>{xG(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>pd(a,t.getContext(o),r)),r}function xG(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=MG(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Dg(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ud(i,e,a?a.children:null,n,r):ud(i,e,t,n,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Qc(a.outlet.component,o))}else o&&pd(e,a,r),r.canActivateChecks.push(new Dg(n)),s.component?ud(i,null,a?a.children:null,n,r):ud(i,null,t,n,r);return r}function MG(i,e,t){if(typeof t=="function")return t(i,e);switch(t){case"pathParamsChange":return!pa(i.url,e.url);case"pathParamsOrQueryParamsChange":return!pa(i.url,e.url)||!Pr(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!IM(i,e)||!Pr(i.queryParams,e.queryParams);case"paramsChange":default:return!IM(i,e)}}function pd(i,e,t){let n=Zc(i),r=i.value;Object.entries(n).forEach(([s,o])=>{r.component?e?pd(o,e.children.getContext(s),t):pd(o,null,t):pd(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Qc(e.outlet.component,r)):t.canDeactivateChecks.push(new Qc(null,r)):t.canDeactivateChecks.push(new Qc(null,r))}function Dd(i){return typeof i=="function"}function SG(i){return typeof i=="boolean"}function bG(i){return i&&Dd(i.canLoad)}function wG(i){return i&&Dd(i.canActivate)}function EG(i){return i&&Dd(i.canActivateChild)}function TG(i){return i&&Dd(i.canDeactivate)}function CG(i){return i&&Dd(i.canMatch)}function $I(i){return i instanceof Fr||i?.name==="EmptyError"}var mg=Symbol("INITIAL_VALUE");function sl(){return wi(i=>bl(i.map(e=>e.pipe(Ur(1),mv(mg)))).pipe(yt(e=>{for(let t of e)if(t!==!0){if(t===mg)return mg;if(t===!1||AG(t))return t}return!0}),Rn(e=>e!==mg),Ur(1)))}function AG(i){return md(i)||i instanceof Md}function DG(i,e){return Wt(t=>{let{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?Ke(tt(ie({},t),{guardsResult:!0})):IG(o,n,r,i).pipe(Wt(a=>a&&SG(a)?RG(n,s,i,e):Ke(a)),yt(a=>tt(ie({},t),{guardsResult:a})))})}function IG(i,e,t,n){return Jt(i).pipe(Wt(r=>FG(r.component,r.route,t,e,n)),fr(r=>r!==!0,!0))}function RG(i,e,t,n){return Jt(e).pipe(ho(r=>Aa(PG(r.route.parent,n),NG(r.route,n),LG(i,r.path,t),OG(i,r.route,t))),fr(r=>r!==!0,!0))}function NG(i,e){return i!==null&&e&&e(new TM(i)),Ke(!0)}function PG(i,e){return i!==null&&e&&e(new wM(i)),Ke(!0)}function OG(i,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return Ke(!0);let r=n.map(s=>Mf(()=>{let o=Td(e)??t,a=ol(s,o),c=wG(a)?a.canActivate(e,i):Xn(o,()=>a(e,i));return ro(c).pipe(fr())}));return Ke(r).pipe(sl())}function LG(i,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>_G(o)).filter(o=>o!==null).map(o=>Mf(()=>{let a=o.guards.map(c=>{let l=Td(o.node)??t,u=ol(c,l),d=EG(u)?u.canActivateChild(n,i):Xn(l,()=>u(n,i));return ro(d).pipe(fr())});return Ke(a).pipe(sl())}));return Ke(s).pipe(sl())}function FG(i,e,t,n,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Ke(!0);let o=s.map(a=>{let c=Td(e)??r,l=ol(a,c),u=TG(l)?l.canDeactivate(i,e,t,n):Xn(c,()=>l(i,e,t,n));return ro(u).pipe(fr())});return Ke(o).pipe(sl())}function kG(i,e,t,n){let r=e.canLoad;if(r===void 0||r.length===0)return Ke(!0);let s=r.map(o=>{let a=ol(o,i),c=bG(a)?a.canLoad(e,t):Xn(i,()=>a(e,t));return ro(c)});return Ke(s).pipe(sl(),qI(n))}function qI(i){return xl(bn(e=>{if(typeof e!="boolean")throw Ag(i,e)}),yt(e=>e===!0))}function UG(i,e,t,n){let r=e.canMatch;if(!r||r.length===0)return Ke(!0);let s=r.map(o=>{let a=ol(o,i),c=CG(a)?a.canMatch(e,t):Xn(i,()=>a(e,t));return ro(c)});return Ke(s).pipe(sl(),qI(n))}var Sd=class{constructor(e){this.segmentGroup=e||null}},bd=class extends Error{constructor(e){super(),this.urlTree=e}};function Yc(i){return Ta(new Sd(i))}function BG(i){return Ta(new Le(4e3,!1))}function VG(i){return Ta(jI(!1,Mi.GuardRejected))}var PM=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return Ke(n);if(r.numberOfChildren>1||!r.children[at])return BG(`${e.redirectTo}`);r=r.children[at]}}applyRedirectCommands(e,t,n,r,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:u,url:d,outlet:f,params:h,data:p,title:v}=r,g=Xn(s,()=>a({params:h,data:p,queryParams:c,fragment:l,routeConfig:u,url:d,outlet:f,title:v}));if(g instanceof ms)throw new bd(g);t=g}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t[0]==="/")throw new bd(o);return o}applyRedirectCreateUrlTree(e,t,n,r){let s=this.createSegmentGroup(e,t.root,n,r);return new ms(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);n[r]=t[a]}else n[r]=s}),n}createSegmentGroup(e,t,n,r){let s=this.createSegments(e,t.segments,n,r),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,n,r)}),new Dt(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new Le(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}},OM={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function zG(i,e,t,n,r){let s=XI(i,e,t);return s.matched?(n=uG(e,n),UG(n,e,t,r).pipe(yt(o=>o===!0?s:ie({},OM)))):Ke(s)}function XI(i,e,t){if(e.path==="**")return HG(t);if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?ie({},OM):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||UH)(t,i,e);if(!r)return ie({},OM);let s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=r.consumed.length>0?ie(ie({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function HG(i){return{matched:!0,parameters:i.length>0?CI(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function MI(i,e,t,n){return t.length>0&&WG(i,t,n)?{segmentGroup:new Dt(e,jG(n,new Dt(t,i.children))),slicedSegments:[]}:t.length===0&&$G(i,t,n)?{segmentGroup:new Dt(i.segments,GG(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new Dt(i.segments,i.children),slicedSegments:t}}function GG(i,e,t,n){let r={};for(let s of t)if(Pg(i,e,s)&&!n[lr(s)]){let o=new Dt([],{});r[lr(s)]=o}return ie(ie({},n),r)}function jG(i,e){let t={};t[at]=e;for(let n of i)if(n.path===""&&lr(n)!==at){let r=new Dt([],{});t[lr(n)]=r}return t}function WG(i,e,t){return t.some(n=>Pg(i,e,n)&&lr(n)!==at)}function $G(i,e,t){return t.some(n=>Pg(i,e,n))}function Pg(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function qG(i,e,t){return e.length===0&&!i.children[t]}var LM=class{};function XG(i,e,t,n,r,s,o="emptyOnly"){return new FM(i,e,t,n,r,o,s).recognize()}var YG=31,FM=class{constructor(e,t,n,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new PM(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Le(4002,`'${e.segmentGroup}'`)}recognize(){let e=MI(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(yt(({children:t,rootSnapshot:n})=>{let r=new xi(n,t),s=new Cg("",r),o=iG(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Jc([],Object.freeze({}),Object.freeze(ie({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),at,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,at,t).pipe(yt(n=>({children:n,rootSnapshot:t})),ws(n=>{if(n instanceof bd)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Sd?this.noMatchError(n):n}))}processSegmentGroup(e,t,n,r,s){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n,s):this.processSegment(e,t,n,n.segments,r,!0,s).pipe(yt(o=>o instanceof xi?[o]:[]))}processChildren(e,t,n,r){let s=[];for(let o of Object.keys(n.children))o==="primary"?s.unshift(o):s.push(o);return Jt(s).pipe(ho(o=>{let a=n.children[o],c=dG(t,o);return this.processSegmentGroup(e,c,a,o,r)}),fv((o,a)=>(o.push(...a),o)),Es(null),dv(),Wt(o=>{if(o===null)return Yc(n);let a=YI(o);return ZG(a),Ke(a)}))}processSegment(e,t,n,r,s,o,a){return Jt(t).pipe(ho(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,n,r,s,o,a).pipe(ws(l=>{if(l instanceof Sd)return Ke(null);throw l}))),fr(c=>!!c),ws(c=>{if($I(c))return qG(n,r,s)?Ke(new LM):Yc(n);throw c}))}processSegmentAgainstRoute(e,t,n,r,s,o,a,c){return lr(n)!==o&&(o===at||!Pg(r,s,n))?Yc(r):n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,n,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,s,o,c):Yc(r)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:f}=XI(t,r,s);if(!c)return Yc(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>YG&&(this.allowRedirects=!1));let h=new Jc(s,l,Object.freeze(ie({},this.urlTree.queryParams)),this.urlTree.fragment,SI(r),lr(r),r.component??r._loadedComponent??null,r,bI(r)),p=Tg(h,a,this.paramsInheritanceStrategy);h.params=Object.freeze(p.params),h.data=Object.freeze(p.data);let v=this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,h,e);return this.applyRedirects.lineralizeSegments(r,v).pipe(Wt(g=>this.processSegment(e,n,t,g.concat(f),o,!1,a)))}matchSegmentAgainstRoute(e,t,n,r,s,o){let a=zG(t,n,r,e,this.urlSerializer);return n.path==="**"&&(t.children={}),a.pipe(wi(c=>c.matched?(e=n._injector??e,this.getChildConfig(e,n,r).pipe(wi(({routes:l})=>{let u=n._loadedInjector??e,{parameters:d,consumedSegments:f,remainingSegments:h}=c,p=new Jc(f,d,Object.freeze(ie({},this.urlTree.queryParams)),this.urlTree.fragment,SI(n),lr(n),n.component??n._loadedComponent??null,n,bI(n)),v=Tg(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(v.params),p.data=Object.freeze(v.data);let{segmentGroup:g,slicedSegments:m}=MI(t,f,h,l);if(m.length===0&&g.hasChildren())return this.processChildren(u,l,g,p).pipe(yt(x=>new xi(p,x)));if(l.length===0&&m.length===0)return Ke(new xi(p,[]));let _=lr(n)===s;return this.processSegment(u,l,g,m,_?at:s,!0,p).pipe(yt(x=>new xi(p,x instanceof xi?[x]:[])))}))):Yc(t)))}getChildConfig(e,t,n){return t.children?Ke({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Ke({routes:t._loadedRoutes,injector:t._loadedInjector}):kG(e,t,n,this.urlSerializer).pipe(Wt(r=>r?this.configLoader.loadChildren(e,t).pipe(bn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):VG(t))):Ke({routes:[],injector:e})}};function ZG(i){i.sort((e,t)=>e.value.outlet===at?-1:t.value.outlet===at?1:e.value.outlet.localeCompare(t.value.outlet))}function KG(i){let e=i.value.routeConfig;return e&&e.path===""}function YI(i){let e=[],t=new Set;for(let n of i){if(!KG(n)){e.push(n);continue}let r=e.find(s=>n.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=YI(n.children);e.push(new xi(n.value,r))}return e.filter(n=>!t.has(n))}function SI(i){return i.data||{}}function bI(i){return i.resolve||{}}function JG(i,e,t,n,r,s){return Wt(o=>XG(i,e,t,n,o.extractedUrl,r,s).pipe(yt(({state:a,tree:c})=>tt(ie({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function QG(i,e){return Wt(t=>{let{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Ke(t);let s=new Set(r.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of ZI(c))o.add(l);let a=0;return Jt(o).pipe(ho(c=>s.has(c)?e4(c,n,i,e):(c.data=Tg(c,c.parent,i).resolve,Ke(void 0))),bn(()=>a++),Da(1),Wt(c=>a===o.size?Ke(t):ci))})}function ZI(i){let e=i.children.map(t=>ZI(t)).flat();return[i,...e]}function e4(i,e,t,n){let r=i.routeConfig,s=i._resolve;return r?.title!==void 0&&!HI(r)&&(s[wd]=r.title),t4(s,i,e,n).pipe(yt(o=>(i._resolvedData=o,i.data=Tg(i,i.parent,t).resolve,null)))}function t4(i,e,t,n){let r=pM(i);if(r.length===0)return Ke({});let s={};return Jt(r).pipe(Wt(o=>n4(i[o],e,t,n).pipe(fr(),bn(a=>{if(a instanceof Md)throw Ag(new tl,a);s[o]=a}))),Da(1),uv(s),ws(o=>$I(o)?ci:Ta(o)))}function n4(i,e,t,n){let r=Td(e)??n,s=ol(i,r),o=s.resolve?s.resolve(e,t):Xn(r,()=>s(e,t));return ro(o)}function fM(i){return wi(e=>{let t=i(e);return t?Jt(t).pipe(yt(()=>e)):Ke(e)})}var KI=(()=>{class i{buildTitle(t){let n,r=t.root;for(;r!==void 0;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(s=>s.outlet===at);return n}getResolvedTitleForRoute(t){return t.data[wd]}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>ee(i4),providedIn:"root"})}}return i})(),i4=(()=>{class i extends KI{constructor(t){super(),this.title=t}updateTitle(t){let n=this.buildTitle(t);n!==void 0&&this.title.setTitle(n)}static{this.\u0275fac=function(n){return new(n||i)(qe(xC))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Id=new Ue("",{providedIn:"root",factory:()=>({})}),r4=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=ui({type:i,selectors:[["ng-component"]],standalone:!0,features:[Eo],decls:1,vars:0,template:function(n,r){n&1&&Zn(0,"router-outlet")},dependencies:[Ad],encapsulation:2})}}return i})();function BM(i){let e=i.children&&i.children.map(BM),t=e?tt(ie({},i),{children:e}):ie({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==at&&(t.component=r4),t}var Ig=new Ue(""),VM=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ee(wh)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ke(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let n=ro(t.loadComponent()).pipe(yt(JI),bn(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),wl(()=>{this.componentLoaders.delete(t)})),r=new ba(n,()=>new Kt).pipe(Sa());return this.componentLoaders.set(t,r),r}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return Ke({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let s=s4(n,this.compiler,t,this.onLoadEndListener).pipe(wl(()=>{this.childrenLoaders.delete(n)})),o=new ba(s,()=>new Kt).pipe(Sa());return this.childrenLoaders.set(n,o),o}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function s4(i,e,t,n){return ro(i.loadChildren()).pipe(yt(JI),Wt(r=>r instanceof Pl||Array.isArray(r)?Ke(r):Jt(e.compileModuleAsync(r))),yt(r=>{n&&n(i);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(t).injector,o=s.get(Ig,[],{optional:!0,self:!0}).flat()),{routes:o.map(BM),injector:s}}))}function o4(i){return i&&typeof i=="object"&&"default"in i}function JI(i){return o4(i)?i.default:i}var zM=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>ee(a4),providedIn:"root"})}}return i})(),a4=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),QI=new Ue(""),eR=new Ue("");function c4(i,e,t){let n=i.get(eR),r=i.get(fn);return i.get(At).runOutsideAngular(()=>{if(!r.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=r.startViewTransition(()=>(s(),l4(i))),{onViewTransitionCreated:c}=n;return c&&Xn(i,()=>c({transition:a,from:e,to:t})),o})}function l4(i){return new Promise(e=>{Hl({read:()=>setTimeout(e)},{injector:i})})}var u4=new Ue(""),HM=(()=>{class i{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Kt,this.transitionAbortSubject=new Kt,this.configLoader=ee(VM),this.environmentInjector=ee(Pn),this.urlSerializer=ee(Ed),this.rootContexts=ee(Cd),this.location=ee(ec),this.inputBindingEnabled=ee(Ng,{optional:!0})!==null,this.titleStrategy=ee(KI),this.options=ee(Id,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ee(zM),this.createViewTransition=ee(QI,{optional:!0}),this.navigationErrorHandler=ee(u4,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Ke(void 0),this.rootComponentType=null;let t=r=>this.events.next(new SM(r)),n=r=>this.events.next(new bM(r));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let n=++this.navigationId;this.transitions?.next(tt(ie(ie({},this.transitions.value),t),{id:n}))}setupNavigations(t,n,r){return this.transitions=new Sn({id:0,currentUrlTree:n,currentRawUrl:n,extractedUrl:this.urlHandlingStrategy.extract(n),urlAfterRedirects:this.urlHandlingStrategy.extract(n),rawUrl:n,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:hd,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Rn(s=>s.id!==0),yt(s=>tt(ie({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),wi(s=>{let o=!1,a=!1;return Ke(s).pipe(wi(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Mi.SupersededByNewNavigation),ci;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?tt(ie({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!l&&u!=="reload"){let d="";return this.events.next(new io(c.id,this.urlSerializer.serialize(c.rawUrl),d,Mg.IgnoredSameUrlNavigation)),c.resolve(!1),ci}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Ke(c).pipe(wi(d=>{let f=this.transitions?.getValue();return this.events.next(new nl(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions?.getValue()?ci:Promise.resolve(d)}),JG(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),bn(d=>{s.targetSnapshot=d.targetSnapshot,s.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=tt(ie({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let f=new Sg(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:d,extractedUrl:f,source:h,restoredState:p,extras:v}=c,g=new nl(d,this.urlSerializer.serialize(f),h,p);this.events.next(g);let m=VI(this.rootComponentType).snapshot;return this.currentTransition=s=tt(ie({},c),{targetSnapshot:m,urlAfterRedirects:f,extras:tt(ie({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,Ke(s)}else{let d="";return this.events.next(new io(c.id,this.urlSerializer.serialize(c.extractedUrl),d,Mg.IgnoredByUrlHandlingStrategy)),c.resolve(!1),ci}}),bn(c=>{let l=new yM(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),yt(c=>(this.currentTransition=s=tt(ie({},c),{guards:yG(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),DG(this.environmentInjector,c=>this.events.next(c)),bn(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw Ag(this.urlSerializer,c.guardsResult);let l=new _M(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Rn(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Mi.GuardRejected),!1)),fM(c=>{if(c.guards.canActivateChecks.length)return Ke(c).pipe(bn(l=>{let u=new xM(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),wi(l=>{let u=!1;return Ke(l).pipe(QG(this.paramsInheritanceStrategy,this.environmentInjector),bn({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(l,"",Mi.NoDataFromResolver)}}))}),bn(l=>{let u=new MM(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}))}),fM(c=>{let l=u=>{let d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(bn(f=>{u.component=f}),yt(()=>{})));for(let f of u.children)d.push(...l(f));return d};return bl(l(c.targetSnapshot.root)).pipe(Es(null),Ur(1))}),fM(()=>this.afterPreactivation()),wi(()=>{let{currentSnapshot:c,targetSnapshot:l}=s,u=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return u?Jt(u).pipe(yt(()=>s)):Ke(s)}),yt(c=>{let l=hG(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=tt(ie({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,s}),bn(()=>{this.events.next(new _d)}),vG(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Ur(1),bn({next:c=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new gs(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{o=!0}}),Ts(this.transitionAbortSubject.pipe(bn(c=>{throw c}))),wl(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",Mi.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),ws(c=>{if(a=!0,WI(c))this.events.next(new ps(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),gG(c)?this.events.next(new il(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let l=new vd(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let u=Xn(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(u instanceof Md){let{message:d,cancellationCode:f}=Ag(this.urlSerializer,u);this.events.next(new ps(s.id,this.urlSerializer.serialize(s.extractedUrl),d,f)),this.events.next(new il(u.redirectTo,u.navigationBehaviorOptions))}else{this.events.next(l);let d=t.errorHandler(c);s.resolve(!!d)}}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return ci}))}))}cancelNavigationTransition(t,n,r){let s=new ps(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function d4(i){return i!==hd}var f4=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>ee(h4),providedIn:"root"})}}return i})(),kM=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},h4=(()=>{class i extends kM{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=$y(i)))(r||i)}})()}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),tR=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:()=>ee(p4),providedIn:"root"})}}return i})(),p4=(()=>{class i extends tR{constructor(){super(...arguments),this.location=ee(ec),this.urlSerializer=ee(Ed),this.options=ee(Id,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ee(zM),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ms,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=VI(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{n.type==="popstate"&&t(n.url,n.state)})}handleRouterEvent(t,n){if(t instanceof nl)this.stateMemento=this.createStateMemento();else if(t instanceof io)this.rawUrlTree=n.initialUrl;else if(t instanceof Sg){if(this.urlUpdateStrategy==="eager"&&!n.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl);this.setBrowserUrl(n.targetBrowserUrl??r,n)}}else t instanceof _d?(this.currentUrlTree=n.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(n.finalUrl,n.initialUrl),this.routerState=n.targetRouterState,this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(n.targetBrowserUrl??this.rawUrlTree,n)):t instanceof ps&&(t.code===Mi.GuardRejected||t.code===Mi.NoDataFromResolver)?this.restoreHistory(n):t instanceof vd?this.restoreHistory(n,!0):t instanceof gs&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,n){let r=t instanceof ms?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl){let s=this.browserPageId,o=ie(ie({},n.extras.state),this.generateNgRouterState(n.id,s));this.location.replaceState(r,"",o)}else{let s=ie(ie({},n.extras.state),this.generateNgRouterState(n.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(t,n=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=$y(i)))(r||i)}})()}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),dd=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(dd||{});function nR(i,e){i.events.pipe(Rn(t=>t instanceof gs||t instanceof ps||t instanceof vd||t instanceof io),yt(t=>t instanceof gs||t instanceof io?dd.COMPLETE:(t instanceof ps?t.code===Mi.Redirect||t.code===Mi.SupersededByNewNavigation:!1)?dd.REDIRECTING:dd.FAILED),Rn(t=>t!==dd.REDIRECTING),Ur(1)).subscribe(()=>{e()})}function m4(i){throw i}var g4={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},v4={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},vs=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=ee(xh),this.stateManager=ee(tR),this.options=ee(Id,{optional:!0})||{},this.pendingTasks=ee(wo),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ee(HM),this.urlSerializer=ee(Ed),this.location=ee(ec),this.urlHandlingStrategy=ee(zM),this._events=new Kt,this.errorHandler=this.options.errorHandler||m4,this.navigated=!1,this.routeReuseStrategy=ee(f4),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ee(Ig,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ee(Ng,{optional:!0}),this.eventsSubscription=new jt,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(n=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(n,s),n instanceof ps&&n.code!==Mi.Redirect&&n.code!==Mi.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof gs)this.navigated=!0;else if(n instanceof il){let o=n.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(n.url,r.currentRawUrl),c=ie({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||d4(r.source)},o);this.scheduleNavigation(a,hd,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}_4(n)&&this._events.next(n)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),hd,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",n)},0)})}navigateToSyncWithBrowser(t,n,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let c=ie({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,n,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(BM),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=n,l=c?this.currentUrlTree.fragment:o,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=ie(ie({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let f=r?r.snapshot:this.routerState.snapshot.root;d=FI(f)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),d=this.currentUrlTree.root}return kI(d,t,u,l??null)}navigateByUrl(t,n={skipLocationChange:!1}){let r=md(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,hd,null,n)}navigate(t,n={skipLocationChange:!1}){return y4(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,n){let r;if(n===!0?r=ie({},g4):n===!1?r=ie({},v4):r=n,md(t))return gI(this.currentUrlTree,t,r);let s=this.parseUrl(t);return gI(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((n,[r,s])=>(s!=null&&(n[r]=s),n),{})}scheduleNavigation(t,n,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,l;o?(a=o.resolve,c=o.reject,l=o.promise):l=new Promise((d,f)=>{a=d,c=f});let u=this.pendingTasks.add();return nR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function y4(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new Le(4008,!1)}function _4(i){return!(i instanceof _d)&&!(i instanceof il)}var Rg=class{};var x4=(()=>{class i{constructor(t,n,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Rn(t=>t instanceof gs),ho(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){let r=[];for(let s of n){s.providers&&!s._injector&&(s._injector=Ka(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Jt(r).pipe(Ca())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;n.loadChildren&&n.canLoad===void 0?r=this.loader.loadChildren(t,n):r=Ke(null);let s=r.pipe(Wt(o=>o===null?Ke(void 0):(n._loadedRoutes=o.routes,n._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(n.loadComponent&&!n._loadedComponent){let o=this.loader.loadComponent(n);return Jt([s,o]).pipe(Ca())}else return s})}static{this.\u0275fac=function(n){return new(n||i)(qe(vs),qe(wh),qe(Pn),qe(Rg),qe(VM))}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),iR=new Ue(""),M4=(()=>{class i{constructor(t,n,r,s,o={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof nl?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof gs?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof io&&t.code===Mg.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof bg&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new bg(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(n){lT()}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})();function S4(i){return i.routerState.root}function Rd(i,e){return{\u0275kind:i,\u0275providers:e}}function b4(){let i=ee(un);return e=>{let t=i.get(Bs);if(e!==t.components[0])return;let n=i.get(vs),r=i.get(rR);i.get(GM)===1&&n.initialNavigation(),i.get(sR,null,ct.Optional)?.setUpPreloading(),i.get(iR,null,ct.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var rR=new Ue("",{factory:()=>new Kt}),GM=new Ue("",{providedIn:"root",factory:()=>1});function w4(){return Rd(2,[{provide:GM,useValue:0},{provide:bh,multi:!0,deps:[un],useFactory:e=>{let t=e.get(sC,Promise.resolve());return()=>t.then(()=>new Promise(n=>{let r=e.get(vs),s=e.get(rR);nR(r,()=>{n(!0)}),e.get(HM).afterPreactivation=()=>(n(!0),s.closed?Ke(void 0):s),r.initialNavigation()}))}}])}function E4(){return Rd(3,[{provide:bh,multi:!0,useFactory:()=>{let e=ee(vs);return()=>{e.setUpLocationChangeListener()}}},{provide:GM,useValue:2}])}var sR=new Ue("");function T4(i){return Rd(0,[{provide:sR,useExisting:x4},{provide:Rg,useExisting:i}])}function C4(){return Rd(8,[xI,{provide:Ng,useExisting:xI}])}function A4(i){let e=[{provide:QI,useValue:c4},{provide:eR,useValue:ie({skipNextTransition:!!i?.skipInitialTransition},i)}];return Rd(9,e)}var wI=new Ue("ROUTER_FORROOT_GUARD"),D4=[ec,{provide:Ed,useClass:tl},vs,Cd,{provide:rl,useFactory:S4,deps:[vs]},VM,[]],jM=(()=>{class i{constructor(t){}static forRoot(t,n){return{ngModule:i,providers:[D4,[],{provide:Ig,multi:!0,useValue:t},{provide:wI,useFactory:P4,deps:[[vs,new Iy,new Vw]]},{provide:Id,useValue:n||{}},n?.useHash?R4():N4(),I4(),n?.preloadingStrategy?T4(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?O4(n):[],n?.bindToComponentInputs?C4().\u0275providers:[],n?.enableViewTransitions?A4().\u0275providers:[],L4()]}}static forChild(t){return{ngModule:i,providers:[{provide:Ig,multi:!0,useValue:t}]}}static{this.\u0275fac=function(n){return new(n||i)(qe(wI,8))}}static{this.\u0275mod=Ki({type:i})}static{this.\u0275inj=Zi({})}}return i})();function I4(){return{provide:iR,useFactory:()=>{let i=ee(uC),e=ee(At),t=ee(Id),n=ee(HM),r=ee(Ed);return t.scrollOffset&&i.setOffset(t.scrollOffset),new M4(r,n,i,e,t)}}}function R4(){return{provide:Co,useClass:aC}}function N4(){return{provide:Co,useClass:b_}}function P4(i){return"guarded"}function O4(i){return[i.initialNavigation==="disabled"?E4().\u0275providers:[],i.initialNavigation==="enabledBlocking"?w4().\u0275providers:[]]}var EI=new Ue("");function L4(){return[{provide:EI,useFactory:b4},{provide:p_,multi:!0,useExisting:EI}]}var aR=["glCanvas"];var F4="__ngt_signal_store_computed__";function k4(i){return e=>{let t=typeof i=="function"?i(e):i;return Object.keys(t).forEach(n=>{let r=n;t[r]===void 0&&e[r]!=null&&(t[r]=e[r])}),t}}function cR(i){return e=>{let t=k4(e);dn(()=>{i.update(n=>ie(ie({},n),t(n)))})}}function lR(i){return(...e)=>{let t=dn(i);return e.length===0?t:e.reduce((n,r)=>n[r],t)}}function uR(i,e){return(...t)=>{if(t.length===0)return i;if(t.length===1&&typeof t[0]=="object"){let a=F4.concat(JSON.stringify(t[0]));return e.has(a)||e.set(a,xr(i,t)),e.get(a)}let[n,r]=U4(t),o=n.join("-").concat(JSON.stringify(r));return e.has(o)||e.set(o,xr(()=>n.reduce((a,c)=>a[c],i()),r)),e.get(o)}}function U4(i){return typeof i.at(-1)=="object"?[i.slice(0,-1),i.at(-1)]:[i,{equal:Object.is}]}function _R(i={},e){let t,n,r,s,o,a=new Map;e||(e={equal:Object.is}),typeof i=="function"?(t=Di({},e),o=t.asReadonly(),r=lR(t),n=cR(t),s=uR(o,a),t.set(i({update:n,get:r,select:s}))):(t=Di(i,e),o=t.asReadonly(),r=lR(t),n=cR(t),s=uR(o,a));let c={select:s,get:r,update:n,state:o};return Object.defineProperty(c,"snapshot",{get:dn.bind({},o),configurable:!1,enumerable:!1}),c}var bt={obj:i=>i===Object(i)&&!Array.isArray(i)&&typeof i!="function",material:i=>!!i&&i.isMaterial,geometry:i=>!!i&&i.isBufferGeometry,orthographicCamera:i=>!!i&&i.isOrthographicCamera,perspectiveCamera:i=>!!i&&i.isPerspectiveCamera,camera:i=>!!i&&i.isCamera,renderer:i=>!!i&&typeof i=="object"&&"render"in i&&typeof i.render=="function",scene:i=>!!i&&i.isScene,ref:i=>i instanceof di,instance:i=>!!i&&!!i.__ngt__,object3D:i=>!!i&&i.isObject3D,colorSpaceExist:i=>"colorSpace"in i||"outputColorSpace"in i,equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(typeof i=="string"||typeof i=="number")return i===e;let s=bt.obj(i);if(s&&n==="reference")return i===e;let o=Array.isArray(i);if(o&&t==="reference")return i===e;if((o||s)&&i===e)return!0;let a;for(a in i)if(!(a in e))return!1;for(a in r?e:i)if(i[a]!==e[a])return!1;if(a===void 0){if(o&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function xR(i){i!==null&&bt.obj(i)&&"needsUpdate"in i&&(i.needsUpdate=!0,"uniformsNeedUpdate"in i&&(i.uniformsNeedUpdate=!0))}function JM(i){bt.camera(i)&&((bt.perspectiveCamera(i)||bt.orthographicCamera(i))&&i.updateProjectionMatrix(),i.updateMatrixWorld()),!(i&&i.isCubeTexture)&&xR(i)}function dR(i,e){i.manual||(bt.orthographicCamera(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix(),i.updateMatrixWorld())}function St(i){if(i)return i.__ngt__}function Ld(i){let e=St(i)?.store;if(e){for(;e.snapshot.previousRoot;)e=e.snapshot.previousRoot;e.snapshot.internal.frames===0&&e.snapshot.invalidate()}JM(i)}function Fd(i,e){let t=i;if(e?.primitive||!t.__ngt__){let n=e||{},{instanceStore:r=_R({parent:null,objects:[],nonObjects:[],geometryStamp:Date.now()})}=n,s=ml(n,["instanceStore"]),o=r.select("nonObjects"),a=r.select("geometryStamp"),c=xr(()=>{let[l]=[o(),a()];return l});t.__ngt__=ie({previousAttach:null,store:null,memoized:{},eventCount:0,handlers:{},instanceStore:r,parent:r.select("parent"),objects:r.select("objects"),nonObjects:c,add(l,u){let d=t.__ngt__.instanceStore.snapshot[u],f=d.findIndex(h=>l===h||!!l.uuid&&!!h.uuid&&l.uuid===h.uuid);f>-1?(d.splice(f,1,l),t.__ngt__.instanceStore.update({[u]:d})):t.__ngt__.instanceStore.update(h=>({[u]:[...h[u],l]})),QM(t.__ngt__.instanceStore.snapshot.parent,u)},remove(l,u){t.__ngt__.instanceStore.update(d=>({[u]:d[u].filter(f=>f!==l)})),QM(t.__ngt__.instanceStore.snapshot.parent,u)},setParent(l){t.__ngt__.instanceStore.update({parent:l})},updateGeometryStamp(){t.__ngt__.instanceStore.update({geometryStamp:Date.now()})}},s)}return t}function QM(i,e){if(!i)return;let t=St(i);if(!t)return;let{parent:n}=t.instanceStore.snapshot;t.instanceStore.update({[e]:(t.instanceStore.snapshot[e]||[]).slice()}),QM(n,e)}var fR={};function Pd(i){if(i)return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId;let e=ad.generateUUID();return fR[e]?Pd():(fR[e]=!0,e)}function eS(i,e){let t=typeof e<"u"?e.devicePixelRatio??2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function B4(i,e){let t=typeof i=="function"?i(e):i;return bt.renderer(t)?t:new Lu(ie({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0},i))}function V4(i,e){return i?new ii(0,0,0,0,.1,1e3):new Ot(75,e.width/e.height,.1,1e3)}function z4(i){let e={nodes:{},materials:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),"material"in t&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function MR(i,e,t,n){let r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function H4(i,e){let{internal:t}=i.snapshot;t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{MR(t.capturedMap,e,n,r)})}function G4(i){function e(c){let l=i.get("internal"),u=c.offsetX-l.initialClick[0],d=c.offsetY-l.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function t(c){return c.filter(l=>["move","over","enter","out","leave"].some(u=>{let d=`pointer${u}`;return St(l)?.handlers?.[d]}))}function n(c,l){let u=i.get(),d=new Set,f=[],h=l?l(u.internal.interaction):u.internal.interaction;for(let g=0;g<h.length;g++){let m=St(h[g])?.store.snapshot;m&&(m.raycaster.camera=void 0)}u.previousRoot||u.events.compute?.(c,i,null);function p(g){let m=St(g)?.store,_=m?.snapshot;return!_||!_.events.enabled||_.raycaster.camera===null?[]:(_.raycaster.camera===void 0&&(_.events.compute?.(c,m,_.previousRoot),_.raycaster.camera===void 0&&(_.raycaster.camera=null)),_.raycaster.camera?_.raycaster.intersectObject(g,!0):[])}let v=h.flatMap(p).sort((g,m)=>{let _=St(g.object)?.store.snapshot,x=St(m.object)?.store.snapshot;return!_||!x?g.distance-m.distance:x.events.priority-_.events.priority||g.distance-m.distance}).filter(g=>{let m=Pd(g);return d.has(m)?!1:(d.add(m),!0)});u.events.filter&&(v=u.events.filter(v,i));for(let g of v){let m=g.object;for(;m;)St(m)?.eventCount&&f.push(tt(ie({},g),{eventObject:m})),m=m.parent}if("pointerId"in c&&u.internal.capturedMap.has(c.pointerId))for(let g of u.internal.capturedMap.get(c.pointerId).values())d.has(Pd(g.intersection))||f.push(g.intersection);return f}function r(c,l,u,d){let f=i.snapshot;if(c.length){let h={stopped:!1};for(let p of c){let{raycaster:v,pointer:g,camera:m,internal:_}=St(p.object)?.store.snapshot||f,x=new A(g.x,g.y,0).unproject(m),y=S=>_.capturedMap.get(S)?.has(p.eventObject)??!1,D=S=>{let M={intersection:p,target:l.target};_.capturedMap.has(S)?_.capturedMap.get(S).set(p.eventObject,M):_.capturedMap.set(S,new Map([[p.eventObject,M]])),l.target.setPointerCapture(S)},w=S=>{let M=_.capturedMap.get(S);M&&MR(_.capturedMap,p.eventObject,M,S)},E={};for(let S in l){let M=l[S];typeof M!="function"&&(E[S]=M)}let C=tt(ie(ie({},p),E),{pointer:g,intersections:c,stopped:h.stopped,delta:u,unprojectedPoint:x,ray:v.ray,camera:m,stopPropagation(){let S="pointerId"in l&&_.capturedMap.get(l.pointerId);if((!S||S.has(p.eventObject))&&(C.stopped=h.stopped=!0,_.hovered.size&&Array.from(_.hovered.values()).find(M=>M.eventObject===p.eventObject))){let M=c.slice(0,c.indexOf(p));s([...M,p])}},target:{hasPointerCapture:y,setPointerCapture:D,releasePointerCapture:w},currentTarget:{hasPointerCapture:y,setPointerCapture:D,releasePointerCapture:w},nativeEvent:l});if(d(C),h.stopped)break}}return c}function s(c){let l=i.get("internal");for(let u of l.hovered.values())if(!c.length||!c.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){let d=u.eventObject,f=St(d),h=f?.handlers;if(l.hovered.delete(Pd(u)),f?.eventCount){let p=tt(ie({},u),{intersections:c});h?.pointerout?.(p),h?.pointerleave?.(p)}}}function o(c,l){for(let u=0;u<l.length;u++)St(l[u])?.handlers.pointermissed?.(c)}function a(c){switch(c){case"pointerleave":case"pointercancel":return()=>s([]);case"lostpointercapture":return l=>{let{internal:u}=i.snapshot;"pointerId"in l&&u.capturedMap.has(l.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(l.pointerId)&&(u.capturedMap.delete(l.pointerId),s([]))})}}return function(u){let d=i.pointerMissed$,f=i.get("internal");f.lastEvent.nativeElement=u;let h=c==="pointermove",p=c==="click"||c==="contextmenu"||c==="dblclick",g=n(u,h?t:void 0),m=p?e(u):0;c==="pointerdown"&&(f.initialClick=[u.offsetX,u.offsetY],f.initialHits=g.map(x=>x.eventObject)),p&&!g.length&&m<=2&&(o(u,f.interaction),d.next(u)),h&&s(g);function _(x){let y=x.eventObject,D=St(y),w=D?.handlers;if(D?.eventCount)if(h){if(w?.pointerover||w?.pointerenter||w?.pointerout||w?.pointerleave){let E=Pd(x),C=f.hovered.get(E);C?C.stopped&&x.stopPropagation():(f.hovered.set(E,x),w.pointerover?.(x),w.pointerenter?.(x))}w?.pointermove?.(x)}else{let E=w?.[c];E?(!p||f.initialHits.includes(y))&&(o(u,f.interaction.filter(C=>!f.initialHits.includes(C))),E(x)):p&&f.initialHits.includes(y)&&o(u,f.interaction.filter(C=>!f.initialHits.includes(C)))}}r(g,u,m,_)}}return{handlePointer:a}}var hR={click:!1,contextmenu:!1,dblclick:!1,wheel:!1,pointerdown:!0,pointerup:!0,pointerleave:!0,pointermove:!0,pointercancel:!0,lostpointercapture:!0};function j4(i){let{handlePointer:e}=G4(i);return{priority:1,enabled:!0,compute:(t,n)=>{let r=n.get();r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(hR).reduce((t,n)=>(t[n]=e(n),t),{}),update:()=>{let{events:t,internal:n}=i.get();n.lastEvent?.nativeElement&&t.handlers&&t.handlers.pointermove(n.lastEvent.nativeElement)},connect:t=>{let n=i.get();n.events.disconnect?.(),n.setEvents({connected:t}),Object.entries(n.events.handlers??{}).forEach(([r,s])=>{let o=hR[r];t.addEventListener(r,s,{passive:o})})},disconnect:()=>{let{events:t,setEvents:n}=i.get();t.connected&&(Object.entries(t.handlers??{}).forEach(([r,s])=>{t.connected instanceof HTMLElement&&t.connected.removeEventListener(r,s)}),n({connected:void 0}))}}}var SR="__ngt_renderer_is_routed_scene__",W4="__ngt_renderer_is_html",$4="__ngt_renderer_is_non_root__",kd="__ngt_renderer_add_comment__",WM="__ngt_dom_parent__",$M={NGT_PORTAL:"ngt-portal",NGT_PRIMITIVE:"ngt-primitive",NGT_VALUE:"ngt-value"},al={RENDER_PRIORITY:"priority",ATTACH:"attach",RAW_VALUE:"rawValue",PARAMETERS:"parameters"},qM={BEFORE_RENDER:"beforeRender",UPDATED:"updated",ATTACHED:"attached"},q4=["added","removed","childadded","childremoved","disposed"],nS=(()=>{class i{constructor(){this.args=nn.required(),this.vcr=ee(_r),this.template=ee(xo),this.injected=!1,this.injectedArgs=null;let t=this.vcr.element.nativeElement;t[kd]&&(t[kd]("args"),delete t[kd]),Wr(()=>{let n=this.args();n==null||!Array.isArray(n)||n.length===1&&n[0]===null||(this.injected=!1,this.injectedArgs=n,dn(()=>{this.createView()}))}),ee(Yn).onDestroy(()=>{this.view?.destroy()})}get value(){return this.validate()?(this.injected=!0,this.injectedArgs):null}validate(){return!this.injected&&!!this.injectedArgs?.length}createView(){this.view&&!this.view.destroyed&&this.view.destroy(),this.view=this.vcr.createEmbeddedView(this.template),this.view.detectChanges()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=bo({type:i,selectors:[["ng-template","args",""]],inputs:{args:[1,"args"]},standalone:!0})}}return i})(),ll=new Map;var X4=new Set,Y4=new Set,Z4=new Set;function XM(i,e){if(i.size)for(let{callback:t}of i.values())t(e)}function Nd(i,e){switch(i){case"before":return XM(X4,e);case"after":return XM(Y4,e);case"tail":return XM(Z4,e)}}function YM(i,e,t){let n=e.snapshot,r=n.clock.getDelta();n.frameloop==="never"&&typeof i=="number"&&(r=i-n.clock.elapsedTime,n.clock.oldTime=n.clock.elapsedTime,n.clock.elapsedTime=i);let s=n.internal.subscribers;for(let o=0;o<s.length;o++){let a=s[o];a.callback(tt(ie({},a.store.snapshot),{delta:r,frame:t}))}return!n.internal.priority&&n.gl.render&&n.gl.render(n.scene,n.camera),n.internal.frames=Math.max(0,n.internal.frames-1),n.frameloop==="always"?1:n.internal.frames}function K4(i){let e=!1,t,n,r=!1;function s(c){n=requestAnimationFrame(s),e=!0,t=0,Nd("before",c),r=!0;for(let l of i.values()){let u=l.snapshot;u.internal.active&&(u.frameloop==="always"||u.internal.frames>0)&&!u.gl.xr?.isPresenting&&(t+=YM(c,l))}if(r=!1,Nd("after",c),t===0)return Nd("tail",c),e=!1,cancelAnimationFrame(n)}function o(c,l=1){let u=c?.snapshot;if(!u)return i.forEach(d=>o(d,l));u.gl.xr?.isPresenting||!u.internal.active||u.frameloop==="never"||(l>1?u.internal.frames=Math.min(60,u.internal.frames+l):r?u.internal.frames=2:u.internal.frames=1,e||(e=!0,requestAnimationFrame(s)))}function a(c,l=!0,u,d){if(l&&Nd("before",c),u)YM(c,u,d);else for(let f of i.values())YM(c,f);l&&Nd("after",c)}return{loop:s,invalidate:o,advance:a}}var[bR]=Kl(()=>K4(ll));function J4(i){let e=bR(),n=ee(fn).defaultView||void 0,r=new Kt,s=_R(({get:l,update:u})=>{let{invalidate:d,advance:f}=e,h=new A,p=new A,v=new A;function g(y=l("camera"),D=p,w=l("size")){let{width:E,height:C,top:S,left:M}=w,R=E/C;D instanceof A?v.copy(D):v.set(...D);let B=y.getWorldPosition(h).distanceTo(v);if(bt.orthographicCamera(y))return{width:E/y.zoom,height:C/y.zoom,top:S,left:M,factor:1,distance:B,aspect:R};let k=y.fov*Math.PI/180,j=2*Math.tan(k/2)*B,Y=j*(E/C);return{width:Y,height:j,top:S,left:M,factor:E/Y,distance:B,aspect:R}}let m,_=y=>u(D=>({performance:tt(ie({},D.performance),{current:y})})),x=new q;return{pointerMissed$:r.asObservable(),events:{priority:1,enabled:!0,connected:!1},invalidate:(y=1)=>d(s,y),advance:(y,D)=>f(y,D,s),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Hc,pointer:x,frameloop:"always",performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let y=l();m&&clearTimeout(m),y.performance.current!==y.performance.min&&_(y.performance.min),m=setTimeout(()=>{_(l("performance","max"))},y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:n?.devicePixelRatio||1,dpr:n?.devicePixelRatio||1,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:g},setEvents:y=>u(D=>tt(ie({},D),{events:ie(ie({},D.events),y)})),setSize:(y,D,w,E)=>{let C=l("camera"),S={width:y,height:D,top:w||0,left:E||0};u(M=>({size:S,viewport:ie(ie({},M.viewport),g(C,p,S))}))},setDpr:y=>u(D=>{let w=eS(y,n);return{viewport:tt(ie({},D.viewport),{dpr:w,initialDpr:D.viewport.initialDpr||w})}}),setFrameloop:(y="always")=>{let D=l("clock");D.stop(),D.elapsedTime=0,y!=="never"&&(D.start(),D.elapsedTime=0),u(()=>({frameloop:y}))},previousRoot:i,internal:{active:!1,priority:0,frames:0,lastEvent:new di(null),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,D=0,w=s)=>{let E=l("internal");return E.priority=E.priority+(D>0?1:0),E.subscribers.push({callback:y,priority:D,store:w}),E.subscribers=E.subscribers.sort((C,S)=>(C.priority||0)-(S.priority||0)),()=>{let C=l("internal");C?.subscribers&&(C.priority=C.priority-(D>0?1:0),C.subscribers=C.subscribers.filter(S=>S.callback!==y))}}}}});Object.defineProperty(s,"pointerMissed$",{get:()=>r});let{size:o,viewport:{dpr:a},camera:c}=s.snapshot;return Wr(()=>{let{camera:l,size:u,viewport:{dpr:d},gl:f}=s.state();if(u!==o||d!==a){o=u,a=d,dR(l,u),f.setPixelRatio(d);let h=typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(u.width,u.height,h)}l!==c&&(c=l,dR(l,u),s.update(h=>({viewport:ie(ie({},h.viewport),h.viewport.getCurrentViewport(l))})))}),s}var Fg=new Ue("NgtStore Token");function wR(i){return i?{provide:Fg,useFactory:i}:{provide:Fg,useFactory:J4}}function ul(i){return ee(Fg,i)}function Q4(i,e){let t=Object.entries(e),n=[];for(let[r,s]of t){let o=r;bt.colorSpaceExist(i)&&(r==="encoding"?o="colorSpace":r==="outputEncoding"&&(o="outputColorSpace")),!bt.equ(s,i[o])&&n.push([r,s])}return n}var Lg="__ngt_apply_props__";function ur(i,e){if(!Object.keys(e).length)return i;let t=St(i),n=t?.store?.snapshot??i[Lg]?.snapshot??{},r=Q4(i,e);for(let a=0;a<r.length;a++){let[c,l]=r[a];if(bt.colorSpaceExist(i)){let h="srgb",p="srgb-linear";c==="encoding"?(c="colorSpace",l=l===3001?h:p):c==="outputEncoding"&&(c="outputColorSpace",l=l===3001?h:p)}let u=i,d=u[c];if(d&&d.set&&(d.copy||d instanceof Tr)){let f=d instanceof de;if(Array.isArray(l))d.fromArray?d.fromArray(l):d.set(...l);else if(d.copy&&l&&l.constructor&&d.constructor.name===l.constructor.name)d.copy(l),!it&&!n.linear&&f&&d.convertSRGBToLinear();else if(l!==void 0){let h=d instanceof de;!h&&d.setScalar?d.setScalar(l):d instanceof Tr&&l instanceof Tr?d.mask=l.mask:d.set(l),!it&&!n?.linear&&h&&d.convertSRGBToLinear()}}else if(u[c]=l,u[c]instanceof cn&&u[c].format===En&&u[c].type===ki){let f=u[c];n?.gl&&(bt.colorSpaceExist(f)&&bt.colorSpaceExist(n.gl)?f.colorSpace=n.gl.outputColorSpace:f.encoding=n.gl.outputEncoding)}JM(u[c]),JM(d),Ld(i)}let s=t?.eventCount,o=t?.instanceStore?.get("parent");if(o&&n.internal&&i.raycast&&s!==t?.eventCount){let a=n.internal.interaction.indexOf(i);a>-1&&n.internal.interaction.splice(a,1),t?.eventCount&&n.internal.interaction.push(i)}return o&&t?.onUpdate&&r.length&&t.onUpdate(i),i[Lg]&&delete i[Lg],i}var ER={};function iS(i){Object.assign(ER,i)}var[ej]=Kl(()=>ER);function ys(i,e,t){let n=[i,null,[],!1,void 0,void 0,void 0,void 0],r=Object.assign(e,{__ngt_renderer__:n});return r.ownerDocument||(r.ownerDocument=t),n[0]!=="three"&&(n[7]=()=>(n[6]||(n[6]=new So(r)),n[6])),r}function tj(i){return!i.__ngt_renderer__||i instanceof Element||i instanceof Document||i instanceof Window}function Og(i){let e=i.__ngt_renderer__[1];if(e&&e.__ngt_renderer__[0]==="portal"&&e.__ngt_renderer__[5]?.__ngt_renderer__[0]==="three")return e.__ngt_renderer__[5];for(;e&&e.__ngt_renderer__[0]!=="three";)e=e.__ngt_renderer__[5]?e.__ngt_renderer__[5]:e.__ngt_renderer__[1];return e}function ZM(i,e){i.__ngt_renderer__[1]||(i.__ngt_renderer__[1]=e)}function pR(i,e){i.__ngt_renderer__[2].includes(e)||i.__ngt_renderer__[2].push(e)}function nj(i,e){let t=i.__ngt_renderer__?.[2].findIndex(n=>e===n);t>=0&&i.__ngt_renderer__[2].splice(t,1)}function kg(i,e,t=[],n=!1){let[r,...s]=t;r&&(s.length===0?n?ur(i,{[r]:e}):i[r]=e:(rj(i,r,n),kg(i[r],e,s,n)))}function ij(i,e,t){let n=St(e);n&&(Array.isArray(t)?kg(i,n.previousAttach,t,n.isRaw):n.previousAttach())}function rj(i,e,t=!1){if((!Object.hasOwn(i,e)&&Reflect&&Reflect.has&&!Reflect.has(i,e)||i[e]===void 0)&&(i[e]={}),t){if(St(i[e]))return;let r=St(i);if(!r)return;Object.assign(i[e],{[Lg]:r.store})}}function sj(i){if(!i)return i;let e="",t=!0;for(let n=0;n<i.length;n++){let r=i[n];if(r==="-"){t=!0;continue}e+=t?r.toUpperCase():r,t=!1}return e}function KM(i,e){let t=St(i),n=St(e);if(!t||!n)throw new Error("[NGT] THREE instances need to be prepared with local state.");let r=!1;if(!n.store||n.store!==t.store||n.store===t.store.get("previousRoot")){n.store=t.store;let s=[...n.objects?dn(n.objects):[],...n.nonObjects?dn(n.nonObjects):[]];for(let o of s){let a=St(o);a&&(a.store=n.store)}}if(n.attach){let s=n.attach;if(typeof s=="function"){let o;if(n.isRaw){if(n.instanceStore.get("parent")!==i&&n.setParent(i),e.__ngt_renderer__[4]===void 0)return;o=s(i,e.__ngt_renderer__[4],n.store)}else o=s(i,e,n.store);o&&(n.previousAttach=o)}else{if(s[0]==="none"){Ld(e);return}if(s[0]==="material"&&s[1]&&typeof Number(s[1])=="number"&&bt.material(e)&&!Array.isArray(i.material)&&(i.material=[]),n.isRaw){if(n.instanceStore.get("parent")!==i&&n.setParent(i),e.__ngt_renderer__[4]===void 0)return;kg(i,e.__ngt_renderer__[4],s,!0)}else kg(i,e,s);n.previousAttach=s.reduce((o,a)=>o[a],i)}}else bt.object3D(i)&&bt.object3D(e)&&(i.add(e),r=!0);t.add&&t.add(e,r?"objects":"nonObjects"),n.parent&&dn(n.parent)!==i&&n.setParent(i),n.onAttach&&n.onAttach({parent:i,node:e}),Ld(e),Ld(i)}function Od(i,e,t){let n=St(e),r=St(i);if(r?.setParent(null),n?.remove(i,"objects"),n?.remove(i,"nonObjects"),e){if(r?.attach)ij(e,i,r.attach);else if(bt.object3D(e)&&bt.object3D(i)){e.remove(i);let o=r?.store||n?.store;o&&H4(o,i)}}let s=r?.primitive;s||(mR(r?.instanceStore.get("objects")||[],i,!!t),mR(i.children,i,!!t)),!s&&i.dispose&&!bt.scene(i)&&queueMicrotask(()=>i.dispose()),e&&Ld(e)}function mR(i,e,t){i&&[...i].forEach(n=>Od(n,e,t))}function oj(i,e,t,n){let r=St(i);if(!r)return console.warn("[NGT] instance has not been prepared yet."),()=>{};if(t===qM.BEFORE_RENDER)return r.store.get("internal").subscribe(a=>n({state:a,object:i}),e||r.priority||0);if(t===qM.ATTACHED)return r.onAttach=n,dn(r.parent)&&r.onAttach({parent:dn(r.parent),node:i}),()=>{r.onAttach=void 0};if(t===qM.UPDATED)return r.onUpdate=n,()=>{r.onUpdate=void 0};if(q4.includes(t)&&i instanceof ni)return t==="disposed"&&(t="dispose"),i.parent&&(t==="added"||t==="removed")&&n({type:t,target:i}),i.addEventListener(t,n),()=>i.removeEventListener(t,n);r.handlers||(r.handlers={});let s=r.handlers[t],o=a=>{s&&s(a),n(a)};if(Object.assign(r.handlers,{[t]:o}),r.eventCount+=1,r.eventCount===1&&i.raycast){let a=r.store;for(;a.get("previousRoot");)a=a.get("previousRoot");(a.get("internal","interaction")||[]).push(i)}return()=>{let a=St(i);if(a){a.eventCount-=1;let c=a.store.get("internal","interaction")||[],l=c.findIndex(u=>u.uuid===i.uuid);l>=0&&c.splice(l,1)}}}var gR=(()=>{class i{constructor(){this.delegateRendererFactory=ee(Hr,{skipSelf:!0}),this.document=ee(fn),this.catalogue=ej(),this.rootStore=ul(),this.portalCommentsNodes=[],this.rendererMap=new Map,this.routedSet=new Set}createRenderer(t,n){let r=this.delegateRendererFactory.createRenderer(t,n);if(!n)return r;if(n.type[W4])return this.rendererMap.set(n.id,r),r;n.type[SR]&&this.routedSet.add(n.id);let s=n.type[$4],o=this.rendererMap.get(n.id);return o||this.rendererMap.set(n.id,o=new tS(r,this.rootStore,this.document,this.portalCommentsNodes,this.catalogue,!t&&!s&&(this.routedSet.size===0||this.routedSet.has(n.id)))),o}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=ke({token:i,factory:i.\u0275fac})}}return i})(),tS=class{constructor(e,t,n,r,s,o=!0){this.delegate=e,this.rootStore=t,this.document=n,this.portalCommentsNodes=r,this.catalogue=s,this.isRoot=o,this.argsCommentNodes=[],this.createText=this.delegate.createText.bind(this.delegate),this.destroy=this.delegate.destroy.bind(this.delegate),this.destroyNode=null,this.selectRootElement=this.delegate.selectRootElement.bind(this.delegate),this.nextSibling=this.delegate.nextSibling.bind(this.delegate),this.addClass=this.delegate.addClass.bind(this.delegate),this.removeClass=this.delegate.removeClass.bind(this.delegate),this.setStyle=this.delegate.setStyle.bind(this.delegate),this.removeStyle=this.delegate.removeStyle.bind(this.delegate),this.setValue=this.delegate.setValue.bind(this.delegate)}createElement(e,t){let n=this.delegate.createElement(e,t);if(t)return ys("dom",n,this.document);if(this.isRoot){this.isRoot=!1;let a=ys("three",this.rootStore.snapshot.scene,this.document);return a.__ngt_renderer__[7]=()=>(a.__ngt_renderer__[6]||(a.__ngt_renderer__[6]=new So(n)),a.__ngt_renderer__[6]),a}if(e===$M.NGT_PORTAL)return ys("portal",n,this.document);if(e===$M.NGT_VALUE)return ys("three",Fd({__ngt_renderer__:{rawValue:void 0}},{store:this.rootStore,isRaw:!0}),this.document);let[r]=[this.getNgtArgs()?.value||[]];if(e===$M.NGT_PRIMITIVE){if(!r[0])throw new Error("[NGT] ngt-primitive without args is invalid");let a=r[0];return St(a)||Fd(a,{store:this.rootStore,primitive:!0}),ys("three",a,this.document)}let s=sj(e.startsWith("ngt-")?e.slice(4):e),o=this.catalogue[s];if(o){let a=Fd(new o(...r),{store:this.rootStore}),c=ys("three",a,this.document),l=St(a);return bt.geometry(a)?l.attach=["geometry"]:bt.material(a)&&(l.attach=["material"]),c}return ys("dom",n,this.document)}createComment(e){let t=this.delegate.createComment(e);return t[kd]=n=>{n==="args"?this.argsCommentNodes.push(t):typeof n=="object"&&this.portalCommentsNodes.push(n)},ys("comment",t,this.document)}appendChild(e,t){let n=e.__ngt_renderer__,r=t.__ngt_renderer__;if(n[0]==="dom"&&(t instanceof Text||r[0]==="dom")){if(pR(e,t),t[WM]&&t[WM]instanceof HTMLElement){this.delegate.appendChild(t[WM],t);return}if(this.delegate.appendChild(e,t),r&&(ZM(t,e),this.shouldFindGrandparentInstance(n,r,t))){let s=Og(e);s&&this.appendChild(s,t)}return}if(r?.[0]==="comment"){ZM(t,e);return}if(ZM(t,e),pR(e,t),r?.[0]==="portal"){r[5]||this.processPortalContainer(t),r[5]&&this.appendChild(e,r[5]);return}if(n[0]==="portal"){n[5]||this.processPortalContainer(e),n[5]&&this.appendChild(n[5],t);return}if(n[0]==="three"&&r?.[0]==="three"){if(St(t)?.instanceStore?.get("parent")||e===t)return;KM(e,t);return}if(n[0]==="three")for(let s of r?.[2]||[])this.appendChild(e,s);if(this.shouldFindGrandparentInstance(n,r,t)){let s=Og(e);s&&this.appendChild(s,t);return}}insertBefore(e,t){e==null||!e.__ngt_renderer__||e===t||this.appendChild(e,t)}removeChild(e,t,n){e==null&&(e=dn(()=>St(t)?.parent?.())||t.__ngt_renderer__?.[1]);let r=t.__ngt_renderer__;if(e==null){r&&(r[0]==="three"&&Od(t,void 0,!0),this.destroyInternal(t,void 0));return}let s=e.__ngt_renderer__;if((!r||!s)&&e instanceof Element&&(t instanceof Element||t instanceof Text||t instanceof Comment)){this.delegate.removeChild(e,t),this.destroyInternal(t,e);return}if(r[0]==="dom"&&(!s||s[0]==="dom")){this.delegate.removeChild(e,t),this.destroyInternal(t,e);return}if(s[0]==="three"&&r[0]==="three"){Od(t,e,!0),this.destroyInternal(t,e);return}if(s[0]==="portal"&&s[5]?.__ngt_renderer__[0]==="three"){this.removeChild(s[5],t,n);return}if(s[0]==="three"){this.destroyInternal(t,e);return}let o=Og(e);o&&this.removeChild(o,t,n),this.destroyInternal(t,o)}parentNode(e){let t=e.__ngt_renderer__;return t?.[1]?t[1]:this.delegate.parentNode(e)}setAttributeInternal(e,t,n,r){let s=e.__ngt_renderer__;if(s[3])return!1;if(s[0]==="three"){if(t===al.RENDER_PRIORITY){let o=Number(n);isNaN(o)&&(o=0,console.warn('[NGT] "priority" is an invalid number, default to 0'));let a=St(e);a&&(a.priority=o)}else if(t===al.ATTACH){let o=n.split(".");if(o.length){let a=St(e);a&&(a.attach=o)}}else{let o=n;o===""||o==="true"||o==="false"?o=o==="true"||o==="":isNaN(Number(o))||(o=Number(o)),t===al.RAW_VALUE?s[4]=o:ur(e,{[t]:o})}return!1}return!0}setAttribute(e,t,n,r){this.setAttributeInternal(e,t,n,r)&&this.delegate.setAttribute(e,t,n)}removeAttribute(e,t,n){this.setAttributeInternal(e,t,void 0,n)&&this.delegate.removeAttribute(e,t,n)}setProperty(e,t,n){let r=e.__ngt_renderer__;if(!r||r[3])return;let s=St(e);if(r[0]==="three"){if(t===al.PARAMETERS){"raycast"in n&&n.raycast===null&&(n.raycast=()=>null),ur(e,n),"geometry"in n&&n.geometry.isBufferGeometry&&s?.updateGeometryStamp();return}let o=s?.instanceStore.get("parent")||r[1];if(s?.isRaw&&t===al.RAW_VALUE){r[4]=n,o&&KM(o,e);return}if(t===al.ATTACH){s&&(s.attach=Array.isArray(n)?n.map(a=>a.toString()):typeof n=="function"?n:typeof n=="string"?n.split("."):[n]),o&&KM(o,e);return}t==="raycast"&&n===null&&(n=()=>null),ur(e,{[t]:n}),t==="geometry"&&n.isBufferGeometry&&s?.updateGeometryStamp();return}return this.delegate.setProperty(e,t,n)}listen(e,t,n){let r=e.__ngt_renderer__;if(!r||tj(e))return this.delegate.listen(e,t,n);if(r[0]==="three"){let s=e,a=St(s)?.priority??0;return oj(s,a,t,n)}if(e===this.rootStore.snapshot.scene){let[s,o]=t.split(":");o==null&&(o=s,s="");let a=s==="window"?e.ownerDocument.defaultView:e.ownerDocument;return this.delegate.listen(a,o,n)}return()=>{}}destroyInternal(e,t){let n=e.__ngt_renderer__;if(!(!n||n[3])){if(n[0]==="three"){let r=St(e);r?.instanceStore&&(r.instanceStore.get("objects").forEach(s=>this.destroyInternal(s,t)),r.instanceStore.get("nonObjects").forEach(s=>this.destroyInternal(s,t))),r?.onUpdate&&delete r.onUpdate,r?.onAttach&&delete r.onAttach,delete r.objects,delete r.nonObjects,delete r.parent,delete r.add,delete r.remove,delete r.store,delete r.handlers,r?.primitive||delete e.__ngt__}n[0]==="comment"&&(n[6]=null,n[7]=null,delete e[kd],this.removeCommentNode(e,this.argsCommentNodes)),n[0]==="portal"&&(n[6]=null,n[7]=null,this.removeCommentNode(e,this.portalCommentsNodes)),n[1]=null;for(let r of n[2]||[]){if(r.__ngt_renderer__?.[0]==="three"&&t){if(t.__ngt_renderer__?.[0]==="three"){Od(r,t,!0);continue}let s=Og(t);s&&Od(r,s,!0)}this.destroyInternal(r,t)}n[2]=[],n[3]=!0,t&&nj(t,e)}}removeCommentNode(e,t){let n=t.findIndex(r=>r===e);n>-1&&t.splice(n,1)}processPortalContainer(e){let t=e.__ngt_renderer__[7]?.()?.injector;if(!t)return;let n=t.get(Fg,null);if(!n)return;let r=n.get("scene");if(!r)return;let s=St(r);s&&(s.store=n),e.__ngt_renderer__[5]=ys("three",r,this.document)}shouldFindGrandparentInstance(e,t,n){let r=e[0],s=t[0],o=St(n),a=s==="three"&&!o?.instanceStore?.get("parent"),c=r==="dom";return a||c&&s==="dom"||c}getNgtArgs(){let e,t=[],n=this.argsCommentNodes.length-1;for(;n>=0;){let r=this.argsCommentNodes[n];if(r.__ngt_renderer__[3]){t.push(n),n--;continue}let s=r.__ngt_renderer__[7]?.()?.injector;if(!s){n--;continue}let o=s.get(nS,null);if(o&&o.validate()){e=o;break}n--}return t.forEach(r=>{this.argsCommentNodes.splice(r,1)}),e}get data(){return this.delegate.data}};function aj(i){let e=[gR,{provide:Hr,useExisting:gR},wR(()=>i)];return ah(e)}var cl={objects:"shallow",strict:!1};function TR(i){return nc(TR,i,()=>{let e=ul(),t=bR();return n=>{let r=ll.has(n),s=ll.get(n);if(s&&console.warn("[NGT] Same canvas root is being created twice"),s||=e,!s)throw new Error("[NGT] No store initialized");r||ll.set(n,s);let o=!1,a;return{isConfigured:o,destroy:(c=500)=>{let l=ll.get(n);l&&(l.update(u=>({internal:tt(ie({},u.internal),{active:!1})})),setTimeout(()=>{try{let u=l.get();u.events.disconnect?.(),u.gl?.renderLists?.dispose?.(),u.gl?.forceContextLoss?.(),u.gl?.xr&&u.xr.disconnect(),lj(u),ll.delete(n)}catch(u){console.error("[NGT] Unexpected error while destroying Canvas Root",u)}},c))},configure:c=>{let{shadows:l=!1,linear:u=!1,flat:d=!1,legacy:f=!1,orthographic:h=!1,frameloop:p="always",dpr:v=[1,2],gl:g,size:m,camera:_,raycaster:x,scene:y,events:D,lookAt:w,performance:E}=c,C=s.snapshot,S={},M=C.gl;C.gl||(S.gl=M=B4(g,n));let R=C.raycaster;R||(S.raycaster=R=new ed);let Y=x||{},{params:B}=Y,k=ml(Y,["params"]);if(bt.equ(k,R,cl)||ur(R,k),bt.equ(B,R.params,cl)||ur(R,{params:ie(ie({},R.params),B||{})}),!C.camera||C.camera===a&&!bt.equ(a,_,cl)){a=_;let V=bt.camera(_),$=V?_:V4(h,m??C.size);V||($.position.z=5,_&&(ur($,_),("aspect"in _||"left"in _||"right"in _||"top"in _||"bottom"in _)&&(Object.assign($,{manual:!0}),$?.updateProjectionMatrix())),!C.camera&&!_?.rotation&&!_?.quaternion&&(Array.isArray(w)?$.lookAt(w[0],w[1],w[2]):w instanceof A?$.lookAt(w):$.lookAt(0,0,0)),$.updateProjectionMatrix?.()),bt.instance($)||($=Fd($,{store:s})),S.camera=$,R.camera=$}if(!C.scene){let V;y instanceof oa?V=y:(V=new oa,y&&ur(V,y)),ur(V,{setAttribute:($,z)=>{n instanceof HTMLCanvasElement&&(n.parentElement?n.parentElement.setAttribute($,z):n.setAttribute($,z))}}),S.scene=Fd(V,{store:s})}if(!C.xr){let V=(ce,ge)=>{s.snapshot.frameloop!=="never"&&t.advance(ce,!0,s,ge)},$=()=>{let ce=s.snapshot;ce.gl.xr.enabled=ce.gl.xr.isPresenting,ce.gl.xr.setAnimationLoop(ce.gl.xr.isPresenting?V:null),ce.gl.xr.isPresenting||t.invalidate(s)},z={connect:()=>{M.xr.addEventListener("sessionstart",$),M.xr.addEventListener("sessionend",$)},disconnect:()=>{M.xr.removeEventListener("sessionstart",$),M.xr.removeEventListener("sessionend",$)}};M.xr&&typeof M.xr.addEventListener=="function"&&z.connect(),S.xr=z}if(M.shadowMap){let V=M.shadowMap.enabled,$=M.shadowMap.type;if(M.shadowMap.enabled=!!l,typeof l=="boolean")M.shadowMap.type=jc;else if(typeof l=="string"){let z={basic:jx,percentage:td,soft:jc,variance:Pi};M.shadowMap.type=z[l]??jc}else bt.obj(l)&&Object.assign(M.shadowMap,l);(V!==M.shadowMap.enabled||$!==M.shadowMap.type)&&xR(M.shadowMap)}if(it){let V=it;"enabled"in V?V.enabled=!f:"legacyMode"in V&&(V.legacyMode=f)}o||ur(M,{outputEncoding:u?3e3:3001,toneMapping:d?sr:rg}),C.legacy!==f&&(S.legacy=f),C.linear!==u&&(S.linear=u),C.flat!==d&&(S.flat=d),M.setClearAlpha&&M.setClearAlpha(0),M.setPixelRatio(eS(C.viewport.dpr)),M.setSize(m?.width??C.size.width,m?.height??C.size.height),bt.obj(g)&&typeof g!="function"&&!bt.renderer(g)&&!bt.equ(g,M,cl)&&ur(M,g),D&&!C.events.handlers&&(S.events=D(s)),E&&!bt.equ(E,C.performance,cl)&&(S.performance=ie(ie({},C.performance),E)),Object.keys(S).length&&s.update(S);let j=cj(n,m);bt.equ(j,C.size,cl)||C.setSize(j.width,j.height,j.top,j.left),v&&C.viewport.dpr!==eS(v)&&C.setDpr(v),C.frameloop!==p&&C.setFrameloop(p),o=!0}}}})}function cj(i,e){return e||(typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement?i.parentElement.getBoundingClientRect():typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?{width:i.width,height:i.height,top:0,left:0}:{width:0,height:0,top:0,left:0})}function lj(i){i.dispose&&i.type!=="Scene"&&i.dispose();for(let e in i)e.dispose?.(),delete i[e]}var vR,uj=(()=>{class i{static{vR=SR}static{this[vR]=!0}constructor(t,n){t.events.pipe(Rn(r=>r instanceof yd),tc()).subscribe(n.detectChanges.bind(n))}static{this.\u0275fac=function(n){return new(n||i)(yr(vs),yr(Vs))}}static{this.\u0275cmp=ui({type:i,selectors:[["ngt-routed-scene"]],standalone:!0,features:[Eo],decls:1,vars:0,template:function(n,r){n&1&&Zn(0,"router-outlet")},dependencies:[Ad],encapsulation:2})}}return i})(),Ug=(()=>{class i{constructor(){this.store=ul(),this.initRoot=TR(),this.host=ee(di),this.zone=ee(At),this.environmentInjector=ee(Pn),this.injector=ee(un),this.sceneGraph=nn.required({transform:t=>t==="routed"?(console.warn("[NGT] 'routed' sceneGraph is not working properly."),uj):t}),this.gl=nn(),this.size=nn(),this.shadows=nn(!1,{transform:t=>t===""?zs(t):t}),this.legacy=nn(!1,{transform:zs}),this.linear=nn(!1,{transform:zs}),this.flat=nn(!1,{transform:zs}),this.orthographic=nn(!1,{transform:zs}),this.frameloop=nn("always"),this.performance=nn(),this.dpr=nn([1,2]),this.raycaster=nn(),this.scene=nn(),this.camera=nn(),this.events=nn(j4),this.eventSource=nn(),this.eventPrefix=nn("offset"),this.lookAt=nn(),this.created=GE(),this.pointerMissed=SC(this.store.get("pointerMissed$")),this.glCanvas=zl.required("glCanvas"),this.glCanvasViewContainerRef=zl.required("glCanvas",{read:_r}),this.hbPointerEvents=xr(()=>this.eventSource()?"none":"auto"),this.resizeResult=Di({},{equal:Object.is}),this.configurator=Di(null),Hl(()=>{let t=this.glCanvas().nativeElement;this.zone.runOutsideAngular(()=>{this.configurator.set(this.initRoot(t))}),Wr(()=>{let n=this.resizeResult();if(!n.width||n.width<=0||!n.height||n.height<=0)return;let r=this.configurator();if(!r)return;let s={gl:this.gl(),shadows:this.shadows(),legacy:this.legacy(),linear:this.linear(),flat:this.flat(),orthographic:this.orthographic(),frameloop:this.frameloop(),performance:this.performance(),dpr:this.dpr(),raycaster:this.raycaster(),scene:this.scene(),camera:this.camera(),events:this.events(),eventSource:this.eventSource(),eventPrefix:this.eventPrefix(),lookAt:this.lookAt(),size:n};this.zone.runOutsideAngular(()=>{r.configure(s),dn(()=>{this.glRef?this.glRef.changeDetectorRef.detectChanges():this.noZoneRender()})})},{injector:this.injector})}),ee(Yn).onDestroy(()=>{this.glRef?.destroy(),this.glEnvironmentInjector?.destroy(),this.configurator()?.destroy()})}noZoneRender(){this.glEnvironmentInjector?.destroy(),this.glRef?.destroy(),this.store.update(s=>({internal:tt(ie({},s.internal),{active:!0})}));let[t,n,r]=[this.store.snapshot,dn(this.eventSource),dn(this.eventPrefix)];t.events.connect?.(n?bt.ref(n)?n.nativeElement:n:this.host.nativeElement),r&&t.setEvents({compute:(s,o)=>{let{pointer:a,raycaster:c,camera:l,size:u}=o.snapshot,d=s[r+"X"],f=s[r+"Y"];a.set(d/u.width*2-1,-(f/u.height)*2+1),c.setFromCamera(a,l)}}),this.created.emit(this.store.snapshot),this.store.get("events","connected")||this.store.get("events").connect?.(dn(this.glCanvas).nativeElement),this.glEnvironmentInjector=Ka([aj(this.store)],this.environmentInjector),this.glRef=dn(this.glCanvasViewContainerRef).createComponent(dn(this.sceneGraph),{environmentInjector:this.glEnvironmentInjector,injector:this.injector}),this.glRef.changeDetectorRef.detectChanges()}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=ui({type:i,selectors:[["ngt-canvas"]],viewQuery:function(n,r){n&1&&(Gl(r.glCanvas,aR,5),Gl(r.glCanvasViewContainerRef,aR,5,_r)),n&2&&yh(2)},hostAttrs:[2,"display","block","position","relative","width","100%","height","100%","overflow","hidden"],hostVars:2,hostBindings:function(n,r){n&2&&Ja("pointer-events",r.hbPointerEvents())},inputs:{sceneGraph:[1,"sceneGraph"],gl:[1,"gl"],size:[1,"size"],shadows:[1,"shadows"],legacy:[1,"legacy"],linear:[1,"linear"],flat:[1,"flat"],orthographic:[1,"orthographic"],frameloop:[1,"frameloop"],performance:[1,"performance"],dpr:[1,"dpr"],raycaster:[1,"raycaster"],scene:[1,"scene"],camera:[1,"camera"],events:[1,"events"],eventSource:[1,"eventSource"],eventPrefix:[1,"eventPrefix"],lookAt:[1,"lookAt"]},outputs:{created:"created",pointerMissed:"pointerMissed"},standalone:!0,features:[HT([TC({emitInZone:!1,emitInitialResult:!0,debounce:{scroll:50,resize:0}}),wR()]),Eo],decls:3,vars:0,consts:[["glCanvas",""],[2,"height","100%","width","100%",3,"ngxResize"],[2,"display","block"]],template:function(n,r){if(n&1){let s=VT();$t(0,"div",1),er("ngxResize",function(a){return vE(s),yE(r.resizeResult.set(a))}),Zn(1,"canvas",2,0),Qt()}},dependencies:[CC],encapsulation:2,changeDetection:0})}}return i})();var M7=new Ue("NGT_HTML_DOM_ELEMENT");var Ud=new Map,yR=new WeakMap;function dj(i){let e=[];return Array.isArray(i)?e=i:typeof i=="string"?e=[i]:e=Object.values(i),e.map(t=>t.includes("undefined")||t.includes("null")||!t?"":t)}function CR(i,e,{extensions:t,onLoad:n,onProgress:r}={}){return()=>{let s=dj(e()),o=yR.get(i(s));return o||(o=new(i(s)),yR.set(i(s),o)),t&&t(o),s.map(a=>a===""?Promise.resolve(null):(Ud.has(a)||Ud.set(a,new Promise((c,l)=>{o.load(a,u=>{"scene"in u&&Object.assign(u,z4(u.scene)),n&&n(u),c(u)},r,u=>l(new Error(`[NGT] Could not load ${a}: ${u?.message}`)))})),Ud.get(a)))}}function Bd(i,e,{extensions:t,onProgress:n,onLoad:r,injector:s}={}){return nc(Bd,s,()=>{let o=Di(null),a=CR(i,e,{extensions:t,onProgress:n,onLoad:r});return Wr(()=>{let c=e(),l=a();Promise.all(l).then(u=>{o.update(()=>{if(Array.isArray(c))return u;if(typeof c=="string")return u[0];let d=Object.keys(c);return d.reduce((f,h)=>(f[h]=u[d.indexOf(h)],f),{})})})}),o.asReadonly()})}Bd.preload=(i,e,t,n)=>{let r=CR(i,e,{extensions:t,onLoad:n})();r&&Promise.all(r)};Bd.destroy=()=>{Ud.clear()};Bd.clear=i=>{(Array.isArray(i)?i:[i]).forEach(t=>{Ud.delete(t)})};var AR=Bd;function rS(i,{priority:e=0,injector:t}={}){return nc(rS,t,()=>{let n=ul(),r=n.get("internal").subscribe(i,e,n);return ee(Yn).onDestroy(()=>void r()),r})}function sS(i){return(e,t,n)=>{if(typeof t>"u"||typeof t=="boolean"){n=!!t;let o=e;return xr(()=>{let a=o();if(!(n&&a==null))return typeof a=="number"?new i().setScalar(a):a?new i(...a):new i},{equal:(a,c)=>!!a&&!!c&&a.equals(c)})}let r=e,s=t;return xr(()=>{let o=r()[s];if(!(n&&o==null))return typeof o=="number"?new i().setScalar(o):o?new i(...o):new i},{equal:(o,a)=>!!o&&!!a&&o.equals(a)})}}var S7=sS(q),b7=sS(A),w7=sS(_t);var hj=[],Bg=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=Ki({type:i});static \u0275inj=Zi({imports:[jM.forRoot(hj),jM]})};function oS(i,e){if(e===tM)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===qc||e===sd){let t=i.getIndex();if(t===null){let o=[],a=i.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)o.push(c);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let n=t.count-2,r=[];if(e===qc)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let s=i.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var Vg=class extends zn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new hS(t)}),this.register(function(t){return new pS(t)}),this.register(function(t){return new bS(t)}),this.register(function(t){return new wS(t)}),this.register(function(t){return new ES(t)}),this.register(function(t){return new gS(t)}),this.register(function(t){return new vS(t)}),this.register(function(t){return new yS(t)}),this.register(function(t){return new _S(t)}),this.register(function(t){return new fS(t)}),this.register(function(t){return new xS(t)}),this.register(function(t){return new mS(t)}),this.register(function(t){return new SS(t)}),this.register(function(t){return new MS(t)}),this.register(function(t){return new uS(t)}),this.register(function(t){return new TS(t)}),this.register(function(t){return new CS(t)})}load(e,t,n,r){let s=this,o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){let l=cr.extractUrlBase(e);o=cr.resolveURL(l,this.path)}else o=cr.extractUrlBase(e);this.manager.itemStart(e);let a=function(l){r?r(l):console.error(l),s.manager.itemError(e),s.manager.itemEnd(e)},c=new si(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{s.parse(l,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s,o={},a={},c=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===PR){try{o[dt.KHR_BINARY_GLTF]=new AS(e)}catch(d){r&&r(d);return}s=JSON.parse(o[dt.KHR_BINARY_GLTF].content)}else s=JSON.parse(c.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let l=new LS(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){let d=this.pluginCallbacks[u](l);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){let d=s.extensionsUsed[u],f=s.extensionsRequired||[];switch(d){case dt.KHR_MATERIALS_UNLIT:o[d]=new dS;break;case dt.KHR_DRACO_MESH_COMPRESSION:o[d]=new DS(s,this.dracoLoader);break;case dt.KHR_TEXTURE_TRANSFORM:o[d]=new IS;break;case dt.KHR_MESH_QUANTIZATION:o[d]=new RS;break;default:f.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(n,r)}parseAsync(e,t){let n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}};function pj(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var dt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},uS=class{constructor(e){this.parser=e,this.name=dt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){let s=t[n];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){let t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;let s=t.json,c=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e],l,u=new de(16777215);c.color!==void 0&&u.setRGB(c.color[0],c.color[1],c.color[2],Tn);let d=c.range!==void 0?c.range:0;switch(c.type){case"directional":l=new zc(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Vc(u),l.distance=d;break;case"spot":l=new Bc(u),l.distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),l.decay=2,_s(l,c),c.intensity!==void 0&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return n._getNodeRef(t.cache,a,c)})}},dS=class{constructor(){this.name=dt.KHR_MATERIALS_UNLIT}getMaterialType(){return In}extendParams(e,t,n){let r=[];e.color=new de(1,1,1),e.opacity=1;let s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){let o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Tn),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",s.baseColorTexture,sn))}return Promise.all(r)}},fS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}},hS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){let a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new q(a,a)}return Promise.all(s)}},pS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_DISPERSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},mS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}},gS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_SHEEN}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[];t.sheenColor=new de(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=r.extensions[this.name];if(o.sheenColorFactor!==void 0){let a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Tn)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,sn)),o.sheenRoughnessTexture!==void 0&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}},vS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}},yS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_VOLUME}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new de().setRGB(a[0],a[1],a[2],Tn),Promise.all(s)}},_S=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_IOR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},xS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_SPECULAR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new de().setRGB(a[0],a[1],a[2],Tn),o.specularColorTexture!==void 0&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,sn)),Promise.all(s)}},MS=class{constructor(e){this.parser=e,this.name=dt.EXT_MATERIALS_BUMP}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}},SS=class{constructor(e){this.parser=e,this.name=dt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Vn}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}},bS=class{constructor(e){this.parser=e,this.name=dt.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;let s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}},wS=class{constructor(e){this.parser=e,this.name=dt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],c=n.textureLoader;if(a.uri){let l=n.options.manager.getHandler(a.uri);l!==null&&(c=l)}return this.detectSupport().then(function(l){if(l)return n.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},ES=class{constructor(e){this.parser=e,this.name=dt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;let o=s.extensions[t],a=r.images[o.source],c=n.textureLoader;if(a.uri){let l=n.options.manager.getHandler(a.uri);l!==null&&(c=l)}return this.detectSupport().then(function(l){if(l)return n.loadTextureImage(e,o.source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},TS=class{constructor(e){this.name=dt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){let r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){let c=r.byteOffset||0,l=r.byteLength||0,u=r.count,d=r.byteStride,f=new Uint8Array(a,c,l);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,d,f,r.mode,r.filter).then(function(h){return h.buffer}):o.ready.then(function(){let h=new ArrayBuffer(u*d);return o.decodeGltfBuffer(new Uint8Array(h),u,d,f,r.mode,r.filter),h})})}else return null}},CS=class{constructor(e){this.name=dt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;let r=t.meshes[n.mesh];for(let l of r.primitives)if(l.mode!==Vi.TRIANGLES&&l.mode!==Vi.TRIANGLE_STRIP&&l.mode!==Vi.TRIANGLE_FAN&&l.mode!==void 0)return null;let o=n.extensions[this.name].attributes,a=[],c={};for(let l in o)a.push(this.parser.getDependency("accessor",o[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{let u=l.pop(),d=u.isGroup?u.children:[u],f=l[0].count,h=[];for(let p of d){let v=new Ve,g=new A,m=new Yt,_=new A(1,1,1),x=new Oc(p.geometry,p.material,f);for(let y=0;y<f;y++)c.TRANSLATION&&g.fromBufferAttribute(c.TRANSLATION,y),c.ROTATION&&m.fromBufferAttribute(c.ROTATION,y),c.SCALE&&_.fromBufferAttribute(c.SCALE,y),x.setMatrixAt(y,v.compose(g,m,_));for(let y in c)if(y==="_COLOR_0"){let D=c[y];x.instanceColor=new ar(D.array,D.itemSize,D.normalized)}else y!=="TRANSLATION"&&y!=="ROTATION"&&y!=="SCALE"&&p.geometry.setAttribute(y,c[y]);Rt.prototype.copy.call(x,p),this.parser.assignFinalMaterial(x),h.push(x)}return u.isGroup?(u.clear(),u.add(...h),u):h[0]}))}},PR="glTF",Vd=12,DR={JSON:1313821514,BIN:5130562},AS=class{constructor(e){this.name=dt.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,Vd),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==PR)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-Vd,s=new DataView(e,Vd),o=0;for(;o<r;){let a=s.getUint32(o,!0);o+=4;let c=s.getUint32(o,!0);if(o+=4,c===DR.JSON){let l=new Uint8Array(e,Vd+o,a);this.content=n.decode(l)}else if(c===DR.BIN){let l=Vd+o;this.body=e.slice(l,l+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},DS=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=dt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},c={},l={};for(let u in o){let d=PS[u]||u.toLowerCase();a[d]=o[u]}for(let u in e.attributes){let d=PS[u]||u.toLowerCase();if(o[u]!==void 0){let f=n.accessors[e.attributes[u]],h=dl[f.componentType];l[d]=h.name,c[d]=f.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d,f){r.decodeDracoFile(u,function(h){for(let p in h.attributes){let v=h.attributes[p],g=c[p];g!==void 0&&(v.normalized=g)}d(h)},a,l,Tn,f)})})}},IS=class{constructor(){this.name=dt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},RS=class{constructor(){this.name=dt.KHR_MESH_QUANTIZATION}},zg=class extends us{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=a*2,l=a*3,u=r-t,d=(n-t)/u,f=d*d,h=f*d,p=e*l,v=p-l,g=-2*h+3*f,m=h-f,_=1-g,x=m-f+d;for(let y=0;y!==a;y++){let D=o[v+y+a],w=o[v+y+c]*u,E=o[p+y+a],C=o[p+y]*u;s[y]=_*D+x*w+g*E+m*C}return s}},mj=new Yt,NS=class extends zg{interpolate_(e,t,n,r){let s=super.interpolate_(e,t,n,r);return mj.fromArray(s).normalize().toArray(s),s}},Vi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},dl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},IR={9728:on,9729:Ht,9984:id,9985:Xo,9986:Zs,9987:pi},RR={33071:ei,33648:Jo,10497:as},aS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},PS={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},so={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},gj={CUBICSPLINE:void 0,LINEAR:na,STEP:ta},cS={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function vj(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new Ar({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:or})),i.DefaultMaterial}function ma(i,e,t){for(let n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function _s(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function yj(i,e,t){let n=!1,r=!1,s=!1;for(let l=0,u=e.length;l<u;l++){let d=e[l];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(r=!0),d.COLOR_0!==void 0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);let o=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){let d=e[l];if(n){let f=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):i.attributes.position;o.push(f)}if(r){let f=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):i.attributes.normal;a.push(f)}if(s){let f=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):i.attributes.color;c.push(f)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c)]).then(function(l){let u=l[0],d=l[1],f=l[2];return n&&(i.morphAttributes.position=u),r&&(i.morphAttributes.normal=d),s&&(i.morphAttributes.color=f),i.morphTargetsRelative=!0,i})}function _j(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function xj(i){let e,t=i.extensions&&i.extensions[dt.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+lS(t.attributes):e=i.indices+":"+lS(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+lS(i.targets[n]);return e}function lS(i){let e="",t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function OS(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Mj(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":i.search(/\.ktx2($|\?)/i)>0||i.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}var Sj=new Ve,LS=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new pj,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,s=!1,o=-1;if(typeof navigator<"u"){let a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;let c=a.match(/Version\/(\d+)/);r=n&&c?parseInt(c[1],10):-1,s=a.indexOf("Firefox")>-1,o=s?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||s&&o<98?this.textureLoader=new fa(this.options.manager):this.textureLoader=new Ju(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new si(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){let a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};return ma(s,a,r),_s(a,r),Promise.all(n._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){for(let c of a.scenes)c.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){let o=t[r].joints;for(let a=0,c=o.length;a<c;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){let o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;let r=n.clone(),s=(o,a)=>{let c=this.associations.get(o);c!=null&&this.associations.set(a,c);for(let[l,u]of o.children.entries())s(u,a.children[l])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){let r=e(t[n]);if(r)return r}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let n=[];for(let r=0;r<t.length;r++){let s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){let n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){let n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[dt.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(s,o){n.load(cr.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){let r=t.byteLength||0,s=t.byteOffset||0;return n.slice(s,s+r)})}loadAccessor(e){let t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){let o=aS[r.type],a=dl[r.componentType],c=r.normalized===!0,l=new a(r.count*o);return Promise.resolve(new xt(l,o,c))}let s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){let a=o[0],c=aS[r.type],l=dl[r.componentType],u=l.BYTES_PER_ELEMENT,d=u*c,f=r.byteOffset||0,h=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0,v,g;if(h&&h!==d){let m=Math.floor(f/h),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count,x=t.cache.get(_);x||(v=new l(a,m*h,r.count*h/u),x=new ls(v,h/u),t.cache.add(_,x)),g=new Cr(x,c,f%h/u,p)}else a===null?v=new l(r.count*c):v=new l(a,f,r.count*c),g=new xt(v,c,p);if(r.sparse!==void 0){let m=aS.SCALAR,_=dl[r.sparse.indices.componentType],x=r.sparse.indices.byteOffset||0,y=r.sparse.values.byteOffset||0,D=new _(o[1],x,r.sparse.count*m),w=new l(o[2],y,r.sparse.count*c);a!==null&&(g=new xt(g.array.slice(),g.itemSize,g.normalized)),g.normalized=!1;for(let E=0,C=D.length;E<C;E++){let S=D[E];if(g.setX(S,w[E*c]),c>=2&&g.setY(S,w[E*c+1]),c>=3&&g.setZ(S,w[E*c+2]),c>=4&&g.setW(S,w[E*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}g.normalized=p}return g})}loadTexture(e){let t=this.json,n=this.options,s=t.textures[e].source,o=t.images[s],a=this.textureLoader;if(o.uri){let c=n.manager.getHandler(o.uri);c!==null&&(a=c)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){let r=this,s=this.json,o=s.textures[e],a=s.images[t],c=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[c])return this.textureCache[c];let l=this.loadImageSource(t,n).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);let f=(s.samplers||{})[o.sampler]||{};return u.magFilter=IR[f.magFilter]||Ht,u.minFilter=IR[f.minFilter]||pi,u.wrapS=RR[f.wrapS]||as,u.wrapT=RR[f.wrapT]||as,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==on&&u.minFilter!==Ht,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){let n=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());let o=r.images[e],a=self.URL||self.webkitURL,c=o.uri||"",l=!1;if(o.bufferView!==void 0)c=n.getDependency("bufferView",o.bufferView).then(function(d){l=!0;let f=new Blob([d],{type:o.mimeType});return c=a.createObjectURL(f),c});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let u=Promise.resolve(c).then(function(d){return new Promise(function(f,h){let p=f;t.isImageBitmapLoader===!0&&(p=function(v){let g=new cn(v);g.needsUpdate=!0,f(g)}),t.load(cr.resolveURL(d,s.path),p,void 0,h)})}).then(function(d){return l===!0&&a.revokeObjectURL(c),_s(d,o),d.userData.mimeType=o.mimeType||Mj(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),d});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){let s=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),s.extensions[dt.KHR_TEXTURE_TRANSFORM]){let a=n.extensions!==void 0?n.extensions[dt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){let c=s.associations.get(o);o=s.extensions[dt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,c)}}return r!==void 0&&(o.colorSpace=r),e[t]=o,o})}assignFinalMaterial(e){let t=e.geometry,n=e.material,r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+n.uuid,c=this.cache.get(a);c||(c=new ca,Zt.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(a,c)),n=c}else if(e.isLine){let a="LineBasicMaterial:"+n.uuid,c=this.cache.get(a);c||(c=new gn,Zt.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,this.cache.add(a,c)),n=c}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=n.clone(),s&&(c.vertexColors=!0),o&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(n))),n=c}e.material=n}getMaterialType(){return Ar}loadMaterial(e){let t=this,n=this.json,r=this.extensions,s=n.materials[e],o,a={},c=s.extensions||{},l=[];if(c[dt.KHR_MATERIALS_UNLIT]){let d=r[dt.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),l.push(d.extendParams(a,s,t))}else{let d=s.pbrMetallicRoughness||{};if(a.color=new de(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){let f=d.baseColorFactor;a.color.setRGB(f[0],f[1],f[2],Tn),a.opacity=f[3]}d.baseColorTexture!==void 0&&l.push(t.assignTexture(a,"map",d.baseColorTexture,sn)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=Qn);let u=s.alphaMode||cS.OPAQUE;if(u===cS.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===cS.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==In&&(l.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new q(1,1),s.normalTexture.scale!==void 0)){let d=s.normalTexture.scale;a.normalScale.set(d,d)}if(s.occlusionTexture!==void 0&&o!==In&&(l.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==In){let d=s.emissiveFactor;a.emissive=new de().setRGB(d[0],d[1],d[2],Tn)}return s.emissiveTexture!==void 0&&o!==In&&l.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,sn)),Promise.all(l).then(function(){let d=new o(a);return s.name&&(d.name=s.name),_s(d,s),t.associations.set(d,{materials:e}),s.extensions&&ma(r,d,s),d})}createUniqueName(e){let t=Nt.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[dt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return NR(c,a,t)})}let o=[];for(let a=0,c=e.length;a<c;a++){let l=e[a],u=xj(l),d=r[u];if(d)o.push(d.promise);else{let f;l.extensions&&l.extensions[dt.KHR_DRACO_MESH_COMPRESSION]?f=s(l):f=NR(new et,l,t),r[u]={primitive:l,promise:f},o.push(f)}}return Promise.all(o)}loadMesh(e){let t=this,n=this.json,r=this.extensions,s=n.meshes[e],o=s.primitives,a=[];for(let c=0,l=o.length;c<l;c++){let u=o[c].material===void 0?vj(this.cache):this.getDependency("material",o[c].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(c){let l=c.slice(0,c.length-1),u=c[c.length-1],d=[];for(let h=0,p=u.length;h<p;h++){let v=u[h],g=o[h],m,_=l[h];if(g.mode===Vi.TRIANGLES||g.mode===Vi.TRIANGLE_STRIP||g.mode===Vi.TRIANGLE_FAN||g.mode===void 0)m=s.isSkinnedMesh===!0?new Nc(v,_):new Ft(v,_),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),g.mode===Vi.TRIANGLE_STRIP?m.geometry=oS(m.geometry,sd):g.mode===Vi.TRIANGLE_FAN&&(m.geometry=oS(m.geometry,qc));else if(g.mode===Vi.LINES)m=new ri(v,_);else if(g.mode===Vi.LINE_STRIP)m=new Ui(v,_);else if(g.mode===Vi.LINE_LOOP)m=new Lc(v,_);else if(g.mode===Vi.POINTS)m=new Fc(v,_);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(m.geometry.morphAttributes).length>0&&_j(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),_s(m,s),g.extensions&&ma(r,m,g),t.assignFinalMaterial(m),d.push(m)}for(let h=0,p=d.length;h<p;h++)t.associations.set(d[h],{meshes:e,primitives:h});if(d.length===1)return s.extensions&&ma(r,d[0],s),d[0];let f=new Li;s.extensions&&ma(r,f,s),t.associations.set(f,{meshes:e});for(let h=0,p=d.length;h<p;h++)f.add(d[h]);return f})}loadCamera(e){let t,n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Ot(ad.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new ii(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),_s(t,n),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],n=[];for(let r=0,s=t.joints.length;r<s;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){let s=r.pop(),o=r,a=[],c=[];for(let l=0,u=o.length;l<u;l++){let d=o[l];if(d){a.push(d);let f=new Ve;s!==null&&f.fromArray(s.array,l*16),c.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new Pc(a,c)})}loadAnimation(e){let t=this.json,n=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,o=[],a=[],c=[],l=[],u=[];for(let d=0,f=r.channels.length;d<f;d++){let h=r.channels[d],p=r.samplers[h.sampler],v=h.target,g=v.node,m=r.parameters!==void 0?r.parameters[p.input]:p.input,_=r.parameters!==void 0?r.parameters[p.output]:p.output;v.node!==void 0&&(o.push(this.getDependency("node",g)),a.push(this.getDependency("accessor",m)),c.push(this.getDependency("accessor",_)),l.push(p),u.push(v))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(d){let f=d[0],h=d[1],p=d[2],v=d[3],g=d[4],m=[];for(let _=0,x=f.length;_<x;_++){let y=f[_],D=h[_],w=p[_],E=v[_],C=g[_];if(y===void 0)continue;y.updateMatrix&&y.updateMatrix();let S=n._createAnimationTracks(y,D,w,E,C);if(S)for(let M=0;M<S.length;M++)m.push(S[M])}return new hs(s,void 0,m)})}createNodeMesh(e){let t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(s){let o=n._getNodeRef(n.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),o})}loadNode(e){let t=this.json,n=this,r=t.nodes[e],s=n._loadNodeShallow(e),o=[],a=r.children||[];for(let l=0,u=a.length;l<u;l++)o.push(n.getDependency("node",a[l]));let c=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),c]).then(function(l){let u=l[0],d=l[1],f=l[2];f!==null&&u.traverse(function(h){h.isSkinnedMesh&&h.bind(f,Sj)});for(let h=0,p=d.length;h<p;h++)u.add(d[h]);return u})}_loadNodeShallow(e){let t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],c=r._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(l){return r._getNodeRef(r.cameraCache,s.camera,l)})),r._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let u;if(s.isBone===!0?u=new aa:l.length>1?u=new Li:l.length===1?u=l[0]:u=new Rt,u!==l[0])for(let d=0,f=l.length;d<f;d++)u.add(l[d]);if(s.name&&(u.userData.name=s.name,u.name=o),_s(u,s),s.extensions&&ma(n,u,s),s.matrix!==void 0){let d=new Ve;d.fromArray(s.matrix),u.applyMatrix4(d)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){let t=this.extensions,n=this.json.scenes[e],r=this,s=new Li;n.name&&(s.name=r.createUniqueName(n.name)),_s(s,n),n.extensions&&ma(t,s,n);let o=n.nodes||[],a=[];for(let c=0,l=o.length;c<l;c++)a.push(r.getDependency("node",o[c]));return Promise.all(a).then(function(c){for(let u=0,d=c.length;u<d;u++)s.add(c[u]);let l=u=>{let d=new Map;for(let[f,h]of r.associations)(f instanceof Zt||f instanceof cn)&&d.set(f,h);return u.traverse(f=>{let h=r.associations.get(f);h!=null&&d.set(f,h)}),d};return r.associations=l(s),s})}_createAnimationTracks(e,t,n,r,s){let o=[],a=e.name?e.name:e.uuid,c=[];so[s.path]===so.weights?e.traverse(function(f){f.morphTargetInfluences&&c.push(f.name?f.name:f.uuid)}):c.push(a);let l;switch(so[s.path]){case so.weights:l=Dr;break;case so.rotation:l=Ir;break;case so.position:case so.scale:l=Rr;break;default:switch(n.itemSize){case 1:l=Dr;break;case 2:case 3:default:l=Rr;break}break}let u=r.interpolation!==void 0?gj[r.interpolation]:na,d=this._getArrayFromAccessor(n);for(let f=0,h=c.length;f<h;f++){let p=new l(c[f]+"."+so[s.path],t.array,d,u);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),o.push(p)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let n=OS(t.constructor),r=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)r[s]=t[s]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){let r=this instanceof Ir?NS:zg;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function bj(i,e,t){let n=e.attributes,r=new hn;if(n.POSITION!==void 0){let a=t.json.accessors[n.POSITION],c=a.min,l=a.max;if(c!==void 0&&l!==void 0){if(r.set(new A(c[0],c[1],c[2]),new A(l[0],l[1],l[2])),a.normalized){let u=OS(dl[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let s=e.targets;if(s!==void 0){let a=new A,c=new A;for(let l=0,u=s.length;l<u;l++){let d=s[l];if(d.POSITION!==void 0){let f=t.json.accessors[d.POSITION],h=f.min,p=f.max;if(h!==void 0&&p!==void 0){if(c.setX(Math.max(Math.abs(h[0]),Math.abs(p[0]))),c.setY(Math.max(Math.abs(h[1]),Math.abs(p[1]))),c.setZ(Math.max(Math.abs(h[2]),Math.abs(p[2]))),f.normalized){let v=OS(dl[f.componentType]);c.multiplyScalar(v)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;let o=new an;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}function NR(i,e,t){let n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(c){i.setAttribute(a,c)})}for(let o in n){let a=PS[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(e.indices!==void 0&&!i.index){let o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return it.workingColorSpace!==Tn&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${it.workingColorSpace}" not supported.`),_s(i,e),bj(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?yj(i,e.targets,t):i})}var fl=class i{selectedColor=Di("#ff0000");uploadedLogo=Di(null);decalSettings=Di({position:new A(1,0,0),size:1,rotation:0});get color(){return this.selectedColor()}setColor(e){this.selectedColor.set(e)}get logo(){return this.uploadedLogo()}setLogo(e){this.uploadedLogo.set(e)}updateDecalSettings(e,t){this.decalSettings.update(n=>tt(ie({},n),{size:e,rotation:t}))}updateDecalPosition(e,t,n){this.decalSettings.update(r=>tt(ie({},r),{position:new A(e,t,n)}))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ej=Object.defineProperty,Tj=(i,e,t)=>e in i?Ej(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Cj=(i,e,t)=>(Tj(i,typeof e!="symbol"?e+"":e,t),t),Hg=class{constructor(){Cj(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let n=this._listeners[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};var Aj=Object.defineProperty,Dj=(i,e,t)=>e in i?Aj(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ze=(i,e,t)=>(Dj(i,typeof e!="symbol"?e+"":e,t),t),Gg=new wr,OR=new Oi,Ij=Math.cos(70*(Math.PI/180)),LR=(i,e)=>(i%e+e)%e,zd=class extends Hg{constructor(e,t){super(),ze(this,"object"),ze(this,"domElement"),ze(this,"enabled",!0),ze(this,"target",new A),ze(this,"minDistance",0),ze(this,"maxDistance",1/0),ze(this,"minZoom",0),ze(this,"maxZoom",1/0),ze(this,"minPolarAngle",0),ze(this,"maxPolarAngle",Math.PI),ze(this,"minAzimuthAngle",-1/0),ze(this,"maxAzimuthAngle",1/0),ze(this,"enableDamping",!1),ze(this,"dampingFactor",.05),ze(this,"enableZoom",!0),ze(this,"zoomSpeed",1),ze(this,"enableRotate",!0),ze(this,"rotateSpeed",1),ze(this,"enablePan",!0),ze(this,"panSpeed",1),ze(this,"screenSpacePanning",!0),ze(this,"keyPanSpeed",7),ze(this,"zoomToCursor",!1),ze(this,"autoRotate",!1),ze(this,"autoRotateSpeed",2),ze(this,"reverseOrbit",!1),ze(this,"reverseHorizontalOrbit",!1),ze(this,"reverseVerticalOrbit",!1),ze(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),ze(this,"mouseButtons",{LEFT:eo.ROTATE,MIDDLE:eo.DOLLY,RIGHT:eo.PAN}),ze(this,"touches",{ONE:to.ROTATE,TWO:to.DOLLY_PAN}),ze(this,"target0"),ze(this,"position0"),ze(this,"zoom0"),ze(this,"_domElementKeyEvents",null),ze(this,"getPolarAngle"),ze(this,"getAzimuthalAngle"),ze(this,"setPolarAngle"),ze(this,"setAzimuthalAngle"),ze(this,"getDistance"),ze(this,"getZoomScale"),ze(this,"listenToKeyEvents"),ze(this,"stopListenToKeyEvents"),ze(this,"saveState"),ze(this,"reset"),ze(this,"update"),ze(this,"connect"),ze(this,"dispose"),ze(this,"dollyIn"),ze(this,"dollyOut"),ze(this,"getScale"),ze(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=O=>{let Z=LR(O,2*Math.PI),ve=u.phi;ve<0&&(ve+=2*Math.PI),Z<0&&(Z+=2*Math.PI);let P=Math.abs(Z-ve);2*Math.PI-P<P&&(Z<ve?Z+=2*Math.PI:ve+=2*Math.PI),d.phi=Z-ve,n.update()},this.setAzimuthalAngle=O=>{let Z=LR(O,2*Math.PI),ve=u.theta;ve<0&&(ve+=2*Math.PI),Z<0&&(Z+=2*Math.PI);let P=Math.abs(Z-ve);2*Math.PI-P<P&&(Z<ve?Z+=2*Math.PI:ve+=2*Math.PI),d.theta=Z-ve,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=O=>{O.addEventListener("keydown",pe),this._domElementKeyEvents=O},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",pe),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),c=a.NONE},this.update=(()=>{let O=new A,Z=new A(0,1,0),ve=new Yt().setFromUnitVectors(e.up,Z),P=ve.clone().invert(),oe=new A,W=new Yt,Q=2*Math.PI;return function(){let ye=n.object.position;ve.setFromUnitVectors(e.up,Z),P.copy(ve).invert(),O.copy(ye).sub(n.target),O.applyQuaternion(ve),u.setFromVector3(O),n.autoRotate&&c===a.NONE&&j(B()),n.enableDamping?(u.theta+=d.theta*n.dampingFactor,u.phi+=d.phi*n.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi);let Ge=n.minAzimuthAngle,wt=n.maxAzimuthAngle;isFinite(Ge)&&isFinite(wt)&&(Ge<-Math.PI?Ge+=Q:Ge>Math.PI&&(Ge-=Q),wt<-Math.PI?wt+=Q:wt>Math.PI&&(wt-=Q),Ge<=wt?u.theta=Math.max(Ge,Math.min(wt,u.theta)):u.theta=u.theta>(Ge+wt)/2?Math.max(Ge,u.theta):Math.min(wt,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),n.zoomToCursor&&S||n.object.isOrthographicCamera?u.radius=Mt(u.radius):u.radius=Mt(u.radius*f),O.setFromSpherical(u),O.applyQuaternion(P),ye.copy(n.target).add(O),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),h.set(0,0,0));let Gt=!1;if(n.zoomToCursor&&S){let mt=null;if(n.object instanceof Ot&&n.object.isPerspectiveCamera){let Mn=O.length();mt=Mt(Mn*f);let Hn=Mn-mt;n.object.position.addScaledVector(E,Hn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){let Mn=new A(C.x,C.y,0);Mn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix(),Gt=!0;let Hn=new A(C.x,C.y,0);Hn.unproject(n.object),n.object.position.sub(Hn).add(Mn),n.object.updateMatrixWorld(),mt=O.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;mt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(mt).add(n.object.position):(Gg.origin.copy(n.object.position),Gg.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Gg.direction))<Ij?e.lookAt(n.target):(OR.setFromNormalAndCoplanarPoint(n.object.up,n.target),Gg.intersectPlane(OR,n.target))))}else n.object instanceof ii&&n.object.isOrthographicCamera&&(Gt=f!==1,Gt&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/f)),n.object.updateProjectionMatrix()));return f=1,S=!1,Gt||oe.distanceToSquared(n.object.position)>l||8*(1-W.dot(n.object.quaternion))>l?(n.dispatchEvent(r),oe.copy(n.object.position),W.copy(n.object.quaternion),Gt=!1,!0):!1}})(),this.connect=O=>{n.domElement=O,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",se),n.domElement.addEventListener("pointerdown",b),n.domElement.addEventListener("pointercancel",X),n.domElement.addEventListener("wheel",De)},this.dispose=()=>{var O,Z,ve,P,oe,W;n.domElement&&(n.domElement.style.touchAction="auto"),(O=n.domElement)==null||O.removeEventListener("contextmenu",se),(Z=n.domElement)==null||Z.removeEventListener("pointerdown",b),(ve=n.domElement)==null||ve.removeEventListener("pointercancel",X),(P=n.domElement)==null||P.removeEventListener("wheel",De),(oe=n.domElement)==null||oe.ownerDocument.removeEventListener("pointermove",U),(W=n.domElement)==null||W.ownerDocument.removeEventListener("pointerup",X),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",pe)};let n=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},c=a.NONE,l=1e-6,u=new Gc,d=new Gc,f=1,h=new A,p=new q,v=new q,g=new q,m=new q,_=new q,x=new q,y=new q,D=new q,w=new q,E=new A,C=new q,S=!1,M=[],R={};function B(){return 2*Math.PI/60/60*n.autoRotateSpeed}function k(){return Math.pow(.95,n.zoomSpeed)}function j(O){n.reverseOrbit||n.reverseHorizontalOrbit?d.theta+=O:d.theta-=O}function Y(O){n.reverseOrbit||n.reverseVerticalOrbit?d.phi+=O:d.phi-=O}let V=(()=>{let O=new A;return function(ve,P){O.setFromMatrixColumn(P,0),O.multiplyScalar(-ve),h.add(O)}})(),$=(()=>{let O=new A;return function(ve,P){n.screenSpacePanning===!0?O.setFromMatrixColumn(P,1):(O.setFromMatrixColumn(P,0),O.crossVectors(n.object.up,O)),O.multiplyScalar(ve),h.add(O)}})(),z=(()=>{let O=new A;return function(ve,P){let oe=n.domElement;if(oe&&n.object instanceof Ot&&n.object.isPerspectiveCamera){let W=n.object.position;O.copy(W).sub(n.target);let Q=O.length();Q*=Math.tan(n.object.fov/2*Math.PI/180),V(2*ve*Q/oe.clientHeight,n.object.matrix),$(2*P*Q/oe.clientHeight,n.object.matrix)}else oe&&n.object instanceof ii&&n.object.isOrthographicCamera?(V(ve*(n.object.right-n.object.left)/n.object.zoom/oe.clientWidth,n.object.matrix),$(P*(n.object.top-n.object.bottom)/n.object.zoom/oe.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ce(O){n.object instanceof Ot&&n.object.isPerspectiveCamera||n.object instanceof ii&&n.object.isOrthographicCamera?f=O:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function ge(O){ce(f/O)}function we(O){ce(f*O)}function Je(O){if(!n.zoomToCursor||!n.domElement)return;S=!0;let Z=n.domElement.getBoundingClientRect(),ve=O.clientX-Z.left,P=O.clientY-Z.top,oe=Z.width,W=Z.height;C.x=ve/oe*2-1,C.y=-(P/W)*2+1,E.set(C.x,C.y,1).unproject(n.object).sub(n.object.position).normalize()}function Mt(O){return Math.max(n.minDistance,Math.min(n.maxDistance,O))}function J(O){p.set(O.clientX,O.clientY)}function le(O){Je(O),y.set(O.clientX,O.clientY)}function Ae(O){m.set(O.clientX,O.clientY)}function fe(O){v.set(O.clientX,O.clientY),g.subVectors(v,p).multiplyScalar(n.rotateSpeed);let Z=n.domElement;Z&&(j(2*Math.PI*g.x/Z.clientHeight),Y(2*Math.PI*g.y/Z.clientHeight)),p.copy(v),n.update()}function Be(O){D.set(O.clientX,O.clientY),w.subVectors(D,y),w.y>0?ge(k()):w.y<0&&we(k()),y.copy(D),n.update()}function Ze(O){_.set(O.clientX,O.clientY),x.subVectors(_,m).multiplyScalar(n.panSpeed),z(x.x,x.y),m.copy(_),n.update()}function $e(O){Je(O),O.deltaY<0?we(k()):O.deltaY>0&&ge(k()),n.update()}function pt(O){let Z=!1;switch(O.code){case n.keys.UP:z(0,n.keyPanSpeed),Z=!0;break;case n.keys.BOTTOM:z(0,-n.keyPanSpeed),Z=!0;break;case n.keys.LEFT:z(n.keyPanSpeed,0),Z=!0;break;case n.keys.RIGHT:z(-n.keyPanSpeed,0),Z=!0;break}Z&&(O.preventDefault(),n.update())}function te(){if(M.length==1)p.set(M[0].pageX,M[0].pageY);else{let O=.5*(M[0].pageX+M[1].pageX),Z=.5*(M[0].pageY+M[1].pageY);p.set(O,Z)}}function ae(){if(M.length==1)m.set(M[0].pageX,M[0].pageY);else{let O=.5*(M[0].pageX+M[1].pageX),Z=.5*(M[0].pageY+M[1].pageY);m.set(O,Z)}}function N(){let O=M[0].pageX-M[1].pageX,Z=M[0].pageY-M[1].pageY,ve=Math.sqrt(O*O+Z*Z);y.set(0,ve)}function Ie(){n.enableZoom&&N(),n.enablePan&&ae()}function re(){n.enableZoom&&N(),n.enableRotate&&te()}function Me(O){if(M.length==1)v.set(O.pageX,O.pageY);else{let ve=Ee(O),P=.5*(O.pageX+ve.x),oe=.5*(O.pageY+ve.y);v.set(P,oe)}g.subVectors(v,p).multiplyScalar(n.rotateSpeed);let Z=n.domElement;Z&&(j(2*Math.PI*g.x/Z.clientHeight),Y(2*Math.PI*g.y/Z.clientHeight)),p.copy(v)}function he(O){if(M.length==1)_.set(O.pageX,O.pageY);else{let Z=Ee(O),ve=.5*(O.pageX+Z.x),P=.5*(O.pageY+Z.y);_.set(ve,P)}x.subVectors(_,m).multiplyScalar(n.panSpeed),z(x.x,x.y),m.copy(_)}function He(O){let Z=Ee(O),ve=O.pageX-Z.x,P=O.pageY-Z.y,oe=Math.sqrt(ve*ve+P*P);D.set(0,oe),w.set(0,Math.pow(D.y/y.y,n.zoomSpeed)),ge(w.y),y.copy(D)}function Se(O){n.enableZoom&&He(O),n.enablePan&&he(O)}function I(O){n.enableZoom&&He(O),n.enableRotate&&Me(O)}function b(O){var Z,ve;n.enabled!==!1&&(M.length===0&&((Z=n.domElement)==null||Z.ownerDocument.addEventListener("pointermove",U),(ve=n.domElement)==null||ve.ownerDocument.addEventListener("pointerup",X)),Te(O),O.pointerType==="touch"?be(O):ne(O))}function U(O){n.enabled!==!1&&(O.pointerType==="touch"?lt(O):K(O))}function X(O){var Z,ve,P;We(O),M.length===0&&((Z=n.domElement)==null||Z.releasePointerCapture(O.pointerId),(ve=n.domElement)==null||ve.ownerDocument.removeEventListener("pointermove",U),(P=n.domElement)==null||P.ownerDocument.removeEventListener("pointerup",X)),n.dispatchEvent(o),c=a.NONE}function ne(O){let Z;switch(O.button){case 0:Z=n.mouseButtons.LEFT;break;case 1:Z=n.mouseButtons.MIDDLE;break;case 2:Z=n.mouseButtons.RIGHT;break;default:Z=-1}switch(Z){case eo.DOLLY:if(n.enableZoom===!1)return;le(O),c=a.DOLLY;break;case eo.ROTATE:if(O.ctrlKey||O.metaKey||O.shiftKey){if(n.enablePan===!1)return;Ae(O),c=a.PAN}else{if(n.enableRotate===!1)return;J(O),c=a.ROTATE}break;case eo.PAN:if(O.ctrlKey||O.metaKey||O.shiftKey){if(n.enableRotate===!1)return;J(O),c=a.ROTATE}else{if(n.enablePan===!1)return;Ae(O),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(s)}function K(O){if(n.enabled!==!1)switch(c){case a.ROTATE:if(n.enableRotate===!1)return;fe(O);break;case a.DOLLY:if(n.enableZoom===!1)return;Be(O);break;case a.PAN:if(n.enablePan===!1)return;Ze(O);break}}function De(O){n.enabled===!1||n.enableZoom===!1||c!==a.NONE&&c!==a.ROTATE||(O.preventDefault(),n.dispatchEvent(s),$e(O),n.dispatchEvent(o))}function pe(O){n.enabled===!1||n.enablePan===!1||pt(O)}function be(O){switch(Xe(O),M.length){case 1:switch(n.touches.ONE){case to.ROTATE:if(n.enableRotate===!1)return;te(),c=a.TOUCH_ROTATE;break;case to.PAN:if(n.enablePan===!1)return;ae(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(n.touches.TWO){case to.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ie(),c=a.TOUCH_DOLLY_PAN;break;case to.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;re(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(s)}function lt(O){switch(Xe(O),c){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;Me(O),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;he(O),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Se(O),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;I(O),n.update();break;default:c=a.NONE}}function se(O){n.enabled!==!1&&O.preventDefault()}function Te(O){M.push(O)}function We(O){delete R[O.pointerId];for(let Z=0;Z<M.length;Z++)if(M[Z].pointerId==O.pointerId){M.splice(Z,1);return}}function Xe(O){let Z=R[O.pointerId];Z===void 0&&(Z=new q,R[O.pointerId]=Z),Z.set(O.pageX,O.pageY)}function Ee(O){let Z=O.pointerId===M[0].pointerId?M[1]:M[0];return R[Z.pointerId]}this.dollyIn=(O=k())=>{we(O),n.update()},this.dollyOut=(O=k())=>{ge(O),n.update()},this.getScale=()=>f,this.setScale=O=>{ce(O),n.update()},this.getZoomScale=()=>k(),t!==void 0&&this.connect(t),this.update()}};var Rj=["orbitControls"],Nj=()=>[0,0,1],Pj=i=>[0,0,i],Oj=()=>[1,1,0],Lj=(i,e)=>[i,e,0],Fj=i=>[i],kj=(i,e)=>[i,e],Uj=i=>[1,i,0];function Bj(i,e){i&1&&Zn(0,"ngt-primitive",5),i&2&&yn("position",Qa(1,Uj,-2))}function Vj(i,e){i&1&&Zn(0,"ngt-orbit-controls",6,0),i&2&&yn("enableZoom",!1)("autoRotate",!1)("autoRotateSpeed",5)}iS(cd);iS({OrbitControls:zd});var jg=class i{colorService=ee(fl);ngtStore=ul();gltf=AR(()=>Vg,()=>"assets/bottle.gltf");mouse=new q;scene=this.ngtStore.get().scene;modelMesh=null;currentDecalMesh=null;camera=this.ngtStore.select("camera");glDomElement=this.ngtStore.select("gl","domElement");orbitControls=zl("orbitControls");model=xr(()=>{let e=this.gltf();if(!e)return null;let t=e.scene.getObjectByName("Object_2");t.material.color.set(new de(this.colorService.color)),this.modelMesh=t;let r=this.colorService.logo;if(r){let s=this.colorService.decalSettings();this.applyDecal(t,r,s)}return console.log(e.scene),e.scene});constructor(){rS(()=>{let e=this.orbitControls()?.nativeElement;e&&e.update()}),Wr(()=>{let e=this.colorService.decalSettings(),t=this.colorService.logo;this.modelMesh&&t&&this.applyDecal(this.modelMesh,t,e)})}applyDecal(e,t,n){if(this.currentDecalMesh){this.scene.remove(this.currentDecalMesh),this.currentDecalMesh.geometry.dispose();let u=this.currentDecalMesh.material;Array.isArray(u)?u.forEach(d=>d.dispose()):u.dispose()}let r=1.07,s=1,o=30,a=new Js(r,r,s,o,1,!0);a.rotateY(Math.PI);let c=new Ar({map:t,transparent:!0,side:Qn,depthWrite:!1}),l=new Ft(a,c);l.position.copy(n.position),l.rotation.copy(e.rotation),this.scene.add(l),this.currentDecalMesh=l}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=ui({type:i,selectors:[["ng-component"]],viewQuery:function(t,n){t&1&&Gl(n.orbitControls,Rj,5),t&2&&yh()},standalone:!0,features:[Eo],decls:7,vars:23,consts:[["orbitControls",""],[3,"intensity"],[3,"intensity","position"],[3,"position",4,"args"],[3,"enableZoom","autoRotate","autoRotateSpeed",4,"args"],[3,"position"],[3,"enableZoom","autoRotate","autoRotateSpeed"]],template:function(t,n){t&1&&(Zn(0,"ngt-ambient-light",1)(1,"ngt-directional-light",2)(2,"ngt-directional-light",2)(3,"ngt-point-light",2)(4,"ngt-point-light",2),vh(5,Bj,1,3,"ngt-primitive",3)(6,Vj,2,3,"ngt-orbit-controls",4)),t&2&&(yn("intensity",2),vn(),yn("intensity",2)("position",Wl(11,Nj)),vn(),yn("intensity",2)("position",Qa(12,Pj,-1)),vn(),yn("intensity",.5)("position",Wl(14,Oj)),vn(),yn("intensity",.5)("position",d_(15,Lj,-.5,-.5)),vn(),yn("args",Qa(18,Fj,n.model())),vn(),yn("args",d_(20,kj,n.camera(),n.glDomElement())))},dependencies:[nS],encapsulation:2,changeDetection:0})};var Wg=class i{colorSelected=new tn;selectedColor="#ff0000";selectColor(e){this.colorSelected.emit(e)}onColorChange(e){let t=e.target;this.selectedColor=t.value,this.colorSelected.emit(this.selectedColor)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=ui({type:i,selectors:[["app-color-selector"]],outputs:{colorSelected:"colorSelected"},decls:8,vars:4,consts:[[1,"color-selector-container"],["for","colorPicker",1,"color-label"],["id","colorPicker","type","color",3,"change","value"]],template:function(t,n){t&1&&($t(0,"div",0)(1,"label",1),Ii(2,"Select a Color:"),Qt(),$t(3,"input",2),er("change",function(s){return n.onColorChange(s)}),Qt(),$t(4,"p"),Ii(5,"Selected Color: "),$t(6,"span"),Ii(7),Qt()()()),t&2&&(vn(3),yn("value",n.selectedColor),vn(3),Ja("color",n.selectedColor),vn(),jl(n.selectedColor))},styles:[".color-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.color-box[_ngcontent-%COMP%]{width:40px;height:40px;cursor:pointer;border:2px solid #ccc;border-radius:50%;transition:transform .2s,border .2s}.color-box[_ngcontent-%COMP%]:hover{transform:scale(1.1);border:2px solid #000}.color-selector-container[_ngcontent-%COMP%]{margin-top:20px}.color-label[_ngcontent-%COMP%]{font-size:16px;font-weight:700;display:block;margin-bottom:10px}input[type=color][_ngcontent-%COMP%]{cursor:pointer;width:50px;height:50px;border:none;border-radius:5px;box-shadow:0 2px 5px #0003;transition:transform .2s ease}input[type=color][_ngcontent-%COMP%]:hover{transform:scale(1.1)}"]})};var Hj=()=>[9,4,3],Gj=i=>({zoom:1,position:i}),$g=class i{constructor(e){this.colorService=e}sceneGraph=jg;decalSize=.7;decalRotationDeg=0;logoTexture=null;ngAfterViewInit(){console.log("after view init")}handleColorSelected(e){this.colorService.setColor(e)}onLogoUpload(e){let t=e.target;if(t.files&&t.files[0]){let n=t.files[0],r=new FileReader;r.onload=()=>{let s=r.result,o=new fa;this.logoTexture=o.load(s,a=>{this.colorService.setLogo(a)})},r.readAsDataURL(n)}}onSizeChange(e){let t=+e.target.value;this.decalSize=t,this.colorService.updateDecalSettings(t,this.degToRad(this.decalRotationDeg))}onRotationChange(e){let t=+e.target.value;this.decalRotationDeg=t,this.colorService.updateDecalSettings(this.decalSize,this.degToRad(t))}degToRad(e){return e*Math.PI/180}static \u0275fac=function(t){return new(t||i)(yr(fl))};static \u0275cmp=ui({type:i,selectors:[["app-product-viewer"]],decls:29,vars:9,consts:[[1,"product-container","container"],[1,"row"],[1,"col-12","col-mg-6","col-lg-6"],[1,"section"],[3,"colorSelected"],[1,"section","mt-4"],[1,"form-group"],["for","logo"],["type","file","id","logo","accept","image/*",1,"form-control",3,"change"],[1,"progress-bar-container","mt-3"],["for","sizeSlider"],["type","range","id","sizeSlider","min","0.1","max","5","step","0.1",3,"input","value"],["for","rotationSlider"],["type","range","id","rotationSlider","min","0","max","360","step","1",3,"input","value"],[1,"col-12","col-md-6","col-lg-6"],[3,"sceneGraph","camera"]],template:function(t,n){t&1&&($t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),Ii(5,"choose color"),Qt(),$t(6,"app-color-selector",4),er("colorSelected",function(s){return n.handleColorSelected(s)}),Qt()(),$t(7,"div",5)(8,"h2"),Ii(9,"Upload Logo"),Qt(),$t(10,"form")(11,"div",6)(12,"label",7),Ii(13,"Upload Logo"),Qt(),$t(14,"input",8),er("change",function(s){return n.onLogoUpload(s)}),Qt()()()(),$t(15,"div",9)(16,"label",10),Ii(17,"Adjust Logo Size"),Qt(),$t(18,"input",11),er("input",function(s){return n.onSizeChange(s)}),Qt(),$t(19,"span"),Ii(20),Qt()(),$t(21,"div",9)(22,"label",12),Ii(23,"Adjust Logo Rotation (\xB0)"),Qt(),$t(24,"input",13),er("input",function(s){return n.onRotationChange(s)}),Qt(),$t(25,"span"),Ii(26),Qt()()(),$t(27,"div",14),Zn(28,"ngt-canvas",15),Qt()()()),t&2&&(vn(18),yn("value",n.decalSize),vn(2),jl(n.decalSize),vn(4),yn("value",n.decalRotationDeg),vn(2),_h("",n.decalRotationDeg,"\xB0"),vn(2),yn("sceneGraph",n.sceneGraph)("camera",Qa(7,Gj,Wl(6,Hj))))},dependencies:[Ug,Wg],styles:["[_nghost-%COMP%]{display:block}.product-container[_ngcontent-%COMP%]{height:100vh;margin:30px auto}.product-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-top:20px;height:inherit}"]})};var qg=class i{title="product-viewer";static \u0275fac=function(t){return new(t||i)};static \u0275cmp=ui({type:i,selectors:[["app-root"]],decls:2,vars:0,template:function(t,n){t&1&&Zn(0,"app-product-viewer")(1,"router-outlet")},dependencies:[Ad,$g],styles:[`[_nghost-%COMP%] {
    --bright-blue: oklch(51.01% 0.274 263.83);
    --electric-violet: oklch(53.18% 0.28 296.97);
    --french-violet: oklch(47.66% 0.246 305.88);
    --vivid-pink: oklch(69.02% 0.277 332.77);
    --hot-red: oklch(61.42% 0.238 15.34);
    --orange-red: oklch(63.32% 0.24 31.68);

    --gray-900: oklch(19.37% 0.006 300.98);
    --gray-700: oklch(36.98% 0.014 302.71);
    --gray-400: oklch(70.9% 0.015 304.04);

    --red-to-pink-to-purple-vertical-gradient: linear-gradient(
      180deg,
      var(--orange-red) 0%,
      var(--vivid-pink) 50%,
      var(--electric-violet) 100%
    );

    --red-to-pink-to-purple-horizontal-gradient: linear-gradient(
      90deg,
      var(--orange-red) 0%,
      var(--vivid-pink) 50%,
      var(--electric-violet) 100%
    );

    --pill-accent: var(--bright-blue);

    font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  h1[_ngcontent-%COMP%] {
    font-size: 3.125rem;
    color: var(--gray-900);
    font-weight: 500;
    line-height: 100%;
    letter-spacing: -0.125rem;
    margin: 0;
    font-family: "Inter Tight", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
  }

  p[_ngcontent-%COMP%] {
    margin: 0;
    color: var(--gray-700);
  }

  main[_ngcontent-%COMP%] {
    width: 100%;
    min-height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    box-sizing: inherit;
    position: relative;
  }

  .angular-logo[_ngcontent-%COMP%] {
    max-width: 9.2rem;
  }

  .content[_ngcontent-%COMP%] {
    display: flex;
    justify-content: space-around;
    width: 100%;
    max-width: 700px;
    margin-bottom: 3rem;
  }

  .content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%] {
    margin-top: 1.75rem;
  }

  .content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {
    margin-top: 1.5rem;
  }

  .divider[_ngcontent-%COMP%] {
    width: 1px;
    background: var(--red-to-pink-to-purple-vertical-gradient);
    margin-inline: 0.5rem;
  }

  .pill-group[_ngcontent-%COMP%] {
    display: flex;
    flex-direction: column;
    align-items: start;
    flex-wrap: wrap;
    gap: 1.25rem;
  }

  .pill[_ngcontent-%COMP%] {
    display: flex;
    align-items: center;
    --pill-accent: var(--bright-blue);
    background: color-mix(in srgb, var(--pill-accent) 5%, transparent);
    color: var(--pill-accent);
    padding-inline: 0.75rem;
    padding-block: 0.375rem;
    border-radius: 2.75rem;
    border: 0;
    transition: background 0.3s ease;
    font-family: var(--inter-font);
    font-size: 0.875rem;
    font-style: normal;
    font-weight: 500;
    line-height: 1.4rem;
    letter-spacing: -0.00875rem;
    text-decoration: none;
  }

  .pill[_ngcontent-%COMP%]:hover {
    background: color-mix(in srgb, var(--pill-accent) 15%, transparent);
  }

  .pill-group[_ngcontent-%COMP%]   .pill[_ngcontent-%COMP%]:nth-child(6n + 1) {
    --pill-accent: var(--bright-blue);
  }
  .pill-group[_ngcontent-%COMP%]   .pill[_ngcontent-%COMP%]:nth-child(6n + 2) {
    --pill-accent: var(--french-violet);
  }
  .pill-group[_ngcontent-%COMP%]   .pill[_ngcontent-%COMP%]:nth-child(6n + 3), 
   .pill-group[_ngcontent-%COMP%]   .pill[_ngcontent-%COMP%]:nth-child(6n + 4), 
   .pill-group[_ngcontent-%COMP%]   .pill[_ngcontent-%COMP%]:nth-child(6n + 5) {
    --pill-accent: var(--hot-red);
  }

  .pill-group[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%] {
    margin-inline-start: 0.25rem;
  }

  .social-links[_ngcontent-%COMP%] {
    display: flex;
    align-items: center;
    gap: 0.73rem;
    margin-top: 1.5rem;
  }

  .social-links[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {
    transition: fill 0.3s ease;
    fill: var(--gray-400);
  }

  .social-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {
    fill: var(--gray-900);
  }

  @media screen and (max-width: 650px) {
    .content[_ngcontent-%COMP%] {
      flex-direction: column;
      width: max-content;
    }

    .divider[_ngcontent-%COMP%] {
      height: 1px;
      width: 100%;
      background: var(--red-to-pink-to-purple-horizontal-gradient);
      margin-block: 1.5rem;
    }
  }`]})};var Xg=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=Ki({type:i,bootstrap:[qg]});static \u0275inj=Zi({imports:[_C,Bg,Ug]})};yC().bootstrapModule(Xg,{ngZoneEventCoalescing:!0}).catch(i=>console.error(i));
